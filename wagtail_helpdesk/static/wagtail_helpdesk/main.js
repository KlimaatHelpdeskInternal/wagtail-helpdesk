/******/ (function() { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "definitionForModuleAndIdentifier": function() { return /* binding */ definitionForModuleAndIdentifier; },
/* harmony export */   "definitionForModuleWithContextAndKey": function() { return /* binding */ definitionForModuleWithContextAndKey; },
/* harmony export */   "definitionsFromContext": function() { return /* binding */ definitionsFromContext; },
/* harmony export */   "identifierForContextKey": function() { return /* binding */ identifierForContextKey; }
/* harmony export */ });
/*
Stimulus Webpack Helpers 1.0.0
Copyright © 2021 Basecamp, LLC
 */
function definitionsFromContext(context) {
    return context.keys()
        .map((key) => definitionForModuleWithContextAndKey(context, key))
        .filter((value) => value);
}
function definitionForModuleWithContextAndKey(context, key) {
    const identifier = identifierForContextKey(key);
    if (identifier) {
        return definitionForModuleAndIdentifier(context(key), identifier);
    }
}
function definitionForModuleAndIdentifier(module, identifier) {
    const controllerConstructor = module.default;
    if (typeof controllerConstructor == "function") {
        return { identifier, controllerConstructor };
    }
}
function identifierForContextKey(key) {
    const logicalName = (key.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/) || [])[1];
    if (logicalName) {
        return logicalName.replace(/_/g, "-").replace(/\//g, "--");
    }
}




/***/ }),

/***/ "./node_modules/@hotwired/stimulus/dist/stimulus.js":
/*!**********************************************************!*\
  !*** ./node_modules/@hotwired/stimulus/dist/stimulus.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Application": function() { return /* binding */ Application; },
/* harmony export */   "AttributeObserver": function() { return /* binding */ AttributeObserver; },
/* harmony export */   "Context": function() { return /* binding */ Context; },
/* harmony export */   "Controller": function() { return /* binding */ Controller; },
/* harmony export */   "ElementObserver": function() { return /* binding */ ElementObserver; },
/* harmony export */   "IndexedMultimap": function() { return /* binding */ IndexedMultimap; },
/* harmony export */   "Multimap": function() { return /* binding */ Multimap; },
/* harmony export */   "SelectorObserver": function() { return /* binding */ SelectorObserver; },
/* harmony export */   "StringMapObserver": function() { return /* binding */ StringMapObserver; },
/* harmony export */   "TokenListObserver": function() { return /* binding */ TokenListObserver; },
/* harmony export */   "ValueListObserver": function() { return /* binding */ ValueListObserver; },
/* harmony export */   "add": function() { return /* binding */ add; },
/* harmony export */   "defaultSchema": function() { return /* binding */ defaultSchema; },
/* harmony export */   "del": function() { return /* binding */ del; },
/* harmony export */   "fetch": function() { return /* binding */ fetch; },
/* harmony export */   "prune": function() { return /* binding */ prune; }
/* harmony export */ });
/*
Stimulus 3.2.1
Copyright © 2022 Basecamp, LLC
 */
class EventListener {
    constructor(eventTarget, eventName, eventOptions) {
        this.eventTarget = eventTarget;
        this.eventName = eventName;
        this.eventOptions = eventOptions;
        this.unorderedBindings = new Set();
    }
    connect() {
        this.eventTarget.addEventListener(this.eventName, this, this.eventOptions);
    }
    disconnect() {
        this.eventTarget.removeEventListener(this.eventName, this, this.eventOptions);
    }
    bindingConnected(binding) {
        this.unorderedBindings.add(binding);
    }
    bindingDisconnected(binding) {
        this.unorderedBindings.delete(binding);
    }
    handleEvent(event) {
        const extendedEvent = extendEvent(event);
        for (const binding of this.bindings) {
            if (extendedEvent.immediatePropagationStopped) {
                break;
            }
            else {
                binding.handleEvent(extendedEvent);
            }
        }
    }
    hasBindings() {
        return this.unorderedBindings.size > 0;
    }
    get bindings() {
        return Array.from(this.unorderedBindings).sort((left, right) => {
            const leftIndex = left.index, rightIndex = right.index;
            return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;
        });
    }
}
function extendEvent(event) {
    if ("immediatePropagationStopped" in event) {
        return event;
    }
    else {
        const { stopImmediatePropagation } = event;
        return Object.assign(event, {
            immediatePropagationStopped: false,
            stopImmediatePropagation() {
                this.immediatePropagationStopped = true;
                stopImmediatePropagation.call(this);
            },
        });
    }
}

class Dispatcher {
    constructor(application) {
        this.application = application;
        this.eventListenerMaps = new Map();
        this.started = false;
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.eventListeners.forEach((eventListener) => eventListener.connect());
        }
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.eventListeners.forEach((eventListener) => eventListener.disconnect());
        }
    }
    get eventListeners() {
        return Array.from(this.eventListenerMaps.values()).reduce((listeners, map) => listeners.concat(Array.from(map.values())), []);
    }
    bindingConnected(binding) {
        this.fetchEventListenerForBinding(binding).bindingConnected(binding);
    }
    bindingDisconnected(binding, clearEventListeners = false) {
        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);
        if (clearEventListeners)
            this.clearEventListenersForBinding(binding);
    }
    handleError(error, message, detail = {}) {
        this.application.handleError(error, `Error ${message}`, detail);
    }
    clearEventListenersForBinding(binding) {
        const eventListener = this.fetchEventListenerForBinding(binding);
        if (!eventListener.hasBindings()) {
            eventListener.disconnect();
            this.removeMappedEventListenerFor(binding);
        }
    }
    removeMappedEventListenerFor(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        eventListenerMap.delete(cacheKey);
        if (eventListenerMap.size == 0)
            this.eventListenerMaps.delete(eventTarget);
    }
    fetchEventListenerForBinding(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        return this.fetchEventListener(eventTarget, eventName, eventOptions);
    }
    fetchEventListener(eventTarget, eventName, eventOptions) {
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        let eventListener = eventListenerMap.get(cacheKey);
        if (!eventListener) {
            eventListener = this.createEventListener(eventTarget, eventName, eventOptions);
            eventListenerMap.set(cacheKey, eventListener);
        }
        return eventListener;
    }
    createEventListener(eventTarget, eventName, eventOptions) {
        const eventListener = new EventListener(eventTarget, eventName, eventOptions);
        if (this.started) {
            eventListener.connect();
        }
        return eventListener;
    }
    fetchEventListenerMapForEventTarget(eventTarget) {
        let eventListenerMap = this.eventListenerMaps.get(eventTarget);
        if (!eventListenerMap) {
            eventListenerMap = new Map();
            this.eventListenerMaps.set(eventTarget, eventListenerMap);
        }
        return eventListenerMap;
    }
    cacheKey(eventName, eventOptions) {
        const parts = [eventName];
        Object.keys(eventOptions)
            .sort()
            .forEach((key) => {
            parts.push(`${eventOptions[key] ? "" : "!"}${key}`);
        });
        return parts.join(":");
    }
}

const defaultActionDescriptorFilters = {
    stop({ event, value }) {
        if (value)
            event.stopPropagation();
        return true;
    },
    prevent({ event, value }) {
        if (value)
            event.preventDefault();
        return true;
    },
    self({ event, value, element }) {
        if (value) {
            return element === event.target;
        }
        else {
            return true;
        }
    },
};
const descriptorPattern = /^(?:(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;
function parseActionDescriptorString(descriptorString) {
    const source = descriptorString.trim();
    const matches = source.match(descriptorPattern) || [];
    let eventName = matches[1];
    let keyFilter = matches[2];
    if (keyFilter && !["keydown", "keyup", "keypress"].includes(eventName)) {
        eventName += `.${keyFilter}`;
        keyFilter = "";
    }
    return {
        eventTarget: parseEventTarget(matches[3]),
        eventName,
        eventOptions: matches[6] ? parseEventOptions(matches[6]) : {},
        identifier: matches[4],
        methodName: matches[5],
        keyFilter,
    };
}
function parseEventTarget(eventTargetName) {
    if (eventTargetName == "window") {
        return window;
    }
    else if (eventTargetName == "document") {
        return document;
    }
}
function parseEventOptions(eventOptions) {
    return eventOptions
        .split(":")
        .reduce((options, token) => Object.assign(options, { [token.replace(/^!/, "")]: !/^!/.test(token) }), {});
}
function stringifyEventTarget(eventTarget) {
    if (eventTarget == window) {
        return "window";
    }
    else if (eventTarget == document) {
        return "document";
    }
}

function camelize(value) {
    return value.replace(/(?:[_-])([a-z0-9])/g, (_, char) => char.toUpperCase());
}
function namespaceCamelize(value) {
    return camelize(value.replace(/--/g, "-").replace(/__/g, "_"));
}
function capitalize(value) {
    return value.charAt(0).toUpperCase() + value.slice(1);
}
function dasherize(value) {
    return value.replace(/([A-Z])/g, (_, char) => `-${char.toLowerCase()}`);
}
function tokenize(value) {
    return value.match(/[^\s]+/g) || [];
}

class Action {
    constructor(element, index, descriptor, schema) {
        this.element = element;
        this.index = index;
        this.eventTarget = descriptor.eventTarget || element;
        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error("missing event name");
        this.eventOptions = descriptor.eventOptions || {};
        this.identifier = descriptor.identifier || error("missing identifier");
        this.methodName = descriptor.methodName || error("missing method name");
        this.keyFilter = descriptor.keyFilter || "";
        this.schema = schema;
    }
    static forToken(token, schema) {
        return new this(token.element, token.index, parseActionDescriptorString(token.content), schema);
    }
    toString() {
        const eventFilter = this.keyFilter ? `.${this.keyFilter}` : "";
        const eventTarget = this.eventTargetName ? `@${this.eventTargetName}` : "";
        return `${this.eventName}${eventFilter}${eventTarget}->${this.identifier}#${this.methodName}`;
    }
    isFilterTarget(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filteres = this.keyFilter.split("+");
        const modifiers = ["meta", "ctrl", "alt", "shift"];
        const [meta, ctrl, alt, shift] = modifiers.map((modifier) => filteres.includes(modifier));
        if (event.metaKey !== meta || event.ctrlKey !== ctrl || event.altKey !== alt || event.shiftKey !== shift) {
            return true;
        }
        const standardFilter = filteres.filter((key) => !modifiers.includes(key))[0];
        if (!standardFilter) {
            return false;
        }
        if (!Object.prototype.hasOwnProperty.call(this.keyMappings, standardFilter)) {
            error(`contains unknown key filter: ${this.keyFilter}`);
        }
        return this.keyMappings[standardFilter].toLowerCase() !== event.key.toLowerCase();
    }
    get params() {
        const params = {};
        const pattern = new RegExp(`^data-${this.identifier}-(.+)-param$`, "i");
        for (const { name, value } of Array.from(this.element.attributes)) {
            const match = name.match(pattern);
            const key = match && match[1];
            if (key) {
                params[camelize(key)] = typecast(value);
            }
        }
        return params;
    }
    get eventTargetName() {
        return stringifyEventTarget(this.eventTarget);
    }
    get keyMappings() {
        return this.schema.keyMappings;
    }
}
const defaultEventNames = {
    a: () => "click",
    button: () => "click",
    form: () => "submit",
    details: () => "toggle",
    input: (e) => (e.getAttribute("type") == "submit" ? "click" : "input"),
    select: () => "change",
    textarea: () => "input",
};
function getDefaultEventNameForElement(element) {
    const tagName = element.tagName.toLowerCase();
    if (tagName in defaultEventNames) {
        return defaultEventNames[tagName](element);
    }
}
function error(message) {
    throw new Error(message);
}
function typecast(value) {
    try {
        return JSON.parse(value);
    }
    catch (o_O) {
        return value;
    }
}

class Binding {
    constructor(context, action) {
        this.context = context;
        this.action = action;
    }
    get index() {
        return this.action.index;
    }
    get eventTarget() {
        return this.action.eventTarget;
    }
    get eventOptions() {
        return this.action.eventOptions;
    }
    get identifier() {
        return this.context.identifier;
    }
    handleEvent(event) {
        if (this.willBeInvokedByEvent(event) && this.applyEventModifiers(event)) {
            this.invokeWithEvent(event);
        }
    }
    get eventName() {
        return this.action.eventName;
    }
    get method() {
        const method = this.controller[this.methodName];
        if (typeof method == "function") {
            return method;
        }
        throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`);
    }
    applyEventModifiers(event) {
        const { element } = this.action;
        const { actionDescriptorFilters } = this.context.application;
        let passes = true;
        for (const [name, value] of Object.entries(this.eventOptions)) {
            if (name in actionDescriptorFilters) {
                const filter = actionDescriptorFilters[name];
                passes = passes && filter({ name, value, event, element });
            }
            else {
                continue;
            }
        }
        return passes;
    }
    invokeWithEvent(event) {
        const { target, currentTarget } = event;
        try {
            const { params } = this.action;
            const actionEvent = Object.assign(event, { params });
            this.method.call(this.controller, actionEvent);
            this.context.logDebugActivity(this.methodName, { event, target, currentTarget, action: this.methodName });
        }
        catch (error) {
            const { identifier, controller, element, index } = this;
            const detail = { identifier, controller, element, index, event };
            this.context.handleError(error, `invoking action "${this.action}"`, detail);
        }
    }
    willBeInvokedByEvent(event) {
        const eventTarget = event.target;
        if (event instanceof KeyboardEvent && this.action.isFilterTarget(event)) {
            return false;
        }
        if (this.element === eventTarget) {
            return true;
        }
        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {
            return this.scope.containsElement(eventTarget);
        }
        else {
            return this.scope.containsElement(this.action.element);
        }
    }
    get controller() {
        return this.context.controller;
    }
    get methodName() {
        return this.action.methodName;
    }
    get element() {
        return this.scope.element;
    }
    get scope() {
        return this.context.scope;
    }
}

class ElementObserver {
    constructor(element, delegate) {
        this.mutationObserverInit = { attributes: true, childList: true, subtree: true };
        this.element = element;
        this.started = false;
        this.delegate = delegate;
        this.elements = new Set();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.refresh();
        }
    }
    pause(callback) {
        if (this.started) {
            this.mutationObserver.disconnect();
            this.started = false;
        }
        callback();
        if (!this.started) {
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.started = true;
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            const matches = new Set(this.matchElementsInTree());
            for (const element of Array.from(this.elements)) {
                if (!matches.has(element)) {
                    this.removeElement(element);
                }
            }
            for (const element of Array.from(matches)) {
                this.addElement(element);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        if (mutation.type == "attributes") {
            this.processAttributeChange(mutation.target, mutation.attributeName);
        }
        else if (mutation.type == "childList") {
            this.processRemovedNodes(mutation.removedNodes);
            this.processAddedNodes(mutation.addedNodes);
        }
    }
    processAttributeChange(node, attributeName) {
        const element = node;
        if (this.elements.has(element)) {
            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {
                this.delegate.elementAttributeChanged(element, attributeName);
            }
            else {
                this.removeElement(element);
            }
        }
        else if (this.matchElement(element)) {
            this.addElement(element);
        }
    }
    processRemovedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element) {
                this.processTree(element, this.removeElement);
            }
        }
    }
    processAddedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element && this.elementIsActive(element)) {
                this.processTree(element, this.addElement);
            }
        }
    }
    matchElement(element) {
        return this.delegate.matchElement(element);
    }
    matchElementsInTree(tree = this.element) {
        return this.delegate.matchElementsInTree(tree);
    }
    processTree(tree, processor) {
        for (const element of this.matchElementsInTree(tree)) {
            processor.call(this, element);
        }
    }
    elementFromNode(node) {
        if (node.nodeType == Node.ELEMENT_NODE) {
            return node;
        }
    }
    elementIsActive(element) {
        if (element.isConnected != this.element.isConnected) {
            return false;
        }
        else {
            return this.element.contains(element);
        }
    }
    addElement(element) {
        if (!this.elements.has(element)) {
            if (this.elementIsActive(element)) {
                this.elements.add(element);
                if (this.delegate.elementMatched) {
                    this.delegate.elementMatched(element);
                }
            }
        }
    }
    removeElement(element) {
        if (this.elements.has(element)) {
            this.elements.delete(element);
            if (this.delegate.elementUnmatched) {
                this.delegate.elementUnmatched(element);
            }
        }
    }
}

class AttributeObserver {
    constructor(element, attributeName, delegate) {
        this.attributeName = attributeName;
        this.delegate = delegate;
        this.elementObserver = new ElementObserver(element, this);
    }
    get element() {
        return this.elementObserver.element;
    }
    get selector() {
        return `[${this.attributeName}]`;
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get started() {
        return this.elementObserver.started;
    }
    matchElement(element) {
        return element.hasAttribute(this.attributeName);
    }
    matchElementsInTree(tree) {
        const match = this.matchElement(tree) ? [tree] : [];
        const matches = Array.from(tree.querySelectorAll(this.selector));
        return match.concat(matches);
    }
    elementMatched(element) {
        if (this.delegate.elementMatchedAttribute) {
            this.delegate.elementMatchedAttribute(element, this.attributeName);
        }
    }
    elementUnmatched(element) {
        if (this.delegate.elementUnmatchedAttribute) {
            this.delegate.elementUnmatchedAttribute(element, this.attributeName);
        }
    }
    elementAttributeChanged(element, attributeName) {
        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {
            this.delegate.elementAttributeValueChanged(element, attributeName);
        }
    }
}

function add(map, key, value) {
    fetch(map, key).add(value);
}
function del(map, key, value) {
    fetch(map, key).delete(value);
    prune(map, key);
}
function fetch(map, key) {
    let values = map.get(key);
    if (!values) {
        values = new Set();
        map.set(key, values);
    }
    return values;
}
function prune(map, key) {
    const values = map.get(key);
    if (values != null && values.size == 0) {
        map.delete(key);
    }
}

class Multimap {
    constructor() {
        this.valuesByKey = new Map();
    }
    get keys() {
        return Array.from(this.valuesByKey.keys());
    }
    get values() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((values, set) => values.concat(Array.from(set)), []);
    }
    get size() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((size, set) => size + set.size, 0);
    }
    add(key, value) {
        add(this.valuesByKey, key, value);
    }
    delete(key, value) {
        del(this.valuesByKey, key, value);
    }
    has(key, value) {
        const values = this.valuesByKey.get(key);
        return values != null && values.has(value);
    }
    hasKey(key) {
        return this.valuesByKey.has(key);
    }
    hasValue(value) {
        const sets = Array.from(this.valuesByKey.values());
        return sets.some((set) => set.has(value));
    }
    getValuesForKey(key) {
        const values = this.valuesByKey.get(key);
        return values ? Array.from(values) : [];
    }
    getKeysForValue(value) {
        return Array.from(this.valuesByKey)
            .filter(([_key, values]) => values.has(value))
            .map(([key, _values]) => key);
    }
}

class IndexedMultimap extends Multimap {
    constructor() {
        super();
        this.keysByValue = new Map();
    }
    get values() {
        return Array.from(this.keysByValue.keys());
    }
    add(key, value) {
        super.add(key, value);
        add(this.keysByValue, value, key);
    }
    delete(key, value) {
        super.delete(key, value);
        del(this.keysByValue, value, key);
    }
    hasValue(value) {
        return this.keysByValue.has(value);
    }
    getKeysForValue(value) {
        const set = this.keysByValue.get(value);
        return set ? Array.from(set) : [];
    }
}

class SelectorObserver {
    constructor(element, selector, delegate, details = {}) {
        this.selector = selector;
        this.details = details;
        this.elementObserver = new ElementObserver(element, this);
        this.delegate = delegate;
        this.matchesByElement = new Multimap();
    }
    get started() {
        return this.elementObserver.started;
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get element() {
        return this.elementObserver.element;
    }
    matchElement(element) {
        const matches = element.matches(this.selector);
        if (this.delegate.selectorMatchElement) {
            return matches && this.delegate.selectorMatchElement(element, this.details);
        }
        return matches;
    }
    matchElementsInTree(tree) {
        const match = this.matchElement(tree) ? [tree] : [];
        const matches = Array.from(tree.querySelectorAll(this.selector)).filter((match) => this.matchElement(match));
        return match.concat(matches);
    }
    elementMatched(element) {
        this.selectorMatched(element);
    }
    elementUnmatched(element) {
        this.selectorUnmatched(element);
    }
    elementAttributeChanged(element, _attributeName) {
        const matches = this.matchElement(element);
        const matchedBefore = this.matchesByElement.has(this.selector, element);
        if (!matches && matchedBefore) {
            this.selectorUnmatched(element);
        }
    }
    selectorMatched(element) {
        if (this.delegate.selectorMatched) {
            this.delegate.selectorMatched(element, this.selector, this.details);
            this.matchesByElement.add(this.selector, element);
        }
    }
    selectorUnmatched(element) {
        this.delegate.selectorUnmatched(element, this.selector, this.details);
        this.matchesByElement.delete(this.selector, element);
    }
}

class StringMapObserver {
    constructor(element, delegate) {
        this.element = element;
        this.delegate = delegate;
        this.started = false;
        this.stringMap = new Map();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, { attributes: true, attributeOldValue: true });
            this.refresh();
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            for (const attributeName of this.knownAttributeNames) {
                this.refreshAttribute(attributeName, null);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        const attributeName = mutation.attributeName;
        if (attributeName) {
            this.refreshAttribute(attributeName, mutation.oldValue);
        }
    }
    refreshAttribute(attributeName, oldValue) {
        const key = this.delegate.getStringMapKeyForAttribute(attributeName);
        if (key != null) {
            if (!this.stringMap.has(attributeName)) {
                this.stringMapKeyAdded(key, attributeName);
            }
            const value = this.element.getAttribute(attributeName);
            if (this.stringMap.get(attributeName) != value) {
                this.stringMapValueChanged(value, key, oldValue);
            }
            if (value == null) {
                const oldValue = this.stringMap.get(attributeName);
                this.stringMap.delete(attributeName);
                if (oldValue)
                    this.stringMapKeyRemoved(key, attributeName, oldValue);
            }
            else {
                this.stringMap.set(attributeName, value);
            }
        }
    }
    stringMapKeyAdded(key, attributeName) {
        if (this.delegate.stringMapKeyAdded) {
            this.delegate.stringMapKeyAdded(key, attributeName);
        }
    }
    stringMapValueChanged(value, key, oldValue) {
        if (this.delegate.stringMapValueChanged) {
            this.delegate.stringMapValueChanged(value, key, oldValue);
        }
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        if (this.delegate.stringMapKeyRemoved) {
            this.delegate.stringMapKeyRemoved(key, attributeName, oldValue);
        }
    }
    get knownAttributeNames() {
        return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)));
    }
    get currentAttributeNames() {
        return Array.from(this.element.attributes).map((attribute) => attribute.name);
    }
    get recordedAttributeNames() {
        return Array.from(this.stringMap.keys());
    }
}

class TokenListObserver {
    constructor(element, attributeName, delegate) {
        this.attributeObserver = new AttributeObserver(element, attributeName, this);
        this.delegate = delegate;
        this.tokensByElement = new Multimap();
    }
    get started() {
        return this.attributeObserver.started;
    }
    start() {
        this.attributeObserver.start();
    }
    pause(callback) {
        this.attributeObserver.pause(callback);
    }
    stop() {
        this.attributeObserver.stop();
    }
    refresh() {
        this.attributeObserver.refresh();
    }
    get element() {
        return this.attributeObserver.element;
    }
    get attributeName() {
        return this.attributeObserver.attributeName;
    }
    elementMatchedAttribute(element) {
        this.tokensMatched(this.readTokensForElement(element));
    }
    elementAttributeValueChanged(element) {
        const [unmatchedTokens, matchedTokens] = this.refreshTokensForElement(element);
        this.tokensUnmatched(unmatchedTokens);
        this.tokensMatched(matchedTokens);
    }
    elementUnmatchedAttribute(element) {
        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));
    }
    tokensMatched(tokens) {
        tokens.forEach((token) => this.tokenMatched(token));
    }
    tokensUnmatched(tokens) {
        tokens.forEach((token) => this.tokenUnmatched(token));
    }
    tokenMatched(token) {
        this.delegate.tokenMatched(token);
        this.tokensByElement.add(token.element, token);
    }
    tokenUnmatched(token) {
        this.delegate.tokenUnmatched(token);
        this.tokensByElement.delete(token.element, token);
    }
    refreshTokensForElement(element) {
        const previousTokens = this.tokensByElement.getValuesForKey(element);
        const currentTokens = this.readTokensForElement(element);
        const firstDifferingIndex = zip(previousTokens, currentTokens).findIndex(([previousToken, currentToken]) => !tokensAreEqual(previousToken, currentToken));
        if (firstDifferingIndex == -1) {
            return [[], []];
        }
        else {
            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];
        }
    }
    readTokensForElement(element) {
        const attributeName = this.attributeName;
        const tokenString = element.getAttribute(attributeName) || "";
        return parseTokenString(tokenString, element, attributeName);
    }
}
function parseTokenString(tokenString, element, attributeName) {
    return tokenString
        .trim()
        .split(/\s+/)
        .filter((content) => content.length)
        .map((content, index) => ({ element, attributeName, content, index }));
}
function zip(left, right) {
    const length = Math.max(left.length, right.length);
    return Array.from({ length }, (_, index) => [left[index], right[index]]);
}
function tokensAreEqual(left, right) {
    return left && right && left.index == right.index && left.content == right.content;
}

class ValueListObserver {
    constructor(element, attributeName, delegate) {
        this.tokenListObserver = new TokenListObserver(element, attributeName, this);
        this.delegate = delegate;
        this.parseResultsByToken = new WeakMap();
        this.valuesByTokenByElement = new WeakMap();
    }
    get started() {
        return this.tokenListObserver.started;
    }
    start() {
        this.tokenListObserver.start();
    }
    stop() {
        this.tokenListObserver.stop();
    }
    refresh() {
        this.tokenListObserver.refresh();
    }
    get element() {
        return this.tokenListObserver.element;
    }
    get attributeName() {
        return this.tokenListObserver.attributeName;
    }
    tokenMatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).set(token, value);
            this.delegate.elementMatchedValue(element, value);
        }
    }
    tokenUnmatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).delete(token);
            this.delegate.elementUnmatchedValue(element, value);
        }
    }
    fetchParseResultForToken(token) {
        let parseResult = this.parseResultsByToken.get(token);
        if (!parseResult) {
            parseResult = this.parseToken(token);
            this.parseResultsByToken.set(token, parseResult);
        }
        return parseResult;
    }
    fetchValuesByTokenForElement(element) {
        let valuesByToken = this.valuesByTokenByElement.get(element);
        if (!valuesByToken) {
            valuesByToken = new Map();
            this.valuesByTokenByElement.set(element, valuesByToken);
        }
        return valuesByToken;
    }
    parseToken(token) {
        try {
            const value = this.delegate.parseValueForToken(token);
            return { value };
        }
        catch (error) {
            return { error };
        }
    }
}

class BindingObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.bindingsByAction = new Map();
    }
    start() {
        if (!this.valueListObserver) {
            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);
            this.valueListObserver.start();
        }
    }
    stop() {
        if (this.valueListObserver) {
            this.valueListObserver.stop();
            delete this.valueListObserver;
            this.disconnectAllActions();
        }
    }
    get element() {
        return this.context.element;
    }
    get identifier() {
        return this.context.identifier;
    }
    get actionAttribute() {
        return this.schema.actionAttribute;
    }
    get schema() {
        return this.context.schema;
    }
    get bindings() {
        return Array.from(this.bindingsByAction.values());
    }
    connectAction(action) {
        const binding = new Binding(this.context, action);
        this.bindingsByAction.set(action, binding);
        this.delegate.bindingConnected(binding);
    }
    disconnectAction(action) {
        const binding = this.bindingsByAction.get(action);
        if (binding) {
            this.bindingsByAction.delete(action);
            this.delegate.bindingDisconnected(binding);
        }
    }
    disconnectAllActions() {
        this.bindings.forEach((binding) => this.delegate.bindingDisconnected(binding, true));
        this.bindingsByAction.clear();
    }
    parseValueForToken(token) {
        const action = Action.forToken(token, this.schema);
        if (action.identifier == this.identifier) {
            return action;
        }
    }
    elementMatchedValue(element, action) {
        this.connectAction(action);
    }
    elementUnmatchedValue(element, action) {
        this.disconnectAction(action);
    }
}

class ValueObserver {
    constructor(context, receiver) {
        this.context = context;
        this.receiver = receiver;
        this.stringMapObserver = new StringMapObserver(this.element, this);
        this.valueDescriptorMap = this.controller.valueDescriptorMap;
    }
    start() {
        this.stringMapObserver.start();
        this.invokeChangedCallbacksForDefaultValues();
    }
    stop() {
        this.stringMapObserver.stop();
    }
    get element() {
        return this.context.element;
    }
    get controller() {
        return this.context.controller;
    }
    getStringMapKeyForAttribute(attributeName) {
        if (attributeName in this.valueDescriptorMap) {
            return this.valueDescriptorMap[attributeName].name;
        }
    }
    stringMapKeyAdded(key, attributeName) {
        const descriptor = this.valueDescriptorMap[attributeName];
        if (!this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), descriptor.writer(descriptor.defaultValue));
        }
    }
    stringMapValueChanged(value, name, oldValue) {
        const descriptor = this.valueDescriptorNameMap[name];
        if (value === null)
            return;
        if (oldValue === null) {
            oldValue = descriptor.writer(descriptor.defaultValue);
        }
        this.invokeChangedCallback(name, value, oldValue);
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        const descriptor = this.valueDescriptorNameMap[key];
        if (this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), oldValue);
        }
        else {
            this.invokeChangedCallback(key, descriptor.writer(descriptor.defaultValue), oldValue);
        }
    }
    invokeChangedCallbacksForDefaultValues() {
        for (const { key, name, defaultValue, writer } of this.valueDescriptors) {
            if (defaultValue != undefined && !this.controller.data.has(key)) {
                this.invokeChangedCallback(name, writer(defaultValue), undefined);
            }
        }
    }
    invokeChangedCallback(name, rawValue, rawOldValue) {
        const changedMethodName = `${name}Changed`;
        const changedMethod = this.receiver[changedMethodName];
        if (typeof changedMethod == "function") {
            const descriptor = this.valueDescriptorNameMap[name];
            try {
                const value = descriptor.reader(rawValue);
                let oldValue = rawOldValue;
                if (rawOldValue) {
                    oldValue = descriptor.reader(rawOldValue);
                }
                changedMethod.call(this.receiver, value, oldValue);
            }
            catch (error) {
                if (error instanceof TypeError) {
                    error.message = `Stimulus Value "${this.context.identifier}.${descriptor.name}" - ${error.message}`;
                }
                throw error;
            }
        }
    }
    get valueDescriptors() {
        const { valueDescriptorMap } = this;
        return Object.keys(valueDescriptorMap).map((key) => valueDescriptorMap[key]);
    }
    get valueDescriptorNameMap() {
        const descriptors = {};
        Object.keys(this.valueDescriptorMap).forEach((key) => {
            const descriptor = this.valueDescriptorMap[key];
            descriptors[descriptor.name] = descriptor;
        });
        return descriptors;
    }
    hasValue(attributeName) {
        const descriptor = this.valueDescriptorNameMap[attributeName];
        const hasMethodName = `has${capitalize(descriptor.name)}`;
        return this.receiver[hasMethodName];
    }
}

class TargetObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.targetsByName = new Multimap();
    }
    start() {
        if (!this.tokenListObserver) {
            this.tokenListObserver = new TokenListObserver(this.element, this.attributeName, this);
            this.tokenListObserver.start();
        }
    }
    stop() {
        if (this.tokenListObserver) {
            this.disconnectAllTargets();
            this.tokenListObserver.stop();
            delete this.tokenListObserver;
        }
    }
    tokenMatched({ element, content: name }) {
        if (this.scope.containsElement(element)) {
            this.connectTarget(element, name);
        }
    }
    tokenUnmatched({ element, content: name }) {
        this.disconnectTarget(element, name);
    }
    connectTarget(element, name) {
        var _a;
        if (!this.targetsByName.has(name, element)) {
            this.targetsByName.add(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetConnected(element, name));
        }
    }
    disconnectTarget(element, name) {
        var _a;
        if (this.targetsByName.has(name, element)) {
            this.targetsByName.delete(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetDisconnected(element, name));
        }
    }
    disconnectAllTargets() {
        for (const name of this.targetsByName.keys) {
            for (const element of this.targetsByName.getValuesForKey(name)) {
                this.disconnectTarget(element, name);
            }
        }
    }
    get attributeName() {
        return `data-${this.context.identifier}-target`;
    }
    get element() {
        return this.context.element;
    }
    get scope() {
        return this.context.scope;
    }
}

function readInheritableStaticArrayValues(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return Array.from(ancestors.reduce((values, constructor) => {
        getOwnStaticArrayValues(constructor, propertyName).forEach((name) => values.add(name));
        return values;
    }, new Set()));
}
function readInheritableStaticObjectPairs(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return ancestors.reduce((pairs, constructor) => {
        pairs.push(...getOwnStaticObjectPairs(constructor, propertyName));
        return pairs;
    }, []);
}
function getAncestorsForConstructor(constructor) {
    const ancestors = [];
    while (constructor) {
        ancestors.push(constructor);
        constructor = Object.getPrototypeOf(constructor);
    }
    return ancestors.reverse();
}
function getOwnStaticArrayValues(constructor, propertyName) {
    const definition = constructor[propertyName];
    return Array.isArray(definition) ? definition : [];
}
function getOwnStaticObjectPairs(constructor, propertyName) {
    const definition = constructor[propertyName];
    return definition ? Object.keys(definition).map((key) => [key, definition[key]]) : [];
}

class OutletObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.outletsByName = new Multimap();
        this.outletElementsByName = new Multimap();
        this.selectorObserverMap = new Map();
    }
    start() {
        if (this.selectorObserverMap.size === 0) {
            this.outletDefinitions.forEach((outletName) => {
                const selector = this.selector(outletName);
                const details = { outletName };
                if (selector) {
                    this.selectorObserverMap.set(outletName, new SelectorObserver(document.body, selector, this, details));
                }
            });
            this.selectorObserverMap.forEach((observer) => observer.start());
        }
        this.dependentContexts.forEach((context) => context.refresh());
    }
    stop() {
        if (this.selectorObserverMap.size > 0) {
            this.disconnectAllOutlets();
            this.selectorObserverMap.forEach((observer) => observer.stop());
            this.selectorObserverMap.clear();
        }
    }
    refresh() {
        this.selectorObserverMap.forEach((observer) => observer.refresh());
    }
    selectorMatched(element, _selector, { outletName }) {
        const outlet = this.getOutlet(element, outletName);
        if (outlet) {
            this.connectOutlet(outlet, element, outletName);
        }
    }
    selectorUnmatched(element, _selector, { outletName }) {
        const outlet = this.getOutletFromMap(element, outletName);
        if (outlet) {
            this.disconnectOutlet(outlet, element, outletName);
        }
    }
    selectorMatchElement(element, { outletName }) {
        return (this.hasOutlet(element, outletName) &&
            element.matches(`[${this.context.application.schema.controllerAttribute}~=${outletName}]`));
    }
    connectOutlet(outlet, element, outletName) {
        var _a;
        if (!this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.add(outletName, outlet);
            this.outletElementsByName.add(outletName, element);
            (_a = this.selectorObserverMap.get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletConnected(outlet, element, outletName));
        }
    }
    disconnectOutlet(outlet, element, outletName) {
        var _a;
        if (this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.delete(outletName, outlet);
            this.outletElementsByName.delete(outletName, element);
            (_a = this.selectorObserverMap
                .get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletDisconnected(outlet, element, outletName));
        }
    }
    disconnectAllOutlets() {
        for (const outletName of this.outletElementsByName.keys) {
            for (const element of this.outletElementsByName.getValuesForKey(outletName)) {
                for (const outlet of this.outletsByName.getValuesForKey(outletName)) {
                    this.disconnectOutlet(outlet, element, outletName);
                }
            }
        }
    }
    selector(outletName) {
        return this.scope.outlets.getSelectorForOutletName(outletName);
    }
    get outletDependencies() {
        const dependencies = new Multimap();
        this.router.modules.forEach((module) => {
            const constructor = module.definition.controllerConstructor;
            const outlets = readInheritableStaticArrayValues(constructor, "outlets");
            outlets.forEach((outlet) => dependencies.add(outlet, module.identifier));
        });
        return dependencies;
    }
    get outletDefinitions() {
        return this.outletDependencies.getKeysForValue(this.identifier);
    }
    get dependentControllerIdentifiers() {
        return this.outletDependencies.getValuesForKey(this.identifier);
    }
    get dependentContexts() {
        const identifiers = this.dependentControllerIdentifiers;
        return this.router.contexts.filter((context) => identifiers.includes(context.identifier));
    }
    hasOutlet(element, outletName) {
        return !!this.getOutlet(element, outletName) || !!this.getOutletFromMap(element, outletName);
    }
    getOutlet(element, outletName) {
        return this.application.getControllerForElementAndIdentifier(element, outletName);
    }
    getOutletFromMap(element, outletName) {
        return this.outletsByName.getValuesForKey(outletName).find((outlet) => outlet.element === element);
    }
    get scope() {
        return this.context.scope;
    }
    get identifier() {
        return this.context.identifier;
    }
    get application() {
        return this.context.application;
    }
    get router() {
        return this.application.router;
    }
}

class Context {
    constructor(module, scope) {
        this.logDebugActivity = (functionName, detail = {}) => {
            const { identifier, controller, element } = this;
            detail = Object.assign({ identifier, controller, element }, detail);
            this.application.logDebugActivity(this.identifier, functionName, detail);
        };
        this.module = module;
        this.scope = scope;
        this.controller = new module.controllerConstructor(this);
        this.bindingObserver = new BindingObserver(this, this.dispatcher);
        this.valueObserver = new ValueObserver(this, this.controller);
        this.targetObserver = new TargetObserver(this, this);
        this.outletObserver = new OutletObserver(this, this);
        try {
            this.controller.initialize();
            this.logDebugActivity("initialize");
        }
        catch (error) {
            this.handleError(error, "initializing controller");
        }
    }
    connect() {
        this.bindingObserver.start();
        this.valueObserver.start();
        this.targetObserver.start();
        this.outletObserver.start();
        try {
            this.controller.connect();
            this.logDebugActivity("connect");
        }
        catch (error) {
            this.handleError(error, "connecting controller");
        }
    }
    refresh() {
        this.outletObserver.refresh();
    }
    disconnect() {
        try {
            this.controller.disconnect();
            this.logDebugActivity("disconnect");
        }
        catch (error) {
            this.handleError(error, "disconnecting controller");
        }
        this.outletObserver.stop();
        this.targetObserver.stop();
        this.valueObserver.stop();
        this.bindingObserver.stop();
    }
    get application() {
        return this.module.application;
    }
    get identifier() {
        return this.module.identifier;
    }
    get schema() {
        return this.application.schema;
    }
    get dispatcher() {
        return this.application.dispatcher;
    }
    get element() {
        return this.scope.element;
    }
    get parentElement() {
        return this.element.parentElement;
    }
    handleError(error, message, detail = {}) {
        const { identifier, controller, element } = this;
        detail = Object.assign({ identifier, controller, element }, detail);
        this.application.handleError(error, `Error ${message}`, detail);
    }
    targetConnected(element, name) {
        this.invokeControllerMethod(`${name}TargetConnected`, element);
    }
    targetDisconnected(element, name) {
        this.invokeControllerMethod(`${name}TargetDisconnected`, element);
    }
    outletConnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletConnected`, outlet, element);
    }
    outletDisconnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletDisconnected`, outlet, element);
    }
    invokeControllerMethod(methodName, ...args) {
        const controller = this.controller;
        if (typeof controller[methodName] == "function") {
            controller[methodName](...args);
        }
    }
}

function bless(constructor) {
    return shadow(constructor, getBlessedProperties(constructor));
}
function shadow(constructor, properties) {
    const shadowConstructor = extend(constructor);
    const shadowProperties = getShadowProperties(constructor.prototype, properties);
    Object.defineProperties(shadowConstructor.prototype, shadowProperties);
    return shadowConstructor;
}
function getBlessedProperties(constructor) {
    const blessings = readInheritableStaticArrayValues(constructor, "blessings");
    return blessings.reduce((blessedProperties, blessing) => {
        const properties = blessing(constructor);
        for (const key in properties) {
            const descriptor = blessedProperties[key] || {};
            blessedProperties[key] = Object.assign(descriptor, properties[key]);
        }
        return blessedProperties;
    }, {});
}
function getShadowProperties(prototype, properties) {
    return getOwnKeys(properties).reduce((shadowProperties, key) => {
        const descriptor = getShadowedDescriptor(prototype, properties, key);
        if (descriptor) {
            Object.assign(shadowProperties, { [key]: descriptor });
        }
        return shadowProperties;
    }, {});
}
function getShadowedDescriptor(prototype, properties, key) {
    const shadowingDescriptor = Object.getOwnPropertyDescriptor(prototype, key);
    const shadowedByValue = shadowingDescriptor && "value" in shadowingDescriptor;
    if (!shadowedByValue) {
        const descriptor = Object.getOwnPropertyDescriptor(properties, key).value;
        if (shadowingDescriptor) {
            descriptor.get = shadowingDescriptor.get || descriptor.get;
            descriptor.set = shadowingDescriptor.set || descriptor.set;
        }
        return descriptor;
    }
}
const getOwnKeys = (() => {
    if (typeof Object.getOwnPropertySymbols == "function") {
        return (object) => [...Object.getOwnPropertyNames(object), ...Object.getOwnPropertySymbols(object)];
    }
    else {
        return Object.getOwnPropertyNames;
    }
})();
const extend = (() => {
    function extendWithReflect(constructor) {
        function extended() {
            return Reflect.construct(constructor, arguments, new.target);
        }
        extended.prototype = Object.create(constructor.prototype, {
            constructor: { value: extended },
        });
        Reflect.setPrototypeOf(extended, constructor);
        return extended;
    }
    function testReflectExtension() {
        const a = function () {
            this.a.call(this);
        };
        const b = extendWithReflect(a);
        b.prototype.a = function () { };
        return new b();
    }
    try {
        testReflectExtension();
        return extendWithReflect;
    }
    catch (error) {
        return (constructor) => class extended extends constructor {
        };
    }
})();

function blessDefinition(definition) {
    return {
        identifier: definition.identifier,
        controllerConstructor: bless(definition.controllerConstructor),
    };
}

class Module {
    constructor(application, definition) {
        this.application = application;
        this.definition = blessDefinition(definition);
        this.contextsByScope = new WeakMap();
        this.connectedContexts = new Set();
    }
    get identifier() {
        return this.definition.identifier;
    }
    get controllerConstructor() {
        return this.definition.controllerConstructor;
    }
    get contexts() {
        return Array.from(this.connectedContexts);
    }
    connectContextForScope(scope) {
        const context = this.fetchContextForScope(scope);
        this.connectedContexts.add(context);
        context.connect();
    }
    disconnectContextForScope(scope) {
        const context = this.contextsByScope.get(scope);
        if (context) {
            this.connectedContexts.delete(context);
            context.disconnect();
        }
    }
    fetchContextForScope(scope) {
        let context = this.contextsByScope.get(scope);
        if (!context) {
            context = new Context(this, scope);
            this.contextsByScope.set(scope, context);
        }
        return context;
    }
}

class ClassMap {
    constructor(scope) {
        this.scope = scope;
    }
    has(name) {
        return this.data.has(this.getDataKey(name));
    }
    get(name) {
        return this.getAll(name)[0];
    }
    getAll(name) {
        const tokenString = this.data.get(this.getDataKey(name)) || "";
        return tokenize(tokenString);
    }
    getAttributeName(name) {
        return this.data.getAttributeNameForKey(this.getDataKey(name));
    }
    getDataKey(name) {
        return `${name}-class`;
    }
    get data() {
        return this.scope.data;
    }
}

class DataMap {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.getAttribute(name);
    }
    set(key, value) {
        const name = this.getAttributeNameForKey(key);
        this.element.setAttribute(name, value);
        return this.get(key);
    }
    has(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.hasAttribute(name);
    }
    delete(key) {
        if (this.has(key)) {
            const name = this.getAttributeNameForKey(key);
            this.element.removeAttribute(name);
            return true;
        }
        else {
            return false;
        }
    }
    getAttributeNameForKey(key) {
        return `data-${this.identifier}-${dasherize(key)}`;
    }
}

class Guide {
    constructor(logger) {
        this.warnedKeysByObject = new WeakMap();
        this.logger = logger;
    }
    warn(object, key, message) {
        let warnedKeys = this.warnedKeysByObject.get(object);
        if (!warnedKeys) {
            warnedKeys = new Set();
            this.warnedKeysByObject.set(object, warnedKeys);
        }
        if (!warnedKeys.has(key)) {
            warnedKeys.add(key);
            this.logger.warn(message, object);
        }
    }
}

function attributeValueContainsToken(attributeName, token) {
    return `[${attributeName}~="${token}"]`;
}

class TargetSet {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(targetName) {
        return this.find(targetName) != null;
    }
    find(...targetNames) {
        return targetNames.reduce((target, targetName) => target || this.findTarget(targetName) || this.findLegacyTarget(targetName), undefined);
    }
    findAll(...targetNames) {
        return targetNames.reduce((targets, targetName) => [
            ...targets,
            ...this.findAllTargets(targetName),
            ...this.findAllLegacyTargets(targetName),
        ], []);
    }
    findTarget(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findElement(selector);
    }
    findAllTargets(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findAllElements(selector);
    }
    getSelectorForTargetName(targetName) {
        const attributeName = this.schema.targetAttributeForScope(this.identifier);
        return attributeValueContainsToken(attributeName, targetName);
    }
    findLegacyTarget(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.deprecate(this.scope.findElement(selector), targetName);
    }
    findAllLegacyTargets(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.scope.findAllElements(selector).map((element) => this.deprecate(element, targetName));
    }
    getLegacySelectorForTargetName(targetName) {
        const targetDescriptor = `${this.identifier}.${targetName}`;
        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);
    }
    deprecate(element, targetName) {
        if (element) {
            const { identifier } = this;
            const attributeName = this.schema.targetAttribute;
            const revisedAttributeName = this.schema.targetAttributeForScope(identifier);
            this.guide.warn(element, `target:${targetName}`, `Please replace ${attributeName}="${identifier}.${targetName}" with ${revisedAttributeName}="${targetName}". ` +
                `The ${attributeName} attribute is deprecated and will be removed in a future version of Stimulus.`);
        }
        return element;
    }
    get guide() {
        return this.scope.guide;
    }
}

class OutletSet {
    constructor(scope, controllerElement) {
        this.scope = scope;
        this.controllerElement = controllerElement;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(outletName) {
        return this.find(outletName) != null;
    }
    find(...outletNames) {
        return outletNames.reduce((outlet, outletName) => outlet || this.findOutlet(outletName), undefined);
    }
    findAll(...outletNames) {
        return outletNames.reduce((outlets, outletName) => [...outlets, ...this.findAllOutlets(outletName)], []);
    }
    getSelectorForOutletName(outletName) {
        const attributeName = this.schema.outletAttributeForScope(this.identifier, outletName);
        return this.controllerElement.getAttribute(attributeName);
    }
    findOutlet(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        if (selector)
            return this.findElement(selector, outletName);
    }
    findAllOutlets(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        return selector ? this.findAllElements(selector, outletName) : [];
    }
    findElement(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName))[0];
    }
    findAllElements(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName));
    }
    matchesElement(element, selector, outletName) {
        const controllerAttribute = element.getAttribute(this.scope.schema.controllerAttribute) || "";
        return element.matches(selector) && controllerAttribute.split(" ").includes(outletName);
    }
}

class Scope {
    constructor(schema, element, identifier, logger) {
        this.targets = new TargetSet(this);
        this.classes = new ClassMap(this);
        this.data = new DataMap(this);
        this.containsElement = (element) => {
            return element.closest(this.controllerSelector) === this.element;
        };
        this.schema = schema;
        this.element = element;
        this.identifier = identifier;
        this.guide = new Guide(logger);
        this.outlets = new OutletSet(this.documentScope, element);
    }
    findElement(selector) {
        return this.element.matches(selector) ? this.element : this.queryElements(selector).find(this.containsElement);
    }
    findAllElements(selector) {
        return [
            ...(this.element.matches(selector) ? [this.element] : []),
            ...this.queryElements(selector).filter(this.containsElement),
        ];
    }
    queryElements(selector) {
        return Array.from(this.element.querySelectorAll(selector));
    }
    get controllerSelector() {
        return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);
    }
    get isDocumentScope() {
        return this.element === document.documentElement;
    }
    get documentScope() {
        return this.isDocumentScope
            ? this
            : new Scope(this.schema, document.documentElement, this.identifier, this.guide.logger);
    }
}

class ScopeObserver {
    constructor(element, schema, delegate) {
        this.element = element;
        this.schema = schema;
        this.delegate = delegate;
        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);
        this.scopesByIdentifierByElement = new WeakMap();
        this.scopeReferenceCounts = new WeakMap();
    }
    start() {
        this.valueListObserver.start();
    }
    stop() {
        this.valueListObserver.stop();
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    parseValueForToken(token) {
        const { element, content: identifier } = token;
        const scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);
        let scope = scopesByIdentifier.get(identifier);
        if (!scope) {
            scope = this.delegate.createScopeForElementAndIdentifier(element, identifier);
            scopesByIdentifier.set(identifier, scope);
        }
        return scope;
    }
    elementMatchedValue(element, value) {
        const referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;
        this.scopeReferenceCounts.set(value, referenceCount);
        if (referenceCount == 1) {
            this.delegate.scopeConnected(value);
        }
    }
    elementUnmatchedValue(element, value) {
        const referenceCount = this.scopeReferenceCounts.get(value);
        if (referenceCount) {
            this.scopeReferenceCounts.set(value, referenceCount - 1);
            if (referenceCount == 1) {
                this.delegate.scopeDisconnected(value);
            }
        }
    }
    fetchScopesByIdentifierForElement(element) {
        let scopesByIdentifier = this.scopesByIdentifierByElement.get(element);
        if (!scopesByIdentifier) {
            scopesByIdentifier = new Map();
            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);
        }
        return scopesByIdentifier;
    }
}

class Router {
    constructor(application) {
        this.application = application;
        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);
        this.scopesByIdentifier = new Multimap();
        this.modulesByIdentifier = new Map();
    }
    get element() {
        return this.application.element;
    }
    get schema() {
        return this.application.schema;
    }
    get logger() {
        return this.application.logger;
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    get modules() {
        return Array.from(this.modulesByIdentifier.values());
    }
    get contexts() {
        return this.modules.reduce((contexts, module) => contexts.concat(module.contexts), []);
    }
    start() {
        this.scopeObserver.start();
    }
    stop() {
        this.scopeObserver.stop();
    }
    loadDefinition(definition) {
        this.unloadIdentifier(definition.identifier);
        const module = new Module(this.application, definition);
        this.connectModule(module);
        const afterLoad = definition.controllerConstructor.afterLoad;
        if (afterLoad) {
            afterLoad(definition.identifier, this.application);
        }
    }
    unloadIdentifier(identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            this.disconnectModule(module);
        }
    }
    getContextForElementAndIdentifier(element, identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            return module.contexts.find((context) => context.element == element);
        }
    }
    handleError(error, message, detail) {
        this.application.handleError(error, message, detail);
    }
    createScopeForElementAndIdentifier(element, identifier) {
        return new Scope(this.schema, element, identifier, this.logger);
    }
    scopeConnected(scope) {
        this.scopesByIdentifier.add(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.connectContextForScope(scope);
        }
    }
    scopeDisconnected(scope) {
        this.scopesByIdentifier.delete(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.disconnectContextForScope(scope);
        }
    }
    connectModule(module) {
        this.modulesByIdentifier.set(module.identifier, module);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.connectContextForScope(scope));
    }
    disconnectModule(module) {
        this.modulesByIdentifier.delete(module.identifier);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.disconnectContextForScope(scope));
    }
}

const defaultSchema = {
    controllerAttribute: "data-controller",
    actionAttribute: "data-action",
    targetAttribute: "data-target",
    targetAttributeForScope: (identifier) => `data-${identifier}-target`,
    outletAttributeForScope: (identifier, outlet) => `data-${identifier}-${outlet}-outlet`,
    keyMappings: Object.assign(Object.assign({ enter: "Enter", tab: "Tab", esc: "Escape", space: " ", up: "ArrowUp", down: "ArrowDown", left: "ArrowLeft", right: "ArrowRight", home: "Home", end: "End" }, objectFromEntries("abcdefghijklmnopqrstuvwxyz".split("").map((c) => [c, c]))), objectFromEntries("0123456789".split("").map((n) => [n, n]))),
};
function objectFromEntries(array) {
    return array.reduce((memo, [k, v]) => (Object.assign(Object.assign({}, memo), { [k]: v })), {});
}

class Application {
    constructor(element = document.documentElement, schema = defaultSchema) {
        this.logger = console;
        this.debug = false;
        this.logDebugActivity = (identifier, functionName, detail = {}) => {
            if (this.debug) {
                this.logFormattedMessage(identifier, functionName, detail);
            }
        };
        this.element = element;
        this.schema = schema;
        this.dispatcher = new Dispatcher(this);
        this.router = new Router(this);
        this.actionDescriptorFilters = Object.assign({}, defaultActionDescriptorFilters);
    }
    static start(element, schema) {
        const application = new this(element, schema);
        application.start();
        return application;
    }
    async start() {
        await domReady();
        this.logDebugActivity("application", "starting");
        this.dispatcher.start();
        this.router.start();
        this.logDebugActivity("application", "start");
    }
    stop() {
        this.logDebugActivity("application", "stopping");
        this.dispatcher.stop();
        this.router.stop();
        this.logDebugActivity("application", "stop");
    }
    register(identifier, controllerConstructor) {
        this.load({ identifier, controllerConstructor });
    }
    registerActionOption(name, filter) {
        this.actionDescriptorFilters[name] = filter;
    }
    load(head, ...rest) {
        const definitions = Array.isArray(head) ? head : [head, ...rest];
        definitions.forEach((definition) => {
            if (definition.controllerConstructor.shouldLoad) {
                this.router.loadDefinition(definition);
            }
        });
    }
    unload(head, ...rest) {
        const identifiers = Array.isArray(head) ? head : [head, ...rest];
        identifiers.forEach((identifier) => this.router.unloadIdentifier(identifier));
    }
    get controllers() {
        return this.router.contexts.map((context) => context.controller);
    }
    getControllerForElementAndIdentifier(element, identifier) {
        const context = this.router.getContextForElementAndIdentifier(element, identifier);
        return context ? context.controller : null;
    }
    handleError(error, message, detail) {
        var _a;
        this.logger.error(`%s\n\n%o\n\n%o`, message, error, detail);
        (_a = window.onerror) === null || _a === void 0 ? void 0 : _a.call(window, message, "", 0, 0, error);
    }
    logFormattedMessage(identifier, functionName, detail = {}) {
        detail = Object.assign({ application: this }, detail);
        this.logger.groupCollapsed(`${identifier} #${functionName}`);
        this.logger.log("details:", Object.assign({}, detail));
        this.logger.groupEnd();
    }
}
function domReady() {
    return new Promise((resolve) => {
        if (document.readyState == "loading") {
            document.addEventListener("DOMContentLoaded", () => resolve());
        }
        else {
            resolve();
        }
    });
}

function ClassPropertiesBlessing(constructor) {
    const classes = readInheritableStaticArrayValues(constructor, "classes");
    return classes.reduce((properties, classDefinition) => {
        return Object.assign(properties, propertiesForClassDefinition(classDefinition));
    }, {});
}
function propertiesForClassDefinition(key) {
    return {
        [`${key}Class`]: {
            get() {
                const { classes } = this;
                if (classes.has(key)) {
                    return classes.get(key);
                }
                else {
                    const attribute = classes.getAttributeName(key);
                    throw new Error(`Missing attribute "${attribute}"`);
                }
            },
        },
        [`${key}Classes`]: {
            get() {
                return this.classes.getAll(key);
            },
        },
        [`has${capitalize(key)}Class`]: {
            get() {
                return this.classes.has(key);
            },
        },
    };
}

function OutletPropertiesBlessing(constructor) {
    const outlets = readInheritableStaticArrayValues(constructor, "outlets");
    return outlets.reduce((properties, outletDefinition) => {
        return Object.assign(properties, propertiesForOutletDefinition(outletDefinition));
    }, {});
}
function propertiesForOutletDefinition(name) {
    const camelizedName = namespaceCamelize(name);
    return {
        [`${camelizedName}Outlet`]: {
            get() {
                const outlet = this.outlets.find(name);
                if (outlet) {
                    const outletController = this.application.getControllerForElementAndIdentifier(outlet, name);
                    if (outletController) {
                        return outletController;
                    }
                    else {
                        throw new Error(`Missing "data-controller=${name}" attribute on outlet element for "${this.identifier}" controller`);
                    }
                }
                throw new Error(`Missing outlet element "${name}" for "${this.identifier}" controller`);
            },
        },
        [`${camelizedName}Outlets`]: {
            get() {
                const outlets = this.outlets.findAll(name);
                if (outlets.length > 0) {
                    return outlets
                        .map((outlet) => {
                        const controller = this.application.getControllerForElementAndIdentifier(outlet, name);
                        if (controller) {
                            return controller;
                        }
                        else {
                            console.warn(`The provided outlet element is missing the outlet controller "${name}" for "${this.identifier}"`, outlet);
                        }
                    })
                        .filter((controller) => controller);
                }
                return [];
            },
        },
        [`${camelizedName}OutletElement`]: {
            get() {
                const outlet = this.outlets.find(name);
                if (outlet) {
                    return outlet;
                }
                else {
                    throw new Error(`Missing outlet element "${name}" for "${this.identifier}" controller`);
                }
            },
        },
        [`${camelizedName}OutletElements`]: {
            get() {
                return this.outlets.findAll(name);
            },
        },
        [`has${capitalize(camelizedName)}Outlet`]: {
            get() {
                return this.outlets.has(name);
            },
        },
    };
}

function TargetPropertiesBlessing(constructor) {
    const targets = readInheritableStaticArrayValues(constructor, "targets");
    return targets.reduce((properties, targetDefinition) => {
        return Object.assign(properties, propertiesForTargetDefinition(targetDefinition));
    }, {});
}
function propertiesForTargetDefinition(name) {
    return {
        [`${name}Target`]: {
            get() {
                const target = this.targets.find(name);
                if (target) {
                    return target;
                }
                else {
                    throw new Error(`Missing target element "${name}" for "${this.identifier}" controller`);
                }
            },
        },
        [`${name}Targets`]: {
            get() {
                return this.targets.findAll(name);
            },
        },
        [`has${capitalize(name)}Target`]: {
            get() {
                return this.targets.has(name);
            },
        },
    };
}

function ValuePropertiesBlessing(constructor) {
    const valueDefinitionPairs = readInheritableStaticObjectPairs(constructor, "values");
    const propertyDescriptorMap = {
        valueDescriptorMap: {
            get() {
                return valueDefinitionPairs.reduce((result, valueDefinitionPair) => {
                    const valueDescriptor = parseValueDefinitionPair(valueDefinitionPair, this.identifier);
                    const attributeName = this.data.getAttributeNameForKey(valueDescriptor.key);
                    return Object.assign(result, { [attributeName]: valueDescriptor });
                }, {});
            },
        },
    };
    return valueDefinitionPairs.reduce((properties, valueDefinitionPair) => {
        return Object.assign(properties, propertiesForValueDefinitionPair(valueDefinitionPair));
    }, propertyDescriptorMap);
}
function propertiesForValueDefinitionPair(valueDefinitionPair, controller) {
    const definition = parseValueDefinitionPair(valueDefinitionPair, controller);
    const { key, name, reader: read, writer: write } = definition;
    return {
        [name]: {
            get() {
                const value = this.data.get(key);
                if (value !== null) {
                    return read(value);
                }
                else {
                    return definition.defaultValue;
                }
            },
            set(value) {
                if (value === undefined) {
                    this.data.delete(key);
                }
                else {
                    this.data.set(key, write(value));
                }
            },
        },
        [`has${capitalize(name)}`]: {
            get() {
                return this.data.has(key) || definition.hasCustomDefaultValue;
            },
        },
    };
}
function parseValueDefinitionPair([token, typeDefinition], controller) {
    return valueDescriptorForTokenAndTypeDefinition({
        controller,
        token,
        typeDefinition,
    });
}
function parseValueTypeConstant(constant) {
    switch (constant) {
        case Array:
            return "array";
        case Boolean:
            return "boolean";
        case Number:
            return "number";
        case Object:
            return "object";
        case String:
            return "string";
    }
}
function parseValueTypeDefault(defaultValue) {
    switch (typeof defaultValue) {
        case "boolean":
            return "boolean";
        case "number":
            return "number";
        case "string":
            return "string";
    }
    if (Array.isArray(defaultValue))
        return "array";
    if (Object.prototype.toString.call(defaultValue) === "[object Object]")
        return "object";
}
function parseValueTypeObject(payload) {
    const typeFromObject = parseValueTypeConstant(payload.typeObject.type);
    if (!typeFromObject)
        return;
    const defaultValueType = parseValueTypeDefault(payload.typeObject.default);
    if (typeFromObject !== defaultValueType) {
        const propertyPath = payload.controller ? `${payload.controller}.${payload.token}` : payload.token;
        throw new Error(`The specified default value for the Stimulus Value "${propertyPath}" must match the defined type "${typeFromObject}". The provided default value of "${payload.typeObject.default}" is of type "${defaultValueType}".`);
    }
    return typeFromObject;
}
function parseValueTypeDefinition(payload) {
    const typeFromObject = parseValueTypeObject({
        controller: payload.controller,
        token: payload.token,
        typeObject: payload.typeDefinition,
    });
    const typeFromDefaultValue = parseValueTypeDefault(payload.typeDefinition);
    const typeFromConstant = parseValueTypeConstant(payload.typeDefinition);
    const type = typeFromObject || typeFromDefaultValue || typeFromConstant;
    if (type)
        return type;
    const propertyPath = payload.controller ? `${payload.controller}.${payload.typeDefinition}` : payload.token;
    throw new Error(`Unknown value type "${propertyPath}" for "${payload.token}" value`);
}
function defaultValueForDefinition(typeDefinition) {
    const constant = parseValueTypeConstant(typeDefinition);
    if (constant)
        return defaultValuesByType[constant];
    const defaultValue = typeDefinition.default;
    if (defaultValue !== undefined)
        return defaultValue;
    return typeDefinition;
}
function valueDescriptorForTokenAndTypeDefinition(payload) {
    const key = `${dasherize(payload.token)}-value`;
    const type = parseValueTypeDefinition(payload);
    return {
        type,
        key,
        name: camelize(key),
        get defaultValue() {
            return defaultValueForDefinition(payload.typeDefinition);
        },
        get hasCustomDefaultValue() {
            return parseValueTypeDefault(payload.typeDefinition) !== undefined;
        },
        reader: readers[type],
        writer: writers[type] || writers.default,
    };
}
const defaultValuesByType = {
    get array() {
        return [];
    },
    boolean: false,
    number: 0,
    get object() {
        return {};
    },
    string: "",
};
const readers = {
    array(value) {
        const array = JSON.parse(value);
        if (!Array.isArray(array)) {
            throw new TypeError(`expected value of type "array" but instead got value "${value}" of type "${parseValueTypeDefault(array)}"`);
        }
        return array;
    },
    boolean(value) {
        return !(value == "0" || String(value).toLowerCase() == "false");
    },
    number(value) {
        return Number(value);
    },
    object(value) {
        const object = JSON.parse(value);
        if (object === null || typeof object != "object" || Array.isArray(object)) {
            throw new TypeError(`expected value of type "object" but instead got value "${value}" of type "${parseValueTypeDefault(object)}"`);
        }
        return object;
    },
    string(value) {
        return value;
    },
};
const writers = {
    default: writeString,
    array: writeJSON,
    object: writeJSON,
};
function writeJSON(value) {
    return JSON.stringify(value);
}
function writeString(value) {
    return `${value}`;
}

class Controller {
    constructor(context) {
        this.context = context;
    }
    static get shouldLoad() {
        return true;
    }
    static afterLoad(_identifier, _application) {
        return;
    }
    get application() {
        return this.context.application;
    }
    get scope() {
        return this.context.scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get targets() {
        return this.scope.targets;
    }
    get outlets() {
        return this.scope.outlets;
    }
    get classes() {
        return this.scope.classes;
    }
    get data() {
        return this.scope.data;
    }
    initialize() {
    }
    connect() {
    }
    disconnect() {
    }
    dispatch(eventName, { target = this.element, detail = {}, prefix = this.identifier, bubbles = true, cancelable = true } = {}) {
        const type = prefix ? `${prefix}:${eventName}` : eventName;
        const event = new CustomEvent(type, { detail, bubbles, cancelable });
        target.dispatchEvent(event);
        return event;
    }
}
Controller.blessings = [
    ClassPropertiesBlessing,
    TargetPropertiesBlessing,
    ValuePropertiesBlessing,
    OutletPropertiesBlessing,
];
Controller.targets = [];
Controller.outlets = [];
Controller.values = {};




/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers/disclosure-controller.js":
/*!*****************************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/disclosure-controller.js ***!
  \*****************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["region"];
  toggleRegion(event) {
    if (event.target.getAttribute('aria-expanded') === 'true') {
      this.regionTarget.setAttribute('aria-hidden', true);
      event.target.setAttribute('aria-expanded', false);
    } else {
      this.regionTarget.setAttribute('aria-hidden', false);
      event.target.setAttribute('aria-expanded', true);
    }
    const rect = this.regionTarget.getBoundingClientRect();
    window.scroll({
      top: window.pageYOffset + rect.top - window.innerHeight / 3,
      left: 0,
      behavior: 'smooth'
    });
  }
});

/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers/navigation-controller.js":
/*!*****************************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/navigation-controller.js ***!
  \*****************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["overlay"];
  open(event) {
    event.stopPropagation();
    this.overlayTarget.classList.add('is-visible');
  }
  close(event) {
    event.stopPropagation();
    this.overlayTarget.classList.remove('is-visible');
  }
});

/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers/question-form-controller.js":
/*!********************************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/question-form-controller.js ***!
  \********************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  connect() {
    this.initializeButtons();
    this.initializeCheckboxes();

    // Repopulate in case of invalid form returned
    this.selectedCategories = this.getSelectedCategories();
    this.toggleSuggestionsDiv();
  }

  // TODO: Refactor to stimulus

  initializeButtons() {
    var continueButton = document.getElementById('form-step__continue');
    var backButton = document.getElementById('form-step__back');
    if (!continueButton || !backButton) {
      return;
    }
    continueButton.addEventListener("click", this.activateStepTwo.bind(this));
    backButton.addEventListener("click", this.activateStepOne.bind(this));
  }
  initializeCheckboxes() {
    var categoriesField = document.querySelector('.form-field__categories');
    if (!categoriesField) {
      return;
    }

    // Whenever a change is detected, show relevant tips
    var checkboxes = categoriesField.querySelectorAll('input');
    var thisRef = this;
    checkboxes.forEach(function (e) {
      e.addEventListener('change', function () {
        if (this.checked) {
          thisRef.selectedCategories.push(this.value);
          thisRef.showSuggestionCategory(this.value);
        } else {
          thisRef.selectedCategories.pop(this.value);
          thisRef.hideSuggestionCategory(this.value);
        }

        // Check whether to show suggestions at all
        thisRef.toggleSuggestionsDiv();
      });
    });
  }
  toggleSuggestionsDiv() {
    var tipsDiv = document.querySelector('.form__tip');
    if (tipsDiv) {
      if (this.selectedCategories.length === 0) {
        tipsDiv.classList.add('is-hidden');
        tipsDiv.classList.add('is-visible');
      } else {
        tipsDiv.classList.add('is-visible');
        tipsDiv.classList.add('is-hidden');
      }
    }
  }
  getSelectedCategories() {
    var selectedCategories = [];
    var categoriesField = document.querySelector('.form-field__categories');
    if (!categoriesField) {
      return;
    }
    var checkboxes = categoriesField.querySelectorAll('input');
    var thisRef = this;
    checkboxes.forEach(function (e) {
      if (e.checked) {
        selectedCategories.push(e.value);
        thisRef.showSuggestionCategory(e.value);
      }
    });
    return selectedCategories;
  }
  showSuggestionCategory(category) {
    var idName = category.replaceAll(' ', '_');
    var suggestionDiv = document.querySelector('#suggestion-answers__' + idName);
    if (!suggestionDiv) {
      return;
    }
    suggestionDiv.classList.remove('is-hidden');
    suggestionDiv.classList.add('is-visible');

    // Move to top
    var parent = suggestionDiv.parentNode;
    if (parent) {
      suggestionDiv.parentNode.insertBefore(suggestionDiv, parent.firstChild);
    }
  }
  hideSuggestionCategory(category) {
    var idName = category.replaceAll(' ', '_');
    var suggestionDiv = document.querySelector('#suggestion-answers__' + idName);
    if (!suggestionDiv) {
      return;
    }
    suggestionDiv.classList.remove('is-visible');
    suggestionDiv.classList.add('is-hidden');
  }
  activateStepTwo() {
    window.scrollTo(0, 0);
    document.querySelectorAll(".form-step__one").forEach(e => e.classList.add('is-hidden'));
    document.querySelectorAll(".form-step__one").forEach(e => e.classList.remove('is-visible'));
    document.querySelectorAll(".form-step__two").forEach(e => e.classList.remove('is-hidden'));
    document.querySelectorAll(".form-step__two").forEach(e => e.classList.add('is-visible'));

    // Set the category tags/buttons in step 2
    var categoriesSpan = document.getElementById("form-step__selected-categories");
    categoriesSpan.innerHTML = this.getSelectedCategoriesHTML();

    // Categories in step 2 function as a back button
    var selectedCategoryButtons = document.querySelectorAll('.selected_category');
    if (selectedCategoryButtons) {
      var thisRef = this;
      selectedCategoryButtons.forEach(function (e) {
        e.addEventListener('click', thisRef.activateStepOne);
      });
    }
  }
  activateStepOne() {
    document.querySelectorAll(".form-step__two").forEach(e => e.classList.add('is-hidden'));
    document.querySelectorAll(".form-step__two").forEach(e => e.classList.remove('is-visible'));
    document.querySelectorAll(".form-step__one").forEach(e => e.classList.remove('is-hidden'));
    document.querySelectorAll(".form-step__one").forEach(e => e.classList.add('is-visible'));
  }
  getSelectedCategoriesHTML() {
    var htmlString = '';
    // Im not sure this is best practice :D
    if (this.selectedCategories.length > 0) {
      this.selectedCategories.forEach(e => htmlString += `<span class="tag selected_category">${e}</span>`);
    } else {
      htmlString = '<span class="tag selected_category">een nieuwe categorie</span>';
    }
    return htmlString;
  }
});

/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers/search-widget-builder-controller.js":
/*!****************************************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/search-widget-builder-controller.js ***!
  \****************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var copy_to_clipboard__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! copy-to-clipboard */ "./node_modules/copy-to-clipboard/index.js");
/* harmony import */ var copy_to_clipboard__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(copy_to_clipboard__WEBPACK_IMPORTED_MODULE_1__);


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["url", "title", "code", "example", "message"];
  connect() {
    this.updateCode();
  }
  keyup(event) {
    this.updateCode();
  }
  copy(event) {
    var self = this;
    copy_to_clipboard__WEBPACK_IMPORTED_MODULE_1___default()(this.codeTarget.value);

    // Show copy message
    this.messageTarget.style.display = "inline";
    setTimeout(function () {
      self.messageTarget.style.display = "none";
    }, 1200);
  }
  clear() {
    this.titleTarget.value = "";
    this.titleTarget.focus();
    this.updateCode();
  }
  updateCode() {
    this.codeTarget.value = `<iframe src="${this.urlTarget.value}?title=${this.titleTarget.value}" style="width: 100%; height: 120px;"></iframe>`;
    this.exampleTarget.innerHTML = this.codeTarget.value;
  }
});

/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers/social-share-buttons-controller.js":
/*!***************************************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/social-share-buttons-controller.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["link"];
  connect() {
    const url = window.location.href;
    const title = document.title;
    this.linkTargets.forEach(element => {
      const socialMediaPlatform = element.dataset.socialPlatform;
      let link = "";
      if (socialMediaPlatform === "facebook") {
        link = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
      } else if (socialMediaPlatform === "twitter") {
        link = `http://twitter.com/share?&url=${url}`;
      } else if (socialMediaPlatform === "linkedin") {
        link = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`;
      } else if (socialMediaPlatform === "whatsapp") {
        link = `https://wa.me/?text=${url}`;
      }
      element.setAttribute("href", link);
    });
  }
});

/***/ }),

/***/ "./node_modules/copy-to-clipboard/index.js":
/*!*************************************************!*\
  !*** ./node_modules/copy-to-clipboard/index.js ***!
  \*************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

"use strict";


var deselectCurrent = __webpack_require__(/*! toggle-selection */ "./node_modules/toggle-selection/index.js");

var clipboardToIE11Formatting = {
  "text/plain": "Text",
  "text/html": "Url",
  "default": "Text"
}

var defaultMessage = "Copy to clipboard: #{key}, Enter";

function format(message) {
  var copyKey = (/mac os x/i.test(navigator.userAgent) ? "⌘" : "Ctrl") + "+C";
  return message.replace(/#{\s*key\s*}/g, copyKey);
}

function copy(text, options) {
  var debug,
    message,
    reselectPrevious,
    range,
    selection,
    mark,
    success = false;
  if (!options) {
    options = {};
  }
  debug = options.debug || false;
  try {
    reselectPrevious = deselectCurrent();

    range = document.createRange();
    selection = document.getSelection();

    mark = document.createElement("span");
    mark.textContent = text;
    // avoid screen readers from reading out loud the text
    mark.ariaHidden = "true"
    // reset user styles for span element
    mark.style.all = "unset";
    // prevents scrolling to the end of the page
    mark.style.position = "fixed";
    mark.style.top = 0;
    mark.style.clip = "rect(0, 0, 0, 0)";
    // used to preserve spaces and line breaks
    mark.style.whiteSpace = "pre";
    // do not inherit user-select (it may be `none`)
    mark.style.webkitUserSelect = "text";
    mark.style.MozUserSelect = "text";
    mark.style.msUserSelect = "text";
    mark.style.userSelect = "text";
    mark.addEventListener("copy", function(e) {
      e.stopPropagation();
      if (options.format) {
        e.preventDefault();
        if (typeof e.clipboardData === "undefined") { // IE 11
          debug && console.warn("unable to use e.clipboardData");
          debug && console.warn("trying IE specific stuff");
          window.clipboardData.clearData();
          var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting["default"]
          window.clipboardData.setData(format, text);
        } else { // all other browsers
          e.clipboardData.clearData();
          e.clipboardData.setData(options.format, text);
        }
      }
      if (options.onCopy) {
        e.preventDefault();
        options.onCopy(e.clipboardData);
      }
    });

    document.body.appendChild(mark);

    range.selectNodeContents(mark);
    selection.addRange(range);

    var successful = document.execCommand("copy");
    if (!successful) {
      throw new Error("copy command was unsuccessful");
    }
    success = true;
  } catch (err) {
    debug && console.error("unable to copy using execCommand: ", err);
    debug && console.warn("trying IE specific stuff");
    try {
      window.clipboardData.setData(options.format || "text", text);
      options.onCopy && options.onCopy(window.clipboardData);
      success = true;
    } catch (err) {
      debug && console.error("unable to copy using clipboardData: ", err);
      debug && console.error("falling back to prompt");
      message = format("message" in options ? options.message : defaultMessage);
      window.prompt(message, text);
    }
  } finally {
    if (selection) {
      if (typeof selection.removeRange == "function") {
        selection.removeRange(range);
      } else {
        selection.removeAllRanges();
      }
    }

    if (mark) {
      document.body.removeChild(mark);
    }
    reselectPrevious();
  }

  return success;
}

module.exports = copy;


/***/ }),

/***/ "./node_modules/toggle-selection/index.js":
/*!************************************************!*\
  !*** ./node_modules/toggle-selection/index.js ***!
  \************************************************/
/***/ (function(module) {


module.exports = function () {
  var selection = document.getSelection();
  if (!selection.rangeCount) {
    return function () {};
  }
  var active = document.activeElement;

  var ranges = [];
  for (var i = 0; i < selection.rangeCount; i++) {
    ranges.push(selection.getRangeAt(i));
  }

  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML
    case 'INPUT':
    case 'TEXTAREA':
      active.blur();
      break;

    default:
      active = null;
      break;
  }

  selection.removeAllRanges();
  return function () {
    selection.type === 'Caret' &&
    selection.removeAllRanges();

    if (!selection.rangeCount) {
      ranges.forEach(function(range) {
        selection.addRange(range);
      });
    }

    active &&
    active.focus();
  };
};


/***/ }),

/***/ "./wagtail_helpdesk/static_src/js/controllers sync recursive \\.js$":
/*!****************************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/controllers/ sync \.js$ ***!
  \****************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

var map = {
	"./disclosure-controller.js": "./wagtail_helpdesk/static_src/js/controllers/disclosure-controller.js",
	"./navigation-controller.js": "./wagtail_helpdesk/static_src/js/controllers/navigation-controller.js",
	"./question-form-controller.js": "./wagtail_helpdesk/static_src/js/controllers/question-form-controller.js",
	"./search-widget-builder-controller.js": "./wagtail_helpdesk/static_src/js/controllers/search-widget-builder-controller.js",
	"./social-share-buttons-controller.js": "./wagtail_helpdesk/static_src/js/controllers/social-share-buttons-controller.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./wagtail_helpdesk/static_src/js/controllers sync recursive \\.js$";

/***/ }),

/***/ "./node_modules/konva/lib/Animation.js":
/*!*********************************************!*\
  !*** ./node_modules/konva/lib/Animation.js ***!
  \*********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Animation": function() { return /* binding */ Animation; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");


const now = (function () {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.glob.performance && _Global_js__WEBPACK_IMPORTED_MODULE_0__.glob.performance.now) {
        return function () {
            return _Global_js__WEBPACK_IMPORTED_MODULE_0__.glob.performance.now();
        };
    }
    return function () {
        return new Date().getTime();
    };
})();
class Animation {
    constructor(func, layers) {
        this.id = Animation.animIdCounter++;
        this.frame = {
            time: 0,
            timeDiff: 0,
            lastTime: now(),
            frameRate: 0,
        };
        this.func = func;
        this.setLayers(layers);
    }
    setLayers(layers) {
        let lays = [];
        if (layers) {
            lays = Array.isArray(layers) ? layers : [layers];
        }
        this.layers = lays;
        return this;
    }
    getLayers() {
        return this.layers;
    }
    addLayer(layer) {
        const layers = this.layers;
        const len = layers.length;
        for (let n = 0; n < len; n++) {
            if (layers[n]._id === layer._id) {
                return false;
            }
        }
        this.layers.push(layer);
        return true;
    }
    isRunning() {
        const a = Animation;
        const animations = a.animations;
        const len = animations.length;
        for (let n = 0; n < len; n++) {
            if (animations[n].id === this.id) {
                return true;
            }
        }
        return false;
    }
    start() {
        this.stop();
        this.frame.timeDiff = 0;
        this.frame.lastTime = now();
        Animation._addAnimation(this);
        return this;
    }
    stop() {
        Animation._removeAnimation(this);
        return this;
    }
    _updateFrameObject(time) {
        this.frame.timeDiff = time - this.frame.lastTime;
        this.frame.lastTime = time;
        this.frame.time += this.frame.timeDiff;
        this.frame.frameRate = 1000 / this.frame.timeDiff;
    }
    static _addAnimation(anim) {
        this.animations.push(anim);
        this._handleAnimation();
    }
    static _removeAnimation(anim) {
        const id = anim.id;
        const animations = this.animations;
        const len = animations.length;
        for (let n = 0; n < len; n++) {
            if (animations[n].id === id) {
                this.animations.splice(n, 1);
                break;
            }
        }
    }
    static _runFrames() {
        const layerHash = {};
        const animations = this.animations;
        for (let n = 0; n < animations.length; n++) {
            const anim = animations[n];
            const layers = anim.layers;
            const func = anim.func;
            anim._updateFrameObject(now());
            const layersLen = layers.length;
            let needRedraw;
            if (func) {
                needRedraw = func.call(anim, anim.frame) !== false;
            }
            else {
                needRedraw = true;
            }
            if (!needRedraw) {
                continue;
            }
            for (let i = 0; i < layersLen; i++) {
                const layer = layers[i];
                if (layer._id !== undefined) {
                    layerHash[layer._id] = layer;
                }
            }
        }
        for (const key in layerHash) {
            if (!layerHash.hasOwnProperty(key)) {
                continue;
            }
            layerHash[key].batchDraw();
        }
    }
    static _animationLoop() {
        const Anim = Animation;
        if (Anim.animations.length) {
            Anim._runFrames();
            _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.requestAnimFrame(Anim._animationLoop);
        }
        else {
            Anim.animRunning = false;
        }
    }
    static _handleAnimation() {
        if (!this.animRunning) {
            this.animRunning = true;
            _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.requestAnimFrame(this._animationLoop);
        }
    }
}
Animation.animations = [];
Animation.animIdCounter = 0;
Animation.animRunning = false;


/***/ }),

/***/ "./node_modules/konva/lib/BezierFunctions.js":
/*!***************************************************!*\
  !*** ./node_modules/konva/lib/BezierFunctions.js ***!
  \***************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "binomialCoefficients": function() { return /* binding */ binomialCoefficients; },
/* harmony export */   "cValues": function() { return /* binding */ cValues; },
/* harmony export */   "getCubicArcLength": function() { return /* binding */ getCubicArcLength; },
/* harmony export */   "getQuadraticArcLength": function() { return /* binding */ getQuadraticArcLength; },
/* harmony export */   "t2length": function() { return /* binding */ t2length; },
/* harmony export */   "tValues": function() { return /* binding */ tValues; }
/* harmony export */ });
const tValues = [
    [],
    [],
    [
        -0.5773502691896257645091487805019574556476,
        0.5773502691896257645091487805019574556476,
    ],
    [
        0, -0.7745966692414833770358530799564799221665,
        0.7745966692414833770358530799564799221665,
    ],
    [
        -0.3399810435848562648026657591032446872005,
        0.3399810435848562648026657591032446872005,
        -0.8611363115940525752239464888928095050957,
        0.8611363115940525752239464888928095050957,
    ],
    [
        0, -0.5384693101056830910363144207002088049672,
        0.5384693101056830910363144207002088049672,
        -0.9061798459386639927976268782993929651256,
        0.9061798459386639927976268782993929651256,
    ],
    [
        0.6612093864662645136613995950199053470064,
        -0.6612093864662645136613995950199053470064,
        -0.2386191860831969086305017216807119354186,
        0.2386191860831969086305017216807119354186,
        -0.9324695142031520278123015544939946091347,
        0.9324695142031520278123015544939946091347,
    ],
    [
        0, 0.4058451513773971669066064120769614633473,
        -0.4058451513773971669066064120769614633473,
        -0.7415311855993944398638647732807884070741,
        0.7415311855993944398638647732807884070741,
        -0.9491079123427585245261896840478512624007,
        0.9491079123427585245261896840478512624007,
    ],
    [
        -0.1834346424956498049394761423601839806667,
        0.1834346424956498049394761423601839806667,
        -0.5255324099163289858177390491892463490419,
        0.5255324099163289858177390491892463490419,
        -0.7966664774136267395915539364758304368371,
        0.7966664774136267395915539364758304368371,
        -0.9602898564975362316835608685694729904282,
        0.9602898564975362316835608685694729904282,
    ],
    [
        0, -0.8360311073266357942994297880697348765441,
        0.8360311073266357942994297880697348765441,
        -0.9681602395076260898355762029036728700494,
        0.9681602395076260898355762029036728700494,
        -0.3242534234038089290385380146433366085719,
        0.3242534234038089290385380146433366085719,
        -0.6133714327005903973087020393414741847857,
        0.6133714327005903973087020393414741847857,
    ],
    [
        -0.1488743389816312108848260011297199846175,
        0.1488743389816312108848260011297199846175,
        -0.4333953941292471907992659431657841622,
        0.4333953941292471907992659431657841622,
        -0.6794095682990244062343273651148735757692,
        0.6794095682990244062343273651148735757692,
        -0.8650633666889845107320966884234930485275,
        0.8650633666889845107320966884234930485275,
        -0.9739065285171717200779640120844520534282,
        0.9739065285171717200779640120844520534282,
    ],
    [
        0, -0.2695431559523449723315319854008615246796,
        0.2695431559523449723315319854008615246796,
        -0.5190961292068118159257256694586095544802,
        0.5190961292068118159257256694586095544802,
        -0.7301520055740493240934162520311534580496,
        0.7301520055740493240934162520311534580496,
        -0.8870625997680952990751577693039272666316,
        0.8870625997680952990751577693039272666316,
        -0.9782286581460569928039380011228573907714,
        0.9782286581460569928039380011228573907714,
    ],
    [
        -0.1252334085114689154724413694638531299833,
        0.1252334085114689154724413694638531299833,
        -0.3678314989981801937526915366437175612563,
        0.3678314989981801937526915366437175612563,
        -0.587317954286617447296702418940534280369,
        0.587317954286617447296702418940534280369,
        -0.7699026741943046870368938332128180759849,
        0.7699026741943046870368938332128180759849,
        -0.9041172563704748566784658661190961925375,
        0.9041172563704748566784658661190961925375,
        -0.9815606342467192506905490901492808229601,
        0.9815606342467192506905490901492808229601,
    ],
    [
        0, -0.2304583159551347940655281210979888352115,
        0.2304583159551347940655281210979888352115,
        -0.4484927510364468528779128521276398678019,
        0.4484927510364468528779128521276398678019,
        -0.6423493394403402206439846069955156500716,
        0.6423493394403402206439846069955156500716,
        -0.8015780907333099127942064895828598903056,
        0.8015780907333099127942064895828598903056,
        -0.9175983992229779652065478365007195123904,
        0.9175983992229779652065478365007195123904,
        -0.9841830547185881494728294488071096110649,
        0.9841830547185881494728294488071096110649,
    ],
    [
        -0.1080549487073436620662446502198347476119,
        0.1080549487073436620662446502198347476119,
        -0.3191123689278897604356718241684754668342,
        0.3191123689278897604356718241684754668342,
        -0.5152486363581540919652907185511886623088,
        0.5152486363581540919652907185511886623088,
        -0.6872929048116854701480198030193341375384,
        0.6872929048116854701480198030193341375384,
        -0.8272013150697649931897947426503949610397,
        0.8272013150697649931897947426503949610397,
        -0.928434883663573517336391139377874264477,
        0.928434883663573517336391139377874264477,
        -0.986283808696812338841597266704052801676,
        0.986283808696812338841597266704052801676,
    ],
    [
        0, -0.2011940939974345223006283033945962078128,
        0.2011940939974345223006283033945962078128,
        -0.3941513470775633698972073709810454683627,
        0.3941513470775633698972073709810454683627,
        -0.5709721726085388475372267372539106412383,
        0.5709721726085388475372267372539106412383,
        -0.7244177313601700474161860546139380096308,
        0.7244177313601700474161860546139380096308,
        -0.8482065834104272162006483207742168513662,
        0.8482065834104272162006483207742168513662,
        -0.9372733924007059043077589477102094712439,
        0.9372733924007059043077589477102094712439,
        -0.9879925180204854284895657185866125811469,
        0.9879925180204854284895657185866125811469,
    ],
    [
        -0.0950125098376374401853193354249580631303,
        0.0950125098376374401853193354249580631303,
        -0.281603550779258913230460501460496106486,
        0.281603550779258913230460501460496106486,
        -0.45801677765722738634241944298357757354,
        0.45801677765722738634241944298357757354,
        -0.6178762444026437484466717640487910189918,
        0.6178762444026437484466717640487910189918,
        -0.7554044083550030338951011948474422683538,
        0.7554044083550030338951011948474422683538,
        -0.8656312023878317438804678977123931323873,
        0.8656312023878317438804678977123931323873,
        -0.9445750230732325760779884155346083450911,
        0.9445750230732325760779884155346083450911,
        -0.9894009349916499325961541734503326274262,
        0.9894009349916499325961541734503326274262,
    ],
    [
        0, -0.1784841814958478558506774936540655574754,
        0.1784841814958478558506774936540655574754,
        -0.3512317634538763152971855170953460050405,
        0.3512317634538763152971855170953460050405,
        -0.5126905370864769678862465686295518745829,
        0.5126905370864769678862465686295518745829,
        -0.6576711592166907658503022166430023351478,
        0.6576711592166907658503022166430023351478,
        -0.7815140038968014069252300555204760502239,
        0.7815140038968014069252300555204760502239,
        -0.8802391537269859021229556944881556926234,
        0.8802391537269859021229556944881556926234,
        -0.9506755217687677612227169578958030214433,
        0.9506755217687677612227169578958030214433,
        -0.9905754753144173356754340199406652765077,
        0.9905754753144173356754340199406652765077,
    ],
    [
        -0.0847750130417353012422618529357838117333,
        0.0847750130417353012422618529357838117333,
        -0.2518862256915055095889728548779112301628,
        0.2518862256915055095889728548779112301628,
        -0.4117511614628426460359317938330516370789,
        0.4117511614628426460359317938330516370789,
        -0.5597708310739475346078715485253291369276,
        0.5597708310739475346078715485253291369276,
        -0.6916870430603532078748910812888483894522,
        0.6916870430603532078748910812888483894522,
        -0.8037049589725231156824174550145907971032,
        0.8037049589725231156824174550145907971032,
        -0.8926024664975557392060605911271455154078,
        0.8926024664975557392060605911271455154078,
        -0.9558239495713977551811958929297763099728,
        0.9558239495713977551811958929297763099728,
        -0.9915651684209309467300160047061507702525,
        0.9915651684209309467300160047061507702525,
    ],
    [
        0, -0.1603586456402253758680961157407435495048,
        0.1603586456402253758680961157407435495048,
        -0.3165640999636298319901173288498449178922,
        0.3165640999636298319901173288498449178922,
        -0.4645707413759609457172671481041023679762,
        0.4645707413759609457172671481041023679762,
        -0.6005453046616810234696381649462392798683,
        0.6005453046616810234696381649462392798683,
        -0.7209661773352293786170958608237816296571,
        0.7209661773352293786170958608237816296571,
        -0.8227146565371428249789224867127139017745,
        0.8227146565371428249789224867127139017745,
        -0.9031559036148179016426609285323124878093,
        0.9031559036148179016426609285323124878093,
        -0.960208152134830030852778840687651526615,
        0.960208152134830030852778840687651526615,
        -0.9924068438435844031890176702532604935893,
        0.9924068438435844031890176702532604935893,
    ],
    [
        -0.0765265211334973337546404093988382110047,
        0.0765265211334973337546404093988382110047,
        -0.227785851141645078080496195368574624743,
        0.227785851141645078080496195368574624743,
        -0.3737060887154195606725481770249272373957,
        0.3737060887154195606725481770249272373957,
        -0.5108670019508270980043640509552509984254,
        0.5108670019508270980043640509552509984254,
        -0.6360536807265150254528366962262859367433,
        0.6360536807265150254528366962262859367433,
        -0.7463319064601507926143050703556415903107,
        0.7463319064601507926143050703556415903107,
        -0.8391169718222188233945290617015206853296,
        0.8391169718222188233945290617015206853296,
        -0.9122344282513259058677524412032981130491,
        0.9122344282513259058677524412032981130491,
        -0.963971927277913791267666131197277221912,
        0.963971927277913791267666131197277221912,
        -0.9931285991850949247861223884713202782226,
        0.9931285991850949247861223884713202782226,
    ],
    [
        0, -0.1455618541608950909370309823386863301163,
        0.1455618541608950909370309823386863301163,
        -0.288021316802401096600792516064600319909,
        0.288021316802401096600792516064600319909,
        -0.4243421202074387835736688885437880520964,
        0.4243421202074387835736688885437880520964,
        -0.551618835887219807059018796724313286622,
        0.551618835887219807059018796724313286622,
        -0.667138804197412319305966669990339162597,
        0.667138804197412319305966669990339162597,
        -0.7684399634756779086158778513062280348209,
        0.7684399634756779086158778513062280348209,
        -0.8533633645833172836472506385875676702761,
        0.8533633645833172836472506385875676702761,
        -0.9200993341504008287901871337149688941591,
        0.9200993341504008287901871337149688941591,
        -0.9672268385663062943166222149076951614246,
        0.9672268385663062943166222149076951614246,
        -0.9937521706203895002602420359379409291933,
        0.9937521706203895002602420359379409291933,
    ],
    [
        -0.0697392733197222212138417961186280818222,
        0.0697392733197222212138417961186280818222,
        -0.2078604266882212854788465339195457342156,
        0.2078604266882212854788465339195457342156,
        -0.3419358208920842251581474204273796195591,
        0.3419358208920842251581474204273796195591,
        -0.4693558379867570264063307109664063460953,
        0.4693558379867570264063307109664063460953,
        -0.5876404035069115929588769276386473488776,
        0.5876404035069115929588769276386473488776,
        -0.6944872631866827800506898357622567712673,
        0.6944872631866827800506898357622567712673,
        -0.7878168059792081620042779554083515213881,
        0.7878168059792081620042779554083515213881,
        -0.8658125777203001365364256370193787290847,
        0.8658125777203001365364256370193787290847,
        -0.9269567721871740005206929392590531966353,
        0.9269567721871740005206929392590531966353,
        -0.9700604978354287271239509867652687108059,
        0.9700604978354287271239509867652687108059,
        -0.994294585482399292073031421161298980393,
        0.994294585482399292073031421161298980393,
    ],
    [
        0, -0.1332568242984661109317426822417661370104,
        0.1332568242984661109317426822417661370104,
        -0.264135680970344930533869538283309602979,
        0.264135680970344930533869538283309602979,
        -0.390301038030290831421488872880605458578,
        0.390301038030290831421488872880605458578,
        -0.5095014778460075496897930478668464305448,
        0.5095014778460075496897930478668464305448,
        -0.6196098757636461563850973116495956533871,
        0.6196098757636461563850973116495956533871,
        -0.7186613631319501944616244837486188483299,
        0.7186613631319501944616244837486188483299,
        -0.8048884016188398921511184069967785579414,
        0.8048884016188398921511184069967785579414,
        -0.8767523582704416673781568859341456716389,
        0.8767523582704416673781568859341456716389,
        -0.9329710868260161023491969890384229782357,
        0.9329710868260161023491969890384229782357,
        -0.9725424712181152319560240768207773751816,
        0.9725424712181152319560240768207773751816,
        -0.9947693349975521235239257154455743605736,
        0.9947693349975521235239257154455743605736,
    ],
    [
        -0.0640568928626056260850430826247450385909,
        0.0640568928626056260850430826247450385909,
        -0.1911188674736163091586398207570696318404,
        0.1911188674736163091586398207570696318404,
        -0.3150426796961633743867932913198102407864,
        0.3150426796961633743867932913198102407864,
        -0.4337935076260451384870842319133497124524,
        0.4337935076260451384870842319133497124524,
        -0.5454214713888395356583756172183723700107,
        0.5454214713888395356583756172183723700107,
        -0.6480936519369755692524957869107476266696,
        0.6480936519369755692524957869107476266696,
        -0.7401241915785543642438281030999784255232,
        0.7401241915785543642438281030999784255232,
        -0.8200019859739029219539498726697452080761,
        0.8200019859739029219539498726697452080761,
        -0.8864155270044010342131543419821967550873,
        0.8864155270044010342131543419821967550873,
        -0.9382745520027327585236490017087214496548,
        0.9382745520027327585236490017087214496548,
        -0.9747285559713094981983919930081690617411,
        0.9747285559713094981983919930081690617411,
        -0.9951872199970213601799974097007368118745,
        0.9951872199970213601799974097007368118745,
    ],
];
const cValues = [
    [],
    [],
    [1.0, 1.0],
    [
        0.8888888888888888888888888888888888888888,
        0.5555555555555555555555555555555555555555,
        0.5555555555555555555555555555555555555555,
    ],
    [
        0.6521451548625461426269360507780005927646,
        0.6521451548625461426269360507780005927646,
        0.3478548451374538573730639492219994072353,
        0.3478548451374538573730639492219994072353,
    ],
    [
        0.5688888888888888888888888888888888888888,
        0.4786286704993664680412915148356381929122,
        0.4786286704993664680412915148356381929122,
        0.2369268850561890875142640407199173626432,
        0.2369268850561890875142640407199173626432,
    ],
    [
        0.3607615730481386075698335138377161116615,
        0.3607615730481386075698335138377161116615,
        0.4679139345726910473898703439895509948116,
        0.4679139345726910473898703439895509948116,
        0.1713244923791703450402961421727328935268,
        0.1713244923791703450402961421727328935268,
    ],
    [
        0.4179591836734693877551020408163265306122,
        0.3818300505051189449503697754889751338783,
        0.3818300505051189449503697754889751338783,
        0.2797053914892766679014677714237795824869,
        0.2797053914892766679014677714237795824869,
        0.1294849661688696932706114326790820183285,
        0.1294849661688696932706114326790820183285,
    ],
    [
        0.3626837833783619829651504492771956121941,
        0.3626837833783619829651504492771956121941,
        0.3137066458778872873379622019866013132603,
        0.3137066458778872873379622019866013132603,
        0.2223810344533744705443559944262408844301,
        0.2223810344533744705443559944262408844301,
        0.1012285362903762591525313543099621901153,
        0.1012285362903762591525313543099621901153,
    ],
    [
        0.3302393550012597631645250692869740488788,
        0.1806481606948574040584720312429128095143,
        0.1806481606948574040584720312429128095143,
        0.0812743883615744119718921581105236506756,
        0.0812743883615744119718921581105236506756,
        0.3123470770400028400686304065844436655987,
        0.3123470770400028400686304065844436655987,
        0.2606106964029354623187428694186328497718,
        0.2606106964029354623187428694186328497718,
    ],
    [
        0.295524224714752870173892994651338329421,
        0.295524224714752870173892994651338329421,
        0.2692667193099963550912269215694693528597,
        0.2692667193099963550912269215694693528597,
        0.2190863625159820439955349342281631924587,
        0.2190863625159820439955349342281631924587,
        0.1494513491505805931457763396576973324025,
        0.1494513491505805931457763396576973324025,
        0.0666713443086881375935688098933317928578,
        0.0666713443086881375935688098933317928578,
    ],
    [
        0.272925086777900630714483528336342189156,
        0.2628045445102466621806888698905091953727,
        0.2628045445102466621806888698905091953727,
        0.2331937645919904799185237048431751394317,
        0.2331937645919904799185237048431751394317,
        0.1862902109277342514260976414316558916912,
        0.1862902109277342514260976414316558916912,
        0.1255803694649046246346942992239401001976,
        0.1255803694649046246346942992239401001976,
        0.0556685671161736664827537204425485787285,
        0.0556685671161736664827537204425485787285,
    ],
    [
        0.2491470458134027850005624360429512108304,
        0.2491470458134027850005624360429512108304,
        0.2334925365383548087608498989248780562594,
        0.2334925365383548087608498989248780562594,
        0.2031674267230659217490644558097983765065,
        0.2031674267230659217490644558097983765065,
        0.160078328543346226334652529543359071872,
        0.160078328543346226334652529543359071872,
        0.1069393259953184309602547181939962242145,
        0.1069393259953184309602547181939962242145,
        0.047175336386511827194615961485017060317,
        0.047175336386511827194615961485017060317,
    ],
    [
        0.2325515532308739101945895152688359481566,
        0.2262831802628972384120901860397766184347,
        0.2262831802628972384120901860397766184347,
        0.2078160475368885023125232193060527633865,
        0.2078160475368885023125232193060527633865,
        0.1781459807619457382800466919960979955128,
        0.1781459807619457382800466919960979955128,
        0.1388735102197872384636017768688714676218,
        0.1388735102197872384636017768688714676218,
        0.0921214998377284479144217759537971209236,
        0.0921214998377284479144217759537971209236,
        0.0404840047653158795200215922009860600419,
        0.0404840047653158795200215922009860600419,
    ],
    [
        0.2152638534631577901958764433162600352749,
        0.2152638534631577901958764433162600352749,
        0.2051984637212956039659240656612180557103,
        0.2051984637212956039659240656612180557103,
        0.1855383974779378137417165901251570362489,
        0.1855383974779378137417165901251570362489,
        0.1572031671581935345696019386238421566056,
        0.1572031671581935345696019386238421566056,
        0.1215185706879031846894148090724766259566,
        0.1215185706879031846894148090724766259566,
        0.0801580871597602098056332770628543095836,
        0.0801580871597602098056332770628543095836,
        0.0351194603317518630318328761381917806197,
        0.0351194603317518630318328761381917806197,
    ],
    [
        0.2025782419255612728806201999675193148386,
        0.1984314853271115764561183264438393248186,
        0.1984314853271115764561183264438393248186,
        0.1861610000155622110268005618664228245062,
        0.1861610000155622110268005618664228245062,
        0.1662692058169939335532008604812088111309,
        0.1662692058169939335532008604812088111309,
        0.1395706779261543144478047945110283225208,
        0.1395706779261543144478047945110283225208,
        0.1071592204671719350118695466858693034155,
        0.1071592204671719350118695466858693034155,
        0.0703660474881081247092674164506673384667,
        0.0703660474881081247092674164506673384667,
        0.0307532419961172683546283935772044177217,
        0.0307532419961172683546283935772044177217,
    ],
    [
        0.1894506104550684962853967232082831051469,
        0.1894506104550684962853967232082831051469,
        0.1826034150449235888667636679692199393835,
        0.1826034150449235888667636679692199393835,
        0.1691565193950025381893120790303599622116,
        0.1691565193950025381893120790303599622116,
        0.1495959888165767320815017305474785489704,
        0.1495959888165767320815017305474785489704,
        0.1246289712555338720524762821920164201448,
        0.1246289712555338720524762821920164201448,
        0.0951585116824927848099251076022462263552,
        0.0951585116824927848099251076022462263552,
        0.0622535239386478928628438369943776942749,
        0.0622535239386478928628438369943776942749,
        0.0271524594117540948517805724560181035122,
        0.0271524594117540948517805724560181035122,
    ],
    [
        0.1794464703562065254582656442618856214487,
        0.1765627053669926463252709901131972391509,
        0.1765627053669926463252709901131972391509,
        0.1680041021564500445099706637883231550211,
        0.1680041021564500445099706637883231550211,
        0.1540457610768102880814315948019586119404,
        0.1540457610768102880814315948019586119404,
        0.1351363684685254732863199817023501973721,
        0.1351363684685254732863199817023501973721,
        0.1118838471934039710947883856263559267358,
        0.1118838471934039710947883856263559267358,
        0.0850361483171791808835353701910620738504,
        0.0850361483171791808835353701910620738504,
        0.0554595293739872011294401653582446605128,
        0.0554595293739872011294401653582446605128,
        0.0241483028685479319601100262875653246916,
        0.0241483028685479319601100262875653246916,
    ],
    [
        0.1691423829631435918406564701349866103341,
        0.1691423829631435918406564701349866103341,
        0.1642764837458327229860537764659275904123,
        0.1642764837458327229860537764659275904123,
        0.1546846751262652449254180038363747721932,
        0.1546846751262652449254180038363747721932,
        0.1406429146706506512047313037519472280955,
        0.1406429146706506512047313037519472280955,
        0.1225552067114784601845191268002015552281,
        0.1225552067114784601845191268002015552281,
        0.1009420441062871655628139849248346070628,
        0.1009420441062871655628139849248346070628,
        0.0764257302548890565291296776166365256053,
        0.0764257302548890565291296776166365256053,
        0.0497145488949697964533349462026386416808,
        0.0497145488949697964533349462026386416808,
        0.0216160135264833103133427102664524693876,
        0.0216160135264833103133427102664524693876,
    ],
    [
        0.1610544498487836959791636253209167350399,
        0.1589688433939543476499564394650472016787,
        0.1589688433939543476499564394650472016787,
        0.152766042065859666778855400897662998461,
        0.152766042065859666778855400897662998461,
        0.1426067021736066117757461094419029724756,
        0.1426067021736066117757461094419029724756,
        0.1287539625393362276755157848568771170558,
        0.1287539625393362276755157848568771170558,
        0.1115666455473339947160239016817659974813,
        0.1115666455473339947160239016817659974813,
        0.0914900216224499994644620941238396526609,
        0.0914900216224499994644620941238396526609,
        0.0690445427376412265807082580060130449618,
        0.0690445427376412265807082580060130449618,
        0.0448142267656996003328381574019942119517,
        0.0448142267656996003328381574019942119517,
        0.0194617882297264770363120414644384357529,
        0.0194617882297264770363120414644384357529,
    ],
    [
        0.1527533871307258506980843319550975934919,
        0.1527533871307258506980843319550975934919,
        0.1491729864726037467878287370019694366926,
        0.1491729864726037467878287370019694366926,
        0.1420961093183820513292983250671649330345,
        0.1420961093183820513292983250671649330345,
        0.1316886384491766268984944997481631349161,
        0.1316886384491766268984944997481631349161,
        0.118194531961518417312377377711382287005,
        0.118194531961518417312377377711382287005,
        0.1019301198172404350367501354803498761666,
        0.1019301198172404350367501354803498761666,
        0.0832767415767047487247581432220462061001,
        0.0832767415767047487247581432220462061001,
        0.0626720483341090635695065351870416063516,
        0.0626720483341090635695065351870416063516,
        0.040601429800386941331039952274932109879,
        0.040601429800386941331039952274932109879,
        0.0176140071391521183118619623518528163621,
        0.0176140071391521183118619623518528163621,
    ],
    [
        0.1460811336496904271919851476833711882448,
        0.1445244039899700590638271665537525436099,
        0.1445244039899700590638271665537525436099,
        0.1398873947910731547221334238675831108927,
        0.1398873947910731547221334238675831108927,
        0.132268938633337461781052574496775604329,
        0.132268938633337461781052574496775604329,
        0.1218314160537285341953671771257335983563,
        0.1218314160537285341953671771257335983563,
        0.1087972991671483776634745780701056420336,
        0.1087972991671483776634745780701056420336,
        0.0934444234560338615532897411139320884835,
        0.0934444234560338615532897411139320884835,
        0.0761001136283793020170516533001831792261,
        0.0761001136283793020170516533001831792261,
        0.0571344254268572082836358264724479574912,
        0.0571344254268572082836358264724479574912,
        0.0369537897708524937999506682993296661889,
        0.0369537897708524937999506682993296661889,
        0.0160172282577743333242246168584710152658,
        0.0160172282577743333242246168584710152658,
    ],
    [
        0.1392518728556319933754102483418099578739,
        0.1392518728556319933754102483418099578739,
        0.1365414983460151713525738312315173965863,
        0.1365414983460151713525738312315173965863,
        0.1311735047870623707329649925303074458757,
        0.1311735047870623707329649925303074458757,
        0.1232523768105124242855609861548144719594,
        0.1232523768105124242855609861548144719594,
        0.1129322960805392183934006074217843191142,
        0.1129322960805392183934006074217843191142,
        0.1004141444428809649320788378305362823508,
        0.1004141444428809649320788378305362823508,
        0.0859416062170677274144436813727028661891,
        0.0859416062170677274144436813727028661891,
        0.0697964684245204880949614189302176573987,
        0.0697964684245204880949614189302176573987,
        0.0522933351526832859403120512732112561121,
        0.0522933351526832859403120512732112561121,
        0.0337749015848141547933022468659129013491,
        0.0337749015848141547933022468659129013491,
        0.0146279952982722006849910980471854451902,
        0.0146279952982722006849910980471854451902,
    ],
    [
        0.1336545721861061753514571105458443385831,
        0.132462039404696617371642464703316925805,
        0.132462039404696617371642464703316925805,
        0.1289057221880821499785953393997936532597,
        0.1289057221880821499785953393997936532597,
        0.1230490843067295304675784006720096548158,
        0.1230490843067295304675784006720096548158,
        0.1149966402224113649416435129339613014914,
        0.1149966402224113649416435129339613014914,
        0.1048920914645414100740861850147438548584,
        0.1048920914645414100740861850147438548584,
        0.0929157660600351474770186173697646486034,
        0.0929157660600351474770186173697646486034,
        0.0792814117767189549228925247420432269137,
        0.0792814117767189549228925247420432269137,
        0.0642324214085258521271696151589109980391,
        0.0642324214085258521271696151589109980391,
        0.0480376717310846685716410716320339965612,
        0.0480376717310846685716410716320339965612,
        0.0309880058569794443106942196418845053837,
        0.0309880058569794443106942196418845053837,
        0.0134118594871417720813094934586150649766,
        0.0134118594871417720813094934586150649766,
    ],
    [
        0.1279381953467521569740561652246953718517,
        0.1279381953467521569740561652246953718517,
        0.1258374563468282961213753825111836887264,
        0.1258374563468282961213753825111836887264,
        0.121670472927803391204463153476262425607,
        0.121670472927803391204463153476262425607,
        0.1155056680537256013533444839067835598622,
        0.1155056680537256013533444839067835598622,
        0.1074442701159656347825773424466062227946,
        0.1074442701159656347825773424466062227946,
        0.0976186521041138882698806644642471544279,
        0.0976186521041138882698806644642471544279,
        0.086190161531953275917185202983742667185,
        0.086190161531953275917185202983742667185,
        0.0733464814110803057340336152531165181193,
        0.0733464814110803057340336152531165181193,
        0.0592985849154367807463677585001085845412,
        0.0592985849154367807463677585001085845412,
        0.0442774388174198061686027482113382288593,
        0.0442774388174198061686027482113382288593,
        0.0285313886289336631813078159518782864491,
        0.0285313886289336631813078159518782864491,
        0.0123412297999871995468056670700372915759,
        0.0123412297999871995468056670700372915759,
    ],
];
const binomialCoefficients = [[1], [1, 1], [1, 2, 1], [1, 3, 3, 1]];
const getCubicArcLength = (xs, ys, t) => {
    let sum;
    let correctedT;
    const n = 20;
    const z = t / 2;
    sum = 0;
    for (let i = 0; i < n; i++) {
        correctedT = z * tValues[n][i] + z;
        sum += cValues[n][i] * BFunc(xs, ys, correctedT);
    }
    return z * sum;
};
const getQuadraticArcLength = (xs, ys, t) => {
    if (t === undefined) {
        t = 1;
    }
    const ax = xs[0] - 2 * xs[1] + xs[2];
    const ay = ys[0] - 2 * ys[1] + ys[2];
    const bx = 2 * xs[1] - 2 * xs[0];
    const by = 2 * ys[1] - 2 * ys[0];
    const A = 4 * (ax * ax + ay * ay);
    const B = 4 * (ax * bx + ay * by);
    const C = bx * bx + by * by;
    if (A === 0) {
        return (t * Math.sqrt(Math.pow(xs[2] - xs[0], 2) + Math.pow(ys[2] - ys[0], 2)));
    }
    const b = B / (2 * A);
    const c = C / A;
    const u = t + b;
    const k = c - b * b;
    const uuk = u * u + k > 0 ? Math.sqrt(u * u + k) : 0;
    const bbk = b * b + k > 0 ? Math.sqrt(b * b + k) : 0;
    const term = b + Math.sqrt(b * b + k) !== 0
        ? k * Math.log(Math.abs((u + uuk) / (b + bbk)))
        : 0;
    return (Math.sqrt(A) / 2) * (u * uuk - b * bbk + term);
};
function BFunc(xs, ys, t) {
    const xbase = getDerivative(1, t, xs);
    const ybase = getDerivative(1, t, ys);
    const combined = xbase * xbase + ybase * ybase;
    return Math.sqrt(combined);
}
const getDerivative = (derivative, t, vs) => {
    const n = vs.length - 1;
    let _vs;
    let value;
    if (n === 0) {
        return 0;
    }
    if (derivative === 0) {
        value = 0;
        for (let k = 0; k <= n; k++) {
            value +=
                binomialCoefficients[n][k] *
                    Math.pow(1 - t, n - k) *
                    Math.pow(t, k) *
                    vs[k];
        }
        return value;
    }
    else {
        _vs = new Array(n);
        for (let k = 0; k < n; k++) {
            _vs[k] = n * (vs[k + 1] - vs[k]);
        }
        return getDerivative(derivative - 1, t, _vs);
    }
};
const t2length = (length, totalLength, func) => {
    let error = 1;
    let t = length / totalLength;
    let step = (length - func(t)) / totalLength;
    let numIterations = 0;
    while (error > 0.001) {
        const increasedTLength = func(t + step);
        const increasedTError = Math.abs(length - increasedTLength) / totalLength;
        if (increasedTError < error) {
            error = increasedTError;
            t += step;
        }
        else {
            const decreasedTLength = func(t - step);
            const decreasedTError = Math.abs(length - decreasedTLength) / totalLength;
            if (decreasedTError < error) {
                error = decreasedTError;
                t -= step;
            }
            else {
                step /= 2;
            }
        }
        numIterations++;
        if (numIterations > 500) {
            break;
        }
    }
    return t;
};


/***/ }),

/***/ "./node_modules/konva/lib/Canvas.js":
/*!******************************************!*\
  !*** ./node_modules/konva/lib/Canvas.js ***!
  \******************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Canvas": function() { return /* binding */ Canvas; },
/* harmony export */   "HitCanvas": function() { return /* binding */ HitCanvas; },
/* harmony export */   "SceneCanvas": function() { return /* binding */ SceneCanvas; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Context_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Context.js */ "./node_modules/konva/lib/Context.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");



let _pixelRatio;
function getDevicePixelRatio() {
    if (_pixelRatio) {
        return _pixelRatio;
    }
    const canvas = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement();
    const context = canvas.getContext('2d');
    _pixelRatio = (function () {
        const devicePixelRatio = _Global_js__WEBPACK_IMPORTED_MODULE_2__.Konva._global.devicePixelRatio || 1, backingStoreRatio = context.webkitBackingStorePixelRatio ||
            context.mozBackingStorePixelRatio ||
            context.msBackingStorePixelRatio ||
            context.oBackingStorePixelRatio ||
            context.backingStorePixelRatio ||
            1;
        return devicePixelRatio / backingStoreRatio;
    })();
    _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.releaseCanvas(canvas);
    return _pixelRatio;
}
class Canvas {
    constructor(config) {
        this.pixelRatio = 1;
        this.width = 0;
        this.height = 0;
        this.isCache = false;
        const conf = config || {};
        const pixelRatio = conf.pixelRatio || _Global_js__WEBPACK_IMPORTED_MODULE_2__.Konva.pixelRatio || getDevicePixelRatio();
        this.pixelRatio = pixelRatio;
        this._canvas = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement();
        this._canvas.style.padding = '0';
        this._canvas.style.margin = '0';
        this._canvas.style.border = '0';
        this._canvas.style.background = 'transparent';
        this._canvas.style.position = 'absolute';
        this._canvas.style.top = '0';
        this._canvas.style.left = '0';
    }
    getContext() {
        return this.context;
    }
    getPixelRatio() {
        return this.pixelRatio;
    }
    setPixelRatio(pixelRatio) {
        const previousRatio = this.pixelRatio;
        this.pixelRatio = pixelRatio;
        this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);
    }
    setWidth(width) {
        this.width = this._canvas.width = width * this.pixelRatio;
        this._canvas.style.width = width + 'px';
        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;
        _context.scale(pixelRatio, pixelRatio);
    }
    setHeight(height) {
        this.height = this._canvas.height = height * this.pixelRatio;
        this._canvas.style.height = height + 'px';
        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;
        _context.scale(pixelRatio, pixelRatio);
    }
    getWidth() {
        return this.width;
    }
    getHeight() {
        return this.height;
    }
    setSize(width, height) {
        this.setWidth(width || 0);
        this.setHeight(height || 0);
    }
    toDataURL(mimeType, quality) {
        try {
            return this._canvas.toDataURL(mimeType, quality);
        }
        catch (e) {
            try {
                return this._canvas.toDataURL();
            }
            catch (err) {
                _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Unable to get data URL. ' +
                    err.message +
                    ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');
                return '';
            }
        }
    }
}
class SceneCanvas extends Canvas {
    constructor(config = { width: 0, height: 0, willReadFrequently: false }) {
        super(config);
        this.context = new _Context_js__WEBPACK_IMPORTED_MODULE_1__.SceneContext(this, {
            willReadFrequently: config.willReadFrequently,
        });
        this.setSize(config.width, config.height);
    }
}
function isCanvasFarblingActive() {
    const c = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement();
    c.width = 1;
    c.height = 1;
    const ctx = c.getContext('2d', {
        willReadFrequently: true,
    });
    ctx.clearRect(0, 0, 1, 1);
    ctx.fillStyle = 'rgba(255,0,255,1)';
    ctx.fillRect(0, 0, 1, 1);
    const d = ctx.getImageData(0, 0, 1, 1).data;
    const exact = d[0] === 255 && d[1] === 0 && d[2] === 255 && d[3] === 255;
    return !exact;
}
function isBraveBrowser() {
    var _a, _b;
    if (typeof navigator === 'undefined') {
        return false;
    }
    return (_b = (_a = navigator.brave) === null || _a === void 0 ? void 0 : _a.isBrave()) !== null && _b !== void 0 ? _b : false;
}
let warned = false;
function checkHitCanvasSupport() {
    if (isBraveBrowser() && isCanvasFarblingActive() && !warned) {
        warned = true;
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.');
    }
    return isBraveBrowser() && isCanvasFarblingActive();
}
class HitCanvas extends Canvas {
    constructor(config = { width: 0, height: 0 }) {
        super(config);
        this.hitCanvas = true;
        this.context = new _Context_js__WEBPACK_IMPORTED_MODULE_1__.HitContext(this);
        this.setSize(config.width, config.height);
        checkHitCanvasSupport();
    }
}


/***/ }),

/***/ "./node_modules/konva/lib/Container.js":
/*!*********************************************!*\
  !*** ./node_modules/konva/lib/Container.js ***!
  \*********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Container": function() { return /* binding */ Container; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Validators.js */ "./node_modules/konva/lib/Validators.js");



class Container extends _Node_js__WEBPACK_IMPORTED_MODULE_1__.Node {
    constructor() {
        super(...arguments);
        this.children = [];
    }
    getChildren(filterFunc) {
        const children = this.children || [];
        if (filterFunc) {
            return children.filter(filterFunc);
        }
        return children;
    }
    hasChildren() {
        return this.getChildren().length > 0;
    }
    removeChildren() {
        this.getChildren().forEach((child) => {
            child.parent = null;
            child.index = 0;
            child.remove();
        });
        this.children = [];
        this._requestDraw();
        return this;
    }
    destroyChildren() {
        this.getChildren().forEach((child) => {
            child.parent = null;
            child.index = 0;
            child.destroy();
        });
        this.children = [];
        this._requestDraw();
        return this;
    }
    add(...children) {
        if (children.length === 0) {
            return this;
        }
        if (children.length > 1) {
            for (let i = 0; i < children.length; i++) {
                this.add(children[i]);
            }
            return this;
        }
        const child = children[0];
        if (child.getParent()) {
            child.moveTo(this);
            return this;
        }
        this._validateAdd(child);
        child.index = this.getChildren().length;
        child.parent = this;
        child._clearCaches();
        this.getChildren().push(child);
        this._fire('add', {
            child: child,
        });
        this._requestDraw();
        return this;
    }
    destroy() {
        if (this.hasChildren()) {
            this.destroyChildren();
        }
        super.destroy();
        return this;
    }
    find(selector) {
        return this._generalFind(selector, false);
    }
    findOne(selector) {
        const result = this._generalFind(selector, true);
        return result.length > 0 ? result[0] : undefined;
    }
    _generalFind(selector, findOne) {
        const retArr = [];
        this._descendants((node) => {
            const valid = node._isMatch(selector);
            if (valid) {
                retArr.push(node);
            }
            if (valid && findOne) {
                return true;
            }
            return false;
        });
        return retArr;
    }
    _descendants(fn) {
        let shouldStop = false;
        const children = this.getChildren();
        for (const child of children) {
            shouldStop = fn(child);
            if (shouldStop) {
                return true;
            }
            if (!child.hasChildren()) {
                continue;
            }
            shouldStop = child._descendants(fn);
            if (shouldStop) {
                return true;
            }
        }
        return false;
    }
    toObject() {
        const obj = _Node_js__WEBPACK_IMPORTED_MODULE_1__.Node.prototype.toObject.call(this);
        obj.children = [];
        this.getChildren().forEach((child) => {
            obj.children.push(child.toObject());
        });
        return obj;
    }
    isAncestorOf(node) {
        let parent = node.getParent();
        while (parent) {
            if (parent._id === this._id) {
                return true;
            }
            parent = parent.getParent();
        }
        return false;
    }
    clone(obj) {
        const node = _Node_js__WEBPACK_IMPORTED_MODULE_1__.Node.prototype.clone.call(this, obj);
        this.getChildren().forEach(function (no) {
            node.add(no.clone());
        });
        return node;
    }
    getAllIntersections(pos) {
        const arr = [];
        this.find('Shape').forEach((shape) => {
            if (shape.isVisible() && shape.intersects(pos)) {
                arr.push(shape);
            }
        });
        return arr;
    }
    _clearSelfAndDescendantCache(attr) {
        var _a;
        super._clearSelfAndDescendantCache(attr);
        if (this.isCached()) {
            return;
        }
        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (node) {
            node._clearSelfAndDescendantCache(attr);
        });
    }
    _setChildrenIndices() {
        var _a;
        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child, n) {
            child.index = n;
        });
        this._requestDraw();
    }
    drawScene(can, top, bufferCanvas) {
        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas()), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedSceneCanvas = cachedCanvas && cachedCanvas.scene;
        const caching = canvas && canvas.isCache;
        if (!this.isVisible() && !caching) {
            return this;
        }
        if (cachedSceneCanvas) {
            context.save();
            const m = this.getAbsoluteTransform(top).getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
            this._drawCachedSceneCanvas(context);
            context.restore();
        }
        else {
            this._drawChildren('drawScene', canvas, top, bufferCanvas);
        }
        return this;
    }
    drawHit(can, top) {
        if (!this.shouldDrawHit(top)) {
            return this;
        }
        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;
        if (cachedHitCanvas) {
            context.save();
            const m = this.getAbsoluteTransform(top).getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
            this._drawCachedHitCanvas(context);
            context.restore();
        }
        else {
            this._drawChildren('drawHit', canvas, top);
        }
        return this;
    }
    _drawChildren(drawMethod, canvas, top, bufferCanvas) {
        var _a;
        const context = canvas && canvas.getContext(), clipWidth = this.clipWidth(), clipHeight = this.clipHeight(), clipFunc = this.clipFunc(), hasClip = (typeof clipWidth === 'number' && typeof clipHeight === 'number') ||
            clipFunc;
        const selfCache = top === this;
        if (hasClip) {
            context.save();
            const transform = this.getAbsoluteTransform(top);
            let m = transform.getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
            context.beginPath();
            let clipArgs;
            if (clipFunc) {
                clipArgs = clipFunc.call(this, context, this);
            }
            else {
                const clipX = this.clipX();
                const clipY = this.clipY();
                context.rect(clipX || 0, clipY || 0, clipWidth, clipHeight);
            }
            context.clip.apply(context, clipArgs);
            m = transform.copy().invert().getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
        }
        const hasComposition = !selfCache &&
            this.globalCompositeOperation() !== 'source-over' &&
            drawMethod === 'drawScene';
        if (hasComposition) {
            context.save();
            context._applyGlobalCompositeOperation(this);
        }
        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {
            child[drawMethod](canvas, top, bufferCanvas);
        });
        if (hasComposition) {
            context.restore();
        }
        if (hasClip) {
            context.restore();
        }
    }
    getClientRect(config = {}) {
        var _a;
        const skipTransform = config.skipTransform;
        const relativeTo = config.relativeTo;
        let minX, minY, maxX, maxY;
        let selfRect = {
            x: Infinity,
            y: Infinity,
            width: 0,
            height: 0,
        };
        const that = this;
        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {
            if (!child.visible()) {
                return;
            }
            const rect = child.getClientRect({
                relativeTo: that,
                skipShadow: config.skipShadow,
                skipStroke: config.skipStroke,
            });
            if (rect.width === 0 && rect.height === 0) {
                return;
            }
            if (minX === undefined) {
                minX = rect.x;
                minY = rect.y;
                maxX = rect.x + rect.width;
                maxY = rect.y + rect.height;
            }
            else {
                minX = Math.min(minX, rect.x);
                minY = Math.min(minY, rect.y);
                maxX = Math.max(maxX, rect.x + rect.width);
                maxY = Math.max(maxY, rect.y + rect.height);
            }
        });
        const shapes = this.find('Shape');
        let hasVisible = false;
        for (let i = 0; i < shapes.length; i++) {
            const shape = shapes[i];
            if (shape._isVisible(this)) {
                hasVisible = true;
                break;
            }
        }
        if (hasVisible && minX !== undefined) {
            selfRect = {
                x: minX,
                y: minY,
                width: maxX - minX,
                height: maxY - minY,
            };
        }
        else {
            selfRect = {
                x: 0,
                y: 0,
                width: 0,
                height: 0,
            };
        }
        if (!skipTransform) {
            return this._transformedRect(selfRect, relativeTo);
        }
        return selfRect;
    }
}
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addComponentsGetterSetter(Container, 'clip', [
    'x',
    'y',
    'width',
    'height',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Container, 'clipX', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Container, 'clipY', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Container, 'clipWidth', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Container, 'clipHeight', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Container, 'clipFunc');


/***/ }),

/***/ "./node_modules/konva/lib/Context.js":
/*!*******************************************!*\
  !*** ./node_modules/konva/lib/Context.js ***!
  \*******************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Context": function() { return /* binding */ Context; },
/* harmony export */   "HitContext": function() { return /* binding */ HitContext; },
/* harmony export */   "SceneContext": function() { return /* binding */ SceneContext; },
/* harmony export */   "isCSSFiltersSupported": function() { return /* binding */ isCSSFiltersSupported; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");


function simplifyArray(arr) {
    const retArr = [], len = arr.length, util = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util;
    for (let n = 0; n < len; n++) {
        let val = arr[n];
        if (util._isNumber(val)) {
            val = Math.round(val * 1000) / 1000;
        }
        else if (!util._isString(val)) {
            val = val + '';
        }
        retArr.push(val);
    }
    return retArr;
}
const COMMA = ',', OPEN_PAREN = '(', CLOSE_PAREN = ')', OPEN_PAREN_BRACKET = '([', CLOSE_BRACKET_PAREN = '])', SEMICOLON = ';', DOUBLE_PAREN = '()', EQUALS = '=', CONTEXT_METHODS = [
    'arc',
    'arcTo',
    'beginPath',
    'bezierCurveTo',
    'clearRect',
    'clip',
    'closePath',
    'createLinearGradient',
    'createPattern',
    'createRadialGradient',
    'drawImage',
    'ellipse',
    'fill',
    'fillText',
    'getImageData',
    'createImageData',
    'lineTo',
    'moveTo',
    'putImageData',
    'quadraticCurveTo',
    'rect',
    'roundRect',
    'restore',
    'rotate',
    'save',
    'scale',
    'setLineDash',
    'setTransform',
    'stroke',
    'strokeText',
    'transform',
    'translate',
];
const CONTEXT_PROPERTIES = [
    'fillStyle',
    'strokeStyle',
    'shadowColor',
    'shadowBlur',
    'shadowOffsetX',
    'shadowOffsetY',
    'letterSpacing',
    'lineCap',
    'lineDashOffset',
    'lineJoin',
    'lineWidth',
    'miterLimit',
    'direction',
    'font',
    'textAlign',
    'textBaseline',
    'globalAlpha',
    'globalCompositeOperation',
    'imageSmoothingEnabled',
    'filter',
];
const traceArrMax = 100;
let _cssFiltersSupported = null;
function isCSSFiltersSupported() {
    if (_cssFiltersSupported !== null) {
        return _cssFiltersSupported;
    }
    try {
        const canvas = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement();
        const ctx = canvas.getContext('2d');
        if (!ctx) {
            _cssFiltersSupported = false;
            return false;
        }
        return !!ctx && 'filter' in ctx;
    }
    catch (e) {
        _cssFiltersSupported = false;
        return false;
    }
}
class Context {
    constructor(canvas) {
        this.canvas = canvas;
        if (_Global_js__WEBPACK_IMPORTED_MODULE_1__.Konva.enableTrace) {
            this.traceArr = [];
            this._enableTrace();
        }
    }
    fillShape(shape) {
        if (shape.fillEnabled()) {
            this._fill(shape);
        }
    }
    _fill(shape) {
    }
    strokeShape(shape) {
        if (shape.hasStroke()) {
            this._stroke(shape);
        }
    }
    _stroke(shape) {
    }
    fillStrokeShape(shape) {
        if (shape.attrs.fillAfterStrokeEnabled) {
            this.strokeShape(shape);
            this.fillShape(shape);
        }
        else {
            this.fillShape(shape);
            this.strokeShape(shape);
        }
    }
    getTrace(relaxed, rounded) {
        let traceArr = this.traceArr, len = traceArr.length, str = '', n, trace, method, args;
        for (n = 0; n < len; n++) {
            trace = traceArr[n];
            method = trace.method;
            if (method) {
                args = trace.args;
                str += method;
                if (relaxed) {
                    str += DOUBLE_PAREN;
                }
                else {
                    if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isArray(args[0])) {
                        str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;
                    }
                    else {
                        if (rounded) {
                            args = args.map((a) => typeof a === 'number' ? Math.floor(a) : a);
                        }
                        str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;
                    }
                }
            }
            else {
                str += trace.property;
                if (!relaxed) {
                    str += EQUALS + trace.val;
                }
            }
            str += SEMICOLON;
        }
        return str;
    }
    clearTrace() {
        this.traceArr = [];
    }
    _trace(str) {
        let traceArr = this.traceArr, len;
        traceArr.push(str);
        len = traceArr.length;
        if (len >= traceArrMax) {
            traceArr.shift();
        }
    }
    reset() {
        const pixelRatio = this.getCanvas().getPixelRatio();
        this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);
    }
    getCanvas() {
        return this.canvas;
    }
    clear(bounds) {
        const canvas = this.getCanvas();
        if (bounds) {
            this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);
        }
        else {
            this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);
        }
    }
    _applyLineCap(shape) {
        const lineCap = shape.attrs.lineCap;
        if (lineCap) {
            this.setAttr('lineCap', lineCap);
        }
    }
    _applyOpacity(shape) {
        const absOpacity = shape.getAbsoluteOpacity();
        if (absOpacity !== 1) {
            this.setAttr('globalAlpha', absOpacity);
        }
    }
    _applyLineJoin(shape) {
        const lineJoin = shape.attrs.lineJoin;
        if (lineJoin) {
            this.setAttr('lineJoin', lineJoin);
        }
    }
    _applyMiterLimit(shape) {
        const miterLimit = shape.attrs.miterLimit;
        if (miterLimit != null) {
            this.setAttr('miterLimit', miterLimit);
        }
    }
    setAttr(attr, val) {
        this._context[attr] = val;
    }
    arc(x, y, radius, startAngle, endAngle, counterClockwise) {
        this._context.arc(x, y, radius, startAngle, endAngle, counterClockwise);
    }
    arcTo(x1, y1, x2, y2, radius) {
        this._context.arcTo(x1, y1, x2, y2, radius);
    }
    beginPath() {
        this._context.beginPath();
    }
    bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {
        this._context.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);
    }
    clearRect(x, y, width, height) {
        this._context.clearRect(x, y, width, height);
    }
    clip(...args) {
        this._context.clip.apply(this._context, args);
    }
    closePath() {
        this._context.closePath();
    }
    createImageData(width, height) {
        const a = arguments;
        if (a.length === 2) {
            return this._context.createImageData(width, height);
        }
        else if (a.length === 1) {
            return this._context.createImageData(width);
        }
    }
    createLinearGradient(x0, y0, x1, y1) {
        return this._context.createLinearGradient(x0, y0, x1, y1);
    }
    createPattern(image, repetition) {
        return this._context.createPattern(image, repetition);
    }
    createRadialGradient(x0, y0, r0, x1, y1, r1) {
        return this._context.createRadialGradient(x0, y0, r0, x1, y1, r1);
    }
    drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight) {
        const a = arguments, _context = this._context;
        if (a.length === 3) {
            _context.drawImage(image, sx, sy);
        }
        else if (a.length === 5) {
            _context.drawImage(image, sx, sy, sWidth, sHeight);
        }
        else if (a.length === 9) {
            _context.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);
        }
    }
    ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise) {
        this._context.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise);
    }
    isPointInPath(x, y, path, fillRule) {
        if (path) {
            return this._context.isPointInPath(path, x, y, fillRule);
        }
        return this._context.isPointInPath(x, y, fillRule);
    }
    fill(...args) {
        this._context.fill.apply(this._context, args);
    }
    fillRect(x, y, width, height) {
        this._context.fillRect(x, y, width, height);
    }
    strokeRect(x, y, width, height) {
        this._context.strokeRect(x, y, width, height);
    }
    fillText(text, x, y, maxWidth) {
        if (maxWidth) {
            this._context.fillText(text, x, y, maxWidth);
        }
        else {
            this._context.fillText(text, x, y);
        }
    }
    measureText(text) {
        return this._context.measureText(text);
    }
    getImageData(sx, sy, sw, sh) {
        return this._context.getImageData(sx, sy, sw, sh);
    }
    lineTo(x, y) {
        this._context.lineTo(x, y);
    }
    moveTo(x, y) {
        this._context.moveTo(x, y);
    }
    rect(x, y, width, height) {
        this._context.rect(x, y, width, height);
    }
    roundRect(x, y, width, height, radii) {
        this._context.roundRect(x, y, width, height, radii);
    }
    putImageData(imageData, dx, dy) {
        this._context.putImageData(imageData, dx, dy);
    }
    quadraticCurveTo(cpx, cpy, x, y) {
        this._context.quadraticCurveTo(cpx, cpy, x, y);
    }
    restore() {
        this._context.restore();
    }
    rotate(angle) {
        this._context.rotate(angle);
    }
    save() {
        this._context.save();
    }
    scale(x, y) {
        this._context.scale(x, y);
    }
    setLineDash(segments) {
        if (this._context.setLineDash) {
            this._context.setLineDash(segments);
        }
        else if ('mozDash' in this._context) {
            this._context['mozDash'] = segments;
        }
        else if ('webkitLineDash' in this._context) {
            this._context['webkitLineDash'] = segments;
        }
    }
    getLineDash() {
        return this._context.getLineDash();
    }
    setTransform(a, b, c, d, e, f) {
        this._context.setTransform(a, b, c, d, e, f);
    }
    stroke(path2d) {
        if (path2d) {
            this._context.stroke(path2d);
        }
        else {
            this._context.stroke();
        }
    }
    strokeText(text, x, y, maxWidth) {
        this._context.strokeText(text, x, y, maxWidth);
    }
    transform(a, b, c, d, e, f) {
        this._context.transform(a, b, c, d, e, f);
    }
    translate(x, y) {
        this._context.translate(x, y);
    }
    _enableTrace() {
        let that = this, len = CONTEXT_METHODS.length, origSetter = this.setAttr, n, args;
        const func = function (methodName) {
            let origMethod = that[methodName], ret;
            that[methodName] = function () {
                args = simplifyArray(Array.prototype.slice.call(arguments, 0));
                ret = origMethod.apply(that, arguments);
                that._trace({
                    method: methodName,
                    args: args,
                });
                return ret;
            };
        };
        for (n = 0; n < len; n++) {
            func(CONTEXT_METHODS[n]);
        }
        that.setAttr = function () {
            origSetter.apply(that, arguments);
            const prop = arguments[0];
            let val = arguments[1];
            if (prop === 'shadowOffsetX' ||
                prop === 'shadowOffsetY' ||
                prop === 'shadowBlur') {
                val = val / this.canvas.getPixelRatio();
            }
            that._trace({
                property: prop,
                val: val,
            });
        };
    }
    _applyGlobalCompositeOperation(node) {
        const op = node.attrs.globalCompositeOperation;
        const def = !op || op === 'source-over';
        if (!def) {
            this.setAttr('globalCompositeOperation', op);
        }
    }
}
CONTEXT_PROPERTIES.forEach(function (prop) {
    Object.defineProperty(Context.prototype, prop, {
        get() {
            return this._context[prop];
        },
        set(val) {
            this._context[prop] = val;
        },
    });
});
class SceneContext extends Context {
    constructor(canvas, { willReadFrequently = false } = {}) {
        super(canvas);
        this._context = canvas._canvas.getContext('2d', {
            willReadFrequently,
        });
    }
    _fillColor(shape) {
        const fill = shape.fill();
        this.setAttr('fillStyle', fill);
        shape._fillFunc(this);
    }
    _fillPattern(shape) {
        this.setAttr('fillStyle', shape._getFillPattern());
        shape._fillFunc(this);
    }
    _fillLinearGradient(shape) {
        const grd = shape._getLinearGradient();
        if (grd) {
            this.setAttr('fillStyle', grd);
            shape._fillFunc(this);
        }
    }
    _fillRadialGradient(shape) {
        const grd = shape._getRadialGradient();
        if (grd) {
            this.setAttr('fillStyle', grd);
            shape._fillFunc(this);
        }
    }
    _fill(shape) {
        const hasColor = shape.fill(), fillPriority = shape.getFillPriority();
        if (hasColor && fillPriority === 'color') {
            this._fillColor(shape);
            return;
        }
        const hasPattern = shape.getFillPatternImage();
        if (hasPattern && fillPriority === 'pattern') {
            this._fillPattern(shape);
            return;
        }
        const hasLinearGradient = shape.getFillLinearGradientColorStops();
        if (hasLinearGradient && fillPriority === 'linear-gradient') {
            this._fillLinearGradient(shape);
            return;
        }
        const hasRadialGradient = shape.getFillRadialGradientColorStops();
        if (hasRadialGradient && fillPriority === 'radial-gradient') {
            this._fillRadialGradient(shape);
            return;
        }
        if (hasColor) {
            this._fillColor(shape);
        }
        else if (hasPattern) {
            this._fillPattern(shape);
        }
        else if (hasLinearGradient) {
            this._fillLinearGradient(shape);
        }
        else if (hasRadialGradient) {
            this._fillRadialGradient(shape);
        }
    }
    _strokeLinearGradient(shape) {
        const start = shape.getStrokeLinearGradientStartPoint(), end = shape.getStrokeLinearGradientEndPoint(), colorStops = shape.getStrokeLinearGradientColorStops(), grd = this.createLinearGradient(start.x, start.y, end.x, end.y);
        if (colorStops) {
            for (let n = 0; n < colorStops.length; n += 2) {
                grd.addColorStop(colorStops[n], colorStops[n + 1]);
            }
            this.setAttr('strokeStyle', grd);
        }
    }
    _stroke(shape) {
        const dash = shape.dash(), strokeScaleEnabled = shape.getStrokeScaleEnabled();
        if (shape.hasStroke()) {
            if (!strokeScaleEnabled) {
                this.save();
                const pixelRatio = this.getCanvas().getPixelRatio();
                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);
            }
            this._applyLineCap(shape);
            if (dash && shape.dashEnabled()) {
                this.setLineDash(dash);
                this.setAttr('lineDashOffset', shape.dashOffset());
            }
            this.setAttr('lineWidth', shape.strokeWidth());
            if (!shape.getShadowForStrokeEnabled()) {
                this.setAttr('shadowColor', 'rgba(0,0,0,0)');
            }
            const hasLinearGradient = shape.getStrokeLinearGradientColorStops();
            if (hasLinearGradient) {
                this._strokeLinearGradient(shape);
            }
            else {
                this.setAttr('strokeStyle', shape.stroke());
            }
            shape._strokeFunc(this);
            if (!strokeScaleEnabled) {
                this.restore();
            }
        }
    }
    _applyShadow(shape) {
        var _a, _b, _c;
        const color = (_a = shape.getShadowRGBA()) !== null && _a !== void 0 ? _a : 'black', blur = (_b = shape.getShadowBlur()) !== null && _b !== void 0 ? _b : 5, offset = (_c = shape.getShadowOffset()) !== null && _c !== void 0 ? _c : {
            x: 0,
            y: 0,
        }, scale = shape.getAbsoluteScale(), ratio = this.canvas.getPixelRatio(), scaleX = scale.x * ratio, scaleY = scale.y * ratio;
        this.setAttr('shadowColor', color);
        this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));
        this.setAttr('shadowOffsetX', offset.x * scaleX);
        this.setAttr('shadowOffsetY', offset.y * scaleY);
    }
}
class HitContext extends Context {
    constructor(canvas) {
        super(canvas);
        this._context = canvas._canvas.getContext('2d', {
            willReadFrequently: true,
        });
    }
    _fill(shape) {
        this.save();
        this.setAttr('fillStyle', shape.colorKey);
        shape._fillFuncHit(this);
        this.restore();
    }
    strokeShape(shape) {
        if (shape.hasHitStroke()) {
            this._stroke(shape);
        }
    }
    _stroke(shape) {
        if (shape.hasHitStroke()) {
            const strokeScaleEnabled = shape.getStrokeScaleEnabled();
            if (!strokeScaleEnabled) {
                this.save();
                const pixelRatio = this.getCanvas().getPixelRatio();
                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);
            }
            this._applyLineCap(shape);
            const hitStrokeWidth = shape.hitStrokeWidth();
            const strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;
            this.setAttr('lineWidth', strokeWidth);
            this.setAttr('strokeStyle', shape.colorKey);
            shape._strokeFuncHit(this);
            if (!strokeScaleEnabled) {
                this.restore();
            }
        }
    }
}


/***/ }),

/***/ "./node_modules/konva/lib/DragAndDrop.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/DragAndDrop.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DD": function() { return /* binding */ DD; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");


const DD = {
    get isDragging() {
        let flag = false;
        DD._dragElements.forEach((elem) => {
            if (elem.dragStatus === 'dragging') {
                flag = true;
            }
        });
        return flag;
    },
    justDragged: false,
    get node() {
        let node;
        DD._dragElements.forEach((elem) => {
            node = elem.node;
        });
        return node;
    },
    _dragElements: new Map(),
    _drag(evt) {
        const nodesToFireEvents = [];
        DD._dragElements.forEach((elem, key) => {
            const { node } = elem;
            const stage = node.getStage();
            stage.setPointersPositions(evt);
            if (elem.pointerId === undefined) {
                elem.pointerId = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._getFirstPointerId(evt);
            }
            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);
            if (!pos) {
                return;
            }
            if (elem.dragStatus !== 'dragging') {
                const dragDistance = node.dragDistance();
                const distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));
                if (distance < dragDistance) {
                    return;
                }
                node.startDrag({ evt });
                if (!node.isDragging()) {
                    return;
                }
            }
            node._setDragPosition(evt, elem);
            nodesToFireEvents.push(node);
        });
        nodesToFireEvents.forEach((node) => {
            node.fire('dragmove', {
                type: 'dragmove',
                target: node,
                evt: evt,
            }, true);
        });
    },
    _endDragBefore(evt) {
        const drawNodes = [];
        DD._dragElements.forEach((elem) => {
            const { node } = elem;
            const stage = node.getStage();
            if (evt) {
                stage.setPointersPositions(evt);
            }
            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);
            if (!pos) {
                return;
            }
            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {
                DD.justDragged = true;
                _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva._mouseListenClick = false;
                _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva._touchListenClick = false;
                _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva._pointerListenClick = false;
                elem.dragStatus = 'stopped';
            }
            const drawNode = elem.node.getLayer() ||
                (elem.node instanceof _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.Stage && elem.node);
            if (drawNode && drawNodes.indexOf(drawNode) === -1) {
                drawNodes.push(drawNode);
            }
        });
        drawNodes.forEach((drawNode) => {
            drawNode.draw();
        });
    },
    _endDragAfter(evt) {
        DD._dragElements.forEach((elem, key) => {
            if (elem.dragStatus === 'stopped') {
                elem.node.fire('dragend', {
                    type: 'dragend',
                    target: elem.node,
                    evt: evt,
                }, true);
            }
            if (elem.dragStatus !== 'dragging') {
                DD._dragElements.delete(key);
            }
        });
    },
};
if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isBrowser) {
    window.addEventListener('mouseup', DD._endDragBefore, true);
    window.addEventListener('touchend', DD._endDragBefore, true);
    window.addEventListener('touchcancel', DD._endDragBefore, true);
    window.addEventListener('mousemove', DD._drag);
    window.addEventListener('touchmove', DD._drag);
    window.addEventListener('mouseup', DD._endDragAfter, false);
    window.addEventListener('touchend', DD._endDragAfter, false);
    window.addEventListener('touchcancel', DD._endDragAfter, false);
}


/***/ }),

/***/ "./node_modules/konva/lib/Factory.js":
/*!*******************************************!*\
  !*** ./node_modules/konva/lib/Factory.js ***!
  \*******************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Factory": function() { return /* binding */ Factory; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Validators.js */ "./node_modules/konva/lib/Validators.js");


const GET = 'get';
const SET = 'set';
const Factory = {
    addGetterSetter(constructor, attr, def, validator, after) {
        Factory.addGetter(constructor, attr, def);
        Factory.addSetter(constructor, attr, validator, after);
        Factory.addOverloadedGetterSetter(constructor, attr);
    },
    addGetter(constructor, attr, def) {
        const method = GET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(attr);
        constructor.prototype[method] =
            constructor.prototype[method] ||
                function () {
                    const val = this.attrs[attr];
                    return val === undefined ? def : val;
                };
    },
    addSetter(constructor, attr, validator, after) {
        const method = SET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(attr);
        if (!constructor.prototype[method]) {
            Factory.overWriteSetter(constructor, attr, validator, after);
        }
    },
    overWriteSetter(constructor, attr, validator, after) {
        const method = SET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(attr);
        constructor.prototype[method] = function (val) {
            if (validator && val !== undefined && val !== null) {
                val = validator.call(this, val, attr);
            }
            this._setAttr(attr, val);
            if (after) {
                after.call(this);
            }
            return this;
        };
    },
    addComponentsGetterSetter(constructor, attr, components, validator, after) {
        const len = components.length, capitalize = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize, getter = GET + capitalize(attr), setter = SET + capitalize(attr);
        constructor.prototype[getter] = function () {
            const ret = {};
            for (let n = 0; n < len; n++) {
                const component = components[n];
                ret[component] = this.getAttr(attr + capitalize(component));
            }
            return ret;
        };
        const basicValidator = (0,_Validators_js__WEBPACK_IMPORTED_MODULE_1__.getComponentValidator)(components);
        constructor.prototype[setter] = function (val) {
            const oldVal = this.attrs[attr];
            if (validator) {
                val = validator.call(this, val, attr);
            }
            if (basicValidator) {
                basicValidator.call(this, val, attr);
            }
            for (const key in val) {
                if (!val.hasOwnProperty(key)) {
                    continue;
                }
                this._setAttr(attr + capitalize(key), val[key]);
            }
            if (!val) {
                components.forEach((component) => {
                    this._setAttr(attr + capitalize(component), undefined);
                });
            }
            this._fireChangeEvent(attr, oldVal, val);
            if (after) {
                after.call(this);
            }
            return this;
        };
        Factory.addOverloadedGetterSetter(constructor, attr);
    },
    addOverloadedGetterSetter(constructor, attr) {
        const capitalizedAttr = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(attr), setter = SET + capitalizedAttr, getter = GET + capitalizedAttr;
        constructor.prototype[attr] = function () {
            if (arguments.length) {
                this[setter](arguments[0]);
                return this;
            }
            return this[getter]();
        };
    },
    addDeprecatedGetterSetter(constructor, attr, def, validator) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Adding deprecated ' + attr);
        const method = GET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(attr);
        const message = attr +
            ' property is deprecated and will be removed soon. Look at Konva change log for more information.';
        constructor.prototype[method] = function () {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error(message);
            const val = this.attrs[attr];
            return val === undefined ? def : val;
        };
        Factory.addSetter(constructor, attr, validator, function () {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error(message);
        });
        Factory.addOverloadedGetterSetter(constructor, attr);
    },
    backCompat(constructor, methods) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.each(methods, function (oldMethodName, newMethodName) {
            const method = constructor.prototype[newMethodName];
            const oldGetter = GET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(oldMethodName);
            const oldSetter = SET + _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._capitalize(oldMethodName);
            function deprecated() {
                method.apply(this, arguments);
                _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('"' +
                    oldMethodName +
                    '" method is deprecated and will be removed soon. Use ""' +
                    newMethodName +
                    '" instead.');
            }
            constructor.prototype[oldMethodName] = deprecated;
            constructor.prototype[oldGetter] = deprecated;
            constructor.prototype[oldSetter] = deprecated;
        });
    },
    afterSetFilter() {
        this._filterUpToDate = false;
    },
};


/***/ }),

/***/ "./node_modules/konva/lib/FastLayer.js":
/*!*********************************************!*\
  !*** ./node_modules/konva/lib/FastLayer.js ***!
  \*********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FastLayer": function() { return /* binding */ FastLayer; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Layer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Layer.js */ "./node_modules/konva/lib/Layer.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");



class FastLayer extends _Layer_js__WEBPACK_IMPORTED_MODULE_1__.Layer {
    constructor(attrs) {
        super(attrs);
        this.listening(false);
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.');
    }
}
FastLayer.prototype.nodeType = 'FastLayer';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_2__._registerNode)(FastLayer);


/***/ }),

/***/ "./node_modules/konva/lib/Global.js":
/*!******************************************!*\
  !*** ./node_modules/konva/lib/Global.js ***!
  \******************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Konva": function() { return /* binding */ Konva; },
/* harmony export */   "_registerNode": function() { return /* binding */ _registerNode; },
/* harmony export */   "glob": function() { return /* binding */ glob; }
/* harmony export */ });
const PI_OVER_180 = Math.PI / 180;
function detectBrowser() {
    return (typeof window !== 'undefined' &&
        ({}.toString.call(window) === '[object Window]' ||
            {}.toString.call(window) === '[object global]'));
}
const glob = typeof global !== 'undefined'
    ? global
    : typeof window !== 'undefined'
        ? window
        : typeof WorkerGlobalScope !== 'undefined'
            ? self
            : {};
const Konva = {
    _global: glob,
    version: '10.0.2',
    isBrowser: detectBrowser(),
    isUnminified: /param/.test(function (param) { }.toString()),
    dblClickWindow: 400,
    getAngle(angle) {
        return Konva.angleDeg ? angle * PI_OVER_180 : angle;
    },
    enableTrace: false,
    pointerEventsEnabled: true,
    autoDrawEnabled: true,
    hitOnDragEnabled: false,
    capturePointerEventsEnabled: false,
    _mouseListenClick: false,
    _touchListenClick: false,
    _pointerListenClick: false,
    _mouseInDblClickWindow: false,
    _touchInDblClickWindow: false,
    _pointerInDblClickWindow: false,
    _mouseDblClickPointerId: null,
    _touchDblClickPointerId: null,
    _pointerDblClickPointerId: null,
    _renderBackend: 'web',
    legacyTextRendering: false,
    pixelRatio: (typeof window !== 'undefined' && window.devicePixelRatio) || 1,
    dragDistance: 3,
    angleDeg: true,
    showWarnings: true,
    dragButtons: [0, 1],
    isDragging() {
        return Konva['DD'].isDragging;
    },
    isTransforming() {
        var _a, _b;
        return (_b = (_a = Konva['Transformer']) === null || _a === void 0 ? void 0 : _a.isTransforming()) !== null && _b !== void 0 ? _b : false;
    },
    isDragReady() {
        return !!Konva['DD'].node;
    },
    releaseCanvasOnDestroy: true,
    document: glob.document,
    _injectGlobal(Konva) {
        if (typeof glob.Konva !== 'undefined') {
            console.error('Severa Konva instances detected. It is not recommended to use multiple Konva instances in the same environment.');
        }
        glob.Konva = Konva;
    },
};
const _registerNode = (NodeClass) => {
    Konva[NodeClass.prototype.getClassName()] = NodeClass;
};
Konva._injectGlobal(Konva);


/***/ }),

/***/ "./node_modules/konva/lib/Group.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/Group.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Group": function() { return /* binding */ Group; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Container.js */ "./node_modules/konva/lib/Container.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");



class Group extends _Container_js__WEBPACK_IMPORTED_MODULE_1__.Container {
    _validateAdd(child) {
        const type = child.getType();
        if (type !== 'Group' && type !== 'Shape') {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util["throw"]('You may only add groups and shapes to groups.');
        }
    }
}
Group.prototype.nodeType = 'Group';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_2__._registerNode)(Group);


/***/ }),

/***/ "./node_modules/konva/lib/Layer.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/Layer.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Layer": function() { return /* binding */ Layer; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Container.js */ "./node_modules/konva/lib/Container.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Canvas_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Canvas.js */ "./node_modules/konva/lib/Canvas.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");








const HASH = '#', BEFORE_DRAW = 'beforeDraw', DRAW = 'draw', INTERSECTION_OFFSETS = [
    { x: 0, y: 0 },
    { x: -1, y: -1 },
    { x: 1, y: -1 },
    { x: 1, y: 1 },
    { x: -1, y: 1 },
], INTERSECTION_OFFSETS_LEN = INTERSECTION_OFFSETS.length;
class Layer extends _Container_js__WEBPACK_IMPORTED_MODULE_1__.Container {
    constructor(config) {
        super(config);
        this.canvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_4__.SceneCanvas();
        this.hitCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_4__.HitCanvas({
            pixelRatio: 1,
        });
        this._waitingForDraw = false;
        this.on('visibleChange.konva', this._checkVisibility);
        this._checkVisibility();
        this.on('imageSmoothingEnabledChange.konva', this._setSmoothEnabled);
        this._setSmoothEnabled();
    }
    createPNGStream() {
        const c = this.canvas._canvas;
        return c.createPNGStream();
    }
    getCanvas() {
        return this.canvas;
    }
    getNativeCanvasElement() {
        return this.canvas._canvas;
    }
    getHitCanvas() {
        return this.hitCanvas;
    }
    getContext() {
        return this.getCanvas().getContext();
    }
    clear(bounds) {
        this.getContext().clear(bounds);
        this.getHitCanvas().getContext().clear(bounds);
        return this;
    }
    setZIndex(index) {
        super.setZIndex(index);
        const stage = this.getStage();
        if (stage && stage.content) {
            stage.content.removeChild(this.getNativeCanvasElement());
            if (index < stage.children.length - 1) {
                stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[index + 1].getCanvas()._canvas);
            }
            else {
                stage.content.appendChild(this.getNativeCanvasElement());
            }
        }
        return this;
    }
    moveToTop() {
        _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.moveToTop.call(this);
        const stage = this.getStage();
        if (stage && stage.content) {
            stage.content.removeChild(this.getNativeCanvasElement());
            stage.content.appendChild(this.getNativeCanvasElement());
        }
        return true;
    }
    moveUp() {
        const moved = _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.moveUp.call(this);
        if (!moved) {
            return false;
        }
        const stage = this.getStage();
        if (!stage || !stage.content) {
            return false;
        }
        stage.content.removeChild(this.getNativeCanvasElement());
        if (this.index < stage.children.length - 1) {
            stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[this.index + 1].getCanvas()._canvas);
        }
        else {
            stage.content.appendChild(this.getNativeCanvasElement());
        }
        return true;
    }
    moveDown() {
        if (_Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.moveDown.call(this)) {
            const stage = this.getStage();
            if (stage) {
                const children = stage.children;
                if (stage.content) {
                    stage.content.removeChild(this.getNativeCanvasElement());
                    stage.content.insertBefore(this.getNativeCanvasElement(), children[this.index + 1].getCanvas()._canvas);
                }
            }
            return true;
        }
        return false;
    }
    moveToBottom() {
        if (_Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.moveToBottom.call(this)) {
            const stage = this.getStage();
            if (stage) {
                const children = stage.children;
                if (stage.content) {
                    stage.content.removeChild(this.getNativeCanvasElement());
                    stage.content.insertBefore(this.getNativeCanvasElement(), children[1].getCanvas()._canvas);
                }
            }
            return true;
        }
        return false;
    }
    getLayer() {
        return this;
    }
    remove() {
        const _canvas = this.getNativeCanvasElement();
        _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.remove.call(this);
        if (_canvas && _canvas.parentNode && _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isInDocument(_canvas)) {
            _canvas.parentNode.removeChild(_canvas);
        }
        return this;
    }
    getStage() {
        return this.parent;
    }
    setSize({ width, height }) {
        this.canvas.setSize(width, height);
        this.hitCanvas.setSize(width, height);
        this._setSmoothEnabled();
        return this;
    }
    _validateAdd(child) {
        const type = child.getType();
        if (type !== 'Group' && type !== 'Shape') {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util["throw"]('You may only add groups and shapes to a layer.');
        }
    }
    _toKonvaCanvas(config) {
        config = { ...config };
        config.width = config.width || this.getWidth();
        config.height = config.height || this.getHeight();
        config.x = config.x !== undefined ? config.x : this.x();
        config.y = config.y !== undefined ? config.y : this.y();
        return _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype._toKonvaCanvas.call(this, config);
    }
    _checkVisibility() {
        const visible = this.visible();
        if (visible) {
            this.canvas._canvas.style.display = 'block';
        }
        else {
            this.canvas._canvas.style.display = 'none';
        }
    }
    _setSmoothEnabled() {
        this.getContext()._context.imageSmoothingEnabled =
            this.imageSmoothingEnabled();
    }
    getWidth() {
        if (this.parent) {
            return this.parent.width();
        }
    }
    setWidth() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.');
    }
    getHeight() {
        if (this.parent) {
            return this.parent.height();
        }
    }
    setHeight() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.');
    }
    batchDraw() {
        if (!this._waitingForDraw) {
            this._waitingForDraw = true;
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.requestAnimFrame(() => {
                this.draw();
                this._waitingForDraw = false;
            });
        }
        return this;
    }
    getIntersection(pos) {
        if (!this.isListening() || !this.isVisible()) {
            return null;
        }
        let spiralSearchDistance = 1;
        let continueSearch = false;
        while (true) {
            for (let i = 0; i < INTERSECTION_OFFSETS_LEN; i++) {
                const intersectionOffset = INTERSECTION_OFFSETS[i];
                const obj = this._getIntersection({
                    x: pos.x + intersectionOffset.x * spiralSearchDistance,
                    y: pos.y + intersectionOffset.y * spiralSearchDistance,
                });
                const shape = obj.shape;
                if (shape) {
                    return shape;
                }
                continueSearch = !!obj.antialiased;
                if (!obj.antialiased) {
                    break;
                }
            }
            if (continueSearch) {
                spiralSearchDistance += 1;
            }
            else {
                return null;
            }
        }
    }
    _getIntersection(pos) {
        const ratio = this.hitCanvas.pixelRatio;
        const p = this.hitCanvas.context.getImageData(Math.round(pos.x * ratio), Math.round(pos.y * ratio), 1, 1).data;
        const p3 = p[3];
        if (p3 === 255) {
            const colorKey = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._rgbToHex(p[0], p[1], p[2]);
            const shape = _Shape_js__WEBPACK_IMPORTED_MODULE_6__.shapes[HASH + colorKey];
            if (shape) {
                return {
                    shape: shape,
                };
            }
            return {
                antialiased: true,
            };
        }
        else if (p3 > 0) {
            return {
                antialiased: true,
            };
        }
        return {};
    }
    drawScene(can, top, bufferCanvas) {
        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas());
        this._fire(BEFORE_DRAW, {
            node: this,
        });
        if (this.clearBeforeDraw()) {
            canvas.getContext().clear();
        }
        _Container_js__WEBPACK_IMPORTED_MODULE_1__.Container.prototype.drawScene.call(this, canvas, top, bufferCanvas);
        this._fire(DRAW, {
            node: this,
        });
        return this;
    }
    drawHit(can, top) {
        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas);
        if (layer && layer.clearBeforeDraw()) {
            layer.getHitCanvas().getContext().clear();
        }
        _Container_js__WEBPACK_IMPORTED_MODULE_1__.Container.prototype.drawHit.call(this, canvas, top);
        return this;
    }
    enableHitGraph() {
        this.hitGraphEnabled(true);
        return this;
    }
    disableHitGraph() {
        this.hitGraphEnabled(false);
        return this;
    }
    setHitGraphEnabled(val) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');
        this.listening(val);
    }
    getHitGraphEnabled(val) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');
        return this.listening();
    }
    toggleHitCanvas() {
        if (!this.parent || !this.parent['content']) {
            return;
        }
        const parent = this.parent;
        const added = !!this.hitCanvas._canvas.parentNode;
        if (added) {
            parent.content.removeChild(this.hitCanvas._canvas);
        }
        else {
            parent.content.appendChild(this.hitCanvas._canvas);
        }
    }
    destroy() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.releaseCanvas(this.getNativeCanvasElement(), this.getHitCanvas()._canvas);
        return super.destroy();
    }
}
Layer.prototype.nodeType = 'Layer';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_7__._registerNode)(Layer);
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addGetterSetter(Layer, 'imageSmoothingEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addGetterSetter(Layer, 'clearBeforeDraw', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addGetterSetter(Layer, 'hitGraphEnabled', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_5__.getBooleanValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/Node.js":
/*!****************************************!*\
  !*** ./node_modules/konva/lib/Node.js ***!
  \****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Node": function() { return /* binding */ Node; }
/* harmony export */ });
/* harmony import */ var _Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas.js */ "./node_modules/konva/lib/Canvas.js");
/* harmony import */ var _Context_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Context.js */ "./node_modules/konva/lib/Context.js");
/* harmony import */ var _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DragAndDrop.js */ "./node_modules/konva/lib/DragAndDrop.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Validators.js */ "./node_modules/konva/lib/Validators.js");







function parseCSSFilters(cssFilter) {
    const filterRegex = /(\w+)\(([^)]+)\)/g;
    let match;
    while ((match = filterRegex.exec(cssFilter)) !== null) {
        const [, filterName, filterValue] = match;
        switch (filterName) {
            case 'blur': {
                const blurRadius = parseFloat(filterValue.replace('px', ''));
                return function (imageData) {
                    this.blurRadius(blurRadius * 0.5);
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Blur) {
                        KonvaFilters.Blur.call(this, imageData);
                    }
                };
            }
            case 'brightness': {
                const brightness = filterValue.includes('%')
                    ? parseFloat(filterValue) / 100
                    : parseFloat(filterValue);
                return function (imageData) {
                    this.brightness(brightness);
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Brightness) {
                        KonvaFilters.Brightness.call(this, imageData);
                    }
                };
            }
            case 'contrast': {
                const contrast = parseFloat(filterValue);
                return function (imageData) {
                    const konvaContrast = 100 * (Math.sqrt(contrast) - 1);
                    this.contrast(konvaContrast);
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Contrast) {
                        KonvaFilters.Contrast.call(this, imageData);
                    }
                };
            }
            case 'grayscale': {
                return function (imageData) {
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Grayscale) {
                        KonvaFilters.Grayscale.call(this, imageData);
                    }
                };
            }
            case 'sepia': {
                return function (imageData) {
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Sepia) {
                        KonvaFilters.Sepia.call(this, imageData);
                    }
                };
            }
            case 'invert': {
                return function (imageData) {
                    const KonvaFilters = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.Filters;
                    if (KonvaFilters && KonvaFilters.Invert) {
                        KonvaFilters.Invert.call(this, imageData);
                    }
                };
            }
            default:
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn(`CSS filter "${filterName}" is not supported in fallback mode. Consider using function filters for better compatibility.`);
                break;
        }
    }
    return () => { };
}
const ABSOLUTE_OPACITY = 'absoluteOpacity', ALL_LISTENERS = 'allEventListeners', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', POINTERENTER = 'pointerenter', POINTERLEAVE = 'pointerleave', TOUCHENTER = 'touchenter', TOUCHLEAVE = 'touchleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', TRANSFORM_CHANGE_STR = [
    'xChange.konva',
    'yChange.konva',
    'scaleXChange.konva',
    'scaleYChange.konva',
    'skewXChange.konva',
    'skewYChange.konva',
    'rotationChange.konva',
    'offsetXChange.konva',
    'offsetYChange.konva',
    'transformsEnabledChange.konva',
].join(SPACE);
let idCounter = 1;
class Node {
    constructor(config) {
        this._id = idCounter++;
        this.eventListeners = {};
        this.attrs = {};
        this.index = 0;
        this._allEventListeners = null;
        this.parent = null;
        this._cache = new Map();
        this._attachedDepsListeners = new Map();
        this._lastPos = null;
        this._batchingTransformChange = false;
        this._needClearTransformCache = false;
        this._filterUpToDate = false;
        this._isUnderCache = false;
        this._dragEventId = null;
        this._shouldFireChangeEvents = false;
        this.setAttrs(config);
        this._shouldFireChangeEvents = true;
    }
    hasChildren() {
        return false;
    }
    _clearCache(attr) {
        if ((attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM) &&
            this._cache.get(attr)) {
            this._cache.get(attr).dirty = true;
        }
        else if (attr) {
            this._cache.delete(attr);
        }
        else {
            this._cache.clear();
        }
    }
    _getCache(attr, privateGetter) {
        let cache = this._cache.get(attr);
        const isTransform = attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM;
        const invalid = cache === undefined || (isTransform && cache.dirty === true);
        if (invalid) {
            cache = privateGetter.call(this);
            this._cache.set(attr, cache);
        }
        return cache;
    }
    _calculate(name, deps, getter) {
        if (!this._attachedDepsListeners.get(name)) {
            const depsString = deps.map((dep) => dep + 'Change.konva').join(SPACE);
            this.on(depsString, () => {
                this._clearCache(name);
            });
            this._attachedDepsListeners.set(name, true);
        }
        return this._getCache(name, getter);
    }
    _getCanvasCache() {
        return this._cache.get(CANVAS);
    }
    _clearSelfAndDescendantCache(attr) {
        this._clearCache(attr);
        if (attr === ABSOLUTE_TRANSFORM) {
            this.fire('absoluteTransformChange');
        }
    }
    clearCache() {
        if (this._cache.has(CANVAS)) {
            const { scene, filter, hit, buffer } = this._cache.get(CANVAS);
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.releaseCanvas(scene, filter, hit, buffer);
            this._cache.delete(CANVAS);
        }
        this._clearSelfAndDescendantCache();
        this._requestDraw();
        return this;
    }
    cache(config) {
        const conf = config || {};
        let rect = {};
        if (conf.x === undefined ||
            conf.y === undefined ||
            conf.width === undefined ||
            conf.height === undefined) {
            rect = this.getClientRect({
                skipTransform: true,
                relativeTo: this.getParent() || undefined,
            });
        }
        let width = Math.ceil(conf.width || rect.width), height = Math.ceil(conf.height || rect.height), pixelRatio = conf.pixelRatio, x = conf.x === undefined ? Math.floor(rect.x) : conf.x, y = conf.y === undefined ? Math.floor(rect.y) : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false, hitCanvasPixelRatio = conf.hitCanvasPixelRatio || 1;
        if (!width || !height) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');
            return;
        }
        const extraPaddingX = Math.abs(Math.round(rect.x) - x) > 0.5 ? 1 : 0;
        const extraPaddingY = Math.abs(Math.round(rect.y) - y) > 0.5 ? 1 : 0;
        width += offset * 2 + extraPaddingX;
        height += offset * 2 + extraPaddingY;
        x -= offset;
        y -= offset;
        const cachedSceneCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.SceneCanvas({
            pixelRatio: pixelRatio,
            width: width,
            height: height,
        }), cachedFilterCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.SceneCanvas({
            pixelRatio: pixelRatio,
            width: 0,
            height: 0,
            willReadFrequently: true,
        }), cachedHitCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.HitCanvas({
            pixelRatio: hitCanvasPixelRatio,
            width: width,
            height: height,
        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();
        const bufferCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.SceneCanvas({
            width: cachedSceneCanvas.width / cachedSceneCanvas.pixelRatio + Math.abs(x),
            height: cachedSceneCanvas.height / cachedSceneCanvas.pixelRatio + Math.abs(y),
            pixelRatio: cachedSceneCanvas.pixelRatio,
        }), bufferContext = bufferCanvas.getContext();
        cachedHitCanvas.isCache = true;
        cachedSceneCanvas.isCache = true;
        this._cache.delete(CANVAS);
        this._filterUpToDate = false;
        if (conf.imageSmoothingEnabled === false) {
            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;
            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;
        }
        sceneContext.save();
        hitContext.save();
        bufferContext.save();
        sceneContext.translate(-x, -y);
        hitContext.translate(-x, -y);
        bufferContext.translate(-x, -y);
        bufferCanvas.x = x;
        bufferCanvas.y = y;
        this._isUnderCache = true;
        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);
        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);
        this.drawScene(cachedSceneCanvas, this, bufferCanvas);
        this.drawHit(cachedHitCanvas, this);
        this._isUnderCache = false;
        sceneContext.restore();
        hitContext.restore();
        if (drawBorder) {
            sceneContext.save();
            sceneContext.beginPath();
            sceneContext.rect(0, 0, width, height);
            sceneContext.closePath();
            sceneContext.setAttr('strokeStyle', 'red');
            sceneContext.setAttr('lineWidth', 5);
            sceneContext.stroke();
            sceneContext.restore();
        }
        this._cache.set(CANVAS, {
            scene: cachedSceneCanvas,
            filter: cachedFilterCanvas,
            hit: cachedHitCanvas,
            buffer: bufferCanvas,
            x: x,
            y: y,
        });
        this._requestDraw();
        return this;
    }
    isCached() {
        return this._cache.has(CANVAS);
    }
    getClientRect(config) {
        throw new Error('abstract "getClientRect" method call');
    }
    _transformedRect(rect, top) {
        const points = [
            { x: rect.x, y: rect.y },
            { x: rect.x + rect.width, y: rect.y },
            { x: rect.x + rect.width, y: rect.y + rect.height },
            { x: rect.x, y: rect.y + rect.height },
        ];
        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
        const trans = this.getAbsoluteTransform(top);
        points.forEach(function (point) {
            const transformed = trans.point(point);
            if (minX === undefined) {
                minX = maxX = transformed.x;
                minY = maxY = transformed.y;
            }
            minX = Math.min(minX, transformed.x);
            minY = Math.min(minY, transformed.y);
            maxX = Math.max(maxX, transformed.x);
            maxY = Math.max(maxY, transformed.y);
        });
        return {
            x: minX,
            y: minY,
            width: maxX - minX,
            height: maxY - minY,
        };
    }
    _drawCachedSceneCanvas(context) {
        context.save();
        context._applyOpacity(this);
        context._applyGlobalCompositeOperation(this);
        const canvasCache = this._getCanvasCache();
        context.translate(canvasCache.x, canvasCache.y);
        const cacheCanvas = this._getCachedSceneCanvas();
        const ratio = cacheCanvas.pixelRatio;
        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);
        context.restore();
    }
    _drawCachedHitCanvas(context) {
        const canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;
        context.save();
        context.translate(canvasCache.x, canvasCache.y);
        context.drawImage(hitCanvas._canvas, 0, 0, hitCanvas.width / hitCanvas.pixelRatio, hitCanvas.height / hitCanvas.pixelRatio);
        context.restore();
    }
    _getCachedSceneCanvas() {
        let filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;
        if (!filters || filters.length === 0) {
            return sceneCanvas;
        }
        if (this._filterUpToDate) {
            return filterCanvas;
        }
        let useNativeOnly = true;
        for (let i = 0; i < filters.length; i++) {
            const fallbackRequired = typeof filters[i] === 'string' && !(0,_Context_js__WEBPACK_IMPORTED_MODULE_1__.isCSSFiltersSupported)();
            if (fallbackRequired) {
            }
            if (typeof filters[i] !== 'string' || !(0,_Context_js__WEBPACK_IMPORTED_MODULE_1__.isCSSFiltersSupported)()) {
                useNativeOnly = false;
                break;
            }
        }
        const ratio = sceneCanvas.pixelRatio;
        filterCanvas.setSize(sceneCanvas.width / sceneCanvas.pixelRatio, sceneCanvas.height / sceneCanvas.pixelRatio);
        if (useNativeOnly) {
            const finalFilter = filters.join(' ');
            filterContext.save();
            filterContext.setAttr('filter', finalFilter);
            filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);
            filterContext.restore();
            this._filterUpToDate = true;
            return filterCanvas;
        }
        try {
            len = filters.length;
            filterContext.clear();
            filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);
            imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());
            for (n = 0; n < len; n++) {
                filter = filters[n];
                if (typeof filter === 'string') {
                    filter = parseCSSFilters(filter);
                }
                filter.call(this, imageData);
                filterContext.putImageData(imageData, 0, 0);
            }
        }
        catch (e) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.error('Unable to apply filter. ' +
                e.message +
                ' This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.');
        }
        this._filterUpToDate = true;
        return filterCanvas;
    }
    on(evtStr, handler) {
        if (this._cache) {
            this._cache.delete(ALL_LISTENERS);
        }
        if (arguments.length === 3) {
            return this._delegate.apply(this, arguments);
        }
        const events = evtStr.split(SPACE);
        for (let n = 0; n < events.length; n++) {
            const event = events[n];
            const parts = event.split('.');
            const baseEvent = parts[0];
            const name = parts[1] || '';
            if (!this.eventListeners[baseEvent]) {
                this.eventListeners[baseEvent] = [];
            }
            this.eventListeners[baseEvent].push({ name, handler });
        }
        return this;
    }
    off(evtStr, callback) {
        let events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;
        this._cache && this._cache.delete(ALL_LISTENERS);
        if (!evtStr) {
            for (t in this.eventListeners) {
                this._off(t);
            }
        }
        for (n = 0; n < len; n++) {
            event = events[n];
            parts = event.split('.');
            baseEvent = parts[0];
            name = parts[1];
            if (baseEvent) {
                if (this.eventListeners[baseEvent]) {
                    this._off(baseEvent, name, callback);
                }
            }
            else {
                for (t in this.eventListeners) {
                    this._off(t, name, callback);
                }
            }
        }
        return this;
    }
    dispatchEvent(evt) {
        const e = {
            target: this,
            type: evt.type,
            evt: evt,
        };
        this.fire(evt.type, e);
        return this;
    }
    addEventListener(type, handler) {
        this.on(type, function (evt) {
            handler.call(this, evt.evt);
        });
        return this;
    }
    removeEventListener(type) {
        this.off(type);
        return this;
    }
    _delegate(event, selector, handler) {
        const stopNode = this;
        this.on(event, function (evt) {
            const targets = evt.target.findAncestors(selector, true, stopNode);
            for (let i = 0; i < targets.length; i++) {
                evt = _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.cloneObject(evt);
                evt.currentTarget = targets[i];
                handler.call(targets[i], evt);
            }
        });
    }
    remove() {
        if (this.isDragging()) {
            this.stopDrag();
        }
        _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements["delete"](this._id);
        this._remove();
        return this;
    }
    _clearCaches() {
        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);
        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);
        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);
        this._clearSelfAndDescendantCache(STAGE);
        this._clearSelfAndDescendantCache(VISIBLE);
        this._clearSelfAndDescendantCache(LISTENING);
    }
    _remove() {
        this._clearCaches();
        const parent = this.getParent();
        if (parent && parent.children) {
            parent.children.splice(this.index, 1);
            parent._setChildrenIndices();
            this.parent = null;
        }
    }
    destroy() {
        this.remove();
        this.clearCache();
        return this;
    }
    getAttr(attr) {
        const method = 'get' + _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._capitalize(attr);
        if (_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isFunction(this[method])) {
            return this[method]();
        }
        return this.attrs[attr];
    }
    getAncestors() {
        let parent = this.getParent(), ancestors = [];
        while (parent) {
            ancestors.push(parent);
            parent = parent.getParent();
        }
        return ancestors;
    }
    getAttrs() {
        return (this.attrs || {});
    }
    setAttrs(config) {
        this._batchTransformChanges(() => {
            let key, method;
            if (!config) {
                return this;
            }
            for (key in config) {
                if (key === CHILDREN) {
                    continue;
                }
                method = SET + _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._capitalize(key);
                if (_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isFunction(this[method])) {
                    this[method](config[key]);
                }
                else {
                    this._setAttr(key, config[key]);
                }
            }
        });
        return this;
    }
    isListening() {
        return this._getCache(LISTENING, this._isListening);
    }
    _isListening(relativeTo) {
        const listening = this.listening();
        if (!listening) {
            return false;
        }
        const parent = this.getParent();
        if (parent && parent !== relativeTo && this !== relativeTo) {
            return parent._isListening(relativeTo);
        }
        else {
            return true;
        }
    }
    isVisible() {
        return this._getCache(VISIBLE, this._isVisible);
    }
    _isVisible(relativeTo) {
        const visible = this.visible();
        if (!visible) {
            return false;
        }
        const parent = this.getParent();
        if (parent && parent !== relativeTo && this !== relativeTo) {
            return parent._isVisible(relativeTo);
        }
        else {
            return true;
        }
    }
    shouldDrawHit(top, skipDragCheck = false) {
        if (top) {
            return this._isVisible(top) && this._isListening(top);
        }
        const layer = this.getLayer();
        let layerUnderDrag = false;
        _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.forEach((elem) => {
            if (elem.dragStatus !== 'dragging') {
                return;
            }
            else if (elem.node.nodeType === 'Stage') {
                layerUnderDrag = true;
            }
            else if (elem.node.getLayer() === layer) {
                layerUnderDrag = true;
            }
        });
        const dragSkip = !skipDragCheck &&
            !_Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.hitOnDragEnabled &&
            (layerUnderDrag || _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.isTransforming());
        return this.isListening() && this.isVisible() && !dragSkip;
    }
    show() {
        this.visible(true);
        return this;
    }
    hide() {
        this.visible(false);
        return this;
    }
    getZIndex() {
        return this.index || 0;
    }
    getAbsoluteZIndex() {
        let depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;
        function addChildren(children) {
            nodes = [];
            len = children.length;
            for (n = 0; n < len; n++) {
                child = children[n];
                index++;
                if (child.nodeType !== SHAPE) {
                    nodes = nodes.concat(child.getChildren().slice());
                }
                if (child._id === that._id) {
                    n = len;
                }
            }
            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {
                addChildren(nodes);
            }
        }
        const stage = this.getStage();
        if (that.nodeType !== UPPER_STAGE && stage) {
            addChildren(stage.getChildren());
        }
        return index;
    }
    getDepth() {
        let depth = 0, parent = this.parent;
        while (parent) {
            depth++;
            parent = parent.parent;
        }
        return depth;
    }
    _batchTransformChanges(func) {
        this._batchingTransformChange = true;
        func();
        this._batchingTransformChange = false;
        if (this._needClearTransformCache) {
            this._clearCache(TRANSFORM);
            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);
        }
        this._needClearTransformCache = false;
    }
    setPosition(pos) {
        this._batchTransformChanges(() => {
            this.x(pos.x);
            this.y(pos.y);
        });
        return this;
    }
    getPosition() {
        return {
            x: this.x(),
            y: this.y(),
        };
    }
    getRelativePointerPosition() {
        const stage = this.getStage();
        if (!stage) {
            return null;
        }
        const pos = stage.getPointerPosition();
        if (!pos) {
            return null;
        }
        const transform = this.getAbsoluteTransform().copy();
        transform.invert();
        return transform.point(pos);
    }
    getAbsolutePosition(top) {
        let haveCachedParent = false;
        let parent = this.parent;
        while (parent) {
            if (parent.isCached()) {
                haveCachedParent = true;
                break;
            }
            parent = parent.parent;
        }
        if (haveCachedParent && !top) {
            top = true;
        }
        const absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new _Util_js__WEBPACK_IMPORTED_MODULE_5__.Transform(), offset = this.offset();
        absoluteTransform.m = absoluteMatrix.slice();
        absoluteTransform.translate(offset.x, offset.y);
        return absoluteTransform.getTranslation();
    }
    setAbsolutePosition(pos) {
        const { x, y, ...origTrans } = this._clearTransform();
        this.attrs.x = x;
        this.attrs.y = y;
        this._clearCache(TRANSFORM);
        const it = this._getAbsoluteTransform().copy();
        it.invert();
        it.translate(pos.x, pos.y);
        pos = {
            x: this.attrs.x + it.getTranslation().x,
            y: this.attrs.y + it.getTranslation().y,
        };
        this._setTransform(origTrans);
        this.setPosition({ x: pos.x, y: pos.y });
        this._clearCache(TRANSFORM);
        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);
        return this;
    }
    _setTransform(trans) {
        let key;
        for (key in trans) {
            this.attrs[key] = trans[key];
        }
    }
    _clearTransform() {
        const trans = {
            x: this.x(),
            y: this.y(),
            rotation: this.rotation(),
            scaleX: this.scaleX(),
            scaleY: this.scaleY(),
            offsetX: this.offsetX(),
            offsetY: this.offsetY(),
            skewX: this.skewX(),
            skewY: this.skewY(),
        };
        this.attrs.x = 0;
        this.attrs.y = 0;
        this.attrs.rotation = 0;
        this.attrs.scaleX = 1;
        this.attrs.scaleY = 1;
        this.attrs.offsetX = 0;
        this.attrs.offsetY = 0;
        this.attrs.skewX = 0;
        this.attrs.skewY = 0;
        return trans;
    }
    move(change) {
        let changeX = change.x, changeY = change.y, x = this.x(), y = this.y();
        if (changeX !== undefined) {
            x += changeX;
        }
        if (changeY !== undefined) {
            y += changeY;
        }
        this.setPosition({ x: x, y: y });
        return this;
    }
    _eachAncestorReverse(func, top) {
        let family = [], parent = this.getParent(), len, n;
        if (top && top._id === this._id) {
            return;
        }
        family.unshift(this);
        while (parent && (!top || parent._id !== top._id)) {
            family.unshift(parent);
            parent = parent.parent;
        }
        len = family.length;
        for (n = 0; n < len; n++) {
            func(family[n]);
        }
    }
    rotate(theta) {
        this.rotation(this.rotation() + theta);
        return this;
    }
    moveToTop() {
        if (!this.parent) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Node has no parent. moveToTop function is ignored.');
            return false;
        }
        const index = this.index, len = this.parent.getChildren().length;
        if (index < len - 1) {
            this.parent.children.splice(index, 1);
            this.parent.children.push(this);
            this.parent._setChildrenIndices();
            return true;
        }
        return false;
    }
    moveUp() {
        if (!this.parent) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Node has no parent. moveUp function is ignored.');
            return false;
        }
        const index = this.index, len = this.parent.getChildren().length;
        if (index < len - 1) {
            this.parent.children.splice(index, 1);
            this.parent.children.splice(index + 1, 0, this);
            this.parent._setChildrenIndices();
            return true;
        }
        return false;
    }
    moveDown() {
        if (!this.parent) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Node has no parent. moveDown function is ignored.');
            return false;
        }
        const index = this.index;
        if (index > 0) {
            this.parent.children.splice(index, 1);
            this.parent.children.splice(index - 1, 0, this);
            this.parent._setChildrenIndices();
            return true;
        }
        return false;
    }
    moveToBottom() {
        if (!this.parent) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Node has no parent. moveToBottom function is ignored.');
            return false;
        }
        const index = this.index;
        if (index > 0) {
            this.parent.children.splice(index, 1);
            this.parent.children.unshift(this);
            this.parent._setChildrenIndices();
            return true;
        }
        return false;
    }
    setZIndex(zIndex) {
        if (!this.parent) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Node has no parent. zIndex parameter is ignored.');
            return this;
        }
        if (zIndex < 0 || zIndex >= this.parent.children.length) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Unexpected value ' +
                zIndex +
                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +
                (this.parent.children.length - 1) +
                '.');
        }
        const index = this.index;
        this.parent.children.splice(index, 1);
        this.parent.children.splice(zIndex, 0, this);
        this.parent._setChildrenIndices();
        return this;
    }
    getAbsoluteOpacity() {
        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);
    }
    _getAbsoluteOpacity() {
        let absOpacity = this.opacity();
        const parent = this.getParent();
        if (parent && !parent._isUnderCache) {
            absOpacity *= parent.getAbsoluteOpacity();
        }
        return absOpacity;
    }
    moveTo(newContainer) {
        if (this.getParent() !== newContainer) {
            this._remove();
            newContainer.add(this);
        }
        return this;
    }
    toObject() {
        let attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;
        const obj = {
            attrs: {},
            className: this.getClassName(),
        };
        for (key in attrs) {
            val = attrs[key];
            nonPlainObject =
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.isObject(val) && !_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isPlainObject(val) && !_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isArray(val);
            if (nonPlainObject) {
                continue;
            }
            getter = typeof this[key] === 'function' && this[key];
            delete attrs[key];
            defaultValue = getter ? getter.call(this) : null;
            attrs[key] = val;
            if (defaultValue !== val) {
                obj.attrs[key] = val;
            }
        }
        return _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._prepareToStringify(obj);
    }
    toJSON() {
        return JSON.stringify(this.toObject());
    }
    getParent() {
        return this.parent;
    }
    findAncestors(selector, includeSelf, stopNode) {
        const res = [];
        if (includeSelf && this._isMatch(selector)) {
            res.push(this);
        }
        let ancestor = this.parent;
        while (ancestor) {
            if (ancestor === stopNode) {
                return res;
            }
            if (ancestor._isMatch(selector)) {
                res.push(ancestor);
            }
            ancestor = ancestor.parent;
        }
        return res;
    }
    isAncestorOf(node) {
        return false;
    }
    findAncestor(selector, includeSelf, stopNode) {
        return this.findAncestors(selector, includeSelf, stopNode)[0];
    }
    _isMatch(selector) {
        if (!selector) {
            return false;
        }
        if (typeof selector === 'function') {
            return selector(this);
        }
        let selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;
        for (n = 0; n < len; n++) {
            sel = selectorArr[n];
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.isValidSelector(sel)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Selector "' +
                    sel +
                    '" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".');
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".');
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Konva is awesome, right?');
            }
            if (sel.charAt(0) === '#') {
                if (this.id() === sel.slice(1)) {
                    return true;
                }
            }
            else if (sel.charAt(0) === '.') {
                if (this.hasName(sel.slice(1))) {
                    return true;
                }
            }
            else if (this.className === sel || this.nodeType === sel) {
                return true;
            }
        }
        return false;
    }
    getLayer() {
        const parent = this.getParent();
        return parent ? parent.getLayer() : null;
    }
    getStage() {
        return this._getCache(STAGE, this._getStage);
    }
    _getStage() {
        const parent = this.getParent();
        if (parent) {
            return parent.getStage();
        }
        else {
            return null;
        }
    }
    fire(eventType, evt = {}, bubble) {
        evt.target = evt.target || this;
        if (bubble) {
            this._fireAndBubble(eventType, evt);
        }
        else {
            this._fire(eventType, evt);
        }
        return this;
    }
    getAbsoluteTransform(top) {
        if (top) {
            return this._getAbsoluteTransform(top);
        }
        else {
            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);
        }
    }
    _getAbsoluteTransform(top) {
        let at;
        if (top) {
            at = new _Util_js__WEBPACK_IMPORTED_MODULE_5__.Transform();
            this._eachAncestorReverse(function (node) {
                const transformsEnabled = node.transformsEnabled();
                if (transformsEnabled === 'all') {
                    at.multiply(node.getTransform());
                }
                else if (transformsEnabled === 'position') {
                    at.translate(node.x() - node.offsetX(), node.y() - node.offsetY());
                }
            }, top);
            return at;
        }
        else {
            at = this._cache.get(ABSOLUTE_TRANSFORM) || new _Util_js__WEBPACK_IMPORTED_MODULE_5__.Transform();
            if (this.parent) {
                this.parent.getAbsoluteTransform().copyInto(at);
            }
            else {
                at.reset();
            }
            const transformsEnabled = this.transformsEnabled();
            if (transformsEnabled === 'all') {
                at.multiply(this.getTransform());
            }
            else if (transformsEnabled === 'position') {
                const x = this.attrs.x || 0;
                const y = this.attrs.y || 0;
                const offsetX = this.attrs.offsetX || 0;
                const offsetY = this.attrs.offsetY || 0;
                at.translate(x - offsetX, y - offsetY);
            }
            at.dirty = false;
            return at;
        }
    }
    getAbsoluteScale(top) {
        let parent = this;
        while (parent) {
            if (parent._isUnderCache) {
                top = parent;
            }
            parent = parent.getParent();
        }
        const transform = this.getAbsoluteTransform(top);
        const attrs = transform.decompose();
        return {
            x: attrs.scaleX,
            y: attrs.scaleY,
        };
    }
    getAbsoluteRotation() {
        return this.getAbsoluteTransform().decompose().rotation;
    }
    getTransform() {
        return this._getCache(TRANSFORM, this._getTransform);
    }
    _getTransform() {
        var _a, _b;
        const m = this._cache.get(TRANSFORM) || new _Util_js__WEBPACK_IMPORTED_MODULE_5__.Transform();
        m.reset();
        const x = this.x(), y = this.y(), rotation = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.getAngle(this.rotation()), scaleX = (_a = this.attrs.scaleX) !== null && _a !== void 0 ? _a : 1, scaleY = (_b = this.attrs.scaleY) !== null && _b !== void 0 ? _b : 1, skewX = this.attrs.skewX || 0, skewY = this.attrs.skewY || 0, offsetX = this.attrs.offsetX || 0, offsetY = this.attrs.offsetY || 0;
        if (x !== 0 || y !== 0) {
            m.translate(x, y);
        }
        if (rotation !== 0) {
            m.rotate(rotation);
        }
        if (skewX !== 0 || skewY !== 0) {
            m.skew(skewX, skewY);
        }
        if (scaleX !== 1 || scaleY !== 1) {
            m.scale(scaleX, scaleY);
        }
        if (offsetX !== 0 || offsetY !== 0) {
            m.translate(-1 * offsetX, -1 * offsetY);
        }
        m.dirty = false;
        return m;
    }
    clone(obj) {
        let attrs = _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.cloneObject(this.attrs), key, allListeners, len, n, listener;
        for (key in obj) {
            attrs[key] = obj[key];
        }
        const node = new this.constructor(attrs);
        for (key in this.eventListeners) {
            allListeners = this.eventListeners[key];
            len = allListeners.length;
            for (n = 0; n < len; n++) {
                listener = allListeners[n];
                if (listener.name.indexOf(KONVA) < 0) {
                    if (!node.eventListeners[key]) {
                        node.eventListeners[key] = [];
                    }
                    node.eventListeners[key].push(listener);
                }
            }
        }
        return node;
    }
    _toKonvaCanvas(config) {
        config = config || {};
        const box = this.getClientRect();
        const stage = this.getStage(), x = config.x !== undefined ? config.x : Math.floor(box.x), y = config.y !== undefined ? config.y : Math.floor(box.y), pixelRatio = config.pixelRatio || 1, canvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.SceneCanvas({
            width: config.width || Math.ceil(box.width) || (stage ? stage.width() : 0),
            height: config.height ||
                Math.ceil(box.height) ||
                (stage ? stage.height() : 0),
            pixelRatio: pixelRatio,
        }), context = canvas.getContext();
        const bufferCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__.SceneCanvas({
            width: canvas.width / canvas.pixelRatio + Math.abs(x),
            height: canvas.height / canvas.pixelRatio + Math.abs(y),
            pixelRatio: canvas.pixelRatio,
        });
        if (config.imageSmoothingEnabled === false) {
            context._context.imageSmoothingEnabled = false;
        }
        context.save();
        if (x || y) {
            context.translate(-1 * x, -1 * y);
        }
        this.drawScene(canvas, undefined, bufferCanvas);
        context.restore();
        return canvas;
    }
    toCanvas(config) {
        return this._toKonvaCanvas(config)._canvas;
    }
    toDataURL(config) {
        config = config || {};
        const mimeType = config.mimeType || null, quality = config.quality || null;
        const url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);
        if (config.callback) {
            config.callback(url);
        }
        return url;
    }
    toImage(config) {
        return new Promise((resolve, reject) => {
            try {
                const callback = config === null || config === void 0 ? void 0 : config.callback;
                if (callback)
                    delete config.callback;
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._urlToImage(this.toDataURL(config), function (img) {
                    resolve(img);
                    callback === null || callback === void 0 ? void 0 : callback(img);
                });
            }
            catch (err) {
                reject(err);
            }
        });
    }
    toBlob(config) {
        return new Promise((resolve, reject) => {
            try {
                const callback = config === null || config === void 0 ? void 0 : config.callback;
                if (callback)
                    delete config.callback;
                this.toCanvas(config).toBlob((blob) => {
                    resolve(blob);
                    callback === null || callback === void 0 ? void 0 : callback(blob);
                }, config === null || config === void 0 ? void 0 : config.mimeType, config === null || config === void 0 ? void 0 : config.quality);
            }
            catch (err) {
                reject(err);
            }
        });
    }
    setSize(size) {
        this.width(size.width);
        this.height(size.height);
        return this;
    }
    getSize() {
        return {
            width: this.width(),
            height: this.height(),
        };
    }
    getClassName() {
        return this.className || this.nodeType;
    }
    getType() {
        return this.nodeType;
    }
    getDragDistance() {
        if (this.attrs.dragDistance !== undefined) {
            return this.attrs.dragDistance;
        }
        else if (this.parent) {
            return this.parent.getDragDistance();
        }
        else {
            return _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.dragDistance;
        }
    }
    _off(type, name, callback) {
        let evtListeners = this.eventListeners[type], i, evtName, handler;
        for (i = 0; i < evtListeners.length; i++) {
            evtName = evtListeners[i].name;
            handler = evtListeners[i].handler;
            if ((evtName !== 'konva' || name === 'konva') &&
                (!name || evtName === name) &&
                (!callback || callback === handler)) {
                evtListeners.splice(i, 1);
                if (evtListeners.length === 0) {
                    delete this.eventListeners[type];
                    break;
                }
                i--;
            }
        }
    }
    _fireChangeEvent(attr, oldVal, newVal) {
        this._fire(attr + CHANGE, {
            oldVal: oldVal,
            newVal: newVal,
        });
    }
    addName(name) {
        if (!this.hasName(name)) {
            const oldName = this.name();
            const newName = oldName ? oldName + ' ' + name : name;
            this.name(newName);
        }
        return this;
    }
    hasName(name) {
        if (!name) {
            return false;
        }
        const fullName = this.name();
        if (!fullName) {
            return false;
        }
        const names = (fullName || '').split(/\s/g);
        return names.indexOf(name) !== -1;
    }
    removeName(name) {
        const names = (this.name() || '').split(/\s/g);
        const index = names.indexOf(name);
        if (index !== -1) {
            names.splice(index, 1);
            this.name(names.join(' '));
        }
        return this;
    }
    setAttr(attr, val) {
        const func = this[SET + _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._capitalize(attr)];
        if (_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isFunction(func)) {
            func.call(this, val);
        }
        else {
            this._setAttr(attr, val);
        }
        return this;
    }
    _requestDraw() {
        if (_Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.autoDrawEnabled) {
            const drawNode = this.getLayer() || this.getStage();
            drawNode === null || drawNode === void 0 ? void 0 : drawNode.batchDraw();
        }
    }
    _setAttr(key, val) {
        const oldVal = this.attrs[key];
        if (oldVal === val && !_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.isObject(val)) {
            return;
        }
        if (val === undefined || val === null) {
            delete this.attrs[key];
        }
        else {
            this.attrs[key] = val;
        }
        if (this._shouldFireChangeEvents) {
            this._fireChangeEvent(key, oldVal, val);
        }
        this._requestDraw();
    }
    _setComponentAttr(key, component, val) {
        let oldVal;
        if (val !== undefined) {
            oldVal = this.attrs[key];
            if (!oldVal) {
                this.attrs[key] = this.getAttr(key);
            }
            this.attrs[key][component] = val;
            this._fireChangeEvent(key, oldVal, val);
        }
    }
    _fireAndBubble(eventType, evt, compareShape) {
        if (evt && this.nodeType === SHAPE) {
            evt.target = this;
        }
        const nonBubbling = [
            MOUSEENTER,
            MOUSELEAVE,
            POINTERENTER,
            POINTERLEAVE,
            TOUCHENTER,
            TOUCHLEAVE,
        ];
        const shouldStop = nonBubbling.indexOf(eventType) !== -1 &&
            ((compareShape &&
                (this === compareShape ||
                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||
                (this.nodeType === 'Stage' && !compareShape));
        if (!shouldStop) {
            this._fire(eventType, evt);
            const stopBubble = nonBubbling.indexOf(eventType) !== -1 &&
                compareShape &&
                compareShape.isAncestorOf &&
                compareShape.isAncestorOf(this) &&
                !compareShape.isAncestorOf(this.parent);
            if (((evt && !evt.cancelBubble) || !evt) &&
                this.parent &&
                this.parent.isListening() &&
                !stopBubble) {
                if (compareShape && compareShape.parent) {
                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape);
                }
                else {
                    this._fireAndBubble.call(this.parent, eventType, evt);
                }
            }
        }
    }
    _getProtoListeners(eventType) {
        var _a, _b, _c;
        const allListeners = (_a = this._cache.get(ALL_LISTENERS)) !== null && _a !== void 0 ? _a : {};
        let events = allListeners === null || allListeners === void 0 ? void 0 : allListeners[eventType];
        if (events === undefined) {
            events = [];
            let obj = Object.getPrototypeOf(this);
            while (obj) {
                const hierarchyEvents = (_c = (_b = obj.eventListeners) === null || _b === void 0 ? void 0 : _b[eventType]) !== null && _c !== void 0 ? _c : [];
                events.push(...hierarchyEvents);
                obj = Object.getPrototypeOf(obj);
            }
            allListeners[eventType] = events;
            this._cache.set(ALL_LISTENERS, allListeners);
        }
        return events;
    }
    _fire(eventType, evt) {
        evt = evt || {};
        evt.currentTarget = this;
        evt.type = eventType;
        const topListeners = this._getProtoListeners(eventType);
        if (topListeners) {
            for (let i = 0; i < topListeners.length; i++) {
                topListeners[i].handler.call(this, evt);
            }
        }
        const selfListeners = this.eventListeners[eventType];
        if (selfListeners) {
            for (let i = 0; i < selfListeners.length; i++) {
                selfListeners[i].handler.call(this, evt);
            }
        }
    }
    draw() {
        this.drawScene();
        this.drawHit();
        return this;
    }
    _createDragElement(evt) {
        const pointerId = evt ? evt.pointerId : undefined;
        const stage = this.getStage();
        const ap = this.getAbsolutePosition();
        if (!stage) {
            return;
        }
        const pos = stage._getPointerById(pointerId) ||
            stage._changedPointerPositions[0] ||
            ap;
        _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.set(this._id, {
            node: this,
            startPointerPos: pos,
            offset: {
                x: pos.x - ap.x,
                y: pos.y - ap.y,
            },
            dragStatus: 'ready',
            pointerId,
        });
    }
    startDrag(evt, bubbleEvent = true) {
        if (!_DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.has(this._id)) {
            this._createDragElement(evt);
        }
        const elem = _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.get(this._id);
        elem.dragStatus = 'dragging';
        this.fire('dragstart', {
            type: 'dragstart',
            target: this,
            evt: evt && evt.evt,
        }, bubbleEvent);
    }
    _setDragPosition(evt, elem) {
        const pos = this.getStage()._getPointerById(elem.pointerId);
        if (!pos) {
            return;
        }
        let newNodePos = {
            x: pos.x - elem.offset.x,
            y: pos.y - elem.offset.y,
        };
        const dbf = this.dragBoundFunc();
        if (dbf !== undefined) {
            const bounded = dbf.call(this, newNodePos, evt);
            if (!bounded) {
                _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.');
            }
            else {
                newNodePos = bounded;
            }
        }
        if (!this._lastPos ||
            this._lastPos.x !== newNodePos.x ||
            this._lastPos.y !== newNodePos.y) {
            this.setAbsolutePosition(newNodePos);
            this._requestDraw();
        }
        this._lastPos = newNodePos;
    }
    stopDrag(evt) {
        const elem = _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.get(this._id);
        if (elem) {
            elem.dragStatus = 'stopped';
        }
        _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._endDragBefore(evt);
        _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._endDragAfter(evt);
    }
    setDraggable(draggable) {
        this._setAttr('draggable', draggable);
        this._dragChange();
    }
    isDragging() {
        const elem = _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.get(this._id);
        return elem ? elem.dragStatus === 'dragging' : false;
    }
    _listenDrag() {
        this._dragCleanup();
        this.on('mousedown.konva touchstart.konva', function (evt) {
            const shouldCheckButton = evt.evt['button'] !== undefined;
            const canDrag = !shouldCheckButton || _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva.dragButtons.indexOf(evt.evt['button']) >= 0;
            if (!canDrag) {
                return;
            }
            if (this.isDragging()) {
                return;
            }
            let hasDraggingChild = false;
            _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.forEach((elem) => {
                if (this.isAncestorOf(elem.node)) {
                    hasDraggingChild = true;
                }
            });
            if (!hasDraggingChild) {
                this._createDragElement(evt);
            }
        });
    }
    _dragChange() {
        if (this.attrs.draggable) {
            this._listenDrag();
        }
        else {
            this._dragCleanup();
            const stage = this.getStage();
            if (!stage) {
                return;
            }
            const dragElement = _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements.get(this._id);
            const isDragging = dragElement && dragElement.dragStatus === 'dragging';
            const isReady = dragElement && dragElement.dragStatus === 'ready';
            if (isDragging) {
                this.stopDrag();
            }
            else if (isReady) {
                _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_2__.DD._dragElements["delete"](this._id);
            }
        }
    }
    _dragCleanup() {
        this.off('mousedown.konva');
        this.off('touchstart.konva');
    }
    isClientRectOnScreen(margin = { x: 0, y: 0 }) {
        const stage = this.getStage();
        if (!stage) {
            return false;
        }
        const screenRect = {
            x: -margin.x,
            y: -margin.y,
            width: stage.width() + 2 * margin.x,
            height: stage.height() + 2 * margin.y,
        };
        return _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.haveIntersection(screenRect, this.getClientRect());
    }
    static create(data, container) {
        if (_Util_js__WEBPACK_IMPORTED_MODULE_5__.Util._isString(data)) {
            data = JSON.parse(data);
        }
        return this._createNode(data, container);
    }
    static _createNode(obj, container) {
        let className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;
        if (container) {
            obj.attrs.container = container;
        }
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva[className]) {
            _Util_js__WEBPACK_IMPORTED_MODULE_5__.Util.warn('Can not find a node with class name "' +
                className +
                '". Fallback to "Shape".');
            className = 'Shape';
        }
        const Class = _Global_js__WEBPACK_IMPORTED_MODULE_4__.Konva[className];
        no = new Class(obj.attrs);
        if (children) {
            len = children.length;
            for (n = 0; n < len; n++) {
                no.add(Node._createNode(children[n]));
            }
        }
        return no;
    }
}
Node.prototype.nodeType = 'Node';
Node.prototype._attrsAffectingSize = [];
Node.prototype.eventListeners = {};
Node.prototype.on.call(Node.prototype, TRANSFORM_CHANGE_STR, function () {
    if (this._batchingTransformChange) {
        this._needClearTransformCache = true;
        return;
    }
    this._clearCache(TRANSFORM);
    this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);
});
Node.prototype.on.call(Node.prototype, 'visibleChange.konva', function () {
    this._clearSelfAndDescendantCache(VISIBLE);
});
Node.prototype.on.call(Node.prototype, 'listeningChange.konva', function () {
    this._clearSelfAndDescendantCache(LISTENING);
});
Node.prototype.on.call(Node.prototype, 'opacityChange.konva', function () {
    this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);
});
const addGetterSetter = _Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addGetterSetter;
addGetterSetter(Node, 'zIndex');
addGetterSetter(Node, 'absolutePosition');
addGetterSetter(Node, 'position');
addGetterSetter(Node, 'x', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'y', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'globalCompositeOperation', 'source-over', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getStringValidator)());
addGetterSetter(Node, 'opacity', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'name', '', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getStringValidator)());
addGetterSetter(Node, 'id', '', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getStringValidator)());
addGetterSetter(Node, 'rotation', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);
addGetterSetter(Node, 'scaleX', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'scaleY', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);
addGetterSetter(Node, 'skewX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'skewY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);
addGetterSetter(Node, 'offsetX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'offsetY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'dragDistance', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'width', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'height', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getNumberValidator)());
addGetterSetter(Node, 'listening', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getBooleanValidator)());
addGetterSetter(Node, 'preventDefault', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getBooleanValidator)());
addGetterSetter(Node, 'filters', undefined, function (val) {
    this._filterUpToDate = false;
    return val;
});
addGetterSetter(Node, 'visible', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getBooleanValidator)());
addGetterSetter(Node, 'transformsEnabled', 'all', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getStringValidator)());
addGetterSetter(Node, 'size');
addGetterSetter(Node, 'dragBoundFunc');
addGetterSetter(Node, 'draggable', false, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_6__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_3__.Factory.backCompat(Node, {
    rotateDeg: 'rotate',
    setRotationDeg: 'setRotation',
    getRotationDeg: 'getRotation',
});


/***/ }),

/***/ "./node_modules/konva/lib/PointerEvents.js":
/*!*************************************************!*\
  !*** ./node_modules/konva/lib/PointerEvents.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createEvent": function() { return /* binding */ createEvent; },
/* harmony export */   "getCapturedShape": function() { return /* binding */ getCapturedShape; },
/* harmony export */   "hasPointerCapture": function() { return /* binding */ hasPointerCapture; },
/* harmony export */   "releaseCapture": function() { return /* binding */ releaseCapture; },
/* harmony export */   "setPointerCapture": function() { return /* binding */ setPointerCapture; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");

const Captures = new Map();
const SUPPORT_POINTER_EVENTS = _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva._global.PointerEvent !== undefined;
function getCapturedShape(pointerId) {
    return Captures.get(pointerId);
}
function createEvent(evt) {
    return {
        evt,
        pointerId: evt.pointerId,
    };
}
function hasPointerCapture(pointerId, shape) {
    return Captures.get(pointerId) === shape;
}
function setPointerCapture(pointerId, shape) {
    releaseCapture(pointerId);
    const stage = shape.getStage();
    if (!stage)
        return;
    Captures.set(pointerId, shape);
    if (SUPPORT_POINTER_EVENTS) {
        shape._fire('gotpointercapture', createEvent(new PointerEvent('gotpointercapture')));
    }
}
function releaseCapture(pointerId, target) {
    const shape = Captures.get(pointerId);
    if (!shape)
        return;
    const stage = shape.getStage();
    if (stage && stage.content) {
    }
    Captures.delete(pointerId);
    if (SUPPORT_POINTER_EVENTS) {
        shape._fire('lostpointercapture', createEvent(new PointerEvent('lostpointercapture')));
    }
}


/***/ }),

/***/ "./node_modules/konva/lib/Shape.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/Shape.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Shape": function() { return /* binding */ Shape; },
/* harmony export */   "shapes": function() { return /* binding */ shapes; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _PointerEvents_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./PointerEvents.js */ "./node_modules/konva/lib/PointerEvents.js");







const HAS_SHADOW = 'hasShadow';
const SHADOW_RGBA = 'shadowRGBA';
const patternImage = 'patternImage';
const linearGradient = 'linearGradient';
const radialGradient = 'radialGradient';
let dummyContext;
function getDummyContext() {
    if (dummyContext) {
        return dummyContext;
    }
    dummyContext = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.createCanvasElement().getContext('2d');
    return dummyContext;
}
const shapes = {};
function _fillFunc(context) {
    const fillRule = this.attrs.fillRule;
    if (fillRule) {
        context.fill(fillRule);
    }
    else {
        context.fill();
    }
}
function _strokeFunc(context) {
    context.stroke();
}
function _fillFuncHit(context) {
    const fillRule = this.attrs.fillRule;
    if (fillRule) {
        context.fill(fillRule);
    }
    else {
        context.fill();
    }
}
function _strokeFuncHit(context) {
    context.stroke();
}
function _clearHasShadowCache() {
    this._clearCache(HAS_SHADOW);
}
function _clearGetShadowRGBACache() {
    this._clearCache(SHADOW_RGBA);
}
function _clearFillPatternCache() {
    this._clearCache(patternImage);
}
function _clearLinearGradientCache() {
    this._clearCache(linearGradient);
}
function _clearRadialGradientCache() {
    this._clearCache(radialGradient);
}
class Shape extends _Node_js__WEBPACK_IMPORTED_MODULE_3__.Node {
    constructor(config) {
        super(config);
        let key;
        while (true) {
            key = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.getRandomColor();
            if (key && !(key in shapes)) {
                break;
            }
        }
        this.colorKey = key;
        shapes[key] = this;
    }
    getContext() {
        _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn('shape.getContext() method is deprecated. Please do not use it.');
        return this.getLayer().getContext();
    }
    getCanvas() {
        _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn('shape.getCanvas() method is deprecated. Please do not use it.');
        return this.getLayer().getCanvas();
    }
    getSceneFunc() {
        return this.attrs.sceneFunc || this['_sceneFunc'];
    }
    getHitFunc() {
        return this.attrs.hitFunc || this['_hitFunc'];
    }
    hasShadow() {
        return this._getCache(HAS_SHADOW, this._hasShadow);
    }
    _hasShadow() {
        return (this.shadowEnabled() &&
            this.shadowOpacity() !== 0 &&
            !!(this.shadowColor() ||
                this.shadowBlur() ||
                this.shadowOffsetX() ||
                this.shadowOffsetY()));
    }
    _getFillPattern() {
        return this._getCache(patternImage, this.__getFillPattern);
    }
    __getFillPattern() {
        if (this.fillPatternImage()) {
            const ctx = getDummyContext();
            const pattern = ctx.createPattern(this.fillPatternImage(), this.fillPatternRepeat() || 'repeat');
            if (pattern && pattern.setTransform) {
                const tr = new _Util_js__WEBPACK_IMPORTED_MODULE_1__.Transform();
                tr.translate(this.fillPatternX(), this.fillPatternY());
                tr.rotate(_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.getAngle(this.fillPatternRotation()));
                tr.scale(this.fillPatternScaleX(), this.fillPatternScaleY());
                tr.translate(-1 * this.fillPatternOffsetX(), -1 * this.fillPatternOffsetY());
                const m = tr.getMatrix();
                const matrix = typeof DOMMatrix === 'undefined'
                    ? {
                        a: m[0],
                        b: m[1],
                        c: m[2],
                        d: m[3],
                        e: m[4],
                        f: m[5],
                    }
                    : new DOMMatrix(m);
                pattern.setTransform(matrix);
            }
            return pattern;
        }
    }
    _getLinearGradient() {
        return this._getCache(linearGradient, this.__getLinearGradient);
    }
    __getLinearGradient() {
        const colorStops = this.fillLinearGradientColorStops();
        if (colorStops) {
            const ctx = getDummyContext();
            const start = this.fillLinearGradientStartPoint();
            const end = this.fillLinearGradientEndPoint();
            const grd = ctx.createLinearGradient(start.x, start.y, end.x, end.y);
            for (let n = 0; n < colorStops.length; n += 2) {
                grd.addColorStop(colorStops[n], colorStops[n + 1]);
            }
            return grd;
        }
    }
    _getRadialGradient() {
        return this._getCache(radialGradient, this.__getRadialGradient);
    }
    __getRadialGradient() {
        const colorStops = this.fillRadialGradientColorStops();
        if (colorStops) {
            const ctx = getDummyContext();
            const start = this.fillRadialGradientStartPoint();
            const end = this.fillRadialGradientEndPoint();
            const grd = ctx.createRadialGradient(start.x, start.y, this.fillRadialGradientStartRadius(), end.x, end.y, this.fillRadialGradientEndRadius());
            for (let n = 0; n < colorStops.length; n += 2) {
                grd.addColorStop(colorStops[n], colorStops[n + 1]);
            }
            return grd;
        }
    }
    getShadowRGBA() {
        return this._getCache(SHADOW_RGBA, this._getShadowRGBA);
    }
    _getShadowRGBA() {
        if (!this.hasShadow()) {
            return;
        }
        const rgba = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.colorToRGBA(this.shadowColor());
        if (rgba) {
            return ('rgba(' +
                rgba.r +
                ',' +
                rgba.g +
                ',' +
                rgba.b +
                ',' +
                rgba.a * (this.shadowOpacity() || 1) +
                ')');
        }
    }
    hasFill() {
        return this._calculate('hasFill', [
            'fillEnabled',
            'fill',
            'fillPatternImage',
            'fillLinearGradientColorStops',
            'fillRadialGradientColorStops',
        ], () => {
            return (this.fillEnabled() &&
                !!(this.fill() ||
                    this.fillPatternImage() ||
                    this.fillLinearGradientColorStops() ||
                    this.fillRadialGradientColorStops()));
        });
    }
    hasStroke() {
        return this._calculate('hasStroke', [
            'strokeEnabled',
            'strokeWidth',
            'stroke',
            'strokeLinearGradientColorStops',
        ], () => {
            return (this.strokeEnabled() &&
                this.strokeWidth() &&
                !!(this.stroke() || this.strokeLinearGradientColorStops()));
        });
    }
    hasHitStroke() {
        const width = this.hitStrokeWidth();
        if (width === 'auto') {
            return this.hasStroke();
        }
        return this.strokeEnabled() && !!width;
    }
    intersects(point) {
        const stage = this.getStage();
        if (!stage) {
            return false;
        }
        const bufferHitCanvas = stage.bufferHitCanvas;
        bufferHitCanvas.getContext().clear();
        this.drawHit(bufferHitCanvas, undefined, true);
        const p = bufferHitCanvas.context.getImageData(Math.round(point.x), Math.round(point.y), 1, 1).data;
        return p[3] > 0;
    }
    destroy() {
        _Node_js__WEBPACK_IMPORTED_MODULE_3__.Node.prototype.destroy.call(this);
        delete shapes[this.colorKey];
        delete this.colorKey;
        return this;
    }
    _useBufferCanvas(forceFill) {
        var _a;
        const perfectDrawEnabled = (_a = this.attrs.perfectDrawEnabled) !== null && _a !== void 0 ? _a : true;
        if (!perfectDrawEnabled) {
            return false;
        }
        const hasFill = forceFill || this.hasFill();
        const hasStroke = this.hasStroke();
        const isTransparent = this.getAbsoluteOpacity() !== 1;
        if (hasFill && hasStroke && isTransparent) {
            return true;
        }
        const hasShadow = this.hasShadow();
        const strokeForShadow = this.shadowForStrokeEnabled();
        if (hasFill && hasStroke && hasShadow && strokeForShadow) {
            return true;
        }
        return false;
    }
    setStrokeHitEnabled(val) {
        _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn('strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead.');
        if (val) {
            this.hitStrokeWidth('auto');
        }
        else {
            this.hitStrokeWidth(0);
        }
    }
    getStrokeHitEnabled() {
        if (this.hitStrokeWidth() === 0) {
            return false;
        }
        else {
            return true;
        }
    }
    getSelfRect() {
        const size = this.size();
        return {
            x: this._centroid ? -size.width / 2 : 0,
            y: this._centroid ? -size.height / 2 : 0,
            width: size.width,
            height: size.height,
        };
    }
    getClientRect(config = {}) {
        let hasCachedParent = false;
        let parent = this.getParent();
        while (parent) {
            if (parent.isCached()) {
                hasCachedParent = true;
                break;
            }
            parent = parent.getParent();
        }
        const skipTransform = config.skipTransform;
        const relativeTo = config.relativeTo || (hasCachedParent && this.getStage()) || undefined;
        const fillRect = this.getSelfRect();
        const applyStroke = !config.skipStroke && this.hasStroke();
        const strokeWidth = (applyStroke && this.strokeWidth()) || 0;
        const fillAndStrokeWidth = fillRect.width + strokeWidth;
        const fillAndStrokeHeight = fillRect.height + strokeWidth;
        const applyShadow = !config.skipShadow && this.hasShadow();
        const shadowOffsetX = applyShadow ? this.shadowOffsetX() : 0;
        const shadowOffsetY = applyShadow ? this.shadowOffsetY() : 0;
        const preWidth = fillAndStrokeWidth + Math.abs(shadowOffsetX);
        const preHeight = fillAndStrokeHeight + Math.abs(shadowOffsetY);
        const blurRadius = (applyShadow && this.shadowBlur()) || 0;
        const width = preWidth + blurRadius * 2;
        const height = preHeight + blurRadius * 2;
        const rect = {
            width: width,
            height: height,
            x: -(strokeWidth / 2 + blurRadius) +
                Math.min(shadowOffsetX, 0) +
                fillRect.x,
            y: -(strokeWidth / 2 + blurRadius) +
                Math.min(shadowOffsetY, 0) +
                fillRect.y,
        };
        if (!skipTransform) {
            return this._transformedRect(rect, relativeTo);
        }
        return rect;
    }
    drawScene(can, top, bufferCanvas) {
        const layer = this.getLayer();
        const canvas = can || layer.getCanvas(), context = canvas.getContext(), cachedCanvas = this._getCanvasCache(), drawFunc = this.getSceneFunc(), hasShadow = this.hasShadow();
        let stage;
        const skipBuffer = false;
        const cachingSelf = top === this;
        if (!this.isVisible() && !cachingSelf) {
            return this;
        }
        if (cachedCanvas) {
            context.save();
            const m = this.getAbsoluteTransform(top).getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
            this._drawCachedSceneCanvas(context);
            context.restore();
            return this;
        }
        if (!drawFunc) {
            return this;
        }
        context.save();
        if (this._useBufferCanvas() && !skipBuffer) {
            stage = this.getStage();
            const bc = bufferCanvas || stage.bufferCanvas;
            const bufferContext = bc.getContext();
            bufferContext.clear();
            bufferContext.save();
            bufferContext._applyLineJoin(this);
            bufferContext._applyMiterLimit(this);
            const o = this.getAbsoluteTransform(top).getMatrix();
            bufferContext.transform(o[0], o[1], o[2], o[3], o[4], o[5]);
            drawFunc.call(this, bufferContext, this);
            bufferContext.restore();
            const ratio = bc.pixelRatio;
            if (hasShadow) {
                context._applyShadow(this);
            }
            context._applyOpacity(this);
            context._applyGlobalCompositeOperation(this);
            context.drawImage(bc._canvas, bc.x || 0, bc.y || 0, bc.width / ratio, bc.height / ratio);
        }
        else {
            context._applyLineJoin(this);
            context._applyMiterLimit(this);
            if (!cachingSelf) {
                const o = this.getAbsoluteTransform(top).getMatrix();
                context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);
                context._applyOpacity(this);
                context._applyGlobalCompositeOperation(this);
            }
            if (hasShadow) {
                context._applyShadow(this);
            }
            drawFunc.call(this, context, this);
        }
        context.restore();
        return this;
    }
    drawHit(can, top, skipDragCheck = false) {
        if (!this.shouldDrawHit(top, skipDragCheck)) {
            return this;
        }
        const layer = this.getLayer(), canvas = can || layer.hitCanvas, context = canvas && canvas.getContext(), drawFunc = this.hitFunc() || this.sceneFunc(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;
        if (!this.colorKey) {
            _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn('Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()');
        }
        if (cachedHitCanvas) {
            context.save();
            const m = this.getAbsoluteTransform(top).getMatrix();
            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
            this._drawCachedHitCanvas(context);
            context.restore();
            return this;
        }
        if (!drawFunc) {
            return this;
        }
        context.save();
        context._applyLineJoin(this);
        context._applyMiterLimit(this);
        const selfCache = this === top;
        if (!selfCache) {
            const o = this.getAbsoluteTransform(top).getMatrix();
            context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);
        }
        drawFunc.call(this, context, this);
        context.restore();
        return this;
    }
    drawHitFromCache(alphaThreshold = 0) {
        const cachedCanvas = this._getCanvasCache(), sceneCanvas = this._getCachedSceneCanvas(), hitCanvas = cachedCanvas.hit, hitContext = hitCanvas.getContext(), hitWidth = hitCanvas.getWidth(), hitHeight = hitCanvas.getHeight();
        hitContext.clear();
        hitContext.drawImage(sceneCanvas._canvas, 0, 0, hitWidth, hitHeight);
        try {
            const hitImageData = hitContext.getImageData(0, 0, hitWidth, hitHeight);
            const hitData = hitImageData.data;
            const len = hitData.length;
            const rgbColorKey = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._hexToRgb(this.colorKey);
            for (let i = 0; i < len; i += 4) {
                const alpha = hitData[i + 3];
                if (alpha > alphaThreshold) {
                    hitData[i] = rgbColorKey.r;
                    hitData[i + 1] = rgbColorKey.g;
                    hitData[i + 2] = rgbColorKey.b;
                    hitData[i + 3] = 255;
                }
                else {
                    hitData[i + 3] = 0;
                }
            }
            hitContext.putImageData(hitImageData, 0, 0);
        }
        catch (e) {
            _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.error('Unable to draw hit graph from cached scene canvas. ' + e.message);
        }
        return this;
    }
    hasPointerCapture(pointerId) {
        return _PointerEvents_js__WEBPACK_IMPORTED_MODULE_5__.hasPointerCapture(pointerId, this);
    }
    setPointerCapture(pointerId) {
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_5__.setPointerCapture(pointerId, this);
    }
    releaseCapture(pointerId) {
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_5__.releaseCapture(pointerId, this);
    }
}
Shape.prototype._fillFunc = _fillFunc;
Shape.prototype._strokeFunc = _strokeFunc;
Shape.prototype._fillFuncHit = _fillFuncHit;
Shape.prototype._strokeFuncHit = _strokeFuncHit;
Shape.prototype._centroid = false;
Shape.prototype.nodeType = 'Shape';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_0__._registerNode)(Shape);
Shape.prototype.eventListeners = {};
Shape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearHasShadowCache);
Shape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearGetShadowRGBACache);
Shape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva', _clearFillPatternCache);
Shape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva', _clearLinearGradientCache);
Shape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva', _clearRadialGradientCache);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'stroke', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getStringOrGradientValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeWidth', 2, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillAfterStrokeEnabled', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'hitStrokeWidth', 'auto', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberOrAutoValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeHitEnabled', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'perfectDrawEnabled', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowForStrokeEnabled', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'lineJoin');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'lineCap');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'miterLimit');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'sceneFunc');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'hitFunc');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'dash');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'dashOffset', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowColor', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getStringValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowBlur', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowOpacity', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'shadowOffset', ['x', 'y']);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowOffsetX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowOffsetY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternImage');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fill', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getStringOrGradientValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillLinearGradientColorStops');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeLinearGradientColorStops');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientStartRadius', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientEndRadius', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientColorStops');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternRepeat', 'repeat');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'shadowEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'dashEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeScaleEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPriority', 'color');
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillPatternOffset', ['x', 'y']);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternOffsetX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternOffsetY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillPatternScale', ['x', 'y']);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternScaleX', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternScaleY', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillLinearGradientStartPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'strokeLinearGradientStartPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillLinearGradientStartPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeLinearGradientStartPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillLinearGradientStartPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeLinearGradientStartPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillLinearGradientEndPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'strokeLinearGradientEndPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillLinearGradientEndPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeLinearGradientEndPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillLinearGradientEndPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'strokeLinearGradientEndPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillRadialGradientStartPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientStartPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientStartPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addComponentsGetterSetter(Shape, 'fillRadialGradientEndPoint', [
    'x',
    'y',
]);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientEndPointX', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRadialGradientEndPointY', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillPatternRotation', 0);
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.addGetterSetter(Shape, 'fillRule', undefined, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getStringValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_2__.Factory.backCompat(Shape, {
    dashArray: 'dash',
    getDashArray: 'getDash',
    setDashArray: 'getDash',
    drawFunc: 'sceneFunc',
    getDrawFunc: 'getSceneFunc',
    setDrawFunc: 'setSceneFunc',
    drawHitFunc: 'hitFunc',
    getDrawHitFunc: 'getHitFunc',
    setDrawHitFunc: 'setHitFunc',
});


/***/ }),

/***/ "./node_modules/konva/lib/Stage.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/Stage.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Stage": function() { return /* binding */ Stage; },
/* harmony export */   "stages": function() { return /* binding */ stages; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Container.js */ "./node_modules/konva/lib/Container.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Canvas_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Canvas.js */ "./node_modules/konva/lib/Canvas.js");
/* harmony import */ var _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./DragAndDrop.js */ "./node_modules/konva/lib/DragAndDrop.js");
/* harmony import */ var _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PointerEvents.js */ "./node_modules/konva/lib/PointerEvents.js");








const STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', POINTEROUT = 'pointerout', POINTERLEAVE = 'pointerleave', POINTEROVER = 'pointerover', POINTERENTER = 'pointerenter', CONTEXTMENU = 'contextmenu', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TOUCHMOVE = 'touchmove', TOUCHCANCEL = 'touchcancel', WHEEL = 'wheel', MAX_LAYERS_NUMBER = 5, EVENTS = [
    [MOUSEENTER, '_pointerenter'],
    [MOUSEDOWN, '_pointerdown'],
    [MOUSEMOVE, '_pointermove'],
    [MOUSEUP, '_pointerup'],
    [MOUSELEAVE, '_pointerleave'],
    [TOUCHSTART, '_pointerdown'],
    [TOUCHMOVE, '_pointermove'],
    [TOUCHEND, '_pointerup'],
    [TOUCHCANCEL, '_pointercancel'],
    [MOUSEOVER, '_pointerover'],
    [WHEEL, '_wheel'],
    [CONTEXTMENU, '_contextmenu'],
    [POINTERDOWN, '_pointerdown'],
    [POINTERMOVE, '_pointermove'],
    [POINTERUP, '_pointerup'],
    [POINTERCANCEL, '_pointercancel'],
    [POINTERLEAVE, '_pointerleave'],
    [LOSTPOINTERCAPTURE, '_lostpointercapture'],
];
const EVENTS_MAP = {
    mouse: {
        [POINTEROUT]: MOUSEOUT,
        [POINTERLEAVE]: MOUSELEAVE,
        [POINTEROVER]: MOUSEOVER,
        [POINTERENTER]: MOUSEENTER,
        [POINTERMOVE]: MOUSEMOVE,
        [POINTERDOWN]: MOUSEDOWN,
        [POINTERUP]: MOUSEUP,
        [POINTERCANCEL]: 'mousecancel',
        pointerclick: 'click',
        pointerdblclick: 'dblclick',
    },
    touch: {
        [POINTEROUT]: 'touchout',
        [POINTERLEAVE]: 'touchleave',
        [POINTEROVER]: 'touchover',
        [POINTERENTER]: 'touchenter',
        [POINTERMOVE]: TOUCHMOVE,
        [POINTERDOWN]: TOUCHSTART,
        [POINTERUP]: TOUCHEND,
        [POINTERCANCEL]: TOUCHCANCEL,
        pointerclick: 'tap',
        pointerdblclick: 'dbltap',
    },
    pointer: {
        [POINTEROUT]: POINTEROUT,
        [POINTERLEAVE]: POINTERLEAVE,
        [POINTEROVER]: POINTEROVER,
        [POINTERENTER]: POINTERENTER,
        [POINTERMOVE]: POINTERMOVE,
        [POINTERDOWN]: POINTERDOWN,
        [POINTERUP]: POINTERUP,
        [POINTERCANCEL]: POINTERCANCEL,
        pointerclick: 'pointerclick',
        pointerdblclick: 'pointerdblclick',
    },
};
const getEventType = (type) => {
    if (type.indexOf('pointer') >= 0) {
        return 'pointer';
    }
    if (type.indexOf('touch') >= 0) {
        return 'touch';
    }
    return 'mouse';
};
const getEventsMap = (eventType) => {
    const type = getEventType(eventType);
    if (type === 'pointer') {
        return _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.pointerEventsEnabled && EVENTS_MAP.pointer;
    }
    if (type === 'touch') {
        return EVENTS_MAP.touch;
    }
    if (type === 'mouse') {
        return EVENTS_MAP.mouse;
    }
};
function checkNoClip(attrs = {}) {
    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');
    }
    return attrs;
}
const NO_POINTERS_MESSAGE = `Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);`;
const stages = [];
class Stage extends _Container_js__WEBPACK_IMPORTED_MODULE_2__.Container {
    constructor(config) {
        super(checkNoClip(config));
        this._pointerPositions = [];
        this._changedPointerPositions = [];
        this._buildDOM();
        this._bindContentEvents();
        stages.push(this);
        this.on('widthChange.konva heightChange.konva', this._resizeDOM);
        this.on('visibleChange.konva', this._checkVisibility);
        this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', () => {
            checkNoClip(this.attrs);
        });
        this._checkVisibility();
    }
    _validateAdd(child) {
        const isLayer = child.getType() === 'Layer';
        const isFastLayer = child.getType() === 'FastLayer';
        const valid = isLayer || isFastLayer;
        if (!valid) {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util["throw"]('You may only add layers to the stage.');
        }
    }
    _checkVisibility() {
        if (!this.content) {
            return;
        }
        const style = this.visible() ? '' : 'none';
        this.content.style.display = style;
    }
    setContainer(container) {
        if (typeof container === STRING) {
            let id;
            if (container.charAt(0) === '.') {
                const className = container.slice(1);
                container = document.getElementsByClassName(className)[0];
            }
            else {
                if (container.charAt(0) !== '#') {
                    id = container;
                }
                else {
                    id = container.slice(1);
                }
                container = document.getElementById(id);
            }
            if (!container) {
                throw 'Can not find container in document with id ' + id;
            }
        }
        this._setAttr('container', container);
        if (this.content) {
            if (this.content.parentElement) {
                this.content.parentElement.removeChild(this.content);
            }
            container.appendChild(this.content);
        }
        return this;
    }
    shouldDrawHit() {
        return true;
    }
    clear() {
        const layers = this.children, len = layers.length;
        for (let n = 0; n < len; n++) {
            layers[n].clear();
        }
        return this;
    }
    clone(obj) {
        if (!obj) {
            obj = {};
        }
        obj.container =
            typeof document !== 'undefined' && document.createElement('div');
        return _Container_js__WEBPACK_IMPORTED_MODULE_2__.Container.prototype.clone.call(this, obj);
    }
    destroy() {
        super.destroy();
        const content = this.content;
        if (content && _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isInDocument(content)) {
            this.container().removeChild(content);
        }
        const index = stages.indexOf(this);
        if (index > -1) {
            stages.splice(index, 1);
        }
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.releaseCanvas(this.bufferCanvas._canvas, this.bufferHitCanvas._canvas);
        return this;
    }
    getPointerPosition() {
        const pos = this._pointerPositions[0] || this._changedPointerPositions[0];
        if (!pos) {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn(NO_POINTERS_MESSAGE);
            return null;
        }
        return {
            x: pos.x,
            y: pos.y,
        };
    }
    _getPointerById(id) {
        return this._pointerPositions.find((p) => p.id === id);
    }
    getPointersPositions() {
        return this._pointerPositions;
    }
    getStage() {
        return this;
    }
    getContent() {
        return this.content;
    }
    _toKonvaCanvas(config) {
        config = { ...config };
        config.x = config.x || 0;
        config.y = config.y || 0;
        config.width = config.width || this.width();
        config.height = config.height || this.height();
        const canvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_4__.SceneCanvas({
            width: config.width,
            height: config.height,
            pixelRatio: config.pixelRatio || 1,
        });
        const _context = canvas.getContext()._context;
        const layers = this.children;
        if (config.x || config.y) {
            _context.translate(-1 * config.x, -1 * config.y);
        }
        layers.forEach(function (layer) {
            if (!layer.isVisible()) {
                return;
            }
            const layerCanvas = layer._toKonvaCanvas(config);
            _context.drawImage(layerCanvas._canvas, config.x, config.y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());
        });
        return canvas;
    }
    getIntersection(pos) {
        if (!pos) {
            return null;
        }
        const layers = this.children, len = layers.length, end = len - 1;
        for (let n = end; n >= 0; n--) {
            const shape = layers[n].getIntersection(pos);
            if (shape) {
                return shape;
            }
        }
        return null;
    }
    _resizeDOM() {
        const width = this.width();
        const height = this.height();
        if (this.content) {
            this.content.style.width = width + PX;
            this.content.style.height = height + PX;
        }
        this.bufferCanvas.setSize(width, height);
        this.bufferHitCanvas.setSize(width, height);
        this.children.forEach((layer) => {
            layer.setSize({ width, height });
            layer.draw();
        });
    }
    add(layer, ...rest) {
        if (arguments.length > 1) {
            for (let i = 0; i < arguments.length; i++) {
                this.add(arguments[i]);
            }
            return this;
        }
        super.add(layer);
        const length = this.children.length;
        if (length > MAX_LAYERS_NUMBER) {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('The stage has ' +
                length +
                ' layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');
        }
        layer.setSize({ width: this.width(), height: this.height() });
        layer.draw();
        if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isBrowser) {
            this.content.appendChild(layer.canvas._canvas);
        }
        return this;
    }
    getParent() {
        return null;
    }
    getLayer() {
        return null;
    }
    hasPointerCapture(pointerId) {
        return _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.hasPointerCapture(pointerId, this);
    }
    setPointerCapture(pointerId) {
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.setPointerCapture(pointerId, this);
    }
    releaseCapture(pointerId) {
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.releaseCapture(pointerId, this);
    }
    getLayers() {
        return this.children;
    }
    _bindContentEvents() {
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isBrowser) {
            return;
        }
        EVENTS.forEach(([event, methodName]) => {
            this.content.addEventListener(event, (evt) => {
                this[methodName](evt);
            }, { passive: false });
        });
    }
    _pointerenter(evt) {
        this.setPointersPositions(evt);
        const events = getEventsMap(evt.type);
        if (events) {
            this._fire(events.pointerenter, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
        }
    }
    _pointerover(evt) {
        this.setPointersPositions(evt);
        const events = getEventsMap(evt.type);
        if (events) {
            this._fire(events.pointerover, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
        }
    }
    _getTargetShape(evenType) {
        let shape = this[evenType + 'targetShape'];
        if (shape && !shape.getStage()) {
            shape = null;
        }
        return shape;
    }
    _pointerleave(evt) {
        const events = getEventsMap(evt.type);
        const eventType = getEventType(evt.type);
        if (!events) {
            return;
        }
        this.setPointersPositions(evt);
        const targetShape = this._getTargetShape(eventType);
        const eventsEnabled = !(_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isDragging() || _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isTransforming()) || _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.hitOnDragEnabled;
        if (targetShape && eventsEnabled) {
            targetShape._fireAndBubble(events.pointerout, { evt: evt });
            targetShape._fireAndBubble(events.pointerleave, { evt: evt });
            this._fire(events.pointerleave, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
            this[eventType + 'targetShape'] = null;
        }
        else if (eventsEnabled) {
            this._fire(events.pointerleave, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
            this._fire(events.pointerout, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
        }
        this.pointerPos = null;
        this._pointerPositions = [];
    }
    _pointerdown(evt) {
        const events = getEventsMap(evt.type);
        const eventType = getEventType(evt.type);
        if (!events) {
            return;
        }
        this.setPointersPositions(evt);
        let triggeredOnShape = false;
        this._changedPointerPositions.forEach((pos) => {
            const shape = this.getIntersection(pos);
            _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_5__.DD.justDragged = false;
            _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'ListenClick'] = true;
            if (!shape || !shape.isListening()) {
                this[eventType + 'ClickStartShape'] = undefined;
                return;
            }
            if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.capturePointerEventsEnabled) {
                shape.setPointerCapture(pos.id);
            }
            this[eventType + 'ClickStartShape'] = shape;
            shape._fireAndBubble(events.pointerdown, {
                evt: evt,
                pointerId: pos.id,
            });
            triggeredOnShape = true;
            const isTouch = evt.type.indexOf('touch') >= 0;
            if (shape.preventDefault() && evt.cancelable && isTouch) {
                evt.preventDefault();
            }
        });
        if (!triggeredOnShape) {
            this._fire(events.pointerdown, {
                evt: evt,
                target: this,
                currentTarget: this,
                pointerId: this._pointerPositions[0].id,
            });
        }
    }
    _pointermove(evt) {
        const events = getEventsMap(evt.type);
        const eventType = getEventType(evt.type);
        if (!events) {
            return;
        }
        const isTouchPointer = evt.type.indexOf('touch') >= 0 ||
            evt.pointerType === 'touch';
        if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isDragging() &&
            _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_5__.DD.node.preventDefault() &&
            evt.cancelable &&
            isTouchPointer) {
            evt.preventDefault();
        }
        this.setPointersPositions(evt);
        const eventsEnabled = !(_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isDragging() || _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isTransforming()) || _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.hitOnDragEnabled;
        if (!eventsEnabled) {
            return;
        }
        const processedShapesIds = {};
        let triggeredOnShape = false;
        const targetShape = this._getTargetShape(eventType);
        this._changedPointerPositions.forEach((pos) => {
            const shape = (_PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.getCapturedShape(pos.id) ||
                this.getIntersection(pos));
            const pointerId = pos.id;
            const event = { evt: evt, pointerId };
            const differentTarget = targetShape !== shape;
            if (differentTarget && targetShape) {
                targetShape._fireAndBubble(events.pointerout, { ...event }, shape);
                targetShape._fireAndBubble(events.pointerleave, { ...event }, shape);
            }
            if (shape) {
                if (processedShapesIds[shape._id]) {
                    return;
                }
                processedShapesIds[shape._id] = true;
            }
            if (shape && shape.isListening()) {
                triggeredOnShape = true;
                if (differentTarget) {
                    shape._fireAndBubble(events.pointerover, { ...event }, targetShape);
                    shape._fireAndBubble(events.pointerenter, { ...event }, targetShape);
                    this[eventType + 'targetShape'] = shape;
                }
                shape._fireAndBubble(events.pointermove, { ...event });
            }
            else {
                if (targetShape) {
                    this._fire(events.pointerover, {
                        evt: evt,
                        target: this,
                        currentTarget: this,
                        pointerId,
                    });
                    this[eventType + 'targetShape'] = null;
                }
            }
        });
        if (!triggeredOnShape) {
            this._fire(events.pointermove, {
                evt: evt,
                target: this,
                currentTarget: this,
                pointerId: this._changedPointerPositions[0].id,
            });
        }
    }
    _pointerup(evt) {
        const events = getEventsMap(evt.type);
        const eventType = getEventType(evt.type);
        if (!events) {
            return;
        }
        this.setPointersPositions(evt);
        const clickStartShape = this[eventType + 'ClickStartShape'];
        const clickEndShape = this[eventType + 'ClickEndShape'];
        const processedShapesIds = {};
        let skipPointerUpTrigger = false;
        this._changedPointerPositions.forEach((pos) => {
            const shape = (_PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.getCapturedShape(pos.id) ||
                this.getIntersection(pos));
            if (shape) {
                shape.releaseCapture(pos.id);
                if (processedShapesIds[shape._id]) {
                    return;
                }
                processedShapesIds[shape._id] = true;
            }
            const pointerId = pos.id;
            const event = { evt: evt, pointerId };
            let fireDblClick = false;
            if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'InDblClickWindow']) {
                fireDblClick = true;
                clearTimeout(this[eventType + 'DblTimeout']);
            }
            else if (!_DragAndDrop_js__WEBPACK_IMPORTED_MODULE_5__.DD.justDragged) {
                _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'InDblClickWindow'] = true;
                clearTimeout(this[eventType + 'DblTimeout']);
            }
            this[eventType + 'DblTimeout'] = setTimeout(function () {
                _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'InDblClickWindow'] = false;
            }, _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.dblClickWindow);
            if (shape && shape.isListening()) {
                skipPointerUpTrigger = true;
                this[eventType + 'ClickEndShape'] = shape;
                shape._fireAndBubble(events.pointerup, { ...event });
                if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'ListenClick'] &&
                    clickStartShape &&
                    clickStartShape === shape) {
                    shape._fireAndBubble(events.pointerclick, { ...event });
                    if (fireDblClick && clickEndShape && clickEndShape === shape) {
                        shape._fireAndBubble(events.pointerdblclick, { ...event });
                    }
                }
            }
            else {
                this[eventType + 'ClickEndShape'] = null;
                if (!skipPointerUpTrigger) {
                    this._fire(events.pointerup, {
                        evt: evt,
                        target: this,
                        currentTarget: this,
                        pointerId: this._changedPointerPositions[0].id,
                    });
                    skipPointerUpTrigger = true;
                }
                if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'ListenClick']) {
                    this._fire(events.pointerclick, {
                        evt: evt,
                        target: this,
                        currentTarget: this,
                        pointerId,
                    });
                }
                if (fireDblClick) {
                    this._fire(events.pointerdblclick, {
                        evt: evt,
                        target: this,
                        currentTarget: this,
                        pointerId,
                    });
                }
            }
        });
        if (!skipPointerUpTrigger) {
            this._fire(events.pointerup, {
                evt: evt,
                target: this,
                currentTarget: this,
                pointerId: this._changedPointerPositions[0].id,
            });
        }
        _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva['_' + eventType + 'ListenClick'] = false;
        if (evt.cancelable && eventType !== 'touch' && eventType !== 'pointer') {
            evt.preventDefault();
        }
    }
    _contextmenu(evt) {
        this.setPointersPositions(evt);
        const shape = this.getIntersection(this.getPointerPosition());
        if (shape && shape.isListening()) {
            shape._fireAndBubble(CONTEXTMENU, { evt: evt });
        }
        else {
            this._fire(CONTEXTMENU, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
        }
    }
    _wheel(evt) {
        this.setPointersPositions(evt);
        const shape = this.getIntersection(this.getPointerPosition());
        if (shape && shape.isListening()) {
            shape._fireAndBubble(WHEEL, { evt: evt });
        }
        else {
            this._fire(WHEEL, {
                evt: evt,
                target: this,
                currentTarget: this,
            });
        }
    }
    _pointercancel(evt) {
        this.setPointersPositions(evt);
        const shape = _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.getCapturedShape(evt.pointerId) ||
            this.getIntersection(this.getPointerPosition());
        if (shape) {
            shape._fireAndBubble(POINTERUP, _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.createEvent(evt));
        }
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.releaseCapture(evt.pointerId);
    }
    _lostpointercapture(evt) {
        _PointerEvents_js__WEBPACK_IMPORTED_MODULE_6__.releaseCapture(evt.pointerId);
    }
    setPointersPositions(evt) {
        const contentPosition = this._getContentPosition();
        let x = null, y = null;
        evt = evt ? evt : window.event;
        if (evt.touches !== undefined) {
            this._pointerPositions = [];
            this._changedPointerPositions = [];
            Array.prototype.forEach.call(evt.touches, (touch) => {
                this._pointerPositions.push({
                    id: touch.identifier,
                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,
                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,
                });
            });
            Array.prototype.forEach.call(evt.changedTouches || evt.touches, (touch) => {
                this._changedPointerPositions.push({
                    id: touch.identifier,
                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,
                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,
                });
            });
        }
        else {
            x = (evt.clientX - contentPosition.left) / contentPosition.scaleX;
            y = (evt.clientY - contentPosition.top) / contentPosition.scaleY;
            this.pointerPos = {
                x: x,
                y: y,
            };
            this._pointerPositions = [{ x, y, id: _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._getFirstPointerId(evt) }];
            this._changedPointerPositions = [
                { x, y, id: _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._getFirstPointerId(evt) },
            ];
        }
    }
    _setPointerPosition(evt) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.');
        this.setPointersPositions(evt);
    }
    _getContentPosition() {
        if (!this.content || !this.content.getBoundingClientRect) {
            return {
                top: 0,
                left: 0,
                scaleX: 1,
                scaleY: 1,
            };
        }
        const rect = this.content.getBoundingClientRect();
        return {
            top: rect.top,
            left: rect.left,
            scaleX: rect.width / this.content.clientWidth || 1,
            scaleY: rect.height / this.content.clientHeight || 1,
        };
    }
    _buildDOM() {
        this.bufferCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_4__.SceneCanvas({
            width: this.width(),
            height: this.height(),
        });
        this.bufferHitCanvas = new _Canvas_js__WEBPACK_IMPORTED_MODULE_4__.HitCanvas({
            pixelRatio: 1,
            width: this.width(),
            height: this.height(),
        });
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isBrowser) {
            return;
        }
        const container = this.container();
        if (!container) {
            throw 'Stage has no container. A container is required.';
        }
        container.innerHTML = '';
        this.content = document.createElement('div');
        this.content.style.position = 'relative';
        this.content.style.userSelect = 'none';
        this.content.className = 'konvajs-content';
        this.content.setAttribute('role', 'presentation');
        container.appendChild(this.content);
        this._resizeDOM();
    }
    cache() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');
        return this;
    }
    clearCache() {
        return this;
    }
    batchDraw() {
        this.getChildren().forEach(function (layer) {
            layer.batchDraw();
        });
        return this;
    }
}
Stage.prototype.nodeType = STAGE;
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Stage);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Stage, 'container');
if (_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.isBrowser) {
    document.addEventListener('visibilitychange', () => {
        stages.forEach((stage) => {
            stage.batchDraw();
        });
    });
}


/***/ }),

/***/ "./node_modules/konva/lib/Tween.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/Tween.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Easings": function() { return /* binding */ Easings; },
/* harmony export */   "Tween": function() { return /* binding */ Tween; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Animation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Animation.js */ "./node_modules/konva/lib/Animation.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");




const blacklist = {
    node: 1,
    duration: 1,
    easing: 1,
    onFinish: 1,
    yoyo: 1,
}, PAUSED = 1, PLAYING = 2, REVERSING = 3, colorAttrs = ['fill', 'stroke', 'shadowColor'];
let idCounter = 0;
class TweenEngine {
    constructor(prop, propFunc, func, begin, finish, duration, yoyo) {
        this.prop = prop;
        this.propFunc = propFunc;
        this.begin = begin;
        this._pos = begin;
        this.duration = duration;
        this._change = 0;
        this.prevPos = 0;
        this.yoyo = yoyo;
        this._time = 0;
        this._position = 0;
        this._startTime = 0;
        this._finish = 0;
        this.func = func;
        this._change = finish - this.begin;
        this.pause();
    }
    fire(str) {
        const handler = this[str];
        if (handler) {
            handler();
        }
    }
    setTime(t) {
        if (t > this.duration) {
            if (this.yoyo) {
                this._time = this.duration;
                this.reverse();
            }
            else {
                this.finish();
            }
        }
        else if (t < 0) {
            if (this.yoyo) {
                this._time = 0;
                this.play();
            }
            else {
                this.reset();
            }
        }
        else {
            this._time = t;
            this.update();
        }
    }
    getTime() {
        return this._time;
    }
    setPosition(p) {
        this.prevPos = this._pos;
        this.propFunc(p);
        this._pos = p;
    }
    getPosition(t) {
        if (t === undefined) {
            t = this._time;
        }
        return this.func(t, this.begin, this._change, this.duration);
    }
    play() {
        this.state = PLAYING;
        this._startTime = this.getTimer() - this._time;
        this.onEnterFrame();
        this.fire('onPlay');
    }
    reverse() {
        this.state = REVERSING;
        this._time = this.duration - this._time;
        this._startTime = this.getTimer() - this._time;
        this.onEnterFrame();
        this.fire('onReverse');
    }
    seek(t) {
        this.pause();
        this._time = t;
        this.update();
        this.fire('onSeek');
    }
    reset() {
        this.pause();
        this._time = 0;
        this.update();
        this.fire('onReset');
    }
    finish() {
        this.pause();
        this._time = this.duration;
        this.update();
        this.fire('onFinish');
    }
    update() {
        this.setPosition(this.getPosition(this._time));
        this.fire('onUpdate');
    }
    onEnterFrame() {
        const t = this.getTimer() - this._startTime;
        if (this.state === PLAYING) {
            this.setTime(t);
        }
        else if (this.state === REVERSING) {
            this.setTime(this.duration - t);
        }
    }
    pause() {
        this.state = PAUSED;
        this.fire('onPause');
    }
    getTimer() {
        return new Date().getTime();
    }
}
class Tween {
    constructor(config) {
        const that = this, node = config.node, nodeId = node._id, easing = config.easing || Easings.Linear, yoyo = !!config.yoyo;
        let duration, key;
        if (typeof config.duration === 'undefined') {
            duration = 0.3;
        }
        else if (config.duration === 0) {
            duration = 0.001;
        }
        else {
            duration = config.duration;
        }
        this.node = node;
        this._id = idCounter++;
        const layers = node.getLayer() ||
            (node instanceof _Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.Stage ? node.getLayers() : null);
        if (!layers) {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');
        }
        this.anim = new _Animation_js__WEBPACK_IMPORTED_MODULE_1__.Animation(function () {
            that.tween.onEnterFrame();
        }, layers);
        this.tween = new TweenEngine(key, function (i) {
            that._tweenFunc(i);
        }, easing, 0, 1, duration * 1000, yoyo);
        this._addListeners();
        if (!Tween.attrs[nodeId]) {
            Tween.attrs[nodeId] = {};
        }
        if (!Tween.attrs[nodeId][this._id]) {
            Tween.attrs[nodeId][this._id] = {};
        }
        if (!Tween.tweens[nodeId]) {
            Tween.tweens[nodeId] = {};
        }
        for (key in config) {
            if (blacklist[key] === undefined) {
                this._addAttr(key, config[key]);
            }
        }
        this.reset();
        this.onFinish = config.onFinish;
        this.onReset = config.onReset;
        this.onUpdate = config.onUpdate;
    }
    _addAttr(key, end) {
        const node = this.node, nodeId = node._id;
        let diff, len, trueEnd, trueStart, endRGBA;
        const tweenId = Tween.tweens[nodeId][key];
        if (tweenId) {
            delete Tween.attrs[nodeId][tweenId][key];
        }
        let start = node.getAttr(key);
        if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isArray(end)) {
            diff = [];
            len = Math.max(end.length, start.length);
            if (key === 'points' && end.length !== start.length) {
                if (end.length > start.length) {
                    trueStart = start;
                    start = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._prepareArrayForTween(start, end, node.closed());
                }
                else {
                    trueEnd = end;
                    end = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._prepareArrayForTween(end, start, node.closed());
                }
            }
            if (key.indexOf('fill') === 0) {
                for (let n = 0; n < len; n++) {
                    if (n % 2 === 0) {
                        diff.push(end[n] - start[n]);
                    }
                    else {
                        const startRGBA = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.colorToRGBA(start[n]);
                        endRGBA = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.colorToRGBA(end[n]);
                        start[n] = startRGBA;
                        diff.push({
                            r: endRGBA.r - startRGBA.r,
                            g: endRGBA.g - startRGBA.g,
                            b: endRGBA.b - startRGBA.b,
                            a: endRGBA.a - startRGBA.a,
                        });
                    }
                }
            }
            else {
                for (let n = 0; n < len; n++) {
                    diff.push(end[n] - start[n]);
                }
            }
        }
        else if (colorAttrs.indexOf(key) !== -1) {
            start = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.colorToRGBA(start);
            endRGBA = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.colorToRGBA(end);
            diff = {
                r: endRGBA.r - start.r,
                g: endRGBA.g - start.g,
                b: endRGBA.b - start.b,
                a: endRGBA.a - start.a,
            };
        }
        else {
            diff = end - start;
        }
        Tween.attrs[nodeId][this._id][key] = {
            start: start,
            diff: diff,
            end: end,
            trueEnd: trueEnd,
            trueStart: trueStart,
        };
        Tween.tweens[nodeId][key] = this._id;
    }
    _tweenFunc(i) {
        const node = this.node, attrs = Tween.attrs[node._id][this._id];
        let key, attr, start, diff, newVal, n, len, end;
        for (key in attrs) {
            attr = attrs[key];
            start = attr.start;
            diff = attr.diff;
            end = attr.end;
            if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isArray(start)) {
                newVal = [];
                len = Math.max(start.length, end.length);
                if (key.indexOf('fill') === 0) {
                    for (n = 0; n < len; n++) {
                        if (n % 2 === 0) {
                            newVal.push((start[n] || 0) + diff[n] * i);
                        }
                        else {
                            newVal.push('rgba(' +
                                Math.round(start[n].r + diff[n].r * i) +
                                ',' +
                                Math.round(start[n].g + diff[n].g * i) +
                                ',' +
                                Math.round(start[n].b + diff[n].b * i) +
                                ',' +
                                (start[n].a + diff[n].a * i) +
                                ')');
                        }
                    }
                }
                else {
                    for (n = 0; n < len; n++) {
                        newVal.push((start[n] || 0) + diff[n] * i);
                    }
                }
            }
            else if (colorAttrs.indexOf(key) !== -1) {
                newVal =
                    'rgba(' +
                        Math.round(start.r + diff.r * i) +
                        ',' +
                        Math.round(start.g + diff.g * i) +
                        ',' +
                        Math.round(start.b + diff.b * i) +
                        ',' +
                        (start.a + diff.a * i) +
                        ')';
            }
            else {
                newVal = start + diff * i;
            }
            node.setAttr(key, newVal);
        }
    }
    _addListeners() {
        this.tween.onPlay = () => {
            this.anim.start();
        };
        this.tween.onReverse = () => {
            this.anim.start();
        };
        this.tween.onPause = () => {
            this.anim.stop();
        };
        this.tween.onFinish = () => {
            const node = this.node;
            const attrs = Tween.attrs[node._id][this._id];
            if (attrs.points && attrs.points.trueEnd) {
                node.setAttr('points', attrs.points.trueEnd);
            }
            if (this.onFinish) {
                this.onFinish.call(this);
            }
        };
        this.tween.onReset = () => {
            const node = this.node;
            const attrs = Tween.attrs[node._id][this._id];
            if (attrs.points && attrs.points.trueStart) {
                node.points(attrs.points.trueStart);
            }
            if (this.onReset) {
                this.onReset();
            }
        };
        this.tween.onUpdate = () => {
            if (this.onUpdate) {
                this.onUpdate.call(this);
            }
        };
    }
    play() {
        this.tween.play();
        return this;
    }
    reverse() {
        this.tween.reverse();
        return this;
    }
    reset() {
        this.tween.reset();
        return this;
    }
    seek(t) {
        this.tween.seek(t * 1000);
        return this;
    }
    pause() {
        this.tween.pause();
        return this;
    }
    finish() {
        this.tween.finish();
        return this;
    }
    destroy() {
        const nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId];
        this.pause();
        if (this.anim) {
            this.anim.stop();
        }
        for (const key in attrs) {
            delete Tween.tweens[nodeId][key];
        }
        delete Tween.attrs[nodeId][thisId];
        if (Tween.tweens[nodeId]) {
            if (Object.keys(Tween.tweens[nodeId]).length === 0) {
                delete Tween.tweens[nodeId];
            }
            if (Object.keys(Tween.attrs[nodeId]).length === 0) {
                delete Tween.attrs[nodeId];
            }
        }
    }
}
Tween.attrs = {};
Tween.tweens = {};
_Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.to = function (params) {
    const onFinish = params.onFinish;
    params.node = this;
    params.onFinish = function () {
        this.destroy();
        if (onFinish) {
            onFinish();
        }
    };
    const tween = new Tween(params);
    tween.play();
};
const Easings = {
    BackEaseIn(t, b, c, d) {
        const s = 1.70158;
        return c * (t /= d) * t * ((s + 1) * t - s) + b;
    },
    BackEaseOut(t, b, c, d) {
        const s = 1.70158;
        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;
    },
    BackEaseInOut(t, b, c, d) {
        let s = 1.70158;
        if ((t /= d / 2) < 1) {
            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;
        }
        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;
    },
    ElasticEaseIn(t, b, c, d, a, p) {
        let s = 0;
        if (t === 0) {
            return b;
        }
        if ((t /= d) === 1) {
            return b + c;
        }
        if (!p) {
            p = d * 0.3;
        }
        if (!a || a < Math.abs(c)) {
            a = c;
            s = p / 4;
        }
        else {
            s = (p / (2 * Math.PI)) * Math.asin(c / a);
        }
        return (-(a *
            Math.pow(2, 10 * (t -= 1)) *
            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);
    },
    ElasticEaseOut(t, b, c, d, a, p) {
        let s = 0;
        if (t === 0) {
            return b;
        }
        if ((t /= d) === 1) {
            return b + c;
        }
        if (!p) {
            p = d * 0.3;
        }
        if (!a || a < Math.abs(c)) {
            a = c;
            s = p / 4;
        }
        else {
            s = (p / (2 * Math.PI)) * Math.asin(c / a);
        }
        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +
            c +
            b);
    },
    ElasticEaseInOut(t, b, c, d, a, p) {
        let s = 0;
        if (t === 0) {
            return b;
        }
        if ((t /= d / 2) === 2) {
            return b + c;
        }
        if (!p) {
            p = d * (0.3 * 1.5);
        }
        if (!a || a < Math.abs(c)) {
            a = c;
            s = p / 4;
        }
        else {
            s = (p / (2 * Math.PI)) * Math.asin(c / a);
        }
        if (t < 1) {
            return (-0.5 *
                (a *
                    Math.pow(2, 10 * (t -= 1)) *
                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +
                b);
        }
        return (a *
            Math.pow(2, -10 * (t -= 1)) *
            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *
            0.5 +
            c +
            b);
    },
    BounceEaseOut(t, b, c, d) {
        if ((t /= d) < 1 / 2.75) {
            return c * (7.5625 * t * t) + b;
        }
        else if (t < 2 / 2.75) {
            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;
        }
        else if (t < 2.5 / 2.75) {
            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;
        }
        else {
            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;
        }
    },
    BounceEaseIn(t, b, c, d) {
        return c - Easings.BounceEaseOut(d - t, 0, c, d) + b;
    },
    BounceEaseInOut(t, b, c, d) {
        if (t < d / 2) {
            return Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;
        }
        else {
            return Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;
        }
    },
    EaseIn(t, b, c, d) {
        return c * (t /= d) * t + b;
    },
    EaseOut(t, b, c, d) {
        return -c * (t /= d) * (t - 2) + b;
    },
    EaseInOut(t, b, c, d) {
        if ((t /= d / 2) < 1) {
            return (c / 2) * t * t + b;
        }
        return (-c / 2) * (--t * (t - 2) - 1) + b;
    },
    StrongEaseIn(t, b, c, d) {
        return c * (t /= d) * t * t * t * t + b;
    },
    StrongEaseOut(t, b, c, d) {
        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;
    },
    StrongEaseInOut(t, b, c, d) {
        if ((t /= d / 2) < 1) {
            return (c / 2) * t * t * t * t * t + b;
        }
        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;
    },
    Linear(t, b, c, d) {
        return (c * t) / d + b;
    },
};


/***/ }),

/***/ "./node_modules/konva/lib/Util.js":
/*!****************************************!*\
  !*** ./node_modules/konva/lib/Util.js ***!
  \****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Transform": function() { return /* binding */ Transform; },
/* harmony export */   "Util": function() { return /* binding */ Util; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");

const NODE_ERROR = `Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`;
const ensureBrowser = () => {
    if (typeof document === 'undefined') {
        throw new Error(NODE_ERROR);
    }
};
class Transform {
    constructor(m = [1, 0, 0, 1, 0, 0]) {
        this.dirty = false;
        this.m = (m && m.slice()) || [1, 0, 0, 1, 0, 0];
    }
    reset() {
        this.m[0] = 1;
        this.m[1] = 0;
        this.m[2] = 0;
        this.m[3] = 1;
        this.m[4] = 0;
        this.m[5] = 0;
    }
    copy() {
        return new Transform(this.m);
    }
    copyInto(tr) {
        tr.m[0] = this.m[0];
        tr.m[1] = this.m[1];
        tr.m[2] = this.m[2];
        tr.m[3] = this.m[3];
        tr.m[4] = this.m[4];
        tr.m[5] = this.m[5];
    }
    point(point) {
        const m = this.m;
        return {
            x: m[0] * point.x + m[2] * point.y + m[4],
            y: m[1] * point.x + m[3] * point.y + m[5],
        };
    }
    translate(x, y) {
        this.m[4] += this.m[0] * x + this.m[2] * y;
        this.m[5] += this.m[1] * x + this.m[3] * y;
        return this;
    }
    scale(sx, sy) {
        this.m[0] *= sx;
        this.m[1] *= sx;
        this.m[2] *= sy;
        this.m[3] *= sy;
        return this;
    }
    rotate(rad) {
        const c = Math.cos(rad);
        const s = Math.sin(rad);
        const m11 = this.m[0] * c + this.m[2] * s;
        const m12 = this.m[1] * c + this.m[3] * s;
        const m21 = this.m[0] * -s + this.m[2] * c;
        const m22 = this.m[1] * -s + this.m[3] * c;
        this.m[0] = m11;
        this.m[1] = m12;
        this.m[2] = m21;
        this.m[3] = m22;
        return this;
    }
    getTranslation() {
        return {
            x: this.m[4],
            y: this.m[5],
        };
    }
    skew(sx, sy) {
        const m11 = this.m[0] + this.m[2] * sy;
        const m12 = this.m[1] + this.m[3] * sy;
        const m21 = this.m[2] + this.m[0] * sx;
        const m22 = this.m[3] + this.m[1] * sx;
        this.m[0] = m11;
        this.m[1] = m12;
        this.m[2] = m21;
        this.m[3] = m22;
        return this;
    }
    multiply(matrix) {
        const m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];
        const m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];
        const m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];
        const m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];
        const dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];
        const dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];
        this.m[0] = m11;
        this.m[1] = m12;
        this.m[2] = m21;
        this.m[3] = m22;
        this.m[4] = dx;
        this.m[5] = dy;
        return this;
    }
    invert() {
        const d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);
        const m0 = this.m[3] * d;
        const m1 = -this.m[1] * d;
        const m2 = -this.m[2] * d;
        const m3 = this.m[0] * d;
        const m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);
        const m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);
        this.m[0] = m0;
        this.m[1] = m1;
        this.m[2] = m2;
        this.m[3] = m3;
        this.m[4] = m4;
        this.m[5] = m5;
        return this;
    }
    getMatrix() {
        return this.m;
    }
    decompose() {
        const a = this.m[0];
        const b = this.m[1];
        const c = this.m[2];
        const d = this.m[3];
        const e = this.m[4];
        const f = this.m[5];
        const delta = a * d - b * c;
        const result = {
            x: e,
            y: f,
            rotation: 0,
            scaleX: 0,
            scaleY: 0,
            skewX: 0,
            skewY: 0,
        };
        if (a != 0 || b != 0) {
            const r = Math.sqrt(a * a + b * b);
            result.rotation = b > 0 ? Math.acos(a / r) : -Math.acos(a / r);
            result.scaleX = r;
            result.scaleY = delta / r;
            result.skewX = (a * c + b * d) / delta;
            result.skewY = 0;
        }
        else if (c != 0 || d != 0) {
            const s = Math.sqrt(c * c + d * d);
            result.rotation =
                Math.PI / 2 - (d > 0 ? Math.acos(-c / s) : -Math.acos(c / s));
            result.scaleX = delta / s;
            result.scaleY = s;
            result.skewX = 0;
            result.skewY = (a * c + b * d) / delta;
        }
        else {
        }
        result.rotation = Util._getRotation(result.rotation);
        return result;
    }
}
const OBJECT_ARRAY = '[object Array]', OBJECT_NUMBER = '[object Number]', OBJECT_STRING = '[object String]', OBJECT_BOOLEAN = '[object Boolean]', PI_OVER_DEG180 = Math.PI / 180, DEG180_OVER_PI = 180 / Math.PI, HASH = '#', EMPTY_STRING = '', ZERO = '0', KONVA_WARNING = 'Konva warning: ', KONVA_ERROR = 'Konva error: ', RGB_PAREN = 'rgb(', COLORS = {
    aliceblue: [240, 248, 255],
    antiquewhite: [250, 235, 215],
    aqua: [0, 255, 255],
    aquamarine: [127, 255, 212],
    azure: [240, 255, 255],
    beige: [245, 245, 220],
    bisque: [255, 228, 196],
    black: [0, 0, 0],
    blanchedalmond: [255, 235, 205],
    blue: [0, 0, 255],
    blueviolet: [138, 43, 226],
    brown: [165, 42, 42],
    burlywood: [222, 184, 135],
    cadetblue: [95, 158, 160],
    chartreuse: [127, 255, 0],
    chocolate: [210, 105, 30],
    coral: [255, 127, 80],
    cornflowerblue: [100, 149, 237],
    cornsilk: [255, 248, 220],
    crimson: [220, 20, 60],
    cyan: [0, 255, 255],
    darkblue: [0, 0, 139],
    darkcyan: [0, 139, 139],
    darkgoldenrod: [184, 132, 11],
    darkgray: [169, 169, 169],
    darkgreen: [0, 100, 0],
    darkgrey: [169, 169, 169],
    darkkhaki: [189, 183, 107],
    darkmagenta: [139, 0, 139],
    darkolivegreen: [85, 107, 47],
    darkorange: [255, 140, 0],
    darkorchid: [153, 50, 204],
    darkred: [139, 0, 0],
    darksalmon: [233, 150, 122],
    darkseagreen: [143, 188, 143],
    darkslateblue: [72, 61, 139],
    darkslategray: [47, 79, 79],
    darkslategrey: [47, 79, 79],
    darkturquoise: [0, 206, 209],
    darkviolet: [148, 0, 211],
    deeppink: [255, 20, 147],
    deepskyblue: [0, 191, 255],
    dimgray: [105, 105, 105],
    dimgrey: [105, 105, 105],
    dodgerblue: [30, 144, 255],
    firebrick: [178, 34, 34],
    floralwhite: [255, 255, 240],
    forestgreen: [34, 139, 34],
    fuchsia: [255, 0, 255],
    gainsboro: [220, 220, 220],
    ghostwhite: [248, 248, 255],
    gold: [255, 215, 0],
    goldenrod: [218, 165, 32],
    gray: [128, 128, 128],
    green: [0, 128, 0],
    greenyellow: [173, 255, 47],
    grey: [128, 128, 128],
    honeydew: [240, 255, 240],
    hotpink: [255, 105, 180],
    indianred: [205, 92, 92],
    indigo: [75, 0, 130],
    ivory: [255, 255, 240],
    khaki: [240, 230, 140],
    lavender: [230, 230, 250],
    lavenderblush: [255, 240, 245],
    lawngreen: [124, 252, 0],
    lemonchiffon: [255, 250, 205],
    lightblue: [173, 216, 230],
    lightcoral: [240, 128, 128],
    lightcyan: [224, 255, 255],
    lightgoldenrodyellow: [250, 250, 210],
    lightgray: [211, 211, 211],
    lightgreen: [144, 238, 144],
    lightgrey: [211, 211, 211],
    lightpink: [255, 182, 193],
    lightsalmon: [255, 160, 122],
    lightseagreen: [32, 178, 170],
    lightskyblue: [135, 206, 250],
    lightslategray: [119, 136, 153],
    lightslategrey: [119, 136, 153],
    lightsteelblue: [176, 196, 222],
    lightyellow: [255, 255, 224],
    lime: [0, 255, 0],
    limegreen: [50, 205, 50],
    linen: [250, 240, 230],
    magenta: [255, 0, 255],
    maroon: [128, 0, 0],
    mediumaquamarine: [102, 205, 170],
    mediumblue: [0, 0, 205],
    mediumorchid: [186, 85, 211],
    mediumpurple: [147, 112, 219],
    mediumseagreen: [60, 179, 113],
    mediumslateblue: [123, 104, 238],
    mediumspringgreen: [0, 250, 154],
    mediumturquoise: [72, 209, 204],
    mediumvioletred: [199, 21, 133],
    midnightblue: [25, 25, 112],
    mintcream: [245, 255, 250],
    mistyrose: [255, 228, 225],
    moccasin: [255, 228, 181],
    navajowhite: [255, 222, 173],
    navy: [0, 0, 128],
    oldlace: [253, 245, 230],
    olive: [128, 128, 0],
    olivedrab: [107, 142, 35],
    orange: [255, 165, 0],
    orangered: [255, 69, 0],
    orchid: [218, 112, 214],
    palegoldenrod: [238, 232, 170],
    palegreen: [152, 251, 152],
    paleturquoise: [175, 238, 238],
    palevioletred: [219, 112, 147],
    papayawhip: [255, 239, 213],
    peachpuff: [255, 218, 185],
    peru: [205, 133, 63],
    pink: [255, 192, 203],
    plum: [221, 160, 203],
    powderblue: [176, 224, 230],
    purple: [128, 0, 128],
    rebeccapurple: [102, 51, 153],
    red: [255, 0, 0],
    rosybrown: [188, 143, 143],
    royalblue: [65, 105, 225],
    saddlebrown: [139, 69, 19],
    salmon: [250, 128, 114],
    sandybrown: [244, 164, 96],
    seagreen: [46, 139, 87],
    seashell: [255, 245, 238],
    sienna: [160, 82, 45],
    silver: [192, 192, 192],
    skyblue: [135, 206, 235],
    slateblue: [106, 90, 205],
    slategray: [119, 128, 144],
    slategrey: [119, 128, 144],
    snow: [255, 255, 250],
    springgreen: [0, 255, 127],
    steelblue: [70, 130, 180],
    tan: [210, 180, 140],
    teal: [0, 128, 128],
    thistle: [216, 191, 216],
    transparent: [255, 255, 255, 0],
    tomato: [255, 99, 71],
    turquoise: [64, 224, 208],
    violet: [238, 130, 238],
    wheat: [245, 222, 179],
    white: [255, 255, 255],
    whitesmoke: [245, 245, 245],
    yellow: [255, 255, 0],
    yellowgreen: [154, 205, 5],
}, RGB_REGEX = /rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;
let animQueue = [];
const req = (typeof requestAnimationFrame !== 'undefined' && requestAnimationFrame) ||
    function (f) {
        setTimeout(f, 60);
    };
const Util = {
    _isElement(obj) {
        return !!(obj && obj.nodeType == 1);
    },
    _isFunction(obj) {
        return !!(obj && obj.constructor && obj.call && obj.apply);
    },
    _isPlainObject(obj) {
        return !!obj && obj.constructor === Object;
    },
    _isArray(obj) {
        return Object.prototype.toString.call(obj) === OBJECT_ARRAY;
    },
    _isNumber(obj) {
        return (Object.prototype.toString.call(obj) === OBJECT_NUMBER &&
            !isNaN(obj) &&
            isFinite(obj));
    },
    _isString(obj) {
        return Object.prototype.toString.call(obj) === OBJECT_STRING;
    },
    _isBoolean(obj) {
        return Object.prototype.toString.call(obj) === OBJECT_BOOLEAN;
    },
    isObject(val) {
        return val instanceof Object;
    },
    isValidSelector(selector) {
        if (typeof selector !== 'string') {
            return false;
        }
        const firstChar = selector[0];
        return (firstChar === '#' ||
            firstChar === '.' ||
            firstChar === firstChar.toUpperCase());
    },
    _sign(number) {
        if (number === 0) {
            return 1;
        }
        if (number > 0) {
            return 1;
        }
        else {
            return -1;
        }
    },
    requestAnimFrame(callback) {
        animQueue.push(callback);
        if (animQueue.length === 1) {
            req(function () {
                const queue = animQueue;
                animQueue = [];
                queue.forEach(function (cb) {
                    cb();
                });
            });
        }
    },
    createCanvasElement() {
        ensureBrowser();
        const canvas = document.createElement('canvas');
        try {
            canvas.style = canvas.style || {};
        }
        catch (e) { }
        return canvas;
    },
    createImageElement() {
        ensureBrowser();
        return document.createElement('img');
    },
    _isInDocument(el) {
        while ((el = el.parentNode)) {
            if (el == document) {
                return true;
            }
        }
        return false;
    },
    _urlToImage(url, callback) {
        const imageObj = Util.createImageElement();
        imageObj.onload = function () {
            callback(imageObj);
        };
        imageObj.src = url;
    },
    _rgbToHex(r, g, b) {
        return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    },
    _hexToRgb(hex) {
        hex = hex.replace(HASH, EMPTY_STRING);
        const bigint = parseInt(hex, 16);
        return {
            r: (bigint >> 16) & 255,
            g: (bigint >> 8) & 255,
            b: bigint & 255,
        };
    },
    getRandomColor() {
        let randColor = ((Math.random() * 0xffffff) << 0).toString(16);
        while (randColor.length < 6) {
            randColor = ZERO + randColor;
        }
        return HASH + randColor;
    },
    getRGB(color) {
        let rgb;
        if (color in COLORS) {
            rgb = COLORS[color];
            return {
                r: rgb[0],
                g: rgb[1],
                b: rgb[2],
            };
        }
        else if (color[0] === HASH) {
            return this._hexToRgb(color.substring(1));
        }
        else if (color.substr(0, 4) === RGB_PAREN) {
            rgb = RGB_REGEX.exec(color.replace(/ /g, ''));
            return {
                r: parseInt(rgb[1], 10),
                g: parseInt(rgb[2], 10),
                b: parseInt(rgb[3], 10),
            };
        }
        else {
            return {
                r: 0,
                g: 0,
                b: 0,
            };
        }
    },
    colorToRGBA(str) {
        str = str || 'black';
        return (Util._namedColorToRBA(str) ||
            Util._hex3ColorToRGBA(str) ||
            Util._hex4ColorToRGBA(str) ||
            Util._hex6ColorToRGBA(str) ||
            Util._hex8ColorToRGBA(str) ||
            Util._rgbColorToRGBA(str) ||
            Util._rgbaColorToRGBA(str) ||
            Util._hslColorToRGBA(str));
    },
    _namedColorToRBA(str) {
        const c = COLORS[str.toLowerCase()];
        if (!c) {
            return null;
        }
        return {
            r: c[0],
            g: c[1],
            b: c[2],
            a: 1,
        };
    },
    _rgbColorToRGBA(str) {
        if (str.indexOf('rgb(') === 0) {
            str = str.match(/rgb\(([^)]+)\)/)[1];
            const parts = str.split(/ *, */).map(Number);
            return {
                r: parts[0],
                g: parts[1],
                b: parts[2],
                a: 1,
            };
        }
    },
    _rgbaColorToRGBA(str) {
        if (str.indexOf('rgba(') === 0) {
            str = str.match(/rgba\(([^)]+)\)/)[1];
            const parts = str.split(/ *, */).map((n, index) => {
                if (n.slice(-1) === '%') {
                    return index === 3 ? parseInt(n) / 100 : (parseInt(n) / 100) * 255;
                }
                return Number(n);
            });
            return {
                r: parts[0],
                g: parts[1],
                b: parts[2],
                a: parts[3],
            };
        }
    },
    _hex8ColorToRGBA(str) {
        if (str[0] === '#' && str.length === 9) {
            return {
                r: parseInt(str.slice(1, 3), 16),
                g: parseInt(str.slice(3, 5), 16),
                b: parseInt(str.slice(5, 7), 16),
                a: parseInt(str.slice(7, 9), 16) / 0xff,
            };
        }
    },
    _hex6ColorToRGBA(str) {
        if (str[0] === '#' && str.length === 7) {
            return {
                r: parseInt(str.slice(1, 3), 16),
                g: parseInt(str.slice(3, 5), 16),
                b: parseInt(str.slice(5, 7), 16),
                a: 1,
            };
        }
    },
    _hex4ColorToRGBA(str) {
        if (str[0] === '#' && str.length === 5) {
            return {
                r: parseInt(str[1] + str[1], 16),
                g: parseInt(str[2] + str[2], 16),
                b: parseInt(str[3] + str[3], 16),
                a: parseInt(str[4] + str[4], 16) / 0xff,
            };
        }
    },
    _hex3ColorToRGBA(str) {
        if (str[0] === '#' && str.length === 4) {
            return {
                r: parseInt(str[1] + str[1], 16),
                g: parseInt(str[2] + str[2], 16),
                b: parseInt(str[3] + str[3], 16),
                a: 1,
            };
        }
    },
    _hslColorToRGBA(str) {
        if (/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(str)) {
            const [_, ...hsl] = /hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(str);
            const h = Number(hsl[0]) / 360;
            const s = Number(hsl[1]) / 100;
            const l = Number(hsl[2]) / 100;
            let t2;
            let t3;
            let val;
            if (s === 0) {
                val = l * 255;
                return {
                    r: Math.round(val),
                    g: Math.round(val),
                    b: Math.round(val),
                    a: 1,
                };
            }
            if (l < 0.5) {
                t2 = l * (1 + s);
            }
            else {
                t2 = l + s - l * s;
            }
            const t1 = 2 * l - t2;
            const rgb = [0, 0, 0];
            for (let i = 0; i < 3; i++) {
                t3 = h + (1 / 3) * -(i - 1);
                if (t3 < 0) {
                    t3++;
                }
                if (t3 > 1) {
                    t3--;
                }
                if (6 * t3 < 1) {
                    val = t1 + (t2 - t1) * 6 * t3;
                }
                else if (2 * t3 < 1) {
                    val = t2;
                }
                else if (3 * t3 < 2) {
                    val = t1 + (t2 - t1) * (2 / 3 - t3) * 6;
                }
                else {
                    val = t1;
                }
                rgb[i] = val * 255;
            }
            return {
                r: Math.round(rgb[0]),
                g: Math.round(rgb[1]),
                b: Math.round(rgb[2]),
                a: 1,
            };
        }
    },
    haveIntersection(r1, r2) {
        return !(r2.x > r1.x + r1.width ||
            r2.x + r2.width < r1.x ||
            r2.y > r1.y + r1.height ||
            r2.y + r2.height < r1.y);
    },
    cloneObject(obj) {
        const retObj = {};
        for (const key in obj) {
            if (this._isPlainObject(obj[key])) {
                retObj[key] = this.cloneObject(obj[key]);
            }
            else if (this._isArray(obj[key])) {
                retObj[key] = this.cloneArray(obj[key]);
            }
            else {
                retObj[key] = obj[key];
            }
        }
        return retObj;
    },
    cloneArray(arr) {
        return arr.slice(0);
    },
    degToRad(deg) {
        return deg * PI_OVER_DEG180;
    },
    radToDeg(rad) {
        return rad * DEG180_OVER_PI;
    },
    _degToRad(deg) {
        Util.warn('Util._degToRad is removed. Please use public Util.degToRad instead.');
        return Util.degToRad(deg);
    },
    _radToDeg(rad) {
        Util.warn('Util._radToDeg is removed. Please use public Util.radToDeg instead.');
        return Util.radToDeg(rad);
    },
    _getRotation(radians) {
        return _Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.angleDeg ? Util.radToDeg(radians) : radians;
    },
    _capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    },
    throw(str) {
        throw new Error(KONVA_ERROR + str);
    },
    error(str) {
        console.error(KONVA_ERROR + str);
    },
    warn(str) {
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.showWarnings) {
            return;
        }
        console.warn(KONVA_WARNING + str);
    },
    each(obj, func) {
        for (const key in obj) {
            func(key, obj[key]);
        }
    },
    _inRange(val, left, right) {
        return left <= val && val < right;
    },
    _getProjectionToSegment(x1, y1, x2, y2, x3, y3) {
        let x, y, dist;
        const pd2 = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);
        if (pd2 == 0) {
            x = x1;
            y = y1;
            dist = (x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2);
        }
        else {
            const u = ((x3 - x1) * (x2 - x1) + (y3 - y1) * (y2 - y1)) / pd2;
            if (u < 0) {
                x = x1;
                y = y1;
                dist = (x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3);
            }
            else if (u > 1.0) {
                x = x2;
                y = y2;
                dist = (x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3);
            }
            else {
                x = x1 + u * (x2 - x1);
                y = y1 + u * (y2 - y1);
                dist = (x - x3) * (x - x3) + (y - y3) * (y - y3);
            }
        }
        return [x, y, dist];
    },
    _getProjectionToLine(pt, line, isClosed) {
        const pc = Util.cloneObject(pt);
        let dist = Number.MAX_VALUE;
        line.forEach(function (p1, i) {
            if (!isClosed && i === line.length - 1) {
                return;
            }
            const p2 = line[(i + 1) % line.length];
            const proj = Util._getProjectionToSegment(p1.x, p1.y, p2.x, p2.y, pt.x, pt.y);
            const px = proj[0], py = proj[1], pdist = proj[2];
            if (pdist < dist) {
                pc.x = px;
                pc.y = py;
                dist = pdist;
            }
        });
        return pc;
    },
    _prepareArrayForTween(startArray, endArray, isClosed) {
        const start = [], end = [];
        if (startArray.length > endArray.length) {
            const temp = endArray;
            endArray = startArray;
            startArray = temp;
        }
        for (let n = 0; n < startArray.length; n += 2) {
            start.push({
                x: startArray[n],
                y: startArray[n + 1],
            });
        }
        for (let n = 0; n < endArray.length; n += 2) {
            end.push({
                x: endArray[n],
                y: endArray[n + 1],
            });
        }
        const newStart = [];
        end.forEach(function (point) {
            const pr = Util._getProjectionToLine(point, start, isClosed);
            newStart.push(pr.x);
            newStart.push(pr.y);
        });
        return newStart;
    },
    _prepareToStringify(obj) {
        let desc;
        obj.visitedByCircularReferenceRemoval = true;
        for (const key in obj) {
            if (!(obj.hasOwnProperty(key) && obj[key] && typeof obj[key] == 'object')) {
                continue;
            }
            desc = Object.getOwnPropertyDescriptor(obj, key);
            if (obj[key].visitedByCircularReferenceRemoval ||
                Util._isElement(obj[key])) {
                if (desc.configurable) {
                    delete obj[key];
                }
                else {
                    return null;
                }
            }
            else if (Util._prepareToStringify(obj[key]) === null) {
                if (desc.configurable) {
                    delete obj[key];
                }
                else {
                    return null;
                }
            }
        }
        delete obj.visitedByCircularReferenceRemoval;
        return obj;
    },
    _assign(target, source) {
        for (const key in source) {
            target[key] = source[key];
        }
        return target;
    },
    _getFirstPointerId(evt) {
        if (!evt.touches) {
            return evt.pointerId || 999;
        }
        else {
            return evt.changedTouches[0].identifier;
        }
    },
    releaseCanvas(...canvases) {
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.releaseCanvasOnDestroy)
            return;
        canvases.forEach((c) => {
            c.width = 0;
            c.height = 0;
        });
    },
    drawRoundedRectPath(context, width, height, cornerRadius) {
        let xOrigin = width < 0 ? width : 0;
        let yOrigin = height < 0 ? height : 0;
        width = Math.abs(width);
        height = Math.abs(height);
        let topLeft = 0;
        let topRight = 0;
        let bottomLeft = 0;
        let bottomRight = 0;
        if (typeof cornerRadius === 'number') {
            topLeft =
                topRight =
                    bottomLeft =
                        bottomRight =
                            Math.min(cornerRadius, width / 2, height / 2);
        }
        else {
            topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);
            topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);
            bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);
            bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);
        }
        context.moveTo(xOrigin + topLeft, yOrigin);
        context.lineTo(xOrigin + width - topRight, yOrigin);
        context.arc(xOrigin + width - topRight, yOrigin + topRight, topRight, (Math.PI * 3) / 2, 0, false);
        context.lineTo(xOrigin + width, yOrigin + height - bottomRight);
        context.arc(xOrigin + width - bottomRight, yOrigin + height - bottomRight, bottomRight, 0, Math.PI / 2, false);
        context.lineTo(xOrigin + bottomLeft, yOrigin + height);
        context.arc(xOrigin + bottomLeft, yOrigin + height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);
        context.lineTo(xOrigin, yOrigin + topLeft);
        context.arc(xOrigin + topLeft, yOrigin + topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);
    },
    drawRoundedPolygonPath(context, points, sides, radius, cornerRadius) {
        radius = Math.abs(radius);
        for (let i = 0; i < sides; i++) {
            const prev = points[(i - 1 + sides) % sides];
            const curr = points[i];
            const next = points[(i + 1) % sides];
            const vec1 = { x: curr.x - prev.x, y: curr.y - prev.y };
            const vec2 = { x: next.x - curr.x, y: next.y - curr.y };
            const len1 = Math.hypot(vec1.x, vec1.y);
            const len2 = Math.hypot(vec2.x, vec2.y);
            let currCornerRadius;
            if (typeof cornerRadius === 'number') {
                currCornerRadius = cornerRadius;
            }
            else {
                currCornerRadius = i < cornerRadius.length ? cornerRadius[i] : 0;
            }
            const maxCornerRadius = radius * Math.cos(Math.PI / sides);
            currCornerRadius =
                maxCornerRadius * Math.min(1, (currCornerRadius / radius) * 2);
            const normalVec1 = { x: vec1.x / len1, y: vec1.y / len1 };
            const normalVec2 = { x: vec2.x / len2, y: vec2.y / len2 };
            const p1 = {
                x: curr.x - normalVec1.x * currCornerRadius,
                y: curr.y - normalVec1.y * currCornerRadius,
            };
            const p2 = {
                x: curr.x + normalVec2.x * currCornerRadius,
                y: curr.y + normalVec2.y * currCornerRadius,
            };
            if (i === 0) {
                context.moveTo(p1.x, p1.y);
            }
            else {
                context.lineTo(p1.x, p1.y);
            }
            context.arcTo(curr.x, curr.y, p2.x, p2.y, currCornerRadius);
        }
    },
};


/***/ }),

/***/ "./node_modules/konva/lib/Validators.js":
/*!**********************************************!*\
  !*** ./node_modules/konva/lib/Validators.js ***!
  \**********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RGBComponent": function() { return /* binding */ RGBComponent; },
/* harmony export */   "alphaComponent": function() { return /* binding */ alphaComponent; },
/* harmony export */   "getBooleanValidator": function() { return /* binding */ getBooleanValidator; },
/* harmony export */   "getComponentValidator": function() { return /* binding */ getComponentValidator; },
/* harmony export */   "getFunctionValidator": function() { return /* binding */ getFunctionValidator; },
/* harmony export */   "getNumberArrayValidator": function() { return /* binding */ getNumberArrayValidator; },
/* harmony export */   "getNumberOrArrayOfNumbersValidator": function() { return /* binding */ getNumberOrArrayOfNumbersValidator; },
/* harmony export */   "getNumberOrAutoValidator": function() { return /* binding */ getNumberOrAutoValidator; },
/* harmony export */   "getNumberValidator": function() { return /* binding */ getNumberValidator; },
/* harmony export */   "getStringOrGradientValidator": function() { return /* binding */ getStringOrGradientValidator; },
/* harmony export */   "getStringValidator": function() { return /* binding */ getStringValidator; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");


function _formatValue(val) {
    if (_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isString(val)) {
        return '"' + val + '"';
    }
    if (Object.prototype.toString.call(val) === '[object Number]') {
        return val;
    }
    if (_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isBoolean(val)) {
        return val;
    }
    return Object.prototype.toString.call(val);
}
function RGBComponent(val) {
    if (val > 255) {
        return 255;
    }
    else if (val < 0) {
        return 0;
    }
    return Math.round(val);
}
function alphaComponent(val) {
    if (val > 1) {
        return 1;
    }
    else if (val < 0.0001) {
        return 0.0001;
    }
    return val;
}
function getNumberValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isNumber(val)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a number.');
            }
            return val;
        };
    }
}
function getNumberOrArrayOfNumbersValidator(noOfElements) {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            let isNumber = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isNumber(val);
            let isValidArray = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isArray(val) && val.length == noOfElements;
            if (!isNumber && !isValidArray) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a number or Array<number>(' +
                    noOfElements +
                    ')');
            }
            return val;
        };
    }
}
function getNumberOrAutoValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            const isNumber = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isNumber(val);
            const isAuto = val === 'auto';
            if (!(isNumber || isAuto)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a number or "auto".');
            }
            return val;
        };
    }
}
function getStringValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isString(val)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a string.');
            }
            return val;
        };
    }
}
function getStringOrGradientValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            const isString = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isString(val);
            const isGradient = Object.prototype.toString.call(val) === '[object CanvasGradient]' ||
                (val && val['addColorStop']);
            if (!(isString || isGradient)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a string or a native gradient.');
            }
            return val;
        };
    }
}
function getFunctionValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isFunction(val)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a function.');
            }
            return val;
        };
    }
}
function getNumberArrayValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            const TypedArray = Int8Array ? Object.getPrototypeOf(Int8Array) : null;
            if (TypedArray && val instanceof TypedArray) {
                return val;
            }
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isArray(val)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a array of numbers.');
            }
            else {
                val.forEach(function (item) {
                    if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._isNumber(item)) {
                        _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn('"' +
                            attr +
                            '" attribute has non numeric element ' +
                            item +
                            '. Make sure that all elements are numbers.');
                    }
                });
            }
            return val;
        };
    }
}
function getBooleanValidator() {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            const isBool = val === true || val === false;
            if (!isBool) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be a boolean.');
            }
            return val;
        };
    }
}
function getComponentValidator(components) {
    if (_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva.isUnminified) {
        return function (val, attr) {
            if (val === undefined || val === null) {
                return val;
            }
            if (!_Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.isObject(val)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.warn(_formatValue(val) +
                    ' is a not valid value for "' +
                    attr +
                    '" attribute. The value should be an object with properties ' +
                    components);
            }
            return val;
        };
    }
}


/***/ }),

/***/ "./node_modules/konva/lib/_CoreInternals.js":
/*!**************************************************!*\
  !*** ./node_modules/konva/lib/_CoreInternals.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Konva": function() { return /* binding */ Konva; }
/* harmony export */ });
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Container.js */ "./node_modules/konva/lib/Container.js");
/* harmony import */ var _Stage_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Stage.js */ "./node_modules/konva/lib/Stage.js");
/* harmony import */ var _Layer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Layer.js */ "./node_modules/konva/lib/Layer.js");
/* harmony import */ var _FastLayer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./FastLayer.js */ "./node_modules/konva/lib/FastLayer.js");
/* harmony import */ var _Group_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Group.js */ "./node_modules/konva/lib/Group.js");
/* harmony import */ var _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./DragAndDrop.js */ "./node_modules/konva/lib/DragAndDrop.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Animation_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Animation.js */ "./node_modules/konva/lib/Animation.js");
/* harmony import */ var _Tween_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Tween.js */ "./node_modules/konva/lib/Tween.js");
/* harmony import */ var _Context_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Context.js */ "./node_modules/konva/lib/Context.js");
/* harmony import */ var _Canvas_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Canvas.js */ "./node_modules/konva/lib/Canvas.js");














const Konva = _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util._assign(_Global_js__WEBPACK_IMPORTED_MODULE_0__.Konva, {
    Util: _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util,
    Transform: _Util_js__WEBPACK_IMPORTED_MODULE_1__.Transform,
    Node: _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node,
    Container: _Container_js__WEBPACK_IMPORTED_MODULE_3__.Container,
    Stage: _Stage_js__WEBPACK_IMPORTED_MODULE_4__.Stage,
    stages: _Stage_js__WEBPACK_IMPORTED_MODULE_4__.stages,
    Layer: _Layer_js__WEBPACK_IMPORTED_MODULE_5__.Layer,
    FastLayer: _FastLayer_js__WEBPACK_IMPORTED_MODULE_6__.FastLayer,
    Group: _Group_js__WEBPACK_IMPORTED_MODULE_7__.Group,
    DD: _DragAndDrop_js__WEBPACK_IMPORTED_MODULE_8__.DD,
    Shape: _Shape_js__WEBPACK_IMPORTED_MODULE_9__.Shape,
    shapes: _Shape_js__WEBPACK_IMPORTED_MODULE_9__.shapes,
    Animation: _Animation_js__WEBPACK_IMPORTED_MODULE_10__.Animation,
    Tween: _Tween_js__WEBPACK_IMPORTED_MODULE_11__.Tween,
    Easings: _Tween_js__WEBPACK_IMPORTED_MODULE_11__.Easings,
    Context: _Context_js__WEBPACK_IMPORTED_MODULE_12__.Context,
    Canvas: _Canvas_js__WEBPACK_IMPORTED_MODULE_13__.Canvas,
});
/* harmony default export */ __webpack_exports__["default"] = (Konva);


/***/ }),

/***/ "./node_modules/konva/lib/_FullInternals.js":
/*!**************************************************!*\
  !*** ./node_modules/konva/lib/_FullInternals.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Konva": function() { return /* binding */ Konva; }
/* harmony export */ });
/* harmony import */ var _CoreInternals_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_CoreInternals.js */ "./node_modules/konva/lib/_CoreInternals.js");
/* harmony import */ var _shapes_Arc_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shapes/Arc.js */ "./node_modules/konva/lib/shapes/Arc.js");
/* harmony import */ var _shapes_Arrow_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shapes/Arrow.js */ "./node_modules/konva/lib/shapes/Arrow.js");
/* harmony import */ var _shapes_Circle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./shapes/Circle.js */ "./node_modules/konva/lib/shapes/Circle.js");
/* harmony import */ var _shapes_Ellipse_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./shapes/Ellipse.js */ "./node_modules/konva/lib/shapes/Ellipse.js");
/* harmony import */ var _shapes_Image_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./shapes/Image.js */ "./node_modules/konva/lib/shapes/Image.js");
/* harmony import */ var _shapes_Label_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./shapes/Label.js */ "./node_modules/konva/lib/shapes/Label.js");
/* harmony import */ var _shapes_Line_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./shapes/Line.js */ "./node_modules/konva/lib/shapes/Line.js");
/* harmony import */ var _shapes_Path_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./shapes/Path.js */ "./node_modules/konva/lib/shapes/Path.js");
/* harmony import */ var _shapes_Rect_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./shapes/Rect.js */ "./node_modules/konva/lib/shapes/Rect.js");
/* harmony import */ var _shapes_RegularPolygon_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./shapes/RegularPolygon.js */ "./node_modules/konva/lib/shapes/RegularPolygon.js");
/* harmony import */ var _shapes_Ring_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./shapes/Ring.js */ "./node_modules/konva/lib/shapes/Ring.js");
/* harmony import */ var _shapes_Sprite_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./shapes/Sprite.js */ "./node_modules/konva/lib/shapes/Sprite.js");
/* harmony import */ var _shapes_Star_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./shapes/Star.js */ "./node_modules/konva/lib/shapes/Star.js");
/* harmony import */ var _shapes_Text_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./shapes/Text.js */ "./node_modules/konva/lib/shapes/Text.js");
/* harmony import */ var _shapes_TextPath_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./shapes/TextPath.js */ "./node_modules/konva/lib/shapes/TextPath.js");
/* harmony import */ var _shapes_Transformer_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./shapes/Transformer.js */ "./node_modules/konva/lib/shapes/Transformer.js");
/* harmony import */ var _shapes_Wedge_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./shapes/Wedge.js */ "./node_modules/konva/lib/shapes/Wedge.js");
/* harmony import */ var _filters_Blur_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./filters/Blur.js */ "./node_modules/konva/lib/filters/Blur.js");
/* harmony import */ var _filters_Brighten_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./filters/Brighten.js */ "./node_modules/konva/lib/filters/Brighten.js");
/* harmony import */ var _filters_Brightness_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./filters/Brightness.js */ "./node_modules/konva/lib/filters/Brightness.js");
/* harmony import */ var _filters_Contrast_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./filters/Contrast.js */ "./node_modules/konva/lib/filters/Contrast.js");
/* harmony import */ var _filters_Emboss_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./filters/Emboss.js */ "./node_modules/konva/lib/filters/Emboss.js");
/* harmony import */ var _filters_Enhance_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./filters/Enhance.js */ "./node_modules/konva/lib/filters/Enhance.js");
/* harmony import */ var _filters_Grayscale_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./filters/Grayscale.js */ "./node_modules/konva/lib/filters/Grayscale.js");
/* harmony import */ var _filters_HSL_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./filters/HSL.js */ "./node_modules/konva/lib/filters/HSL.js");
/* harmony import */ var _filters_HSV_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./filters/HSV.js */ "./node_modules/konva/lib/filters/HSV.js");
/* harmony import */ var _filters_Invert_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./filters/Invert.js */ "./node_modules/konva/lib/filters/Invert.js");
/* harmony import */ var _filters_Kaleidoscope_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./filters/Kaleidoscope.js */ "./node_modules/konva/lib/filters/Kaleidoscope.js");
/* harmony import */ var _filters_Mask_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./filters/Mask.js */ "./node_modules/konva/lib/filters/Mask.js");
/* harmony import */ var _filters_Noise_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./filters/Noise.js */ "./node_modules/konva/lib/filters/Noise.js");
/* harmony import */ var _filters_Pixelate_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./filters/Pixelate.js */ "./node_modules/konva/lib/filters/Pixelate.js");
/* harmony import */ var _filters_Posterize_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./filters/Posterize.js */ "./node_modules/konva/lib/filters/Posterize.js");
/* harmony import */ var _filters_RGB_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./filters/RGB.js */ "./node_modules/konva/lib/filters/RGB.js");
/* harmony import */ var _filters_RGBA_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./filters/RGBA.js */ "./node_modules/konva/lib/filters/RGBA.js");
/* harmony import */ var _filters_Sepia_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./filters/Sepia.js */ "./node_modules/konva/lib/filters/Sepia.js");
/* harmony import */ var _filters_Solarize_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./filters/Solarize.js */ "./node_modules/konva/lib/filters/Solarize.js");
/* harmony import */ var _filters_Threshold_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./filters/Threshold.js */ "./node_modules/konva/lib/filters/Threshold.js");






































const Konva = _CoreInternals_js__WEBPACK_IMPORTED_MODULE_0__.Konva.Util._assign(_CoreInternals_js__WEBPACK_IMPORTED_MODULE_0__.Konva, {
    Arc: _shapes_Arc_js__WEBPACK_IMPORTED_MODULE_1__.Arc,
    Arrow: _shapes_Arrow_js__WEBPACK_IMPORTED_MODULE_2__.Arrow,
    Circle: _shapes_Circle_js__WEBPACK_IMPORTED_MODULE_3__.Circle,
    Ellipse: _shapes_Ellipse_js__WEBPACK_IMPORTED_MODULE_4__.Ellipse,
    Image: _shapes_Image_js__WEBPACK_IMPORTED_MODULE_5__.Image,
    Label: _shapes_Label_js__WEBPACK_IMPORTED_MODULE_6__.Label,
    Tag: _shapes_Label_js__WEBPACK_IMPORTED_MODULE_6__.Tag,
    Line: _shapes_Line_js__WEBPACK_IMPORTED_MODULE_7__.Line,
    Path: _shapes_Path_js__WEBPACK_IMPORTED_MODULE_8__.Path,
    Rect: _shapes_Rect_js__WEBPACK_IMPORTED_MODULE_9__.Rect,
    RegularPolygon: _shapes_RegularPolygon_js__WEBPACK_IMPORTED_MODULE_10__.RegularPolygon,
    Ring: _shapes_Ring_js__WEBPACK_IMPORTED_MODULE_11__.Ring,
    Sprite: _shapes_Sprite_js__WEBPACK_IMPORTED_MODULE_12__.Sprite,
    Star: _shapes_Star_js__WEBPACK_IMPORTED_MODULE_13__.Star,
    Text: _shapes_Text_js__WEBPACK_IMPORTED_MODULE_14__.Text,
    TextPath: _shapes_TextPath_js__WEBPACK_IMPORTED_MODULE_15__.TextPath,
    Transformer: _shapes_Transformer_js__WEBPACK_IMPORTED_MODULE_16__.Transformer,
    Wedge: _shapes_Wedge_js__WEBPACK_IMPORTED_MODULE_17__.Wedge,
    Filters: {
        Blur: _filters_Blur_js__WEBPACK_IMPORTED_MODULE_18__.Blur,
        Brightness: _filters_Brightness_js__WEBPACK_IMPORTED_MODULE_20__.Brightness,
        Brighten: _filters_Brighten_js__WEBPACK_IMPORTED_MODULE_19__.Brighten,
        Contrast: _filters_Contrast_js__WEBPACK_IMPORTED_MODULE_21__.Contrast,
        Emboss: _filters_Emboss_js__WEBPACK_IMPORTED_MODULE_22__.Emboss,
        Enhance: _filters_Enhance_js__WEBPACK_IMPORTED_MODULE_23__.Enhance,
        Grayscale: _filters_Grayscale_js__WEBPACK_IMPORTED_MODULE_24__.Grayscale,
        HSL: _filters_HSL_js__WEBPACK_IMPORTED_MODULE_25__.HSL,
        HSV: _filters_HSV_js__WEBPACK_IMPORTED_MODULE_26__.HSV,
        Invert: _filters_Invert_js__WEBPACK_IMPORTED_MODULE_27__.Invert,
        Kaleidoscope: _filters_Kaleidoscope_js__WEBPACK_IMPORTED_MODULE_28__.Kaleidoscope,
        Mask: _filters_Mask_js__WEBPACK_IMPORTED_MODULE_29__.Mask,
        Noise: _filters_Noise_js__WEBPACK_IMPORTED_MODULE_30__.Noise,
        Pixelate: _filters_Pixelate_js__WEBPACK_IMPORTED_MODULE_31__.Pixelate,
        Posterize: _filters_Posterize_js__WEBPACK_IMPORTED_MODULE_32__.Posterize,
        RGB: _filters_RGB_js__WEBPACK_IMPORTED_MODULE_33__.RGB,
        RGBA: _filters_RGBA_js__WEBPACK_IMPORTED_MODULE_34__.RGBA,
        Sepia: _filters_Sepia_js__WEBPACK_IMPORTED_MODULE_35__.Sepia,
        Solarize: _filters_Solarize_js__WEBPACK_IMPORTED_MODULE_36__.Solarize,
        Threshold: _filters_Threshold_js__WEBPACK_IMPORTED_MODULE_37__.Threshold,
    },
});


/***/ }),

/***/ "./node_modules/konva/lib/filters/Blur.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/filters/Blur.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Blur": function() { return /* binding */ Blur; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



function BlurStack() {
    this.r = 0;
    this.g = 0;
    this.b = 0;
    this.a = 0;
    this.next = null;
}
const mul_table = [
    512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292,
    512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292,
    273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259,
    496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292,
    282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373,
    364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259,
    507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381,
    374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292,
    287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461,
    454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373,
    368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309,
    305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259,
    257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442,
    437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381,
    377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332,
    329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292,
    289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259,
];
const shg_table = [
    9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17,
    17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19,
    19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
    20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
    21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22,
    22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
    22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23,
    23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
    23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
    23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
    24, 24, 24, 24, 24, 24, 24,
];
function filterGaussBlurRGBA(imageData, radius) {
    const pixels = imageData.data, width = imageData.width, height = imageData.height;
    let p, yi, yw, r_sum, g_sum, b_sum, a_sum, r_out_sum, g_out_sum, b_out_sum, a_out_sum, r_in_sum, g_in_sum, b_in_sum, a_in_sum, pr, pg, pb, pa, rbs;
    const div = radius + radius + 1, widthMinus1 = width - 1, heightMinus1 = height - 1, radiusPlus1 = radius + 1, sumFactor = (radiusPlus1 * (radiusPlus1 + 1)) / 2, stackStart = new BlurStack(), mul_sum = mul_table[radius], shg_sum = shg_table[radius];
    let stackEnd = null, stack = stackStart, stackIn = null, stackOut = null;
    for (let i = 1; i < div; i++) {
        stack = stack.next = new BlurStack();
        if (i === radiusPlus1) {
            stackEnd = stack;
        }
    }
    stack.next = stackStart;
    yw = yi = 0;
    for (let y = 0; y < height; y++) {
        r_in_sum =
            g_in_sum =
                b_in_sum =
                    a_in_sum =
                        r_sum =
                            g_sum =
                                b_sum =
                                    a_sum =
                                        0;
        r_out_sum = radiusPlus1 * (pr = pixels[yi]);
        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
        a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);
        r_sum += sumFactor * pr;
        g_sum += sumFactor * pg;
        b_sum += sumFactor * pb;
        a_sum += sumFactor * pa;
        stack = stackStart;
        for (let i = 0; i < radiusPlus1; i++) {
            stack.r = pr;
            stack.g = pg;
            stack.b = pb;
            stack.a = pa;
            stack = stack.next;
        }
        for (let i = 1; i < radiusPlus1; i++) {
            p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);
            r_sum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);
            g_sum += (stack.g = pg = pixels[p + 1]) * rbs;
            b_sum += (stack.b = pb = pixels[p + 2]) * rbs;
            a_sum += (stack.a = pa = pixels[p + 3]) * rbs;
            r_in_sum += pr;
            g_in_sum += pg;
            b_in_sum += pb;
            a_in_sum += pa;
            stack = stack.next;
        }
        stackIn = stackStart;
        stackOut = stackEnd;
        for (let x = 0; x < width; x++) {
            pixels[yi + 3] = pa = (a_sum * mul_sum) >> shg_sum;
            if (pa !== 0) {
                pa = 255 / pa;
                pixels[yi] = ((r_sum * mul_sum) >> shg_sum) * pa;
                pixels[yi + 1] = ((g_sum * mul_sum) >> shg_sum) * pa;
                pixels[yi + 2] = ((b_sum * mul_sum) >> shg_sum) * pa;
            }
            else {
                pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;
            }
            r_sum -= r_out_sum;
            g_sum -= g_out_sum;
            b_sum -= b_out_sum;
            a_sum -= a_out_sum;
            r_out_sum -= stackIn.r;
            g_out_sum -= stackIn.g;
            b_out_sum -= stackIn.b;
            a_out_sum -= stackIn.a;
            p = (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;
            r_in_sum += stackIn.r = pixels[p];
            g_in_sum += stackIn.g = pixels[p + 1];
            b_in_sum += stackIn.b = pixels[p + 2];
            a_in_sum += stackIn.a = pixels[p + 3];
            r_sum += r_in_sum;
            g_sum += g_in_sum;
            b_sum += b_in_sum;
            a_sum += a_in_sum;
            stackIn = stackIn.next;
            r_out_sum += pr = stackOut.r;
            g_out_sum += pg = stackOut.g;
            b_out_sum += pb = stackOut.b;
            a_out_sum += pa = stackOut.a;
            r_in_sum -= pr;
            g_in_sum -= pg;
            b_in_sum -= pb;
            a_in_sum -= pa;
            stackOut = stackOut.next;
            yi += 4;
        }
        yw += width;
    }
    for (let x = 0; x < width; x++) {
        g_in_sum =
            b_in_sum =
                a_in_sum =
                    r_in_sum =
                        g_sum =
                            b_sum =
                                a_sum =
                                    r_sum =
                                        0;
        yi = x << 2;
        r_out_sum = radiusPlus1 * (pr = pixels[yi]);
        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
        a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);
        r_sum += sumFactor * pr;
        g_sum += sumFactor * pg;
        b_sum += sumFactor * pb;
        a_sum += sumFactor * pa;
        stack = stackStart;
        for (let i = 0; i < radiusPlus1; i++) {
            stack.r = pr;
            stack.g = pg;
            stack.b = pb;
            stack.a = pa;
            stack = stack.next;
        }
        let yp = width;
        for (let i = 1; i <= radius; i++) {
            yi = (yp + x) << 2;
            r_sum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);
            g_sum += (stack.g = pg = pixels[yi + 1]) * rbs;
            b_sum += (stack.b = pb = pixels[yi + 2]) * rbs;
            a_sum += (stack.a = pa = pixels[yi + 3]) * rbs;
            r_in_sum += pr;
            g_in_sum += pg;
            b_in_sum += pb;
            a_in_sum += pa;
            stack = stack.next;
            if (i < heightMinus1) {
                yp += width;
            }
        }
        yi = x;
        stackIn = stackStart;
        stackOut = stackEnd;
        for (let y = 0; y < height; y++) {
            p = yi << 2;
            pixels[p + 3] = pa = (a_sum * mul_sum) >> shg_sum;
            if (pa > 0) {
                pa = 255 / pa;
                pixels[p] = ((r_sum * mul_sum) >> shg_sum) * pa;
                pixels[p + 1] = ((g_sum * mul_sum) >> shg_sum) * pa;
                pixels[p + 2] = ((b_sum * mul_sum) >> shg_sum) * pa;
            }
            else {
                pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;
            }
            r_sum -= r_out_sum;
            g_sum -= g_out_sum;
            b_sum -= b_out_sum;
            a_sum -= a_out_sum;
            r_out_sum -= stackIn.r;
            g_out_sum -= stackIn.g;
            b_out_sum -= stackIn.b;
            a_out_sum -= stackIn.a;
            p =
                (x +
                    ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width) <<
                    2;
            r_sum += r_in_sum += stackIn.r = pixels[p];
            g_sum += g_in_sum += stackIn.g = pixels[p + 1];
            b_sum += b_in_sum += stackIn.b = pixels[p + 2];
            a_sum += a_in_sum += stackIn.a = pixels[p + 3];
            stackIn = stackIn.next;
            r_out_sum += pr = stackOut.r;
            g_out_sum += pg = stackOut.g;
            b_out_sum += pb = stackOut.b;
            a_out_sum += pa = stackOut.a;
            r_in_sum -= pr;
            g_in_sum -= pg;
            b_in_sum -= pb;
            a_in_sum -= pa;
            stackOut = stackOut.next;
            yi += width;
        }
    }
}
const Blur = function Blur(imageData) {
    const radius = Math.round(this.blurRadius());
    if (radius > 0) {
        filterGaussBlurRGBA(imageData, radius);
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'blurRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Brighten.js":
/*!****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Brighten.js ***!
  \****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Brighten": function() { return /* binding */ Brighten; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Brighten = function (imageData) {
    const brightness = this.brightness() * 255, data = imageData.data, len = data.length;
    for (let i = 0; i < len; i += 4) {
        data[i] += brightness;
        data[i + 1] += brightness;
        data[i + 2] += brightness;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'brightness', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Brightness.js":
/*!******************************************************!*\
  !*** ./node_modules/konva/lib/filters/Brightness.js ***!
  \******************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Brightness": function() { return /* binding */ Brightness; }
/* harmony export */ });
const Brightness = function (imageData) {
    const brightness = this.brightness(), data = imageData.data, len = data.length;
    for (let i = 0; i < len; i += 4) {
        data[i] = Math.min(255, data[i] * brightness);
        data[i + 1] = Math.min(255, data[i + 1] * brightness);
        data[i + 2] = Math.min(255, data[i + 2] * brightness);
    }
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/Contrast.js":
/*!****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Contrast.js ***!
  \****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Contrast": function() { return /* binding */ Contrast; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Contrast = function (imageData) {
    const adjust = Math.pow((this.contrast() + 100) / 100, 2);
    const data = imageData.data, nPixels = data.length;
    let red = 150, green = 150, blue = 150;
    for (let i = 0; i < nPixels; i += 4) {
        red = data[i];
        green = data[i + 1];
        blue = data[i + 2];
        red /= 255;
        red -= 0.5;
        red *= adjust;
        red += 0.5;
        red *= 255;
        green /= 255;
        green -= 0.5;
        green *= adjust;
        green += 0.5;
        green *= 255;
        blue /= 255;
        blue -= 0.5;
        blue *= adjust;
        blue += 0.5;
        blue *= 255;
        red = red < 0 ? 0 : red > 255 ? 255 : red;
        green = green < 0 ? 0 : green > 255 ? 255 : green;
        blue = blue < 0 ? 0 : blue > 255 ? 255 : blue;
        data[i] = red;
        data[i + 1] = green;
        data[i + 2] = blue;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'contrast', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Emboss.js":
/*!**************************************************!*\
  !*** ./node_modules/konva/lib/filters/Emboss.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Emboss": function() { return /* binding */ Emboss; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Emboss = function (imageData) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j;
    const data = imageData.data;
    const w = imageData.width;
    const h = imageData.height;
    const strength01 = Math.min(1, Math.max(0, (_b = (_a = this.embossStrength) === null || _a === void 0 ? void 0 : _a.call(this)) !== null && _b !== void 0 ? _b : 0.5));
    const whiteLevel01 = Math.min(1, Math.max(0, (_d = (_c = this.embossWhiteLevel) === null || _c === void 0 ? void 0 : _c.call(this)) !== null && _d !== void 0 ? _d : 0.5));
    const directionMap = {
        'top-left': 315,
        top: 270,
        'top-right': 225,
        right: 180,
        'bottom-right': 135,
        bottom: 90,
        'bottom-left': 45,
        left: 0,
    };
    const directionDeg = (_g = directionMap[(_f = (_e = this.embossDirection) === null || _e === void 0 ? void 0 : _e.call(this)) !== null && _f !== void 0 ? _f : 'top-left']) !== null && _g !== void 0 ? _g : 315;
    const blend = !!((_j = (_h = this.embossBlend) === null || _h === void 0 ? void 0 : _h.call(this)) !== null && _j !== void 0 ? _j : false);
    const strength = strength01 * 10;
    const bias = whiteLevel01 * 255;
    const dirRad = (directionDeg * Math.PI) / 180;
    const cx = Math.cos(dirRad);
    const cy = Math.sin(dirRad);
    const SCALE = (128 / 1020) * strength;
    const src = new Uint8ClampedArray(data);
    const lum = new Float32Array(w * h);
    for (let p = 0, i = 0; i < data.length; i += 4, p++) {
        lum[p] = 0.2126 * src[i] + 0.7152 * src[i + 1] + 0.0722 * src[i + 2];
    }
    const Gx = [-1, 0, 1, -2, 0, 2, -1, 0, 1];
    const Gy = [-1, -2, -1, 0, 0, 0, 1, 2, 1];
    const OFF = [-w - 1, -w, -w + 1, -1, 0, 1, w - 1, w, w + 1];
    const clamp8 = (v) => (v < 0 ? 0 : v > 255 ? 255 : v);
    for (let y = 1; y < h - 1; y++) {
        for (let x = 1; x < w - 1; x++) {
            const p = y * w + x;
            let sx = 0, sy = 0;
            sx += lum[p + OFF[0]] * Gx[0];
            sy += lum[p + OFF[0]] * Gy[0];
            sx += lum[p + OFF[1]] * Gx[1];
            sy += lum[p + OFF[1]] * Gy[1];
            sx += lum[p + OFF[2]] * Gx[2];
            sy += lum[p + OFF[2]] * Gy[2];
            sx += lum[p + OFF[3]] * Gx[3];
            sy += lum[p + OFF[3]] * Gy[3];
            sx += lum[p + OFF[5]] * Gx[5];
            sy += lum[p + OFF[5]] * Gy[5];
            sx += lum[p + OFF[6]] * Gx[6];
            sy += lum[p + OFF[6]] * Gy[6];
            sx += lum[p + OFF[7]] * Gx[7];
            sy += lum[p + OFF[7]] * Gy[7];
            sx += lum[p + OFF[8]] * Gx[8];
            sy += lum[p + OFF[8]] * Gy[8];
            const r = cx * sx + cy * sy;
            const outGray = clamp8(bias + r * SCALE);
            const o = p * 4;
            if (blend) {
                const delta = outGray - bias;
                data[o] = clamp8(src[o] + delta);
                data[o + 1] = clamp8(src[o + 1] + delta);
                data[o + 2] = clamp8(src[o + 2] + delta);
                data[o + 3] = src[o + 3];
            }
            else {
                data[o] = data[o + 1] = data[o + 2] = outGray;
                data[o + 3] = src[o + 3];
            }
        }
    }
    for (let x = 0; x < w; x++) {
        let oTop = x * 4, oBot = ((h - 1) * w + x) * 4;
        data[oTop] = src[oTop];
        data[oTop + 1] = src[oTop + 1];
        data[oTop + 2] = src[oTop + 2];
        data[oTop + 3] = src[oTop + 3];
        data[oBot] = src[oBot];
        data[oBot + 1] = src[oBot + 1];
        data[oBot + 2] = src[oBot + 2];
        data[oBot + 3] = src[oBot + 3];
    }
    for (let y = 1; y < h - 1; y++) {
        let oL = y * w * 4, oR = (y * w + (w - 1)) * 4;
        data[oL] = src[oL];
        data[oL + 1] = src[oL + 1];
        data[oL + 2] = src[oL + 2];
        data[oL + 3] = src[oL + 3];
        data[oR] = src[oR];
        data[oR + 1] = src[oR + 1];
        data[oR + 2] = src[oR + 2];
        data[oR + 3] = src[oR + 3];
    }
    return imageData;
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'embossStrength', 0.5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'embossWhiteLevel', 0.5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'embossDirection', 'top-left', undefined, _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'embossBlend', false, undefined, _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Enhance.js":
/*!***************************************************!*\
  !*** ./node_modules/konva/lib/filters/Enhance.js ***!
  \***************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Enhance": function() { return /* binding */ Enhance; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



function remap(fromValue, fromMin, fromMax, toMin, toMax) {
    const fromRange = fromMax - fromMin, toRange = toMax - toMin;
    if (fromRange === 0) {
        return toMin + toRange / 2;
    }
    if (toRange === 0) {
        return toMin;
    }
    let toValue = (fromValue - fromMin) / fromRange;
    toValue = toRange * toValue + toMin;
    return toValue;
}
const Enhance = function (imageData) {
    const data = imageData.data, nSubPixels = data.length;
    let rMin = data[0], rMax = rMin, r, gMin = data[1], gMax = gMin, g, bMin = data[2], bMax = bMin, b;
    const enhanceAmount = this.enhance();
    if (enhanceAmount === 0) {
        return;
    }
    for (let i = 0; i < nSubPixels; i += 4) {
        r = data[i + 0];
        if (r < rMin) {
            rMin = r;
        }
        else if (r > rMax) {
            rMax = r;
        }
        g = data[i + 1];
        if (g < gMin) {
            gMin = g;
        }
        else if (g > gMax) {
            gMax = g;
        }
        b = data[i + 2];
        if (b < bMin) {
            bMin = b;
        }
        else if (b > bMax) {
            bMax = b;
        }
    }
    if (rMax === rMin) {
        rMax = 255;
        rMin = 0;
    }
    if (gMax === gMin) {
        gMax = 255;
        gMin = 0;
    }
    if (bMax === bMin) {
        bMax = 255;
        bMin = 0;
    }
    let rGoalMax, rGoalMin, gGoalMax, gGoalMin, bGoalMax, bGoalMin;
    if (enhanceAmount > 0) {
        rGoalMax = rMax + enhanceAmount * (255 - rMax);
        rGoalMin = rMin - enhanceAmount * (rMin - 0);
        gGoalMax = gMax + enhanceAmount * (255 - gMax);
        gGoalMin = gMin - enhanceAmount * (gMin - 0);
        bGoalMax = bMax + enhanceAmount * (255 - bMax);
        bGoalMin = bMin - enhanceAmount * (bMin - 0);
    }
    else {
        const rMid = (rMax + rMin) * 0.5;
        rGoalMax = rMax + enhanceAmount * (rMax - rMid);
        rGoalMin = rMin + enhanceAmount * (rMin - rMid);
        const gMid = (gMax + gMin) * 0.5;
        gGoalMax = gMax + enhanceAmount * (gMax - gMid);
        gGoalMin = gMin + enhanceAmount * (gMin - gMid);
        const bMid = (bMax + bMin) * 0.5;
        bGoalMax = bMax + enhanceAmount * (bMax - bMid);
        bGoalMin = bMin + enhanceAmount * (bMin - bMid);
    }
    for (let i = 0; i < nSubPixels; i += 4) {
        data[i + 0] = remap(data[i + 0], rMin, rMax, rGoalMin, rGoalMax);
        data[i + 1] = remap(data[i + 1], gMin, gMax, gGoalMin, gGoalMax);
        data[i + 2] = remap(data[i + 2], bMin, bMax, bGoalMin, bGoalMax);
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'enhance', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Grayscale.js":
/*!*****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Grayscale.js ***!
  \*****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Grayscale": function() { return /* binding */ Grayscale; }
/* harmony export */ });
const Grayscale = function (imageData) {
    const data = imageData.data, len = data.length;
    for (let i = 0; i < len; i += 4) {
        const brightness = 0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2];
        data[i] = brightness;
        data[i + 1] = brightness;
        data[i + 2] = brightness;
    }
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/HSL.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/filters/HSL.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HSL": function() { return /* binding */ HSL; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'hue', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'saturation', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'luminance', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
const HSL = function (imageData) {
    const data = imageData.data, nPixels = data.length, v = 1, s = Math.pow(2, this.saturation()), h = Math.abs(this.hue() + 360) % 360, l = this.luminance() * 127;
    const vsu = v * s * Math.cos((h * Math.PI) / 180), vsw = v * s * Math.sin((h * Math.PI) / 180);
    const rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw, rg = 0.587 * v - 0.587 * vsu + 0.33 * vsw, rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;
    const gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw, gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw, gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;
    const br = 0.299 * v - 0.3 * vsu + 1.25 * vsw, bg = 0.587 * v - 0.586 * vsu - 1.05 * vsw, bb = 0.114 * v + 0.886 * vsu - 0.2 * vsw;
    let r, g, b, a;
    for (let i = 0; i < nPixels; i += 4) {
        r = data[i + 0];
        g = data[i + 1];
        b = data[i + 2];
        a = data[i + 3];
        data[i + 0] = rr * r + rg * g + rb * b + l;
        data[i + 1] = gr * r + gg * g + gb * b + l;
        data[i + 2] = br * r + bg * g + bb * b + l;
        data[i + 3] = a;
    }
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/HSV.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/filters/HSV.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HSV": function() { return /* binding */ HSV; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const HSV = function (imageData) {
    const data = imageData.data, nPixels = data.length, v = Math.pow(2, this.value()), s = Math.pow(2, this.saturation()), h = Math.abs(this.hue() + 360) % 360;
    const vsu = v * s * Math.cos((h * Math.PI) / 180), vsw = v * s * Math.sin((h * Math.PI) / 180);
    const rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw, rg = 0.587 * v - 0.587 * vsu + 0.33 * vsw, rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;
    const gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw, gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw, gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;
    const br = 0.299 * v - 0.3 * vsu + 1.25 * vsw, bg = 0.587 * v - 0.586 * vsu - 1.05 * vsw, bb = 0.114 * v + 0.886 * vsu - 0.2 * vsw;
    for (let i = 0; i < nPixels; i += 4) {
        const r = data[i + 0];
        const g = data[i + 1];
        const b = data[i + 2];
        const a = data[i + 3];
        data[i + 0] = rr * r + rg * g + rb * b;
        data[i + 1] = gr * r + gg * g + gb * b;
        data[i + 2] = br * r + bg * g + bb * b;
        data[i + 3] = a;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'hue', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'saturation', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'value', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Invert.js":
/*!**************************************************!*\
  !*** ./node_modules/konva/lib/filters/Invert.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Invert": function() { return /* binding */ Invert; }
/* harmony export */ });
const Invert = function (imageData) {
    const data = imageData.data, len = data.length;
    for (let i = 0; i < len; i += 4) {
        data[i] = 255 - data[i];
        data[i + 1] = 255 - data[i + 1];
        data[i + 2] = 255 - data[i + 2];
    }
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/Kaleidoscope.js":
/*!********************************************************!*\
  !*** ./node_modules/konva/lib/filters/Kaleidoscope.js ***!
  \********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Kaleidoscope": function() { return /* binding */ Kaleidoscope; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");




const ToPolar = function (src, dst, opt) {
    const srcPixels = src.data, dstPixels = dst.data, xSize = src.width, ySize = src.height, xMid = opt.polarCenterX || xSize / 2, yMid = opt.polarCenterY || ySize / 2;
    let rMax = Math.sqrt(xMid * xMid + yMid * yMid);
    let x = xSize - xMid;
    let y = ySize - yMid;
    const rad = Math.sqrt(x * x + y * y);
    rMax = rad > rMax ? rad : rMax;
    const rSize = ySize, tSize = xSize;
    const conversion = ((360 / tSize) * Math.PI) / 180;
    for (let theta = 0; theta < tSize; theta += 1) {
        const sin = Math.sin(theta * conversion);
        const cos = Math.cos(theta * conversion);
        for (let radius = 0; radius < rSize; radius += 1) {
            x = Math.floor(xMid + ((rMax * radius) / rSize) * cos);
            y = Math.floor(yMid + ((rMax * radius) / rSize) * sin);
            let i = (y * xSize + x) * 4;
            const r = srcPixels[i + 0];
            const g = srcPixels[i + 1];
            const b = srcPixels[i + 2];
            const a = srcPixels[i + 3];
            i = (theta + radius * xSize) * 4;
            dstPixels[i + 0] = r;
            dstPixels[i + 1] = g;
            dstPixels[i + 2] = b;
            dstPixels[i + 3] = a;
        }
    }
};
const FromPolar = function (src, dst, opt) {
    const srcPixels = src.data, dstPixels = dst.data, xSize = src.width, ySize = src.height, xMid = opt.polarCenterX || xSize / 2, yMid = opt.polarCenterY || ySize / 2;
    let rMax = Math.sqrt(xMid * xMid + yMid * yMid);
    let x = xSize - xMid;
    let y = ySize - yMid;
    const rad = Math.sqrt(x * x + y * y);
    rMax = rad > rMax ? rad : rMax;
    const rSize = ySize, tSize = xSize, phaseShift = opt.polarRotation || 0;
    let x1, y1;
    for (x = 0; x < xSize; x += 1) {
        for (y = 0; y < ySize; y += 1) {
            const dx = x - xMid;
            const dy = y - yMid;
            const radius = (Math.sqrt(dx * dx + dy * dy) * rSize) / rMax;
            let theta = ((Math.atan2(dy, dx) * 180) / Math.PI + 360 + phaseShift) % 360;
            theta = (theta * tSize) / 360;
            x1 = Math.floor(theta);
            y1 = Math.floor(radius);
            let i = (y1 * xSize + x1) * 4;
            const r = srcPixels[i + 0];
            const g = srcPixels[i + 1];
            const b = srcPixels[i + 2];
            const a = srcPixels[i + 3];
            i = (y * xSize + x) * 4;
            dstPixels[i + 0] = r;
            dstPixels[i + 1] = g;
            dstPixels[i + 2] = b;
            dstPixels[i + 3] = a;
        }
    }
};
const Kaleidoscope = function (imageData) {
    const xSize = imageData.width, ySize = imageData.height;
    let x, y, xoff, i, r, g, b, a, srcPos, dstPos;
    let power = Math.round(this.kaleidoscopePower());
    const angle = Math.round(this.kaleidoscopeAngle());
    const offset = Math.floor((xSize * (angle % 360)) / 360);
    if (power < 1) {
        return;
    }
    const tempCanvas = _Util_js__WEBPACK_IMPORTED_MODULE_2__.Util.createCanvasElement();
    tempCanvas.width = xSize;
    tempCanvas.height = ySize;
    const scratchData = tempCanvas
        .getContext('2d')
        .getImageData(0, 0, xSize, ySize);
    _Util_js__WEBPACK_IMPORTED_MODULE_2__.Util.releaseCanvas(tempCanvas);
    ToPolar(imageData, scratchData, {
        polarCenterX: xSize / 2,
        polarCenterY: ySize / 2,
    });
    let minSectionSize = xSize / Math.pow(2, power);
    while (minSectionSize <= 8) {
        minSectionSize = minSectionSize * 2;
        power -= 1;
    }
    minSectionSize = Math.ceil(minSectionSize);
    let sectionSize = minSectionSize;
    let xStart = 0, xEnd = sectionSize, xDelta = 1;
    if (offset + minSectionSize > xSize) {
        xStart = sectionSize;
        xEnd = 0;
        xDelta = -1;
    }
    for (y = 0; y < ySize; y += 1) {
        for (x = xStart; x !== xEnd; x += xDelta) {
            xoff = Math.round(x + offset) % xSize;
            srcPos = (xSize * y + xoff) * 4;
            r = scratchData.data[srcPos + 0];
            g = scratchData.data[srcPos + 1];
            b = scratchData.data[srcPos + 2];
            a = scratchData.data[srcPos + 3];
            dstPos = (xSize * y + x) * 4;
            scratchData.data[dstPos + 0] = r;
            scratchData.data[dstPos + 1] = g;
            scratchData.data[dstPos + 2] = b;
            scratchData.data[dstPos + 3] = a;
        }
    }
    for (y = 0; y < ySize; y += 1) {
        sectionSize = Math.floor(minSectionSize);
        for (i = 0; i < power; i += 1) {
            for (x = 0; x < sectionSize + 1; x += 1) {
                srcPos = (xSize * y + x) * 4;
                r = scratchData.data[srcPos + 0];
                g = scratchData.data[srcPos + 1];
                b = scratchData.data[srcPos + 2];
                a = scratchData.data[srcPos + 3];
                dstPos = (xSize * y + sectionSize * 2 - x - 1) * 4;
                scratchData.data[dstPos + 0] = r;
                scratchData.data[dstPos + 1] = g;
                scratchData.data[dstPos + 2] = b;
                scratchData.data[dstPos + 3] = a;
            }
            sectionSize *= 2;
        }
    }
    FromPolar(scratchData, imageData, { polarRotation: 0 });
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'kaleidoscopePower', 2, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'kaleidoscopeAngle', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Mask.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/filters/Mask.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Mask": function() { return /* binding */ Mask; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



function pixelAt(idata, x, y) {
    let idx = (y * idata.width + x) * 4;
    const d = [];
    d.push(idata.data[idx++], idata.data[idx++], idata.data[idx++], idata.data[idx++]);
    return d;
}
function rgbDistance(p1, p2) {
    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) +
        Math.pow(p1[1] - p2[1], 2) +
        Math.pow(p1[2] - p2[2], 2));
}
function rgbMean(pTab) {
    const m = [0, 0, 0];
    for (let i = 0; i < pTab.length; i++) {
        m[0] += pTab[i][0];
        m[1] += pTab[i][1];
        m[2] += pTab[i][2];
    }
    m[0] /= pTab.length;
    m[1] /= pTab.length;
    m[2] /= pTab.length;
    return m;
}
function backgroundMask(idata, threshold) {
    const rgbv_no = pixelAt(idata, 0, 0);
    const rgbv_ne = pixelAt(idata, idata.width - 1, 0);
    const rgbv_so = pixelAt(idata, 0, idata.height - 1);
    const rgbv_se = pixelAt(idata, idata.width - 1, idata.height - 1);
    const thres = threshold || 10;
    if (rgbDistance(rgbv_no, rgbv_ne) < thres &&
        rgbDistance(rgbv_ne, rgbv_se) < thres &&
        rgbDistance(rgbv_se, rgbv_so) < thres &&
        rgbDistance(rgbv_so, rgbv_no) < thres) {
        const mean = rgbMean([rgbv_ne, rgbv_no, rgbv_se, rgbv_so]);
        const mask = [];
        for (let i = 0; i < idata.width * idata.height; i++) {
            const d = rgbDistance(mean, [
                idata.data[i * 4],
                idata.data[i * 4 + 1],
                idata.data[i * 4 + 2],
            ]);
            mask[i] = d < thres ? 0 : 255;
        }
        return mask;
    }
}
function applyMask(idata, mask) {
    for (let i = 0; i < idata.width * idata.height; i++) {
        idata.data[4 * i + 3] = mask[i];
    }
}
function erodeMask(mask, sw, sh) {
    const weights = [1, 1, 1, 1, 0, 1, 1, 1, 1];
    const side = Math.round(Math.sqrt(weights.length));
    const halfSide = Math.floor(side / 2);
    const maskResult = [];
    for (let y = 0; y < sh; y++) {
        for (let x = 0; x < sw; x++) {
            const so = y * sw + x;
            let a = 0;
            for (let cy = 0; cy < side; cy++) {
                for (let cx = 0; cx < side; cx++) {
                    const scy = y + cy - halfSide;
                    const scx = x + cx - halfSide;
                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {
                        const srcOff = scy * sw + scx;
                        const wt = weights[cy * side + cx];
                        a += mask[srcOff] * wt;
                    }
                }
            }
            maskResult[so] = a === 255 * 8 ? 255 : 0;
        }
    }
    return maskResult;
}
function dilateMask(mask, sw, sh) {
    const weights = [1, 1, 1, 1, 1, 1, 1, 1, 1];
    const side = Math.round(Math.sqrt(weights.length));
    const halfSide = Math.floor(side / 2);
    const maskResult = [];
    for (let y = 0; y < sh; y++) {
        for (let x = 0; x < sw; x++) {
            const so = y * sw + x;
            let a = 0;
            for (let cy = 0; cy < side; cy++) {
                for (let cx = 0; cx < side; cx++) {
                    const scy = y + cy - halfSide;
                    const scx = x + cx - halfSide;
                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {
                        const srcOff = scy * sw + scx;
                        const wt = weights[cy * side + cx];
                        a += mask[srcOff] * wt;
                    }
                }
            }
            maskResult[so] = a >= 255 * 4 ? 255 : 0;
        }
    }
    return maskResult;
}
function smoothEdgeMask(mask, sw, sh) {
    const weights = [
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
        1 / 9,
    ];
    const side = Math.round(Math.sqrt(weights.length));
    const halfSide = Math.floor(side / 2);
    const maskResult = [];
    for (let y = 0; y < sh; y++) {
        for (let x = 0; x < sw; x++) {
            const so = y * sw + x;
            let a = 0;
            for (let cy = 0; cy < side; cy++) {
                for (let cx = 0; cx < side; cx++) {
                    const scy = y + cy - halfSide;
                    const scx = x + cx - halfSide;
                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {
                        const srcOff = scy * sw + scx;
                        const wt = weights[cy * side + cx];
                        a += mask[srcOff] * wt;
                    }
                }
            }
            maskResult[so] = a;
        }
    }
    return maskResult;
}
const Mask = function (imageData) {
    const threshold = this.threshold();
    let mask = backgroundMask(imageData, threshold);
    if (mask) {
        mask = erodeMask(mask, imageData.width, imageData.height);
        mask = dilateMask(mask, imageData.width, imageData.height);
        mask = smoothEdgeMask(mask, imageData.width, imageData.height);
        applyMask(imageData, mask);
    }
    return imageData;
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'threshold', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Noise.js":
/*!*************************************************!*\
  !*** ./node_modules/konva/lib/filters/Noise.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Noise": function() { return /* binding */ Noise; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Noise = function (imageData) {
    const amount = this.noise() * 255, data = imageData.data, nPixels = data.length, half = amount / 2;
    for (let i = 0; i < nPixels; i += 4) {
        data[i + 0] += half - 2 * half * Math.random();
        data[i + 1] += half - 2 * half * Math.random();
        data[i + 2] += half - 2 * half * Math.random();
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'noise', 0.2, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Pixelate.js":
/*!****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Pixelate.js ***!
  \****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Pixelate": function() { return /* binding */ Pixelate; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");




const Pixelate = function (imageData) {
    let pixelSize = Math.ceil(this.pixelSize()), width = imageData.width, height = imageData.height, nBinsX = Math.ceil(width / pixelSize), nBinsY = Math.ceil(height / pixelSize), data = imageData.data;
    if (pixelSize <= 0) {
        _Util_js__WEBPACK_IMPORTED_MODULE_1__.Util.error('pixelSize value can not be <= 0');
        return;
    }
    for (let xBin = 0; xBin < nBinsX; xBin += 1) {
        for (let yBin = 0; yBin < nBinsY; yBin += 1) {
            let red = 0;
            let green = 0;
            let blue = 0;
            let alpha = 0;
            const xBinStart = xBin * pixelSize;
            const xBinEnd = xBinStart + pixelSize;
            const yBinStart = yBin * pixelSize;
            const yBinEnd = yBinStart + pixelSize;
            let pixelsInBin = 0;
            for (let x = xBinStart; x < xBinEnd; x += 1) {
                if (x >= width) {
                    continue;
                }
                for (let y = yBinStart; y < yBinEnd; y += 1) {
                    if (y >= height) {
                        continue;
                    }
                    const i = (width * y + x) * 4;
                    red += data[i + 0];
                    green += data[i + 1];
                    blue += data[i + 2];
                    alpha += data[i + 3];
                    pixelsInBin += 1;
                }
            }
            red = red / pixelsInBin;
            green = green / pixelsInBin;
            blue = blue / pixelsInBin;
            alpha = alpha / pixelsInBin;
            for (let x = xBinStart; x < xBinEnd; x += 1) {
                if (x >= width) {
                    continue;
                }
                for (let y = yBinStart; y < yBinEnd; y += 1) {
                    if (y >= height) {
                        continue;
                    }
                    const i = (width * y + x) * 4;
                    data[i + 0] = red;
                    data[i + 1] = green;
                    data[i + 2] = blue;
                    data[i + 3] = alpha;
                }
            }
        }
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_2__.Node, 'pixelSize', 8, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/Posterize.js":
/*!*****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Posterize.js ***!
  \*****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Posterize": function() { return /* binding */ Posterize; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Posterize = function (imageData) {
    const levels = Math.round(this.levels() * 254) + 1, data = imageData.data, len = data.length, scale = 255 / levels;
    for (let i = 0; i < len; i += 1) {
        data[i] = Math.floor(data[i] / scale) * scale;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'levels', 0.5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/RGB.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/filters/RGB.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RGB": function() { return /* binding */ RGB; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const RGB = function (imageData) {
    const data = imageData.data, nPixels = data.length, red = this.red(), green = this.green(), blue = this.blue();
    for (let i = 0; i < nPixels; i += 4) {
        const brightness = (0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2]) / 255;
        data[i] = brightness * red;
        data[i + 1] = brightness * green;
        data[i + 2] = brightness * blue;
        data[i + 3] = data[i + 3];
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'red', 0, function (val) {
    this._filterUpToDate = false;
    if (val > 255) {
        return 255;
    }
    else if (val < 0) {
        return 0;
    }
    else {
        return Math.round(val);
    }
});
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'green', 0, function (val) {
    this._filterUpToDate = false;
    if (val > 255) {
        return 255;
    }
    else if (val < 0) {
        return 0;
    }
    else {
        return Math.round(val);
    }
});
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'blue', 0, _Validators_js__WEBPACK_IMPORTED_MODULE_2__.RGBComponent, _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/filters/RGBA.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/filters/RGBA.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RGBA": function() { return /* binding */ RGBA; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const RGBA = function (imageData) {
    const data = imageData.data, nPixels = data.length, red = this.red(), green = this.green(), blue = this.blue(), alpha = this.alpha();
    for (let i = 0; i < nPixels; i += 4) {
        const ia = 1 - alpha;
        data[i] = red * alpha + data[i] * ia;
        data[i + 1] = green * alpha + data[i + 1] * ia;
        data[i + 2] = blue * alpha + data[i + 2] * ia;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'red', 0, function (val) {
    this._filterUpToDate = false;
    if (val > 255) {
        return 255;
    }
    else if (val < 0) {
        return 0;
    }
    else {
        return Math.round(val);
    }
});
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'green', 0, function (val) {
    this._filterUpToDate = false;
    if (val > 255) {
        return 255;
    }
    else if (val < 0) {
        return 0;
    }
    else {
        return Math.round(val);
    }
});
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'blue', 0, _Validators_js__WEBPACK_IMPORTED_MODULE_2__.RGBComponent, _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'alpha', 1, function (val) {
    this._filterUpToDate = false;
    if (val > 1) {
        return 1;
    }
    else if (val < 0) {
        return 0;
    }
    else {
        return val;
    }
});


/***/ }),

/***/ "./node_modules/konva/lib/filters/Sepia.js":
/*!*************************************************!*\
  !*** ./node_modules/konva/lib/filters/Sepia.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Sepia": function() { return /* binding */ Sepia; }
/* harmony export */ });
const Sepia = function (imageData) {
    const data = imageData.data, nPixels = data.length;
    for (let i = 0; i < nPixels; i += 4) {
        const r = data[i + 0];
        const g = data[i + 1];
        const b = data[i + 2];
        data[i + 0] = Math.min(255, r * 0.393 + g * 0.769 + b * 0.189);
        data[i + 1] = Math.min(255, r * 0.349 + g * 0.686 + b * 0.168);
        data[i + 2] = Math.min(255, r * 0.272 + g * 0.534 + b * 0.131);
    }
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/Solarize.js":
/*!****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Solarize.js ***!
  \****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Solarize": function() { return /* binding */ Solarize; }
/* harmony export */ });
const Solarize = function (imageData) {
    const threshold = 128;
    const d = imageData.data;
    for (let i = 0; i < d.length; i += 4) {
        const r = d[i], g = d[i + 1], b = d[i + 2];
        const L = 0.2126 * r + 0.7152 * g + 0.0722 * b;
        if (L >= threshold) {
            d[i] = 255 - r;
            d[i + 1] = 255 - g;
            d[i + 2] = 255 - b;
        }
    }
    return imageData;
};


/***/ }),

/***/ "./node_modules/konva/lib/filters/Threshold.js":
/*!*****************************************************!*\
  !*** ./node_modules/konva/lib/filters/Threshold.js ***!
  \*****************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Threshold": function() { return /* binding */ Threshold; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");



const Threshold = function (imageData) {
    const level = this.threshold() * 255, data = imageData.data, len = data.length;
    for (let i = 0; i < len; i += 1) {
        data[i] = data[i] < level ? 0 : 255;
    }
};
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(_Node_js__WEBPACK_IMPORTED_MODULE_1__.Node, 'threshold', 0.5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)(), _Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.afterSetFilter);


/***/ }),

/***/ "./node_modules/konva/lib/index.js":
/*!*****************************************!*\
  !*** ./node_modules/konva/lib/index.js ***!
  \*****************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _FullInternals_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_FullInternals.js */ "./node_modules/konva/lib/_FullInternals.js");

/* harmony default export */ __webpack_exports__["default"] = (_FullInternals_js__WEBPACK_IMPORTED_MODULE_0__.Konva);


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Arc.js":
/*!**********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Arc.js ***!
  \**********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Arc": function() { return /* binding */ Arc; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");





class Arc extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const angle = _Global_js__WEBPACK_IMPORTED_MODULE_2__.Konva.getAngle(this.angle()), clockwise = this.clockwise();
        context.beginPath();
        context.arc(0, 0, this.outerRadius(), 0, angle, clockwise);
        context.arc(0, 0, this.innerRadius(), angle, 0, !clockwise);
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.outerRadius() * 2;
    }
    getHeight() {
        return this.outerRadius() * 2;
    }
    setWidth(width) {
        this.outerRadius(width / 2);
    }
    setHeight(height) {
        this.outerRadius(height / 2);
    }
    getSelfRect() {
        const innerRadius = this.innerRadius();
        const outerRadius = this.outerRadius();
        const clockwise = this.clockwise();
        const angle = _Global_js__WEBPACK_IMPORTED_MODULE_2__.Konva.getAngle(clockwise ? 360 - this.angle() : this.angle());
        const boundLeftRatio = Math.cos(Math.min(angle, Math.PI));
        const boundRightRatio = 1;
        const boundTopRatio = Math.sin(Math.min(Math.max(Math.PI, angle), (3 * Math.PI) / 2));
        const boundBottomRatio = Math.sin(Math.min(angle, Math.PI / 2));
        const boundLeft = boundLeftRatio * (boundLeftRatio > 0 ? innerRadius : outerRadius);
        const boundRight = boundRightRatio * (boundRightRatio > 0 ? outerRadius : innerRadius);
        const boundTop = boundTopRatio * (boundTopRatio > 0 ? innerRadius : outerRadius);
        const boundBottom = boundBottomRatio * (boundBottomRatio > 0 ? outerRadius : innerRadius);
        return {
            x: boundLeft,
            y: clockwise ? -1 * boundBottom : boundTop,
            width: boundRight - boundLeft,
            height: boundBottom - boundTop,
        };
    }
}
Arc.prototype._centroid = true;
Arc.prototype.className = 'Arc';
Arc.prototype._attrsAffectingSize = [
    'innerRadius',
    'outerRadius',
    'angle',
    'clockwise',
];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_2__._registerNode)(Arc);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arc, 'innerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arc, 'outerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arc, 'angle', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arc, 'clockwise', false, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getBooleanValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Arrow.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Arrow.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Arrow": function() { return /* binding */ Arrow; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Line_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Line.js */ "./node_modules/konva/lib/shapes/Line.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Path_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Path.js */ "./node_modules/konva/lib/shapes/Path.js");





class Arrow extends _Line_js__WEBPACK_IMPORTED_MODULE_1__.Line {
    _sceneFunc(ctx) {
        super._sceneFunc(ctx);
        const PI2 = Math.PI * 2;
        const points = this.points();
        let tp = points;
        const fromTension = this.tension() !== 0 && points.length > 4;
        if (fromTension) {
            tp = this.getTensionPoints();
        }
        const length = this.pointerLength();
        const n = points.length;
        let dx, dy;
        if (fromTension) {
            const lp = [
                tp[tp.length - 4],
                tp[tp.length - 3],
                tp[tp.length - 2],
                tp[tp.length - 1],
                points[n - 2],
                points[n - 1],
            ];
            const lastLength = _Path_js__WEBPACK_IMPORTED_MODULE_4__.Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);
            const previous = _Path_js__WEBPACK_IMPORTED_MODULE_4__.Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);
            dx = points[n - 2] - previous.x;
            dy = points[n - 1] - previous.y;
        }
        else {
            dx = points[n - 2] - points[n - 4];
            dy = points[n - 1] - points[n - 3];
        }
        const radians = (Math.atan2(dy, dx) + PI2) % PI2;
        const width = this.pointerWidth();
        if (this.pointerAtEnding()) {
            ctx.save();
            ctx.beginPath();
            ctx.translate(points[n - 2], points[n - 1]);
            ctx.rotate(radians);
            ctx.moveTo(0, 0);
            ctx.lineTo(-length, width / 2);
            ctx.lineTo(-length, -width / 2);
            ctx.closePath();
            ctx.restore();
            this.__fillStroke(ctx);
        }
        if (this.pointerAtBeginning()) {
            ctx.save();
            ctx.beginPath();
            ctx.translate(points[0], points[1]);
            if (fromTension) {
                dx = (tp[0] + tp[2]) / 2 - points[0];
                dy = (tp[1] + tp[3]) / 2 - points[1];
            }
            else {
                dx = points[2] - points[0];
                dy = points[3] - points[1];
            }
            ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);
            ctx.moveTo(0, 0);
            ctx.lineTo(-length, width / 2);
            ctx.lineTo(-length, -width / 2);
            ctx.closePath();
            ctx.restore();
            this.__fillStroke(ctx);
        }
    }
    __fillStroke(ctx) {
        const isDashEnabled = this.dashEnabled();
        if (isDashEnabled) {
            this.attrs.dashEnabled = false;
            ctx.setLineDash([]);
        }
        ctx.fillStrokeShape(this);
        if (isDashEnabled) {
            this.attrs.dashEnabled = true;
        }
    }
    getSelfRect() {
        const lineRect = super.getSelfRect();
        const offset = this.pointerWidth() / 2;
        return {
            x: lineRect.x,
            y: lineRect.y - offset,
            width: lineRect.width,
            height: lineRect.height + offset * 2,
        };
    }
}
Arrow.prototype.className = 'Arrow';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Arrow);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arrow, 'pointerLength', 10, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arrow, 'pointerWidth', 10, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arrow, 'pointerAtBeginning', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Arrow, 'pointerAtEnding', true);


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Circle.js":
/*!*************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Circle.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Circle": function() { return /* binding */ Circle; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");




class Circle extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        context.beginPath();
        context.arc(0, 0, this.attrs.radius || 0, 0, Math.PI * 2, false);
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.radius() * 2;
    }
    getHeight() {
        return this.radius() * 2;
    }
    setWidth(width) {
        if (this.radius() !== width / 2) {
            this.radius(width / 2);
        }
    }
    setHeight(height) {
        if (this.radius() !== height / 2) {
            this.radius(height / 2);
        }
    }
}
Circle.prototype._centroid = true;
Circle.prototype.className = 'Circle';
Circle.prototype._attrsAffectingSize = ['radius'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Circle);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Circle, 'radius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Ellipse.js":
/*!**************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Ellipse.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Ellipse": function() { return /* binding */ Ellipse; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");




class Ellipse extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const rx = this.radiusX(), ry = this.radiusY();
        context.beginPath();
        context.save();
        if (rx !== ry) {
            context.scale(1, ry / rx);
        }
        context.arc(0, 0, rx, 0, Math.PI * 2, false);
        context.restore();
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.radiusX() * 2;
    }
    getHeight() {
        return this.radiusY() * 2;
    }
    setWidth(width) {
        this.radiusX(width / 2);
    }
    setHeight(height) {
        this.radiusY(height / 2);
    }
}
Ellipse.prototype.className = 'Ellipse';
Ellipse.prototype._centroid = true;
Ellipse.prototype._attrsAffectingSize = ['radiusX', 'radiusY'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Ellipse);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addComponentsGetterSetter(Ellipse, 'radius', ['x', 'y']);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Ellipse, 'radiusX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Ellipse, 'radiusY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Image.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Image.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Image": function() { return /* binding */ Image; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");





class Image extends _Shape_js__WEBPACK_IMPORTED_MODULE_2__.Shape {
    constructor(attrs) {
        super(attrs);
        this._loadListener = () => {
            this._requestDraw();
        };
        this.on('imageChange.konva', (props) => {
            this._removeImageLoad(props.oldVal);
            this._setImageLoad();
        });
        this._setImageLoad();
    }
    _setImageLoad() {
        const image = this.image();
        if (image && image.complete) {
            return;
        }
        if (image && image.readyState === 4) {
            return;
        }
        if (image && image['addEventListener']) {
            image['addEventListener']('load', this._loadListener);
        }
    }
    _removeImageLoad(image) {
        if (image && image['removeEventListener']) {
            image['removeEventListener']('load', this._loadListener);
        }
    }
    destroy() {
        this._removeImageLoad(this.image());
        super.destroy();
        return this;
    }
    _useBufferCanvas() {
        const hasCornerRadius = !!this.cornerRadius();
        const hasShadow = this.hasShadow();
        if (hasCornerRadius && hasShadow) {
            return true;
        }
        return super._useBufferCanvas(true);
    }
    _sceneFunc(context) {
        const width = this.getWidth();
        const height = this.getHeight();
        const cornerRadius = this.cornerRadius();
        const image = this.attrs.image;
        let params;
        if (image) {
            const cropWidth = this.attrs.cropWidth;
            const cropHeight = this.attrs.cropHeight;
            if (cropWidth && cropHeight) {
                params = [
                    image,
                    this.cropX(),
                    this.cropY(),
                    cropWidth,
                    cropHeight,
                    0,
                    0,
                    width,
                    height,
                ];
            }
            else {
                params = [image, 0, 0, width, height];
            }
        }
        if (this.hasFill() || this.hasStroke() || cornerRadius) {
            context.beginPath();
            cornerRadius
                ? _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.drawRoundedRectPath(context, width, height, cornerRadius)
                : context.rect(0, 0, width, height);
            context.closePath();
            context.fillStrokeShape(this);
        }
        if (image) {
            if (cornerRadius) {
                context.clip();
            }
            context.drawImage.apply(context, params);
        }
    }
    _hitFunc(context) {
        const width = this.width(), height = this.height(), cornerRadius = this.cornerRadius();
        context.beginPath();
        if (!cornerRadius) {
            context.rect(0, 0, width, height);
        }
        else {
            _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.drawRoundedRectPath(context, width, height, cornerRadius);
        }
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        var _a, _b;
        return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.width;
    }
    getHeight() {
        var _a, _b;
        return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.height;
    }
    static fromURL(url, callback, onError = null) {
        const img = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createImageElement();
        img.onload = function () {
            const image = new Image({
                image: img,
            });
            callback(image);
        };
        img.onerror = onError;
        img.crossOrigin = 'Anonymous';
        img.src = url;
    }
}
Image.prototype.className = 'Image';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Image);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'cornerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberOrArrayOfNumbersValidator)(4));
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'image');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'cropX', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'cropY', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'cropWidth', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Image, 'cropHeight', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Label.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Label.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Label": function() { return /* binding */ Label; },
/* harmony export */   "Tag": function() { return /* binding */ Tag; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Group_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Group.js */ "./node_modules/konva/lib/Group.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");





const ATTR_CHANGE_LIST = [
    'fontFamily',
    'fontSize',
    'fontStyle',
    'padding',
    'lineHeight',
    'text',
    'width',
    'height',
    'pointerDirection',
    'pointerWidth',
    'pointerHeight',
], CHANGE_KONVA = 'Change.konva', NONE = 'none', UP = 'up', RIGHT = 'right', DOWN = 'down', LEFT = 'left', attrChangeListLen = ATTR_CHANGE_LIST.length;
class Label extends _Group_js__WEBPACK_IMPORTED_MODULE_2__.Group {
    constructor(config) {
        super(config);
        this.on('add.konva', function (evt) {
            this._addListeners(evt.child);
            this._sync();
        });
    }
    getText() {
        return this.find('Text')[0];
    }
    getTag() {
        return this.find('Tag')[0];
    }
    _addListeners(text) {
        let that = this, n;
        const func = function () {
            that._sync();
        };
        for (n = 0; n < attrChangeListLen; n++) {
            text.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, func);
        }
    }
    getWidth() {
        return this.getText().width();
    }
    getHeight() {
        return this.getText().height();
    }
    _sync() {
        let text = this.getText(), tag = this.getTag(), width, height, pointerDirection, pointerWidth, x, y, pointerHeight;
        if (text && tag) {
            width = text.width();
            height = text.height();
            pointerDirection = tag.pointerDirection();
            pointerWidth = tag.pointerWidth();
            pointerHeight = tag.pointerHeight();
            x = 0;
            y = 0;
            switch (pointerDirection) {
                case UP:
                    x = width / 2;
                    y = -1 * pointerHeight;
                    break;
                case RIGHT:
                    x = width + pointerWidth;
                    y = height / 2;
                    break;
                case DOWN:
                    x = width / 2;
                    y = height + pointerHeight;
                    break;
                case LEFT:
                    x = -1 * pointerWidth;
                    y = height / 2;
                    break;
            }
            tag.setAttrs({
                x: -1 * x,
                y: -1 * y,
                width: width,
                height: height,
            });
            text.setAttrs({
                x: -1 * x,
                y: -1 * y,
            });
        }
    }
}
Label.prototype.className = 'Label';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_4__._registerNode)(Label);
class Tag extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const width = this.width(), height = this.height(), pointerDirection = this.pointerDirection(), pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), cornerRadius = this.cornerRadius();
        let topLeft = 0;
        let topRight = 0;
        let bottomLeft = 0;
        let bottomRight = 0;
        if (typeof cornerRadius === 'number') {
            topLeft =
                topRight =
                    bottomLeft =
                        bottomRight =
                            Math.min(cornerRadius, width / 2, height / 2);
        }
        else {
            topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);
            topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);
            bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);
            bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);
        }
        context.beginPath();
        context.moveTo(topLeft, 0);
        if (pointerDirection === UP) {
            context.lineTo((width - pointerWidth) / 2, 0);
            context.lineTo(width / 2, -1 * pointerHeight);
            context.lineTo((width + pointerWidth) / 2, 0);
        }
        context.lineTo(width - topRight, 0);
        context.arc(width - topRight, topRight, topRight, (Math.PI * 3) / 2, 0, false);
        if (pointerDirection === RIGHT) {
            context.lineTo(width, (height - pointerHeight) / 2);
            context.lineTo(width + pointerWidth, height / 2);
            context.lineTo(width, (height + pointerHeight) / 2);
        }
        context.lineTo(width, height - bottomRight);
        context.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, false);
        if (pointerDirection === DOWN) {
            context.lineTo((width + pointerWidth) / 2, height);
            context.lineTo(width / 2, height + pointerHeight);
            context.lineTo((width - pointerWidth) / 2, height);
        }
        context.lineTo(bottomLeft, height);
        context.arc(bottomLeft, height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);
        if (pointerDirection === LEFT) {
            context.lineTo(0, (height + pointerHeight) / 2);
            context.lineTo(-1 * pointerWidth, height / 2);
            context.lineTo(0, (height - pointerHeight) / 2);
        }
        context.lineTo(0, topLeft);
        context.arc(topLeft, topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);
        context.closePath();
        context.fillStrokeShape(this);
    }
    getSelfRect() {
        let x = 0, y = 0, pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), direction = this.pointerDirection(), width = this.width(), height = this.height();
        if (direction === UP) {
            y -= pointerHeight;
            height += pointerHeight;
        }
        else if (direction === DOWN) {
            height += pointerHeight;
        }
        else if (direction === LEFT) {
            x -= pointerWidth * 1.5;
            width += pointerWidth;
        }
        else if (direction === RIGHT) {
            width += pointerWidth * 1.5;
        }
        return {
            x: x,
            y: y,
            width: width,
            height: height,
        };
    }
}
Tag.prototype.className = 'Tag';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_4__._registerNode)(Tag);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Tag, 'pointerDirection', NONE);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Tag, 'pointerWidth', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Tag, 'pointerHeight', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Tag, 'cornerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberOrArrayOfNumbersValidator)(4));


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Line.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Line.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Line": function() { return /* binding */ Line; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");




function getControlPoints(x0, y0, x1, y1, x2, y2, t) {
    const d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2)), d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)), fa = (t * d01) / (d01 + d12), fb = (t * d12) / (d01 + d12), p1x = x1 - fa * (x2 - x0), p1y = y1 - fa * (y2 - y0), p2x = x1 + fb * (x2 - x0), p2y = y1 + fb * (y2 - y0);
    return [p1x, p1y, p2x, p2y];
}
function expandPoints(p, tension) {
    const len = p.length, allPoints = [];
    for (let n = 2; n < len - 2; n += 2) {
        const cp = getControlPoints(p[n - 2], p[n - 1], p[n], p[n + 1], p[n + 2], p[n + 3], tension);
        if (isNaN(cp[0])) {
            continue;
        }
        allPoints.push(cp[0]);
        allPoints.push(cp[1]);
        allPoints.push(p[n]);
        allPoints.push(p[n + 1]);
        allPoints.push(cp[2]);
        allPoints.push(cp[3]);
    }
    return allPoints;
}
class Line extends _Shape_js__WEBPACK_IMPORTED_MODULE_2__.Shape {
    constructor(config) {
        super(config);
        this.on('pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva', function () {
            this._clearCache('tensionPoints');
        });
    }
    _sceneFunc(context) {
        const points = this.points(), length = points.length, tension = this.tension(), closed = this.closed(), bezier = this.bezier();
        if (!length) {
            return;
        }
        let n = 0;
        context.beginPath();
        context.moveTo(points[0], points[1]);
        if (tension !== 0 && length > 4) {
            const tp = this.getTensionPoints();
            const len = tp.length;
            n = closed ? 0 : 4;
            if (!closed) {
                context.quadraticCurveTo(tp[0], tp[1], tp[2], tp[3]);
            }
            while (n < len - 2) {
                context.bezierCurveTo(tp[n++], tp[n++], tp[n++], tp[n++], tp[n++], tp[n++]);
            }
            if (!closed) {
                context.quadraticCurveTo(tp[len - 2], tp[len - 1], points[length - 2], points[length - 1]);
            }
        }
        else if (bezier) {
            n = 2;
            while (n < length) {
                context.bezierCurveTo(points[n++], points[n++], points[n++], points[n++], points[n++], points[n++]);
            }
        }
        else {
            for (n = 2; n < length; n += 2) {
                context.lineTo(points[n], points[n + 1]);
            }
        }
        if (closed) {
            context.closePath();
            context.fillStrokeShape(this);
        }
        else {
            context.strokeShape(this);
        }
    }
    getTensionPoints() {
        return this._getCache('tensionPoints', this._getTensionPoints);
    }
    _getTensionPoints() {
        if (this.closed()) {
            return this._getTensionPointsClosed();
        }
        else {
            return expandPoints(this.points(), this.tension());
        }
    }
    _getTensionPointsClosed() {
        const p = this.points(), len = p.length, tension = this.tension(), firstControlPoints = getControlPoints(p[len - 2], p[len - 1], p[0], p[1], p[2], p[3], tension), lastControlPoints = getControlPoints(p[len - 4], p[len - 3], p[len - 2], p[len - 1], p[0], p[1], tension), middle = expandPoints(p, tension), tp = [firstControlPoints[2], firstControlPoints[3]]
            .concat(middle)
            .concat([
            lastControlPoints[0],
            lastControlPoints[1],
            p[len - 2],
            p[len - 1],
            lastControlPoints[2],
            lastControlPoints[3],
            firstControlPoints[0],
            firstControlPoints[1],
            p[0],
            p[1],
        ]);
        return tp;
    }
    getWidth() {
        return this.getSelfRect().width;
    }
    getHeight() {
        return this.getSelfRect().height;
    }
    getSelfRect() {
        let points = this.points();
        if (points.length < 4) {
            return {
                x: points[0] || 0,
                y: points[1] || 0,
                width: 0,
                height: 0,
            };
        }
        if (this.tension() !== 0) {
            points = [
                points[0],
                points[1],
                ...this._getTensionPoints(),
                points[points.length - 2],
                points[points.length - 1],
            ];
        }
        else {
            points = this.points();
        }
        let minX = points[0];
        let maxX = points[0];
        let minY = points[1];
        let maxY = points[1];
        let x, y;
        for (let i = 0; i < points.length / 2; i++) {
            x = points[i * 2];
            y = points[i * 2 + 1];
            minX = Math.min(minX, x);
            maxX = Math.max(maxX, x);
            minY = Math.min(minY, y);
            maxY = Math.max(maxY, y);
        }
        return {
            x: minX,
            y: minY,
            width: maxX - minX,
            height: maxY - minY,
        };
    }
}
Line.prototype.className = 'Line';
Line.prototype._attrsAffectingSize = ['points', 'bezier', 'tension'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_1__._registerNode)(Line);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Line, 'closed', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Line, 'bezier', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Line, 'tension', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Line, 'points', [], (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberArrayValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Path.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Path.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Path": function() { return /* binding */ Path; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../BezierFunctions.js */ "./node_modules/konva/lib/BezierFunctions.js");




class Path extends _Shape_js__WEBPACK_IMPORTED_MODULE_2__.Shape {
    constructor(config) {
        super(config);
        this.dataArray = [];
        this.pathLength = 0;
        this._readDataAttribute();
        this.on('dataChange.konva', function () {
            this._readDataAttribute();
        });
    }
    _readDataAttribute() {
        this.dataArray = Path.parsePathData(this.data());
        this.pathLength = Path.getPathLength(this.dataArray);
    }
    _sceneFunc(context) {
        const ca = this.dataArray;
        context.beginPath();
        let isClosed = false;
        for (let n = 0; n < ca.length; n++) {
            const c = ca[n].command;
            const p = ca[n].points;
            switch (c) {
                case 'L':
                    context.lineTo(p[0], p[1]);
                    break;
                case 'M':
                    context.moveTo(p[0], p[1]);
                    break;
                case 'C':
                    context.bezierCurveTo(p[0], p[1], p[2], p[3], p[4], p[5]);
                    break;
                case 'Q':
                    context.quadraticCurveTo(p[0], p[1], p[2], p[3]);
                    break;
                case 'A':
                    const cx = p[0], cy = p[1], rx = p[2], ry = p[3], theta = p[4], dTheta = p[5], psi = p[6], fs = p[7];
                    const r = rx > ry ? rx : ry;
                    const scaleX = rx > ry ? 1 : rx / ry;
                    const scaleY = rx > ry ? ry / rx : 1;
                    context.translate(cx, cy);
                    context.rotate(psi);
                    context.scale(scaleX, scaleY);
                    context.arc(0, 0, r, theta, theta + dTheta, 1 - fs);
                    context.scale(1 / scaleX, 1 / scaleY);
                    context.rotate(-psi);
                    context.translate(-cx, -cy);
                    break;
                case 'z':
                    isClosed = true;
                    context.closePath();
                    break;
            }
        }
        if (!isClosed && !this.hasFill()) {
            context.strokeShape(this);
        }
        else {
            context.fillStrokeShape(this);
        }
    }
    getSelfRect() {
        let points = [];
        this.dataArray.forEach(function (data) {
            if (data.command === 'A') {
                const start = data.points[4];
                const dTheta = data.points[5];
                const end = data.points[4] + dTheta;
                let inc = Math.PI / 180.0;
                if (Math.abs(start - end) < inc) {
                    inc = Math.abs(start - end);
                }
                if (dTheta < 0) {
                    for (let t = start - inc; t > end; t -= inc) {
                        const point = Path.getPointOnEllipticalArc(data.points[0], data.points[1], data.points[2], data.points[3], t, 0);
                        points.push(point.x, point.y);
                    }
                }
                else {
                    for (let t = start + inc; t < end; t += inc) {
                        const point = Path.getPointOnEllipticalArc(data.points[0], data.points[1], data.points[2], data.points[3], t, 0);
                        points.push(point.x, point.y);
                    }
                }
            }
            else if (data.command === 'C') {
                for (let t = 0.0; t <= 1; t += 0.01) {
                    const point = Path.getPointOnCubicBezier(t, data.start.x, data.start.y, data.points[0], data.points[1], data.points[2], data.points[3], data.points[4], data.points[5]);
                    points.push(point.x, point.y);
                }
            }
            else {
                points = points.concat(data.points);
            }
        });
        let minX = points[0];
        let maxX = points[0];
        let minY = points[1];
        let maxY = points[1];
        let x, y;
        for (let i = 0; i < points.length / 2; i++) {
            x = points[i * 2];
            y = points[i * 2 + 1];
            if (!isNaN(x)) {
                minX = Math.min(minX, x);
                maxX = Math.max(maxX, x);
            }
            if (!isNaN(y)) {
                minY = Math.min(minY, y);
                maxY = Math.max(maxY, y);
            }
        }
        return {
            x: minX,
            y: minY,
            width: maxX - minX,
            height: maxY - minY,
        };
    }
    getLength() {
        return this.pathLength;
    }
    getPointAtLength(length) {
        return Path.getPointAtLengthOfDataArray(length, this.dataArray);
    }
    static getLineLength(x1, y1, x2, y2) {
        return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));
    }
    static getPathLength(dataArray) {
        let pathLength = 0;
        for (let i = 0; i < dataArray.length; ++i) {
            pathLength += dataArray[i].pathLength;
        }
        return pathLength;
    }
    static getPointAtLengthOfDataArray(length, dataArray) {
        let points, i = 0, ii = dataArray.length;
        if (!ii) {
            return null;
        }
        while (i < ii && length > dataArray[i].pathLength) {
            length -= dataArray[i].pathLength;
            ++i;
        }
        if (i === ii) {
            points = dataArray[i - 1].points.slice(-2);
            return {
                x: points[0],
                y: points[1],
            };
        }
        if (length < 0.01) {
            const cmd = dataArray[i].command;
            if (cmd === 'M') {
                points = dataArray[i].points.slice(0, 2);
                return {
                    x: points[0],
                    y: points[1],
                };
            }
            else {
                return {
                    x: dataArray[i].start.x,
                    y: dataArray[i].start.y,
                };
            }
        }
        const cp = dataArray[i];
        const p = cp.points;
        switch (cp.command) {
            case 'L':
                return Path.getPointOnLine(length, cp.start.x, cp.start.y, p[0], p[1]);
            case 'C':
                return Path.getPointOnCubicBezier((0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.t2length)(length, Path.getPathLength(dataArray), (i) => {
                    return (0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.getCubicArcLength)([cp.start.x, p[0], p[2], p[4]], [cp.start.y, p[1], p[3], p[5]], i);
                }), cp.start.x, cp.start.y, p[0], p[1], p[2], p[3], p[4], p[5]);
            case 'Q':
                return Path.getPointOnQuadraticBezier((0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.t2length)(length, Path.getPathLength(dataArray), (i) => {
                    return (0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.getQuadraticArcLength)([cp.start.x, p[0], p[2]], [cp.start.y, p[1], p[3]], i);
                }), cp.start.x, cp.start.y, p[0], p[1], p[2], p[3]);
            case 'A':
                const cx = p[0], cy = p[1], rx = p[2], ry = p[3], dTheta = p[5], psi = p[6];
                let theta = p[4];
                theta += (dTheta * length) / cp.pathLength;
                return Path.getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi);
        }
        return null;
    }
    static getPointOnLine(dist, P1x, P1y, P2x, P2y, fromX, fromY) {
        fromX = fromX !== null && fromX !== void 0 ? fromX : P1x;
        fromY = fromY !== null && fromY !== void 0 ? fromY : P1y;
        const len = this.getLineLength(P1x, P1y, P2x, P2y);
        if (len < 1e-10) {
            return { x: P1x, y: P1y };
        }
        if (P2x === P1x) {
            return { x: fromX, y: fromY + (P2y > P1y ? dist : -dist) };
        }
        const m = (P2y - P1y) / (P2x - P1x);
        const run = Math.sqrt((dist * dist) / (1 + m * m)) * (P2x < P1x ? -1 : 1);
        const rise = m * run;
        if (Math.abs(fromY - P1y - m * (fromX - P1x)) < 1e-10) {
            return { x: fromX + run, y: fromY + rise };
        }
        const u = ((fromX - P1x) * (P2x - P1x) + (fromY - P1y) * (P2y - P1y)) / (len * len);
        const ix = P1x + u * (P2x - P1x);
        const iy = P1y + u * (P2y - P1y);
        const pRise = this.getLineLength(fromX, fromY, ix, iy);
        const pRun = Math.sqrt(dist * dist - pRise * pRise);
        const adjustedRun = Math.sqrt((pRun * pRun) / (1 + m * m)) * (P2x < P1x ? -1 : 1);
        const adjustedRise = m * adjustedRun;
        return { x: ix + adjustedRun, y: iy + adjustedRise };
    }
    static getPointOnCubicBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y, P4x, P4y) {
        function CB1(t) {
            return t * t * t;
        }
        function CB2(t) {
            return 3 * t * t * (1 - t);
        }
        function CB3(t) {
            return 3 * t * (1 - t) * (1 - t);
        }
        function CB4(t) {
            return (1 - t) * (1 - t) * (1 - t);
        }
        const x = P4x * CB1(pct) + P3x * CB2(pct) + P2x * CB3(pct) + P1x * CB4(pct);
        const y = P4y * CB1(pct) + P3y * CB2(pct) + P2y * CB3(pct) + P1y * CB4(pct);
        return { x, y };
    }
    static getPointOnQuadraticBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y) {
        function QB1(t) {
            return t * t;
        }
        function QB2(t) {
            return 2 * t * (1 - t);
        }
        function QB3(t) {
            return (1 - t) * (1 - t);
        }
        const x = P3x * QB1(pct) + P2x * QB2(pct) + P1x * QB3(pct);
        const y = P3y * QB1(pct) + P2y * QB2(pct) + P1y * QB3(pct);
        return { x, y };
    }
    static getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi) {
        const cosPsi = Math.cos(psi), sinPsi = Math.sin(psi);
        const pt = {
            x: rx * Math.cos(theta),
            y: ry * Math.sin(theta),
        };
        return {
            x: cx + (pt.x * cosPsi - pt.y * sinPsi),
            y: cy + (pt.x * sinPsi + pt.y * cosPsi),
        };
    }
    static parsePathData(data) {
        if (!data) {
            return [];
        }
        let cs = data;
        const cc = [
            'm',
            'M',
            'l',
            'L',
            'v',
            'V',
            'h',
            'H',
            'z',
            'Z',
            'c',
            'C',
            'q',
            'Q',
            't',
            'T',
            's',
            'S',
            'a',
            'A',
        ];
        cs = cs.replace(new RegExp(' ', 'g'), ',');
        for (let n = 0; n < cc.length; n++) {
            cs = cs.replace(new RegExp(cc[n], 'g'), '|' + cc[n]);
        }
        const arr = cs.split('|');
        const ca = [];
        const coords = [];
        let cpx = 0;
        let cpy = 0;
        const re = /([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;
        let match;
        for (let n = 1; n < arr.length; n++) {
            let str = arr[n];
            let c = str.charAt(0);
            str = str.slice(1);
            coords.length = 0;
            while ((match = re.exec(str))) {
                coords.push(match[0]);
            }
            let p = [];
            let arcParamIndex = c === 'A' || c === 'a' ? 0 : -1;
            for (let j = 0, jlen = coords.length; j < jlen; j++) {
                const token = coords[j];
                if (token === '00') {
                    p.push(0, 0);
                    if (arcParamIndex >= 0) {
                        arcParamIndex += 2;
                        if (arcParamIndex >= 7)
                            arcParamIndex -= 7;
                    }
                    continue;
                }
                if (arcParamIndex >= 0) {
                    if (arcParamIndex === 3) {
                        if (/^[01]{2}\d+(?:\.\d+)?$/.test(token)) {
                            p.push(parseInt(token[0], 10));
                            p.push(parseInt(token[1], 10));
                            p.push(parseFloat(token.slice(2)));
                            arcParamIndex += 3;
                            if (arcParamIndex >= 7)
                                arcParamIndex -= 7;
                            continue;
                        }
                        if (token === '11' || token === '10' || token === '01') {
                            p.push(parseInt(token[0], 10));
                            p.push(parseInt(token[1], 10));
                            arcParamIndex += 2;
                            if (arcParamIndex >= 7)
                                arcParamIndex -= 7;
                            continue;
                        }
                        if (token === '0' || token === '1') {
                            p.push(parseInt(token, 10));
                            arcParamIndex += 1;
                            if (arcParamIndex >= 7)
                                arcParamIndex -= 7;
                            continue;
                        }
                    }
                    else if (arcParamIndex === 4) {
                        if (/^[01]\d+(?:\.\d+)?$/.test(token)) {
                            p.push(parseInt(token[0], 10));
                            p.push(parseFloat(token.slice(1)));
                            arcParamIndex += 2;
                            if (arcParamIndex >= 7)
                                arcParamIndex -= 7;
                            continue;
                        }
                        if (token === '0' || token === '1') {
                            p.push(parseInt(token, 10));
                            arcParamIndex += 1;
                            if (arcParamIndex >= 7)
                                arcParamIndex -= 7;
                            continue;
                        }
                    }
                    const parsedArc = parseFloat(token);
                    if (!isNaN(parsedArc)) {
                        p.push(parsedArc);
                    }
                    else {
                        p.push(0);
                    }
                    arcParamIndex += 1;
                    if (arcParamIndex >= 7)
                        arcParamIndex -= 7;
                }
                else {
                    const parsed = parseFloat(token);
                    if (!isNaN(parsed)) {
                        p.push(parsed);
                    }
                    else {
                        p.push(0);
                    }
                }
            }
            while (p.length > 0) {
                if (isNaN(p[0])) {
                    break;
                }
                let cmd = '';
                let points = [];
                const startX = cpx, startY = cpy;
                let prevCmd, ctlPtx, ctlPty;
                let rx, ry, psi, fa, fs, x1, y1;
                switch (c) {
                    case 'l':
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'L';
                        points.push(cpx, cpy);
                        break;
                    case 'L':
                        cpx = p.shift();
                        cpy = p.shift();
                        points.push(cpx, cpy);
                        break;
                    case 'm':
                        const dx = p.shift();
                        const dy = p.shift();
                        cpx += dx;
                        cpy += dy;
                        cmd = 'M';
                        if (ca.length > 2 && ca[ca.length - 1].command === 'z') {
                            for (let idx = ca.length - 2; idx >= 0; idx--) {
                                if (ca[idx].command === 'M') {
                                    cpx = ca[idx].points[0] + dx;
                                    cpy = ca[idx].points[1] + dy;
                                    break;
                                }
                            }
                        }
                        points.push(cpx, cpy);
                        c = 'l';
                        break;
                    case 'M':
                        cpx = p.shift();
                        cpy = p.shift();
                        cmd = 'M';
                        points.push(cpx, cpy);
                        c = 'L';
                        break;
                    case 'h':
                        cpx += p.shift();
                        cmd = 'L';
                        points.push(cpx, cpy);
                        break;
                    case 'H':
                        cpx = p.shift();
                        cmd = 'L';
                        points.push(cpx, cpy);
                        break;
                    case 'v':
                        cpy += p.shift();
                        cmd = 'L';
                        points.push(cpx, cpy);
                        break;
                    case 'V':
                        cpy = p.shift();
                        cmd = 'L';
                        points.push(cpx, cpy);
                        break;
                    case 'C':
                        points.push(p.shift(), p.shift(), p.shift(), p.shift());
                        cpx = p.shift();
                        cpy = p.shift();
                        points.push(cpx, cpy);
                        break;
                    case 'c':
                        points.push(cpx + p.shift(), cpy + p.shift(), cpx + p.shift(), cpy + p.shift());
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'C';
                        points.push(cpx, cpy);
                        break;
                    case 'S':
                        ctlPtx = cpx;
                        ctlPty = cpy;
                        prevCmd = ca[ca.length - 1];
                        if (prevCmd.command === 'C') {
                            ctlPtx = cpx + (cpx - prevCmd.points[2]);
                            ctlPty = cpy + (cpy - prevCmd.points[3]);
                        }
                        points.push(ctlPtx, ctlPty, p.shift(), p.shift());
                        cpx = p.shift();
                        cpy = p.shift();
                        cmd = 'C';
                        points.push(cpx, cpy);
                        break;
                    case 's':
                        ctlPtx = cpx;
                        ctlPty = cpy;
                        prevCmd = ca[ca.length - 1];
                        if (prevCmd.command === 'C') {
                            ctlPtx = cpx + (cpx - prevCmd.points[2]);
                            ctlPty = cpy + (cpy - prevCmd.points[3]);
                        }
                        points.push(ctlPtx, ctlPty, cpx + p.shift(), cpy + p.shift());
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'C';
                        points.push(cpx, cpy);
                        break;
                    case 'Q':
                        points.push(p.shift(), p.shift());
                        cpx = p.shift();
                        cpy = p.shift();
                        points.push(cpx, cpy);
                        break;
                    case 'q':
                        points.push(cpx + p.shift(), cpy + p.shift());
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'Q';
                        points.push(cpx, cpy);
                        break;
                    case 'T':
                        ctlPtx = cpx;
                        ctlPty = cpy;
                        prevCmd = ca[ca.length - 1];
                        if (prevCmd.command === 'Q') {
                            ctlPtx = cpx + (cpx - prevCmd.points[0]);
                            ctlPty = cpy + (cpy - prevCmd.points[1]);
                        }
                        cpx = p.shift();
                        cpy = p.shift();
                        cmd = 'Q';
                        points.push(ctlPtx, ctlPty, cpx, cpy);
                        break;
                    case 't':
                        ctlPtx = cpx;
                        ctlPty = cpy;
                        prevCmd = ca[ca.length - 1];
                        if (prevCmd.command === 'Q') {
                            ctlPtx = cpx + (cpx - prevCmd.points[0]);
                            ctlPty = cpy + (cpy - prevCmd.points[1]);
                        }
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'Q';
                        points.push(ctlPtx, ctlPty, cpx, cpy);
                        break;
                    case 'A':
                        rx = p.shift();
                        ry = p.shift();
                        psi = p.shift();
                        fa = p.shift();
                        fs = p.shift();
                        x1 = cpx;
                        y1 = cpy;
                        cpx = p.shift();
                        cpy = p.shift();
                        cmd = 'A';
                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);
                        break;
                    case 'a':
                        rx = p.shift();
                        ry = p.shift();
                        psi = p.shift();
                        fa = p.shift();
                        fs = p.shift();
                        x1 = cpx;
                        y1 = cpy;
                        cpx += p.shift();
                        cpy += p.shift();
                        cmd = 'A';
                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);
                        break;
                }
                ca.push({
                    command: cmd || c,
                    points: points,
                    start: {
                        x: startX,
                        y: startY,
                    },
                    pathLength: this.calcLength(startX, startY, cmd || c, points),
                });
            }
            if (c === 'z' || c === 'Z') {
                ca.push({
                    command: 'z',
                    points: [],
                    start: undefined,
                    pathLength: 0,
                });
            }
        }
        return ca;
    }
    static calcLength(x, y, cmd, points) {
        let len, p1, p2, t;
        const path = Path;
        switch (cmd) {
            case 'L':
                return path.getLineLength(x, y, points[0], points[1]);
            case 'C':
                return (0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.getCubicArcLength)([x, points[0], points[2], points[4]], [y, points[1], points[3], points[5]], 1);
            case 'Q':
                return (0,_BezierFunctions_js__WEBPACK_IMPORTED_MODULE_3__.getQuadraticArcLength)([x, points[0], points[2]], [y, points[1], points[3]], 1);
            case 'A':
                len = 0.0;
                const start = points[4];
                const dTheta = points[5];
                const end = points[4] + dTheta;
                let inc = Math.PI / 180.0;
                if (Math.abs(start - end) < inc) {
                    inc = Math.abs(start - end);
                }
                p1 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);
                if (dTheta < 0) {
                    for (t = start - inc; t > end; t -= inc) {
                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);
                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);
                        p1 = p2;
                    }
                }
                else {
                    for (t = start + inc; t < end; t += inc) {
                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);
                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);
                        p1 = p2;
                    }
                }
                p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);
                len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);
                return len;
        }
        return 0;
    }
    static convertEndpointToCenterParameterization(x1, y1, x2, y2, fa, fs, rx, ry, psiDeg) {
        const psi = psiDeg * (Math.PI / 180.0);
        const xp = (Math.cos(psi) * (x1 - x2)) / 2.0 + (Math.sin(psi) * (y1 - y2)) / 2.0;
        const yp = (-1 * Math.sin(psi) * (x1 - x2)) / 2.0 +
            (Math.cos(psi) * (y1 - y2)) / 2.0;
        const lambda = (xp * xp) / (rx * rx) + (yp * yp) / (ry * ry);
        if (lambda > 1) {
            rx *= Math.sqrt(lambda);
            ry *= Math.sqrt(lambda);
        }
        let f = Math.sqrt((rx * rx * (ry * ry) - rx * rx * (yp * yp) - ry * ry * (xp * xp)) /
            (rx * rx * (yp * yp) + ry * ry * (xp * xp)));
        if (fa === fs) {
            f *= -1;
        }
        if (isNaN(f)) {
            f = 0;
        }
        const cxp = (f * rx * yp) / ry;
        const cyp = (f * -ry * xp) / rx;
        const cx = (x1 + x2) / 2.0 + Math.cos(psi) * cxp - Math.sin(psi) * cyp;
        const cy = (y1 + y2) / 2.0 + Math.sin(psi) * cxp + Math.cos(psi) * cyp;
        const vMag = function (v) {
            return Math.sqrt(v[0] * v[0] + v[1] * v[1]);
        };
        const vRatio = function (u, v) {
            return (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v));
        };
        const vAngle = function (u, v) {
            return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));
        };
        const theta = vAngle([1, 0], [(xp - cxp) / rx, (yp - cyp) / ry]);
        const u = [(xp - cxp) / rx, (yp - cyp) / ry];
        const v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];
        let dTheta = vAngle(u, v);
        if (vRatio(u, v) <= -1) {
            dTheta = Math.PI;
        }
        if (vRatio(u, v) >= 1) {
            dTheta = 0;
        }
        if (fs === 0 && dTheta > 0) {
            dTheta = dTheta - 2 * Math.PI;
        }
        if (fs === 1 && dTheta < 0) {
            dTheta = dTheta + 2 * Math.PI;
        }
        return [cx, cy, rx, ry, theta, dTheta, psi, fs];
    }
}
Path.prototype.className = 'Path';
Path.prototype._attrsAffectingSize = ['data'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_1__._registerNode)(Path);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Path, 'data');


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Rect.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Rect.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Rect": function() { return /* binding */ Rect; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");





class Rect extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const cornerRadius = this.cornerRadius(), width = this.width(), height = this.height();
        context.beginPath();
        if (!cornerRadius) {
            context.rect(0, 0, width, height);
        }
        else {
            _Util_js__WEBPACK_IMPORTED_MODULE_3__.Util.drawRoundedRectPath(context, width, height, cornerRadius);
        }
        context.closePath();
        context.fillStrokeShape(this);
    }
}
Rect.prototype.className = 'Rect';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_2__._registerNode)(Rect);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Rect, 'cornerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberOrArrayOfNumbersValidator)(4));


/***/ }),

/***/ "./node_modules/konva/lib/shapes/RegularPolygon.js":
/*!*********************************************************!*\
  !*** ./node_modules/konva/lib/shapes/RegularPolygon.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RegularPolygon": function() { return /* binding */ RegularPolygon; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");





class RegularPolygon extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const points = this._getPoints(), radius = this.radius(), sides = this.sides(), cornerRadius = this.cornerRadius();
        context.beginPath();
        if (!cornerRadius) {
            context.moveTo(points[0].x, points[0].y);
            for (let n = 1; n < points.length; n++) {
                context.lineTo(points[n].x, points[n].y);
            }
        }
        else {
            _Util_js__WEBPACK_IMPORTED_MODULE_4__.Util.drawRoundedPolygonPath(context, points, sides, radius, cornerRadius);
        }
        context.closePath();
        context.fillStrokeShape(this);
    }
    _getPoints() {
        const sides = this.attrs.sides;
        const radius = this.attrs.radius || 0;
        const points = [];
        for (let n = 0; n < sides; n++) {
            points.push({
                x: radius * Math.sin((n * 2 * Math.PI) / sides),
                y: -1 * radius * Math.cos((n * 2 * Math.PI) / sides),
            });
        }
        return points;
    }
    getSelfRect() {
        const points = this._getPoints();
        let minX = points[0].x;
        let maxX = points[0].y;
        let minY = points[0].x;
        let maxY = points[0].y;
        points.forEach((point) => {
            minX = Math.min(minX, point.x);
            maxX = Math.max(maxX, point.x);
            minY = Math.min(minY, point.y);
            maxY = Math.max(maxY, point.y);
        });
        return {
            x: minX,
            y: minY,
            width: maxX - minX,
            height: maxY - minY,
        };
    }
    getWidth() {
        return this.radius() * 2;
    }
    getHeight() {
        return this.radius() * 2;
    }
    setWidth(width) {
        this.radius(width / 2);
    }
    setHeight(height) {
        this.radius(height / 2);
    }
}
RegularPolygon.prototype.className = 'RegularPolygon';
RegularPolygon.prototype._centroid = true;
RegularPolygon.prototype._attrsAffectingSize = ['radius'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(RegularPolygon);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(RegularPolygon, 'radius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(RegularPolygon, 'sides', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(RegularPolygon, 'cornerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberOrArrayOfNumbersValidator)(4));


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Ring.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Ring.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Ring": function() { return /* binding */ Ring; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");




const PIx2 = Math.PI * 2;
class Ring extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        context.beginPath();
        context.arc(0, 0, this.innerRadius(), 0, PIx2, false);
        context.moveTo(this.outerRadius(), 0);
        context.arc(0, 0, this.outerRadius(), PIx2, 0, true);
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.outerRadius() * 2;
    }
    getHeight() {
        return this.outerRadius() * 2;
    }
    setWidth(width) {
        this.outerRadius(width / 2);
    }
    setHeight(height) {
        this.outerRadius(height / 2);
    }
}
Ring.prototype.className = 'Ring';
Ring.prototype._centroid = true;
Ring.prototype._attrsAffectingSize = ['innerRadius', 'outerRadius'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Ring);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Ring, 'innerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Ring, 'outerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Sprite.js":
/*!*************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Sprite.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Sprite": function() { return /* binding */ Sprite; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Animation_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Animation.js */ "./node_modules/konva/lib/Animation.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");





class Sprite extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    constructor(config) {
        super(config);
        this._updated = true;
        this.anim = new _Animation_js__WEBPACK_IMPORTED_MODULE_2__.Animation(() => {
            const updated = this._updated;
            this._updated = false;
            return updated;
        });
        this.on('animationChange.konva', function () {
            this.frameIndex(0);
        });
        this.on('frameIndexChange.konva', function () {
            this._updated = true;
        });
        this.on('frameRateChange.konva', function () {
            if (!this.anim.isRunning()) {
                return;
            }
            clearInterval(this.interval);
            this._setInterval();
        });
    }
    _sceneFunc(context) {
        const anim = this.animation(), index = this.frameIndex(), ix4 = index * 4, set = this.animations()[anim], offsets = this.frameOffsets(), x = set[ix4 + 0], y = set[ix4 + 1], width = set[ix4 + 2], height = set[ix4 + 3], image = this.image();
        if (this.hasFill() || this.hasStroke()) {
            context.beginPath();
            context.rect(0, 0, width, height);
            context.closePath();
            context.fillStrokeShape(this);
        }
        if (image) {
            if (offsets) {
                const offset = offsets[anim], ix2 = index * 2;
                context.drawImage(image, x, y, width, height, offset[ix2 + 0], offset[ix2 + 1], width, height);
            }
            else {
                context.drawImage(image, x, y, width, height, 0, 0, width, height);
            }
        }
    }
    _hitFunc(context) {
        const anim = this.animation(), index = this.frameIndex(), ix4 = index * 4, set = this.animations()[anim], offsets = this.frameOffsets(), width = set[ix4 + 2], height = set[ix4 + 3];
        context.beginPath();
        if (offsets) {
            const offset = offsets[anim];
            const ix2 = index * 2;
            context.rect(offset[ix2 + 0], offset[ix2 + 1], width, height);
        }
        else {
            context.rect(0, 0, width, height);
        }
        context.closePath();
        context.fillShape(this);
    }
    _useBufferCanvas() {
        return super._useBufferCanvas(true);
    }
    _setInterval() {
        const that = this;
        this.interval = setInterval(function () {
            that._updateIndex();
        }, 1000 / this.frameRate());
    }
    start() {
        if (this.isRunning()) {
            return;
        }
        const layer = this.getLayer();
        this.anim.setLayers(layer);
        this._setInterval();
        this.anim.start();
    }
    stop() {
        this.anim.stop();
        clearInterval(this.interval);
    }
    isRunning() {
        return this.anim.isRunning();
    }
    _updateIndex() {
        const index = this.frameIndex(), animation = this.animation(), animations = this.animations(), anim = animations[animation], len = anim.length / 4;
        if (index < len - 1) {
            this.frameIndex(index + 1);
        }
        else {
            this.frameIndex(0);
        }
    }
}
Sprite.prototype.className = 'Sprite';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_4__._registerNode)(Sprite);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'animation');
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'animations');
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'frameOffsets');
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'image');
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'frameIndex', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Sprite, 'frameRate', 17, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.backCompat(Sprite, {
    index: 'frameIndex',
    getIndex: 'getFrameIndex',
    setIndex: 'setFrameIndex',
});


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Star.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Star.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Star": function() { return /* binding */ Star; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");




class Star extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        const innerRadius = this.innerRadius(), outerRadius = this.outerRadius(), numPoints = this.numPoints();
        context.beginPath();
        context.moveTo(0, 0 - outerRadius);
        for (let n = 1; n < numPoints * 2; n++) {
            const radius = n % 2 === 0 ? outerRadius : innerRadius;
            const x = radius * Math.sin((n * Math.PI) / numPoints);
            const y = -1 * radius * Math.cos((n * Math.PI) / numPoints);
            context.lineTo(x, y);
        }
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.outerRadius() * 2;
    }
    getHeight() {
        return this.outerRadius() * 2;
    }
    setWidth(width) {
        this.outerRadius(width / 2);
    }
    setHeight(height) {
        this.outerRadius(height / 2);
    }
}
Star.prototype.className = 'Star';
Star.prototype._centroid = true;
Star.prototype._attrsAffectingSize = ['innerRadius', 'outerRadius'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Star);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Star, 'numPoints', 5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Star, 'innerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Star, 'outerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_2__.getNumberValidator)());


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Text.js":
/*!***********************************************!*\
  !*** ./node_modules/konva/lib/shapes/Text.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Text": function() { return /* binding */ Text; },
/* harmony export */   "stringToArray": function() { return /* binding */ stringToArray; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");






function stringToArray(string) {
    return [...string].reduce((acc, char, index, array) => {
        if (/\p{Emoji}/u.test(char)) {
            const nextChar = array[index + 1];
            if (nextChar && /\p{Emoji_Modifier}|\u200D/u.test(nextChar)) {
                acc.push(char + nextChar);
                array[index + 1] = '';
            }
            else {
                acc.push(char);
            }
        }
        else if (/\p{Regional_Indicator}{2}/u.test(char + (array[index + 1] || ''))) {
            acc.push(char + array[index + 1]);
        }
        else if (index > 0 && /\p{Mn}|\p{Me}|\p{Mc}/u.test(char)) {
            acc[acc.length - 1] += char;
        }
        else if (char) {
            acc.push(char);
        }
        return acc;
    }, []);
}
const AUTO = 'auto', CENTER = 'center', INHERIT = 'inherit', JUSTIFY = 'justify', CHANGE_KONVA = 'Change.konva', CONTEXT_2D = '2d', DASH = '-', LEFT = 'left', TEXT = 'text', TEXT_UPPER = 'Text', TOP = 'top', BOTTOM = 'bottom', MIDDLE = 'middle', NORMAL = 'normal', PX_SPACE = 'px ', SPACE = ' ', RIGHT = 'right', RTL = 'rtl', WORD = 'word', CHAR = 'char', NONE = 'none', ELLIPSIS = '…', ATTR_CHANGE_LIST = [
    'direction',
    'fontFamily',
    'fontSize',
    'fontStyle',
    'fontVariant',
    'padding',
    'align',
    'verticalAlign',
    'lineHeight',
    'text',
    'width',
    'height',
    'wrap',
    'ellipsis',
    'letterSpacing',
], attrChangeListLen = ATTR_CHANGE_LIST.length;
function normalizeFontFamily(fontFamily) {
    return fontFamily
        .split(',')
        .map((family) => {
        family = family.trim();
        const hasSpace = family.indexOf(' ') >= 0;
        const hasQuotes = family.indexOf('"') >= 0 || family.indexOf("'") >= 0;
        if (hasSpace && !hasQuotes) {
            family = `"${family}"`;
        }
        return family;
    })
        .join(', ');
}
let dummyContext;
function getDummyContext() {
    if (dummyContext) {
        return dummyContext;
    }
    dummyContext = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement().getContext(CONTEXT_2D);
    return dummyContext;
}
function _fillFunc(context) {
    context.fillText(this._partialText, this._partialTextX, this._partialTextY);
}
function _strokeFunc(context) {
    context.setAttr('miterLimit', 2);
    context.strokeText(this._partialText, this._partialTextX, this._partialTextY);
}
function checkDefaultFill(config) {
    config = config || {};
    if (!config.fillLinearGradientColorStops &&
        !config.fillRadialGradientColorStops &&
        !config.fillPatternImage) {
        config.fill = config.fill || 'black';
    }
    return config;
}
class Text extends _Shape_js__WEBPACK_IMPORTED_MODULE_2__.Shape {
    constructor(config) {
        super(checkDefaultFill(config));
        this._partialTextX = 0;
        this._partialTextY = 0;
        for (let n = 0; n < attrChangeListLen; n++) {
            this.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, this._setTextData);
        }
        this._setTextData();
    }
    _sceneFunc(context) {
        var _a, _b;
        const textArr = this.textArr, textArrLen = textArr.length;
        if (!this.text()) {
            return;
        }
        let padding = this.padding(), fontSize = this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, verticalAlign = this.verticalAlign(), direction = this.direction(), alignY = 0, align = this.align(), totalWidth = this.getWidth(), letterSpacing = this.letterSpacing(), charRenderFunc = this.charRenderFunc(), fill = this.fill(), textDecoration = this.textDecoration(), shouldUnderline = textDecoration.indexOf('underline') !== -1, shouldLineThrough = textDecoration.indexOf('line-through') !== -1, n;
        direction = direction === INHERIT ? context.direction : direction;
        let translateY = lineHeightPx / 2;
        let baseline = MIDDLE;
        if (!_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.legacyTextRendering) {
            const metrics = this.measureSize('M');
            baseline = 'alphabetic';
            const ascent = (_a = metrics.fontBoundingBoxAscent) !== null && _a !== void 0 ? _a : metrics.actualBoundingBoxAscent;
            const descent = (_b = metrics.fontBoundingBoxDescent) !== null && _b !== void 0 ? _b : metrics.actualBoundingBoxDescent;
            translateY = (ascent - descent) / 2 + lineHeightPx / 2;
        }
        if (direction === RTL) {
            context.setAttr('direction', direction);
        }
        context.setAttr('font', this._getContextFont());
        context.setAttr('textBaseline', baseline);
        context.setAttr('textAlign', LEFT);
        if (verticalAlign === MIDDLE) {
            alignY = (this.getHeight() - textArrLen * lineHeightPx - padding * 2) / 2;
        }
        else if (verticalAlign === BOTTOM) {
            alignY = this.getHeight() - textArrLen * lineHeightPx - padding * 2;
        }
        context.translate(padding, alignY + padding);
        for (n = 0; n < textArrLen; n++) {
            let lineTranslateX = 0;
            let lineTranslateY = 0;
            const obj = textArr[n], text = obj.text, width = obj.width, lastLine = obj.lastInParagraph;
            context.save();
            if (align === RIGHT) {
                lineTranslateX += totalWidth - width - padding * 2;
            }
            else if (align === CENTER) {
                lineTranslateX += (totalWidth - width - padding * 2) / 2;
            }
            if (shouldUnderline) {
                context.save();
                context.beginPath();
                const yOffset = !_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.legacyTextRendering
                    ? Math.round(fontSize / 4)
                    : Math.round(fontSize / 2);
                const x = lineTranslateX;
                const y = translateY + lineTranslateY + yOffset;
                context.moveTo(x, y);
                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;
                context.lineTo(x + Math.round(lineWidth), y);
                context.lineWidth = fontSize / 15;
                const gradient = this._getLinearGradient();
                context.strokeStyle = gradient || fill;
                context.stroke();
                context.restore();
            }
            if (direction !== RTL &&
                (letterSpacing !== 0 || align === JUSTIFY || charRenderFunc)) {
                const spacesNumber = text.split(' ').length - 1;
                const array = stringToArray(text);
                for (let li = 0; li < array.length; li++) {
                    const letter = array[li];
                    if (letter === ' ' && !lastLine && align === JUSTIFY) {
                        lineTranslateX += (totalWidth - padding * 2 - width) / spacesNumber;
                    }
                    this._partialTextX = lineTranslateX;
                    this._partialTextY = translateY + lineTranslateY;
                    this._partialText = letter;
                    if (charRenderFunc) {
                        context.save();
                        const previousLines = textArr.slice(0, n);
                        const previousGraphemes = previousLines.reduce((acc, line) => acc + stringToArray(line.text).length, 0);
                        const charIndex = li + previousGraphemes;
                        charRenderFunc({
                            char: letter,
                            index: charIndex,
                            x: lineTranslateX,
                            y: translateY + lineTranslateY,
                            lineIndex: n,
                            column: li,
                            isLastInLine: lastLine,
                            width: this.measureSize(letter).width,
                            context,
                        });
                    }
                    context.fillStrokeShape(this);
                    if (charRenderFunc) {
                        context.restore();
                    }
                    lineTranslateX += this.measureSize(letter).width + letterSpacing;
                }
            }
            else {
                if (letterSpacing !== 0) {
                    context.setAttr('letterSpacing', `${letterSpacing}px`);
                }
                this._partialTextX = lineTranslateX;
                this._partialTextY = translateY + lineTranslateY;
                this._partialText = text;
                context.fillStrokeShape(this);
            }
            if (shouldLineThrough) {
                context.save();
                context.beginPath();
                const yOffset = !_Global_js__WEBPACK_IMPORTED_MODULE_3__.Konva.legacyTextRendering
                    ? -Math.round(fontSize / 4)
                    : 0;
                const x = align === JUSTIFY ? 0 : lineTranslateX;
                context.moveTo(x, translateY + lineTranslateY + yOffset);
                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;
                context.lineTo(x + Math.round(lineWidth), translateY + lineTranslateY + yOffset);
                context.lineWidth = fontSize / 15;
                const gradient = this._getLinearGradient();
                context.strokeStyle = gradient || fill;
                context.stroke();
                context.restore();
            }
            context.restore();
            if (textArrLen > 1) {
                translateY += lineHeightPx;
            }
        }
    }
    _hitFunc(context) {
        const width = this.getWidth(), height = this.getHeight();
        context.beginPath();
        context.rect(0, 0, width, height);
        context.closePath();
        context.fillStrokeShape(this);
    }
    setText(text) {
        const str = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._isString(text)
            ? text
            : text === null || text === undefined
                ? ''
                : text + '';
        this._setAttr(TEXT, str);
        return this;
    }
    getWidth() {
        const isAuto = this.attrs.width === AUTO || this.attrs.width === undefined;
        return isAuto ? this.getTextWidth() + this.padding() * 2 : this.attrs.width;
    }
    getHeight() {
        const isAuto = this.attrs.height === AUTO || this.attrs.height === undefined;
        return isAuto
            ? this.fontSize() * this.textArr.length * this.lineHeight() +
                this.padding() * 2
            : this.attrs.height;
    }
    getTextWidth() {
        return this.textWidth;
    }
    getTextHeight() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');
        return this.textHeight;
    }
    measureSize(text) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
        let _context = getDummyContext(), fontSize = this.fontSize(), metrics;
        _context.save();
        _context.font = this._getContextFont();
        metrics = _context.measureText(text);
        _context.restore();
        const scaleFactor = fontSize / 100;
        return {
            actualBoundingBoxAscent: (_a = metrics.actualBoundingBoxAscent) !== null && _a !== void 0 ? _a : 71.58203125 * scaleFactor,
            actualBoundingBoxDescent: (_b = metrics.actualBoundingBoxDescent) !== null && _b !== void 0 ? _b : 0,
            actualBoundingBoxLeft: (_c = metrics.actualBoundingBoxLeft) !== null && _c !== void 0 ? _c : -7.421875 * scaleFactor,
            actualBoundingBoxRight: (_d = metrics.actualBoundingBoxRight) !== null && _d !== void 0 ? _d : 75.732421875 * scaleFactor,
            alphabeticBaseline: (_e = metrics.alphabeticBaseline) !== null && _e !== void 0 ? _e : 0,
            emHeightAscent: (_f = metrics.emHeightAscent) !== null && _f !== void 0 ? _f : 100 * scaleFactor,
            emHeightDescent: (_g = metrics.emHeightDescent) !== null && _g !== void 0 ? _g : -20 * scaleFactor,
            fontBoundingBoxAscent: (_h = metrics.fontBoundingBoxAscent) !== null && _h !== void 0 ? _h : 91 * scaleFactor,
            fontBoundingBoxDescent: (_j = metrics.fontBoundingBoxDescent) !== null && _j !== void 0 ? _j : 21 * scaleFactor,
            hangingBaseline: (_k = metrics.hangingBaseline) !== null && _k !== void 0 ? _k : 72.80000305175781 * scaleFactor,
            ideographicBaseline: (_l = metrics.ideographicBaseline) !== null && _l !== void 0 ? _l : -21 * scaleFactor,
            width: metrics.width,
            height: fontSize,
        };
    }
    _getContextFont() {
        return (this.fontStyle() +
            SPACE +
            this.fontVariant() +
            SPACE +
            (this.fontSize() + PX_SPACE) +
            normalizeFontFamily(this.fontFamily()));
    }
    _addTextLine(line) {
        const align = this.align();
        if (align === JUSTIFY) {
            line = line.trim();
        }
        const width = this._getTextWidth(line);
        return this.textArr.push({
            text: line,
            width: width,
            lastInParagraph: false,
        });
    }
    _getTextWidth(text) {
        const letterSpacing = this.letterSpacing();
        const length = text.length;
        return getDummyContext().measureText(text).width + letterSpacing * length;
    }
    _setTextData() {
        let lines = this.text().split('\n'), fontSize = +this.fontSize(), textWidth = 0, lineHeightPx = this.lineHeight() * fontSize, width = this.attrs.width, height = this.attrs.height, fixedWidth = width !== AUTO && width !== undefined, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxWidth = width - padding * 2, maxHeightPx = height - padding * 2, currentHeightPx = 0, wrap = this.wrap(), shouldWrap = wrap !== NONE, wrapAtWord = wrap !== CHAR && shouldWrap, shouldAddEllipsis = this.ellipsis();
        this.textArr = [];
        getDummyContext().font = this._getContextFont();
        const additionalWidth = shouldAddEllipsis
            ? this._getTextWidth(ELLIPSIS)
            : 0;
        for (let i = 0, max = lines.length; i < max; ++i) {
            let line = lines[i];
            let lineWidth = this._getTextWidth(line);
            if (fixedWidth && lineWidth > maxWidth) {
                while (line.length > 0) {
                    let low = 0, high = stringToArray(line).length, match = '', matchWidth = 0;
                    while (low < high) {
                        const mid = (low + high) >>> 1, lineArray = stringToArray(line), substr = lineArray.slice(0, mid + 1).join(''), substrWidth = this._getTextWidth(substr);
                        const shouldConsiderEllipsis = shouldAddEllipsis &&
                            fixedHeight &&
                            currentHeightPx + lineHeightPx > maxHeightPx;
                        const effectiveWidth = shouldConsiderEllipsis
                            ? substrWidth + additionalWidth
                            : substrWidth;
                        if (effectiveWidth <= maxWidth) {
                            low = mid + 1;
                            match = substr;
                            matchWidth = substrWidth;
                        }
                        else {
                            high = mid;
                        }
                    }
                    if (match) {
                        if (wrapAtWord) {
                            const lineArray = stringToArray(line);
                            const matchArray = stringToArray(match);
                            const nextChar = lineArray[matchArray.length];
                            const nextIsSpaceOrDash = nextChar === SPACE || nextChar === DASH;
                            let wrapIndex;
                            if (nextIsSpaceOrDash && matchWidth <= maxWidth) {
                                wrapIndex = matchArray.length;
                            }
                            else {
                                const lastSpaceIndex = matchArray.lastIndexOf(SPACE);
                                const lastDashIndex = matchArray.lastIndexOf(DASH);
                                wrapIndex = Math.max(lastSpaceIndex, lastDashIndex) + 1;
                            }
                            if (wrapIndex > 0) {
                                low = wrapIndex;
                                match = lineArray.slice(0, low).join('');
                                matchWidth = this._getTextWidth(match);
                            }
                        }
                        match = match.trimRight();
                        this._addTextLine(match);
                        textWidth = Math.max(textWidth, matchWidth);
                        currentHeightPx += lineHeightPx;
                        const shouldHandleEllipsis = this._shouldHandleEllipsis(currentHeightPx);
                        if (shouldHandleEllipsis) {
                            this._tryToAddEllipsisToLastLine();
                            break;
                        }
                        const lineArray = stringToArray(line);
                        line = lineArray.slice(low).join('').trimLeft();
                        if (line.length > 0) {
                            lineWidth = this._getTextWidth(line);
                            if (lineWidth <= maxWidth) {
                                this._addTextLine(line);
                                currentHeightPx += lineHeightPx;
                                textWidth = Math.max(textWidth, lineWidth);
                                break;
                            }
                        }
                    }
                    else {
                        break;
                    }
                }
            }
            else {
                this._addTextLine(line);
                currentHeightPx += lineHeightPx;
                textWidth = Math.max(textWidth, lineWidth);
                if (this._shouldHandleEllipsis(currentHeightPx) && i < max - 1) {
                    this._tryToAddEllipsisToLastLine();
                }
            }
            if (this.textArr[this.textArr.length - 1]) {
                this.textArr[this.textArr.length - 1].lastInParagraph = true;
            }
            if (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx) {
                break;
            }
        }
        this.textHeight = fontSize;
        this.textWidth = textWidth;
    }
    _shouldHandleEllipsis(currentHeightPx) {
        const fontSize = +this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, height = this.attrs.height, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxHeightPx = height - padding * 2, wrap = this.wrap(), shouldWrap = wrap !== NONE;
        return (!shouldWrap ||
            (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx));
    }
    _tryToAddEllipsisToLastLine() {
        const width = this.attrs.width, fixedWidth = width !== AUTO && width !== undefined, padding = this.padding(), maxWidth = width - padding * 2, shouldAddEllipsis = this.ellipsis();
        const lastLine = this.textArr[this.textArr.length - 1];
        if (!lastLine || !shouldAddEllipsis) {
            return;
        }
        if (fixedWidth) {
            const haveSpace = this._getTextWidth(lastLine.text + ELLIPSIS) < maxWidth;
            if (!haveSpace) {
                lastLine.text = lastLine.text.slice(0, lastLine.text.length - 3);
            }
        }
        this.textArr.splice(this.textArr.length - 1, 1);
        this._addTextLine(lastLine.text + ELLIPSIS);
    }
    getStrokeScaleEnabled() {
        return true;
    }
    _useBufferCanvas() {
        const hasLine = this.textDecoration().indexOf('underline') !== -1 ||
            this.textDecoration().indexOf('line-through') !== -1;
        const hasShadow = this.hasShadow();
        if (hasLine && hasShadow) {
            return true;
        }
        return super._useBufferCanvas();
    }
}
Text.prototype._fillFunc = _fillFunc;
Text.prototype._strokeFunc = _strokeFunc;
Text.prototype.className = TEXT_UPPER;
Text.prototype._attrsAffectingSize = [
    'text',
    'fontSize',
    'padding',
    'wrap',
    'lineHeight',
    'letterSpacing',
];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_3__._registerNode)(Text);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.overWriteSetter(Text, 'width', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberOrAutoValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.overWriteSetter(Text, 'height', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberOrAutoValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'direction', INHERIT);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'fontFamily', 'Arial');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'fontSize', 12, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'fontStyle', NORMAL);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'fontVariant', NORMAL);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'padding', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'align', LEFT);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'verticalAlign', TOP);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'lineHeight', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'wrap', WORD);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'ellipsis', false, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'letterSpacing', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'text', '', (0,_Validators_js__WEBPACK_IMPORTED_MODULE_4__.getStringValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'textDecoration', '');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Text, 'charRenderFunc', undefined);


/***/ }),

/***/ "./node_modules/konva/lib/shapes/TextPath.js":
/*!***************************************************!*\
  !*** ./node_modules/konva/lib/shapes/TextPath.js ***!
  \***************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TextPath": function() { return /* binding */ TextPath; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Path_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Path.js */ "./node_modules/konva/lib/shapes/Path.js");
/* harmony import */ var _Text_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Text.js */ "./node_modules/konva/lib/shapes/Text.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");







const EMPTY_STRING = '', NORMAL = 'normal';
function _fillFunc(context) {
    context.fillText(this.partialText, 0, 0);
}
function _strokeFunc(context) {
    context.strokeText(this.partialText, 0, 0);
}
class TextPath extends _Shape_js__WEBPACK_IMPORTED_MODULE_2__.Shape {
    constructor(config) {
        super(config);
        this.dummyCanvas = _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.createCanvasElement();
        this.dataArray = [];
        this._readDataAttribute();
        this.on('dataChange.konva', function () {
            this._readDataAttribute();
            this._setTextData();
        });
        this.on('textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva', this._setTextData);
        this._setTextData();
    }
    _getTextPathLength() {
        return _Path_js__WEBPACK_IMPORTED_MODULE_3__.Path.getPathLength(this.dataArray);
    }
    _getPointAtLength(length) {
        if (!this.attrs.data) {
            return null;
        }
        const totalLength = this.pathLength;
        if (length > totalLength) {
            return null;
        }
        return _Path_js__WEBPACK_IMPORTED_MODULE_3__.Path.getPointAtLengthOfDataArray(length, this.dataArray);
    }
    _readDataAttribute() {
        this.dataArray = _Path_js__WEBPACK_IMPORTED_MODULE_3__.Path.parsePathData(this.attrs.data);
        this.pathLength = this._getTextPathLength();
    }
    _sceneFunc(context) {
        context.setAttr('font', this._getContextFont());
        context.setAttr('textBaseline', this.textBaseline());
        context.setAttr('textAlign', 'left');
        context.save();
        const textDecoration = this.textDecoration();
        const fill = this.fill();
        const fontSize = this.fontSize();
        const glyphInfo = this.glyphInfo;
        if (textDecoration === 'underline') {
            context.beginPath();
        }
        for (let i = 0; i < glyphInfo.length; i++) {
            context.save();
            const p0 = glyphInfo[i].p0;
            context.translate(p0.x, p0.y);
            context.rotate(glyphInfo[i].rotation);
            this.partialText = glyphInfo[i].text;
            context.fillStrokeShape(this);
            if (textDecoration === 'underline') {
                if (i === 0) {
                    context.moveTo(0, fontSize / 2 + 1);
                }
                context.lineTo(fontSize, fontSize / 2 + 1);
            }
            context.restore();
        }
        if (textDecoration === 'underline') {
            context.strokeStyle = fill;
            context.lineWidth = fontSize / 20;
            context.stroke();
        }
        context.restore();
    }
    _hitFunc(context) {
        context.beginPath();
        const glyphInfo = this.glyphInfo;
        if (glyphInfo.length >= 1) {
            const p0 = glyphInfo[0].p0;
            context.moveTo(p0.x, p0.y);
        }
        for (let i = 0; i < glyphInfo.length; i++) {
            const p1 = glyphInfo[i].p1;
            context.lineTo(p1.x, p1.y);
        }
        context.setAttr('lineWidth', this.fontSize());
        context.setAttr('strokeStyle', this.colorKey);
        context.stroke();
    }
    getTextWidth() {
        return this.textWidth;
    }
    getTextHeight() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');
        return this.textHeight;
    }
    setText(text) {
        return _Text_js__WEBPACK_IMPORTED_MODULE_4__.Text.prototype.setText.call(this, text);
    }
    _getContextFont() {
        return _Text_js__WEBPACK_IMPORTED_MODULE_4__.Text.prototype._getContextFont.call(this);
    }
    _getTextSize(text) {
        const dummyCanvas = this.dummyCanvas;
        const _context = dummyCanvas.getContext('2d');
        _context.save();
        _context.font = this._getContextFont();
        const metrics = _context.measureText(text);
        _context.restore();
        return {
            width: metrics.width,
            height: parseInt(`${this.fontSize()}`, 10),
        };
    }
    _setTextData() {
        const charArr = (0,_Text_js__WEBPACK_IMPORTED_MODULE_4__.stringToArray)(this.text());
        const chars = [];
        let width = 0;
        for (let i = 0; i < charArr.length; i++) {
            chars.push({
                char: charArr[i],
                width: this._getTextSize(charArr[i]).width,
            });
            width += chars[i].width;
        }
        const { height } = this._getTextSize(this.attrs.text);
        this.textWidth = width;
        this.textHeight = height;
        this.glyphInfo = [];
        if (!this.attrs.data) {
            return null;
        }
        const letterSpacing = this.letterSpacing();
        const align = this.align();
        const kerningFunc = this.kerningFunc();
        const textWidth = Math.max(this.textWidth + ((this.attrs.text || '').length - 1) * letterSpacing, 0);
        let offset = 0;
        if (align === 'center') {
            offset = Math.max(0, this.pathLength / 2 - textWidth / 2);
        }
        if (align === 'right') {
            offset = Math.max(0, this.pathLength - textWidth);
        }
        let offsetToGlyph = offset;
        for (let i = 0; i < chars.length; i++) {
            const charStartPoint = this._getPointAtLength(offsetToGlyph);
            if (!charStartPoint)
                return;
            const char = chars[i].char;
            let glyphWidth = chars[i].width + letterSpacing;
            if (char === ' ' && align === 'justify') {
                const numberOfSpaces = this.text().split(' ').length - 1;
                glyphWidth += (this.pathLength - textWidth) / numberOfSpaces;
            }
            const charEndPoint = this._getPointAtLength(offsetToGlyph + glyphWidth);
            if (!charEndPoint) {
                return;
            }
            const width = _Path_js__WEBPACK_IMPORTED_MODULE_3__.Path.getLineLength(charStartPoint.x, charStartPoint.y, charEndPoint.x, charEndPoint.y);
            let kern = 0;
            if (kerningFunc) {
                try {
                    kern = kerningFunc(chars[i - 1].char, char) * this.fontSize();
                }
                catch (e) {
                    kern = 0;
                }
            }
            charStartPoint.x += kern;
            charEndPoint.x += kern;
            this.textWidth += kern;
            const midpoint = _Path_js__WEBPACK_IMPORTED_MODULE_3__.Path.getPointOnLine(kern + width / 2.0, charStartPoint.x, charStartPoint.y, charEndPoint.x, charEndPoint.y);
            const rotation = Math.atan2(charEndPoint.y - charStartPoint.y, charEndPoint.x - charStartPoint.x);
            this.glyphInfo.push({
                transposeX: midpoint.x,
                transposeY: midpoint.y,
                text: charArr[i],
                rotation: rotation,
                p0: charStartPoint,
                p1: charEndPoint,
            });
            offsetToGlyph += glyphWidth;
        }
    }
    getSelfRect() {
        if (!this.glyphInfo.length) {
            return {
                x: 0,
                y: 0,
                width: 0,
                height: 0,
            };
        }
        const points = [];
        this.glyphInfo.forEach(function (info) {
            points.push(info.p0.x);
            points.push(info.p0.y);
            points.push(info.p1.x);
            points.push(info.p1.y);
        });
        let minX = points[0] || 0;
        let maxX = points[0] || 0;
        let minY = points[1] || 0;
        let maxY = points[1] || 0;
        let x, y;
        for (let i = 0; i < points.length / 2; i++) {
            x = points[i * 2];
            y = points[i * 2 + 1];
            minX = Math.min(minX, x);
            maxX = Math.max(maxX, x);
            minY = Math.min(minY, y);
            maxY = Math.max(maxY, y);
        }
        const fontSize = this.fontSize();
        return {
            x: minX - fontSize / 2,
            y: minY - fontSize / 2,
            width: maxX - minX + fontSize,
            height: maxY - minY + fontSize,
        };
    }
    destroy() {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.releaseCanvas(this.dummyCanvas);
        return super.destroy();
    }
}
TextPath.prototype._fillFunc = _fillFunc;
TextPath.prototype._strokeFunc = _strokeFunc;
TextPath.prototype._fillFuncHit = _fillFunc;
TextPath.prototype._strokeFuncHit = _strokeFunc;
TextPath.prototype.className = 'TextPath';
TextPath.prototype._attrsAffectingSize = ['text', 'fontSize', 'data'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_6__._registerNode)(TextPath);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'data');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'fontFamily', 'Arial');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'fontSize', 12, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_5__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'fontStyle', NORMAL);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'align', 'left');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'letterSpacing', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_5__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'textBaseline', 'middle');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'fontVariant', NORMAL);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'text', EMPTY_STRING);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'textDecoration', '');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(TextPath, 'kerningFunc', undefined);


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Transformer.js":
/*!******************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Transformer.js ***!
  \******************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Transformer": function() { return /* binding */ Transformer; }
/* harmony export */ });
/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util.js */ "./node_modules/konva/lib/Util.js");
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Node.js */ "./node_modules/konva/lib/Node.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Rect_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Rect.js */ "./node_modules/konva/lib/shapes/Rect.js");
/* harmony import */ var _Group_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Group.js */ "./node_modules/konva/lib/Group.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");









const EVENTS_NAME = 'tr-konva';
const ATTR_CHANGE_LIST = [
    'resizeEnabledChange',
    'rotateAnchorOffsetChange',
    'rotateEnabledChange',
    'enabledAnchorsChange',
    'anchorSizeChange',
    'borderEnabledChange',
    'borderStrokeChange',
    'borderStrokeWidthChange',
    'borderDashChange',
    'anchorStrokeChange',
    'anchorStrokeWidthChange',
    'anchorFillChange',
    'anchorCornerRadiusChange',
    'ignoreStrokeChange',
    'anchorStyleFuncChange',
]
    .map((e) => e + `.${EVENTS_NAME}`)
    .join(' ');
const NODES_RECT = 'nodesRect';
const TRANSFORM_CHANGE_STR = [
    'widthChange',
    'heightChange',
    'scaleXChange',
    'scaleYChange',
    'skewXChange',
    'skewYChange',
    'rotationChange',
    'offsetXChange',
    'offsetYChange',
    'transformsEnabledChange',
    'strokeWidthChange',
    'draggableChange',
];
const ANGLES = {
    'top-left': -45,
    'top-center': 0,
    'top-right': 45,
    'middle-right': -90,
    'middle-left': 90,
    'bottom-left': -135,
    'bottom-center': 180,
    'bottom-right': 135,
};
const TOUCH_DEVICE = "ontouchstart" in _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva._global;
function getCursor(anchorName, rad, rotateCursor) {
    if (anchorName === 'rotater') {
        return rotateCursor;
    }
    rad += _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.degToRad(ANGLES[anchorName] || 0);
    const angle = ((_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.radToDeg(rad) % 360) + 360) % 360;
    if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 315 + 22.5, 360) || _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 0, 22.5)) {
        return 'ns-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 45 - 22.5, 45 + 22.5)) {
        return 'nesw-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 90 - 22.5, 90 + 22.5)) {
        return 'ew-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 135 - 22.5, 135 + 22.5)) {
        return 'nwse-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 180 - 22.5, 180 + 22.5)) {
        return 'ns-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 225 - 22.5, 225 + 22.5)) {
        return 'nesw-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 270 - 22.5, 270 + 22.5)) {
        return 'ew-resize';
    }
    else if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(angle, 315 - 22.5, 315 + 22.5)) {
        return 'nwse-resize';
    }
    else {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Transformer has unknown angle for cursor detection: ' + angle);
        return 'pointer';
    }
}
const ANCHORS_NAMES = [
    'top-left',
    'top-center',
    'top-right',
    'middle-right',
    'middle-left',
    'bottom-left',
    'bottom-center',
    'bottom-right',
];
const MAX_SAFE_INTEGER = 100000000;
function getCenter(shape) {
    return {
        x: shape.x +
            (shape.width / 2) * Math.cos(shape.rotation) +
            (shape.height / 2) * Math.sin(-shape.rotation),
        y: shape.y +
            (shape.height / 2) * Math.cos(shape.rotation) +
            (shape.width / 2) * Math.sin(shape.rotation),
    };
}
function rotateAroundPoint(shape, angleRad, point) {
    const x = point.x +
        (shape.x - point.x) * Math.cos(angleRad) -
        (shape.y - point.y) * Math.sin(angleRad);
    const y = point.y +
        (shape.x - point.x) * Math.sin(angleRad) +
        (shape.y - point.y) * Math.cos(angleRad);
    return {
        ...shape,
        rotation: shape.rotation + angleRad,
        x,
        y,
    };
}
function rotateAroundCenter(shape, deltaRad) {
    const center = getCenter(shape);
    return rotateAroundPoint(shape, deltaRad, center);
}
function getSnap(snaps, newRotationRad, tol) {
    let snapped = newRotationRad;
    for (let i = 0; i < snaps.length; i++) {
        const angle = _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(snaps[i]);
        const absDiff = Math.abs(angle - newRotationRad) % (Math.PI * 2);
        const dif = Math.min(absDiff, Math.PI * 2 - absDiff);
        if (dif < tol) {
            snapped = angle;
        }
    }
    return snapped;
}
let activeTransformersCount = 0;
class Transformer extends _Group_js__WEBPACK_IMPORTED_MODULE_5__.Group {
    constructor(config) {
        super(config);
        this._movingAnchorName = null;
        this._transforming = false;
        this._createElements();
        this._handleMouseMove = this._handleMouseMove.bind(this);
        this._handleMouseUp = this._handleMouseUp.bind(this);
        this.update = this.update.bind(this);
        this.on(ATTR_CHANGE_LIST, this.update);
        if (this.getNode()) {
            this.update();
        }
    }
    attachTo(node) {
        this.setNode(node);
        return this;
    }
    setNode(node) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead.');
        return this.setNodes([node]);
    }
    getNode() {
        return this._nodes && this._nodes[0];
    }
    _getEventNamespace() {
        return EVENTS_NAME + this._id;
    }
    setNodes(nodes = []) {
        if (this._nodes && this._nodes.length) {
            this.detach();
        }
        const filteredNodes = nodes.filter((node) => {
            if (node.isAncestorOf(this)) {
                _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.error('Konva.Transformer cannot be an a child of the node you are trying to attach');
                return false;
            }
            return true;
        });
        this._nodes = nodes = filteredNodes;
        if (nodes.length === 1 && this.useSingleNodeRotation()) {
            this.rotation(nodes[0].getAbsoluteRotation());
        }
        else {
            this.rotation(0);
        }
        this._nodes.forEach((node) => {
            const onChange = () => {
                if (this.nodes().length === 1 && this.useSingleNodeRotation()) {
                    this.rotation(this.nodes()[0].getAbsoluteRotation());
                }
                this._resetTransformCache();
                if (!this._transforming && !this.isDragging()) {
                    this.update();
                }
            };
            if (node._attrsAffectingSize.length) {
                const additionalEvents = node._attrsAffectingSize
                    .map((prop) => prop + 'Change.' + this._getEventNamespace())
                    .join(' ');
                node.on(additionalEvents, onChange);
            }
            node.on(TRANSFORM_CHANGE_STR.map((e) => e + `.${this._getEventNamespace()}`).join(' '), onChange);
            node.on(`absoluteTransformChange.${this._getEventNamespace()}`, onChange);
            this._proxyDrag(node);
        });
        this._resetTransformCache();
        const elementsCreated = !!this.findOne('.top-left');
        if (elementsCreated) {
            this.update();
        }
        return this;
    }
    _proxyDrag(node) {
        let lastPos;
        node.on(`dragstart.${this._getEventNamespace()}`, (e) => {
            lastPos = node.getAbsolutePosition();
            if (!this.isDragging() && node !== this.findOne('.back')) {
                this.startDrag(e, false);
            }
        });
        node.on(`dragmove.${this._getEventNamespace()}`, (e) => {
            if (!lastPos) {
                return;
            }
            const abs = node.getAbsolutePosition();
            const dx = abs.x - lastPos.x;
            const dy = abs.y - lastPos.y;
            this.nodes().forEach((otherNode) => {
                if (otherNode === node) {
                    return;
                }
                if (otherNode.isDragging()) {
                    return;
                }
                const otherAbs = otherNode.getAbsolutePosition();
                otherNode.setAbsolutePosition({
                    x: otherAbs.x + dx,
                    y: otherAbs.y + dy,
                });
                otherNode.startDrag(e);
            });
            lastPos = null;
        });
    }
    getNodes() {
        return this._nodes || [];
    }
    getActiveAnchor() {
        return this._movingAnchorName;
    }
    detach() {
        if (this._nodes) {
            this._nodes.forEach((node) => {
                node.off('.' + this._getEventNamespace());
            });
        }
        this._nodes = [];
        this._resetTransformCache();
    }
    _resetTransformCache() {
        this._clearCache(NODES_RECT);
        this._clearCache('transform');
        this._clearSelfAndDescendantCache('absoluteTransform');
    }
    _getNodeRect() {
        return this._getCache(NODES_RECT, this.__getNodeRect);
    }
    __getNodeShape(node, rot = this.rotation(), relative) {
        const rect = node.getClientRect({
            skipTransform: true,
            skipShadow: true,
            skipStroke: this.ignoreStroke(),
        });
        const absScale = node.getAbsoluteScale(relative);
        const absPos = node.getAbsolutePosition(relative);
        const dx = rect.x * absScale.x - node.offsetX() * absScale.x;
        const dy = rect.y * absScale.y - node.offsetY() * absScale.y;
        const rotation = (_Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(node.getAbsoluteRotation()) + Math.PI * 2) %
            (Math.PI * 2);
        const box = {
            x: absPos.x + dx * Math.cos(rotation) + dy * Math.sin(-rotation),
            y: absPos.y + dy * Math.cos(rotation) + dx * Math.sin(rotation),
            width: rect.width * absScale.x,
            height: rect.height * absScale.y,
            rotation: rotation,
        };
        return rotateAroundPoint(box, -_Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(rot), {
            x: 0,
            y: 0,
        });
    }
    __getNodeRect() {
        const node = this.getNode();
        if (!node) {
            return {
                x: -MAX_SAFE_INTEGER,
                y: -MAX_SAFE_INTEGER,
                width: 0,
                height: 0,
                rotation: 0,
            };
        }
        const totalPoints = [];
        this.nodes().map((node) => {
            const box = node.getClientRect({
                skipTransform: true,
                skipShadow: true,
                skipStroke: this.ignoreStroke(),
            });
            const points = [
                { x: box.x, y: box.y },
                { x: box.x + box.width, y: box.y },
                { x: box.x + box.width, y: box.y + box.height },
                { x: box.x, y: box.y + box.height },
            ];
            const trans = node.getAbsoluteTransform();
            points.forEach(function (point) {
                const transformed = trans.point(point);
                totalPoints.push(transformed);
            });
        });
        const tr = new _Util_js__WEBPACK_IMPORTED_MODULE_0__.Transform();
        tr.rotate(-_Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation()));
        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
        totalPoints.forEach(function (point) {
            const transformed = tr.point(point);
            if (minX === undefined) {
                minX = maxX = transformed.x;
                minY = maxY = transformed.y;
            }
            minX = Math.min(minX, transformed.x);
            minY = Math.min(minY, transformed.y);
            maxX = Math.max(maxX, transformed.x);
            maxY = Math.max(maxY, transformed.y);
        });
        tr.invert();
        const p = tr.point({ x: minX, y: minY });
        return {
            x: p.x,
            y: p.y,
            width: maxX - minX,
            height: maxY - minY,
            rotation: _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation()),
        };
    }
    getX() {
        return this._getNodeRect().x;
    }
    getY() {
        return this._getNodeRect().y;
    }
    getWidth() {
        return this._getNodeRect().width;
    }
    getHeight() {
        return this._getNodeRect().height;
    }
    _createElements() {
        this._createBack();
        ANCHORS_NAMES.forEach((name) => {
            this._createAnchor(name);
        });
        this._createAnchor('rotater');
    }
    _createAnchor(name) {
        const anchor = new _Rect_js__WEBPACK_IMPORTED_MODULE_4__.Rect({
            stroke: 'rgb(0, 161, 255)',
            fill: 'white',
            strokeWidth: 1,
            name: name + ' _anchor',
            dragDistance: 0,
            draggable: true,
            hitStrokeWidth: TOUCH_DEVICE ? 10 : 'auto',
        });
        const self = this;
        anchor.on('mousedown touchstart', function (e) {
            self._handleMouseDown(e);
        });
        anchor.on('dragstart', (e) => {
            anchor.stopDrag();
            e.cancelBubble = true;
        });
        anchor.on('dragend', (e) => {
            e.cancelBubble = true;
        });
        anchor.on('mouseenter', () => {
            const rad = _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation());
            const rotateCursor = this.rotateAnchorCursor();
            const cursor = getCursor(name, rad, rotateCursor);
            anchor.getStage().content &&
                (anchor.getStage().content.style.cursor = cursor);
            this._cursorChange = true;
        });
        anchor.on('mouseout', () => {
            anchor.getStage().content &&
                (anchor.getStage().content.style.cursor = '');
            this._cursorChange = false;
        });
        this.add(anchor);
    }
    _createBack() {
        const back = new _Shape_js__WEBPACK_IMPORTED_MODULE_3__.Shape({
            name: 'back',
            width: 0,
            height: 0,
            sceneFunc(ctx, shape) {
                const tr = shape.getParent();
                const padding = tr.padding();
                ctx.beginPath();
                ctx.rect(-padding, -padding, shape.width() + padding * 2, shape.height() + padding * 2);
                ctx.moveTo(shape.width() / 2, -padding);
                if (tr.rotateEnabled() && tr.rotateLineVisible()) {
                    ctx.lineTo(shape.width() / 2, -tr.rotateAnchorOffset() * _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._sign(shape.height()) - padding);
                }
                ctx.fillStrokeShape(shape);
            },
            hitFunc: (ctx, shape) => {
                if (!this.shouldOverdrawWholeArea()) {
                    return;
                }
                const padding = this.padding();
                ctx.beginPath();
                ctx.rect(-padding, -padding, shape.width() + padding * 2, shape.height() + padding * 2);
                ctx.fillStrokeShape(shape);
            },
        });
        this.add(back);
        this._proxyDrag(back);
        back.on('dragstart', (e) => {
            e.cancelBubble = true;
        });
        back.on('dragmove', (e) => {
            e.cancelBubble = true;
        });
        back.on('dragend', (e) => {
            e.cancelBubble = true;
        });
        this.on('dragmove', (e) => {
            this.update();
        });
    }
    _handleMouseDown(e) {
        if (this._transforming) {
            return;
        }
        this._movingAnchorName = e.target.name().split(' ')[0];
        const attrs = this._getNodeRect();
        const width = attrs.width;
        const height = attrs.height;
        const hypotenuse = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        this.sin = Math.abs(height / hypotenuse);
        this.cos = Math.abs(width / hypotenuse);
        if (typeof window !== 'undefined') {
            window.addEventListener('mousemove', this._handleMouseMove);
            window.addEventListener('touchmove', this._handleMouseMove);
            window.addEventListener('mouseup', this._handleMouseUp, true);
            window.addEventListener('touchend', this._handleMouseUp, true);
        }
        this._transforming = true;
        const ap = e.target.getAbsolutePosition();
        const pos = e.target.getStage().getPointerPosition();
        this._anchorDragOffset = {
            x: pos.x - ap.x,
            y: pos.y - ap.y,
        };
        activeTransformersCount++;
        this._fire('transformstart', { evt: e.evt, target: this.getNode() });
        this._nodes.forEach((target) => {
            target._fire('transformstart', { evt: e.evt, target });
        });
    }
    _handleMouseMove(e) {
        let x, y, newHypotenuse;
        const anchorNode = this.findOne('.' + this._movingAnchorName);
        const stage = anchorNode.getStage();
        stage.setPointersPositions(e);
        const pp = stage.getPointerPosition();
        let newNodePos = {
            x: pp.x - this._anchorDragOffset.x,
            y: pp.y - this._anchorDragOffset.y,
        };
        const oldAbs = anchorNode.getAbsolutePosition();
        if (this.anchorDragBoundFunc()) {
            newNodePos = this.anchorDragBoundFunc()(oldAbs, newNodePos, e);
        }
        anchorNode.setAbsolutePosition(newNodePos);
        const newAbs = anchorNode.getAbsolutePosition();
        if (oldAbs.x === newAbs.x && oldAbs.y === newAbs.y) {
            return;
        }
        if (this._movingAnchorName === 'rotater') {
            const attrs = this._getNodeRect();
            x = anchorNode.x() - attrs.width / 2;
            y = -anchorNode.y() + attrs.height / 2;
            let delta = Math.atan2(-y, x) + Math.PI / 2;
            if (attrs.height < 0) {
                delta -= Math.PI;
            }
            const oldRotation = _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation());
            const newRotation = oldRotation + delta;
            const tol = _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotationSnapTolerance());
            const snappedRot = getSnap(this.rotationSnaps(), newRotation, tol);
            const diff = snappedRot - attrs.rotation;
            const shape = rotateAroundCenter(attrs, diff);
            this._fitNodesInto(shape, e);
            return;
        }
        const shiftBehavior = this.shiftBehavior();
        let keepProportion;
        if (shiftBehavior === 'inverted') {
            keepProportion = this.keepRatio() && !e.shiftKey;
        }
        else if (shiftBehavior === 'none') {
            keepProportion = this.keepRatio();
        }
        else {
            keepProportion = this.keepRatio() || e.shiftKey;
        }
        let centeredScaling = this.centeredScaling() || e.altKey;
        if (this._movingAnchorName === 'top-left') {
            if (keepProportion) {
                const comparePoint = centeredScaling
                    ? {
                        x: this.width() / 2,
                        y: this.height() / 2,
                    }
                    : {
                        x: this.findOne('.bottom-right').x(),
                        y: this.findOne('.bottom-right').y(),
                    };
                newHypotenuse = Math.sqrt(Math.pow(comparePoint.x - anchorNode.x(), 2) +
                    Math.pow(comparePoint.y - anchorNode.y(), 2));
                const reverseX = this.findOne('.top-left').x() > comparePoint.x ? -1 : 1;
                const reverseY = this.findOne('.top-left').y() > comparePoint.y ? -1 : 1;
                x = newHypotenuse * this.cos * reverseX;
                y = newHypotenuse * this.sin * reverseY;
                this.findOne('.top-left').x(comparePoint.x - x);
                this.findOne('.top-left').y(comparePoint.y - y);
            }
        }
        else if (this._movingAnchorName === 'top-center') {
            this.findOne('.top-left').y(anchorNode.y());
        }
        else if (this._movingAnchorName === 'top-right') {
            if (keepProportion) {
                const comparePoint = centeredScaling
                    ? {
                        x: this.width() / 2,
                        y: this.height() / 2,
                    }
                    : {
                        x: this.findOne('.bottom-left').x(),
                        y: this.findOne('.bottom-left').y(),
                    };
                newHypotenuse = Math.sqrt(Math.pow(anchorNode.x() - comparePoint.x, 2) +
                    Math.pow(comparePoint.y - anchorNode.y(), 2));
                const reverseX = this.findOne('.top-right').x() < comparePoint.x ? -1 : 1;
                const reverseY = this.findOne('.top-right').y() > comparePoint.y ? -1 : 1;
                x = newHypotenuse * this.cos * reverseX;
                y = newHypotenuse * this.sin * reverseY;
                this.findOne('.top-right').x(comparePoint.x + x);
                this.findOne('.top-right').y(comparePoint.y - y);
            }
            var pos = anchorNode.position();
            this.findOne('.top-left').y(pos.y);
            this.findOne('.bottom-right').x(pos.x);
        }
        else if (this._movingAnchorName === 'middle-left') {
            this.findOne('.top-left').x(anchorNode.x());
        }
        else if (this._movingAnchorName === 'middle-right') {
            this.findOne('.bottom-right').x(anchorNode.x());
        }
        else if (this._movingAnchorName === 'bottom-left') {
            if (keepProportion) {
                const comparePoint = centeredScaling
                    ? {
                        x: this.width() / 2,
                        y: this.height() / 2,
                    }
                    : {
                        x: this.findOne('.top-right').x(),
                        y: this.findOne('.top-right').y(),
                    };
                newHypotenuse = Math.sqrt(Math.pow(comparePoint.x - anchorNode.x(), 2) +
                    Math.pow(anchorNode.y() - comparePoint.y, 2));
                const reverseX = comparePoint.x < anchorNode.x() ? -1 : 1;
                const reverseY = anchorNode.y() < comparePoint.y ? -1 : 1;
                x = newHypotenuse * this.cos * reverseX;
                y = newHypotenuse * this.sin * reverseY;
                anchorNode.x(comparePoint.x - x);
                anchorNode.y(comparePoint.y + y);
            }
            pos = anchorNode.position();
            this.findOne('.top-left').x(pos.x);
            this.findOne('.bottom-right').y(pos.y);
        }
        else if (this._movingAnchorName === 'bottom-center') {
            this.findOne('.bottom-right').y(anchorNode.y());
        }
        else if (this._movingAnchorName === 'bottom-right') {
            if (keepProportion) {
                const comparePoint = centeredScaling
                    ? {
                        x: this.width() / 2,
                        y: this.height() / 2,
                    }
                    : {
                        x: this.findOne('.top-left').x(),
                        y: this.findOne('.top-left').y(),
                    };
                newHypotenuse = Math.sqrt(Math.pow(anchorNode.x() - comparePoint.x, 2) +
                    Math.pow(anchorNode.y() - comparePoint.y, 2));
                const reverseX = this.findOne('.bottom-right').x() < comparePoint.x ? -1 : 1;
                const reverseY = this.findOne('.bottom-right').y() < comparePoint.y ? -1 : 1;
                x = newHypotenuse * this.cos * reverseX;
                y = newHypotenuse * this.sin * reverseY;
                this.findOne('.bottom-right').x(comparePoint.x + x);
                this.findOne('.bottom-right').y(comparePoint.y + y);
            }
        }
        else {
            console.error(new Error('Wrong position argument of selection resizer: ' +
                this._movingAnchorName));
        }
        centeredScaling = this.centeredScaling() || e.altKey;
        if (centeredScaling) {
            const topLeft = this.findOne('.top-left');
            const bottomRight = this.findOne('.bottom-right');
            const topOffsetX = topLeft.x();
            const topOffsetY = topLeft.y();
            const bottomOffsetX = this.getWidth() - bottomRight.x();
            const bottomOffsetY = this.getHeight() - bottomRight.y();
            bottomRight.move({
                x: -topOffsetX,
                y: -topOffsetY,
            });
            topLeft.move({
                x: bottomOffsetX,
                y: bottomOffsetY,
            });
        }
        const absPos = this.findOne('.top-left').getAbsolutePosition();
        x = absPos.x;
        y = absPos.y;
        const width = this.findOne('.bottom-right').x() - this.findOne('.top-left').x();
        const height = this.findOne('.bottom-right').y() - this.findOne('.top-left').y();
        this._fitNodesInto({
            x: x,
            y: y,
            width: width,
            height: height,
            rotation: _Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation()),
        }, e);
    }
    _handleMouseUp(e) {
        this._removeEvents(e);
    }
    getAbsoluteTransform() {
        return this.getTransform();
    }
    _removeEvents(e) {
        var _a;
        if (this._transforming) {
            this._transforming = false;
            if (typeof window !== 'undefined') {
                window.removeEventListener('mousemove', this._handleMouseMove);
                window.removeEventListener('touchmove', this._handleMouseMove);
                window.removeEventListener('mouseup', this._handleMouseUp, true);
                window.removeEventListener('touchend', this._handleMouseUp, true);
            }
            const node = this.getNode();
            activeTransformersCount--;
            this._fire('transformend', { evt: e, target: node });
            (_a = this.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();
            if (node) {
                this._nodes.forEach((target) => {
                    var _a;
                    target._fire('transformend', { evt: e, target });
                    (_a = target.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();
                });
            }
            this._movingAnchorName = null;
        }
    }
    _fitNodesInto(newAttrs, evt) {
        const oldAttrs = this._getNodeRect();
        const minSize = 1;
        if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(newAttrs.width, -this.padding() * 2 - minSize, minSize)) {
            this.update();
            return;
        }
        if (_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._inRange(newAttrs.height, -this.padding() * 2 - minSize, minSize)) {
            this.update();
            return;
        }
        const t = new _Util_js__WEBPACK_IMPORTED_MODULE_0__.Transform();
        t.rotate(_Global_js__WEBPACK_IMPORTED_MODULE_6__.Konva.getAngle(this.rotation()));
        if (this._movingAnchorName &&
            newAttrs.width < 0 &&
            this._movingAnchorName.indexOf('left') >= 0) {
            const offset = t.point({
                x: -this.padding() * 2,
                y: 0,
            });
            newAttrs.x += offset.x;
            newAttrs.y += offset.y;
            newAttrs.width += this.padding() * 2;
            this._movingAnchorName = this._movingAnchorName.replace('left', 'right');
            this._anchorDragOffset.x -= offset.x;
            this._anchorDragOffset.y -= offset.y;
        }
        else if (this._movingAnchorName &&
            newAttrs.width < 0 &&
            this._movingAnchorName.indexOf('right') >= 0) {
            const offset = t.point({
                x: this.padding() * 2,
                y: 0,
            });
            this._movingAnchorName = this._movingAnchorName.replace('right', 'left');
            this._anchorDragOffset.x -= offset.x;
            this._anchorDragOffset.y -= offset.y;
            newAttrs.width += this.padding() * 2;
        }
        if (this._movingAnchorName &&
            newAttrs.height < 0 &&
            this._movingAnchorName.indexOf('top') >= 0) {
            const offset = t.point({
                x: 0,
                y: -this.padding() * 2,
            });
            newAttrs.x += offset.x;
            newAttrs.y += offset.y;
            this._movingAnchorName = this._movingAnchorName.replace('top', 'bottom');
            this._anchorDragOffset.x -= offset.x;
            this._anchorDragOffset.y -= offset.y;
            newAttrs.height += this.padding() * 2;
        }
        else if (this._movingAnchorName &&
            newAttrs.height < 0 &&
            this._movingAnchorName.indexOf('bottom') >= 0) {
            const offset = t.point({
                x: 0,
                y: this.padding() * 2,
            });
            this._movingAnchorName = this._movingAnchorName.replace('bottom', 'top');
            this._anchorDragOffset.x -= offset.x;
            this._anchorDragOffset.y -= offset.y;
            newAttrs.height += this.padding() * 2;
        }
        if (this.boundBoxFunc()) {
            const bounded = this.boundBoxFunc()(oldAttrs, newAttrs);
            if (bounded) {
                newAttrs = bounded;
            }
            else {
                _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('boundBoxFunc returned falsy. You should return new bound rect from it!');
            }
        }
        const baseSize = 10000000;
        const oldTr = new _Util_js__WEBPACK_IMPORTED_MODULE_0__.Transform();
        oldTr.translate(oldAttrs.x, oldAttrs.y);
        oldTr.rotate(oldAttrs.rotation);
        oldTr.scale(oldAttrs.width / baseSize, oldAttrs.height / baseSize);
        const newTr = new _Util_js__WEBPACK_IMPORTED_MODULE_0__.Transform();
        const newScaleX = newAttrs.width / baseSize;
        const newScaleY = newAttrs.height / baseSize;
        if (this.flipEnabled() === false) {
            newTr.translate(newAttrs.x, newAttrs.y);
            newTr.rotate(newAttrs.rotation);
            newTr.translate(newAttrs.width < 0 ? newAttrs.width : 0, newAttrs.height < 0 ? newAttrs.height : 0);
            newTr.scale(Math.abs(newScaleX), Math.abs(newScaleY));
        }
        else {
            newTr.translate(newAttrs.x, newAttrs.y);
            newTr.rotate(newAttrs.rotation);
            newTr.scale(newScaleX, newScaleY);
        }
        const delta = newTr.multiply(oldTr.invert());
        this._nodes.forEach((node) => {
            var _a;
            if (!node.getStage()) {
                return;
            }
            const parentTransform = node.getParent().getAbsoluteTransform();
            const localTransform = node.getTransform().copy();
            localTransform.translate(node.offsetX(), node.offsetY());
            const newLocalTransform = new _Util_js__WEBPACK_IMPORTED_MODULE_0__.Transform();
            newLocalTransform
                .multiply(parentTransform.copy().invert())
                .multiply(delta)
                .multiply(parentTransform)
                .multiply(localTransform);
            const attrs = newLocalTransform.decompose();
            node.setAttrs(attrs);
            (_a = node.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();
        });
        this.rotation(_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._getRotation(newAttrs.rotation));
        this._nodes.forEach((node) => {
            this._fire('transform', { evt: evt, target: node });
            node._fire('transform', { evt: evt, target: node });
        });
        this._resetTransformCache();
        this.update();
        this.getLayer().batchDraw();
    }
    forceUpdate() {
        this._resetTransformCache();
        this.update();
    }
    _batchChangeChild(selector, attrs) {
        const anchor = this.findOne(selector);
        anchor.setAttrs(attrs);
    }
    update() {
        var _a;
        const attrs = this._getNodeRect();
        this.rotation(_Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._getRotation(attrs.rotation));
        const width = attrs.width;
        const height = attrs.height;
        const enabledAnchors = this.enabledAnchors();
        const resizeEnabled = this.resizeEnabled();
        const padding = this.padding();
        const anchorSize = this.anchorSize();
        const anchors = this.find('._anchor');
        anchors.forEach((node) => {
            node.setAttrs({
                width: anchorSize,
                height: anchorSize,
                offsetX: anchorSize / 2,
                offsetY: anchorSize / 2,
                stroke: this.anchorStroke(),
                strokeWidth: this.anchorStrokeWidth(),
                fill: this.anchorFill(),
                cornerRadius: this.anchorCornerRadius(),
            });
        });
        this._batchChangeChild('.top-left', {
            x: 0,
            y: 0,
            offsetX: anchorSize / 2 + padding,
            offsetY: anchorSize / 2 + padding,
            visible: resizeEnabled && enabledAnchors.indexOf('top-left') >= 0,
        });
        this._batchChangeChild('.top-center', {
            x: width / 2,
            y: 0,
            offsetY: anchorSize / 2 + padding,
            visible: resizeEnabled && enabledAnchors.indexOf('top-center') >= 0,
        });
        this._batchChangeChild('.top-right', {
            x: width,
            y: 0,
            offsetX: anchorSize / 2 - padding,
            offsetY: anchorSize / 2 + padding,
            visible: resizeEnabled && enabledAnchors.indexOf('top-right') >= 0,
        });
        this._batchChangeChild('.middle-left', {
            x: 0,
            y: height / 2,
            offsetX: anchorSize / 2 + padding,
            visible: resizeEnabled && enabledAnchors.indexOf('middle-left') >= 0,
        });
        this._batchChangeChild('.middle-right', {
            x: width,
            y: height / 2,
            offsetX: anchorSize / 2 - padding,
            visible: resizeEnabled && enabledAnchors.indexOf('middle-right') >= 0,
        });
        this._batchChangeChild('.bottom-left', {
            x: 0,
            y: height,
            offsetX: anchorSize / 2 + padding,
            offsetY: anchorSize / 2 - padding,
            visible: resizeEnabled && enabledAnchors.indexOf('bottom-left') >= 0,
        });
        this._batchChangeChild('.bottom-center', {
            x: width / 2,
            y: height,
            offsetY: anchorSize / 2 - padding,
            visible: resizeEnabled && enabledAnchors.indexOf('bottom-center') >= 0,
        });
        this._batchChangeChild('.bottom-right', {
            x: width,
            y: height,
            offsetX: anchorSize / 2 - padding,
            offsetY: anchorSize / 2 - padding,
            visible: resizeEnabled && enabledAnchors.indexOf('bottom-right') >= 0,
        });
        this._batchChangeChild('.rotater', {
            x: width / 2,
            y: -this.rotateAnchorOffset() * _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util._sign(height) - padding,
            visible: this.rotateEnabled(),
        });
        this._batchChangeChild('.back', {
            width: width,
            height: height,
            visible: this.borderEnabled(),
            stroke: this.borderStroke(),
            strokeWidth: this.borderStrokeWidth(),
            dash: this.borderDash(),
            draggable: this.nodes().some((node) => node.draggable()),
            x: 0,
            y: 0,
        });
        const styleFunc = this.anchorStyleFunc();
        if (styleFunc) {
            anchors.forEach((node) => {
                styleFunc(node);
            });
        }
        (_a = this.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();
    }
    isTransforming() {
        return this._transforming;
    }
    stopTransform() {
        if (this._transforming) {
            this._removeEvents();
            const anchorNode = this.findOne('.' + this._movingAnchorName);
            if (anchorNode) {
                anchorNode.stopDrag();
            }
        }
    }
    destroy() {
        if (this.getStage() && this._cursorChange) {
            this.getStage().content && (this.getStage().content.style.cursor = '');
        }
        _Group_js__WEBPACK_IMPORTED_MODULE_5__.Group.prototype.destroy.call(this);
        this.detach();
        this._removeEvents();
        return this;
    }
    toObject() {
        return _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.toObject.call(this);
    }
    clone(obj) {
        const node = _Node_js__WEBPACK_IMPORTED_MODULE_2__.Node.prototype.clone.call(this, obj);
        return node;
    }
    getClientRect() {
        if (this.nodes().length > 0) {
            return super.getClientRect();
        }
        else {
            return { x: 0, y: 0, width: 0, height: 0 };
        }
    }
}
Transformer.isTransforming = () => {
    return activeTransformersCount > 0;
};
function validateAnchors(val) {
    if (!(val instanceof Array)) {
        _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('enabledAnchors value should be an array');
    }
    if (val instanceof Array) {
        val.forEach(function (name) {
            if (ANCHORS_NAMES.indexOf(name) === -1) {
                _Util_js__WEBPACK_IMPORTED_MODULE_0__.Util.warn('Unknown anchor name: ' +
                    name +
                    '. Available names are: ' +
                    ANCHORS_NAMES.join(', '));
            }
        });
    }
    return val || [];
}
Transformer.prototype.className = 'Transformer';
(0,_Global_js__WEBPACK_IMPORTED_MODULE_6__._registerNode)(Transformer);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'enabledAnchors', ANCHORS_NAMES, validateAnchors);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'flipEnabled', true, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getBooleanValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'resizeEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorSize', 10, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotateEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotateLineVisible', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotationSnaps', []);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotateAnchorOffset', 50, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotateAnchorCursor', 'crosshair');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'rotationSnapTolerance', 5, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'borderEnabled', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorStroke', 'rgb(0, 161, 255)');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorStrokeWidth', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorFill', 'white');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorCornerRadius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'borderStroke', 'rgb(0, 161, 255)');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'borderStrokeWidth', 1, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'borderDash');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'keepRatio', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'shiftBehavior', 'default');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'centeredScaling', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'ignoreStroke', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'padding', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_7__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'nodes');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'node');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'boundBoxFunc');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorDragBoundFunc');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'anchorStyleFunc');
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'shouldOverdrawWholeArea', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.addGetterSetter(Transformer, 'useSingleNodeRotation', true);
_Factory_js__WEBPACK_IMPORTED_MODULE_1__.Factory.backCompat(Transformer, {
    lineEnabled: 'borderEnabled',
    rotateHandlerOffset: 'rotateAnchorOffset',
    enabledHandlers: 'enabledAnchors',
});


/***/ }),

/***/ "./node_modules/konva/lib/shapes/Wedge.js":
/*!************************************************!*\
  !*** ./node_modules/konva/lib/shapes/Wedge.js ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Wedge": function() { return /* binding */ Wedge; }
/* harmony export */ });
/* harmony import */ var _Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Factory.js */ "./node_modules/konva/lib/Factory.js");
/* harmony import */ var _Shape_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Shape.js */ "./node_modules/konva/lib/Shape.js");
/* harmony import */ var _Global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Global.js */ "./node_modules/konva/lib/Global.js");
/* harmony import */ var _Validators_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Validators.js */ "./node_modules/konva/lib/Validators.js");





class Wedge extends _Shape_js__WEBPACK_IMPORTED_MODULE_1__.Shape {
    _sceneFunc(context) {
        context.beginPath();
        context.arc(0, 0, this.radius(), 0, _Global_js__WEBPACK_IMPORTED_MODULE_2__.Konva.getAngle(this.angle()), this.clockwise());
        context.lineTo(0, 0);
        context.closePath();
        context.fillStrokeShape(this);
    }
    getWidth() {
        return this.radius() * 2;
    }
    getHeight() {
        return this.radius() * 2;
    }
    setWidth(width) {
        this.radius(width / 2);
    }
    setHeight(height) {
        this.radius(height / 2);
    }
}
Wedge.prototype.className = 'Wedge';
Wedge.prototype._centroid = true;
Wedge.prototype._attrsAffectingSize = ['radius'];
(0,_Global_js__WEBPACK_IMPORTED_MODULE_2__._registerNode)(Wedge);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Wedge, 'radius', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Wedge, 'angle', 0, (0,_Validators_js__WEBPACK_IMPORTED_MODULE_3__.getNumberValidator)());
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.addGetterSetter(Wedge, 'clockwise', false);
_Factory_js__WEBPACK_IMPORTED_MODULE_0__.Factory.backCompat(Wedge, {
    angleDeg: 'angle',
    getAngleDeg: 'getAngle',
    setAngleDeg: 'setAngle',
});


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	!function() {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = function(module) {
/******/ 			var getter = module && module.__esModule ?
/******/ 				function() { return module['default']; } :
/******/ 				function() { return module; };
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
!function() {
"use strict";
var __webpack_exports__ = {};
/*!************************************************!*\
  !*** ./wagtail_helpdesk/static_src/js/main.ts ***!
  \************************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/stimulus-webpack-helpers */ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js");
/* harmony import */ var konva__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! konva */ "./node_modules/konva/lib/index.js");




console.log("test");

window.Stimulus = _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Application.start();
const context = __webpack_require__("./wagtail_helpdesk/static_src/js/controllers sync recursive \\.js$");
Stimulus.load((0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.definitionsFromContext)(context));

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const img = new Image();
img.src =
  "https://www.gardengourmet.nl/sites/default/files/styles/768_width/public/2024-08/vegan-burger.png?itok=pXKWu9wB";

canvas.width = 800;
canvas.height = 600;

let canvasCirclePositions = [
  [0.5, 0.5],
  [0.5, 0.2],
  [0.71, 0.29],
  [0.8, 0.5],
  [0.71, 0.71],
  [0.5, 0.8],
  [0.29, 0.71],
  [0.2, 0.5],
  [0.29, 0.29],
];

let circleRadius = 0.1 * canvas.height;

let amounts = [1, 2, 3, 4, 5, 6, 7, 8, 9];

ctx.font = "20px Arial";
ctx.fillText("Carbon Calculator", canvas.width / 20, canvas.height / 20);

ctx.beginPath();
for (let [i, position] of canvasCirclePositions.entries()) {
  ctx.moveTo(
    position[0] * canvas.width + circleRadius,
    position[1] * canvas.height
  );
  ctx.arc(
    position[0] * canvas.width,
    position[1] * canvas.height,
    circleRadius,
    0,
    2 * Math.PI
  );

  for (let j = 0; j < amounts[i]; j++)
    img.addEventListener("load", () => {
      ctx.drawImage(
        img,
        position[0] * canvas.width -
          0.5 * circleRadius +
          j * (circleRadius / amounts[i]),
        position[1] * canvas.height - (0.5 * circleRadius) / amounts[i],
        circleRadius / amounts[i],
        circleRadius / amounts[i]
      );
    });
}
ctx.stroke();

// first we need to create a stage
const stage = new konva__WEBPACK_IMPORTED_MODULE_2__["default"].Stage({
  container: "konva", // id of container <div>
  width: 800,
  height: 600,
});

// then create layer
const layer = new konva__WEBPACK_IMPORTED_MODULE_2__["default"].Layer();

// create our shapes
let circlePositions = [
  [0.5, 0.5],
  [0.5, 0.2],
  [0.71, 0.29],
  [0.8, 0.5],
  [0.71, 0.71],
  [0.5, 0.8],
  [0.29, 0.71],
  [0.2, 0.5],
  [0.29, 0.29],
];

function createCircle(x, y, radius) {
  return new konva__WEBPACK_IMPORTED_MODULE_2__["default"].Circle({
    x: x,
    y: y,
    radius: radius,
    fill: "white",
    stroke: "black",
  });
}

function createImage(x, y, width, height, source) {
  const imgObj = new Image();
  imgObj.src = source;

  return new konva__WEBPACK_IMPORTED_MODULE_2__["default"].Image({
    x: x,
    y: y,
    image: imgObj,
    width: width,
    height: height,
  });
}

for (let [i, position] of circlePositions.entries()) {
  // add the shapes to the layer
  layer.add(
    createCircle(
      stage.width() * position[0],
      stage.height() * position[1],
      stage.width() * 0.08
    )
  );

  for (let j = 0; j < amounts[i]; j++) {
    layer.add(
      createImage(
        position[0] * stage.width() -
          0.5 * circleRadius +
          j * (circleRadius / amounts[i]),
        position[1] * stage.height() - (0.5 * circleRadius) / amounts[i],
        circleRadius / amounts[i],
        circleRadius / amounts[i],
        "https://www.gardengourmet.nl/sites/default/files/styles/768_width/public/2024-08/vegan-burger.png?itok=pXKWu9wB"
      )
    );
  }
}

// add the layer to the stage
stage.add(layer);

}();
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
!function() {
"use strict";
/*!****************************************************!*\
  !*** ./wagtail_helpdesk/static_src/scss/main.scss ***!
  \****************************************************/
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin

}();
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUJBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseURBQXlEO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELDJDQUEyQztBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHdDQUF3QztBQUM1RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGtDQUFrQztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsS0FBSztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCx3QkFBd0IsR0FBRyxnQkFBZ0IsTUFBTSxjQUFjO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxQkFBcUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsNEJBQTRCO0FBQ2hFO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix3QkFBd0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsd0JBQXdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3QkFBd0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxZQUFZO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsWUFBWTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFlBQVk7QUFDaEQ7QUFDQSxnQ0FBZ0Msb0RBQW9ELElBQUksV0FBVztBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRCxvQkFBb0Isa0NBQWtDO0FBQ3RELHFDQUFxQyxpQ0FBaUM7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0MsZ0JBQWdCLGtDQUFrQztBQUNsRCxpQ0FBaUMsaUNBQWlDO0FBQ2xFLHFEQUFxRCxRQUFRO0FBQzdEO0FBQ0E7QUFDQSx1Q0FBdUMsS0FBSztBQUM1QztBQUNBO0FBQ0EsdUNBQXVDLEtBQUs7QUFDNUM7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLG1CQUFtQjtBQUNqRTtBQUNBO0FBQ0EsS0FBSyxJQUFJO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixLQUFLO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCLEdBQUcsZUFBZTtBQUN6RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLGNBQWMsS0FBSyxNQUFNO0FBQ3hDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0JBQWdCLEdBQUcsV0FBVztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDO0FBQ0E7QUFDQSwrQ0FBK0MsV0FBVyxxQkFBcUIsY0FBYyxJQUFJLFdBQVcsR0FBRyxXQUFXLFNBQVMscUJBQXFCLElBQUksV0FBVztBQUN2Syx1QkFBdUIsZUFBZTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLCtCQUErQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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L0M7QUFDQTtBQUNBLDRCQUE0QixVQUFVO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsT0FBTztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7OztBQ2pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxrQkFBa0IsMEJBQTBCO0FBQzVDO0FBQ0E7O0FBRUEsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMxQm1DO0FBQ0Y7QUFDakM7QUFDQSxRQUFRLHdEQUFnQixJQUFJLDREQUFvQjtBQUNoRDtBQUNBLG1CQUFtQiw0REFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixTQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwyREFBcUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkRBQXFCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN0lPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ0E7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE9BQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMvd0JpQztBQUN1QjtBQUNwQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhEQUF3QjtBQUMzQztBQUNBO0FBQ0EsaUNBQWlDLHNFQUE4QjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSSx3REFBa0I7QUFDdEI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHdEQUFnQjtBQUM5RDtBQUNBLHVCQUF1Qiw4REFBd0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnREFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsMkJBQTJCLGdEQUFnRDtBQUMzRTtBQUNBLDJCQUEyQixxREFBWTtBQUN2QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsOERBQXdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0RBQVU7QUFDbEI7QUFDQTtBQUNBO0FBQ087QUFDUCwyQkFBMkIscUJBQXFCO0FBQ2hEO0FBQ0E7QUFDQSwyQkFBMkIsbURBQVU7QUFDckM7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4SXVDO0FBQ047QUFDb0I7QUFDOUMsd0JBQXdCLDBDQUFJO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIscUJBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixrRUFBNEI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLCtEQUF5QjtBQUM5QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHdCQUF3QixtQkFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUF1QixnQ0FBZ0Msa0VBQWtCO0FBQ3pFLGdFQUF1QixnQ0FBZ0Msa0VBQWtCO0FBQ3pFLGdFQUF1QixvQ0FBb0Msa0VBQWtCO0FBQzdFLGdFQUF1QixxQ0FBcUMsa0VBQWtCO0FBQzlFLGdFQUF1Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDM1RVO0FBQ0c7QUFDcEM7QUFDQSxnREFBZ0QsMENBQUk7QUFDcEQsb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZIQUE2SDtBQUM3SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDhEQUF3QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxZQUFZLHlEQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbURBQWE7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTCxDQUFDO0FBQ007QUFDUCwwQkFBMEIsNkJBQTZCLElBQUk7QUFDM0Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLCtDQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0RBQWM7QUFDOUMsNEJBQTRCLFNBQVM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1EQUFjO0FBQzNDO0FBQ0EsWUFBWSxnREFBVTtBQUN0QjtBQUNBLHdCQUF3QixvREFBUztBQUNqQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtREFBYTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdFQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZ0VBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxTQUFTO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHNEQUFnQjtBQUMxRCxrQ0FBa0Msc0RBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxTQUFTO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQWdCO0FBQ3BDLHNCQUFzQixzREFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG1EQUFhO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxTQUFTO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsU0FBUztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsaEJvQztBQUNwQzs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHdCQUF3QixJQUFJLE1BQU0sSUFBSSxNQUFNLElBQUk7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE9BQU87QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxlQUFlLHNEQUFjO0FBQzdCLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGFBQWEsMERBQWtCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZUFBZTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0JBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxVQUFVO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxFQUFFO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxVQUFVO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFpQjtBQUN4QztBQUNBLHVCQUF1QiwwRUFBcUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxTQUFTO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxTQUFTO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFhO0FBQ2IsZ0VBQXVCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3cEJpQjtBQUNKO0FBQ1M7QUFDWDtBQUNvQztBQUMvRCxtQkFBbUIsNENBQUs7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDhEQUF3QjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBYTtBQUNiLGdFQUF1QiwwQkFBMEIsa0ZBQWtDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyQjNDO0FBQ0o7QUFDdUQ7QUFDOUM7QUFDWDtBQUMzQiw2QkFBNkIsNENBQUs7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixtQkFBbUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGlFQUEyQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFdBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFhO0FBQ2IsZ0VBQXVCLDhCQUE4QixrRUFBa0I7QUFDdkUsZ0VBQXVCLDZCQUE2QixrRUFBa0I7QUFDdEUsZ0VBQXVCLG9DQUFvQyxrRkFBa0M7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkVyRDtBQUNKO0FBQ2tCO0FBQ1Q7QUFDN0M7QUFDTyxtQkFBbUIsNENBQUs7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQWE7QUFDYixnRUFBdUIseUJBQXlCLGtFQUFrQjtBQUNsRSxnRUFBdUIseUJBQXlCLGtFQUFrQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaEMxQjtBQUNKO0FBQ1E7QUFDVTtBQUNUO0FBQ3RDLHFCQUFxQiw0Q0FBSztBQUNqQztBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isb0RBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBYTtBQUNiLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUIsMEJBQTBCLGtFQUFrQjtBQUNuRSxnRUFBdUIsMEJBQTBCLGtFQUFrQjtBQUNuRSwyREFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzR3VDO0FBQ0o7QUFDa0I7QUFDVDtBQUN0QyxtQkFBbUIsNENBQUs7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFhO0FBQ2IsZ0VBQXVCLHVCQUF1QixrRUFBa0I7QUFDaEUsZ0VBQXVCLHlCQUF5QixrRUFBa0I7QUFDbEUsZ0VBQXVCLHlCQUF5QixrRUFBa0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyQ2hDO0FBQ007QUFDSjtBQUNDO0FBQ3FGO0FBQzdFO0FBQ3RDO0FBQ1A7QUFDQSxnQkFBZ0IsTUFBTTtBQUN0QjtBQUNBLGdDQUFnQyxlQUFlO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLG9CQUFvQixFQUFFO0FBQzNDO0FBQ0E7QUFDQSxrQ0FBa0MsR0FBRyxJQUFJLEdBQUcsSUFBSSxHQUFHO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE9BQU87QUFDaEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4REFBd0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sbUJBQW1CLDRDQUFLO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxpRUFBeUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0JBQWdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGlFQUF5QjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1CQUFtQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxjQUFjO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxpRUFBeUI7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvREFBYztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0NBQVM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBYTtBQUNiLGdFQUF1QixnQkFBZ0Isd0VBQXdCO0FBQy9ELGdFQUF1QixpQkFBaUIsd0VBQXdCO0FBQ2hFLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCLHVCQUF1QixrRUFBa0I7QUFDaEUsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUIscUJBQXFCLGtFQUFrQjtBQUM5RCxnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1Qix3QkFBd0Isa0VBQWtCO0FBQ2pFLGdFQUF1QjtBQUN2QixnRUFBdUIsMEJBQTBCLG1FQUFtQjtBQUNwRSxnRUFBdUIsMkJBQTJCLGtFQUFrQjtBQUNwRSxnRUFBdUIsbUJBQW1CLGtFQUFrQjtBQUM1RCxnRUFBdUI7QUFDdkIsZ0VBQXVCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzNjVztBQUNNO0FBQ0o7QUFDSDtBQUNlO0FBQ007QUFDVDtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHVCQUF1Qiw0Q0FBSztBQUNuQztBQUNBO0FBQ0EsMkJBQTJCLDhEQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx3REFBa0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxzRUFBZ0M7QUFDL0M7QUFDQTtBQUNBLHlCQUF5Qix3REFBa0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQkFBc0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtDQUFTO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUVBQTJCO0FBQzFDO0FBQ0E7QUFDQSxlQUFlLHlFQUFtQztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxnQkFBZ0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVEQUFhO0FBQ3JDO0FBQ0E7QUFDQSx3QkFBd0Isb0JBQW9CO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix3REFBa0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHlEQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsd0RBQWtCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFhO0FBQ2IsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUIsMkJBQTJCLGtFQUFrQjtBQUNwRSxnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QiwrQkFBK0Isa0VBQWtCO0FBQ3hFLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZQc0I7QUFDTDtBQUNOO0FBQ0U7QUFDSDtBQUNHO0FBQ0M7QUFDc0M7QUFDOUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBK0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLG1EQUFhO0FBQ3hCLG9CQUFvQixtREFBYTtBQUNqQyxRQUFRLG1EQUFhLDRCQUE0QixtREFBYTtBQUM5RDtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0EsYUFBYSxtREFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdEQUFVO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isa0JBQWtCO0FBQ3RDLHNCQUFzQixzREFBYztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTywwQkFBMEIsNENBQUs7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrQ0FBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGdEQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELDBCQUEwQjtBQUN0RiwrQ0FBK0MsMEJBQTBCO0FBQ3pFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwwQkFBMEI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsNEJBQTRCLDBCQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBYztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHNEQUFjO0FBQ3JEO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0Esa0JBQWtCLG9CQUFvQjtBQUN0QyxrQkFBa0IsZ0NBQWdDO0FBQ2xELGtCQUFrQiw2Q0FBNkM7QUFDL0Qsa0JBQWtCLGlDQUFpQztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVCx1QkFBdUIsK0NBQVM7QUFDaEMsbUJBQW1CLHNEQUFjO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSw2QkFBNkIsa0JBQWtCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isc0RBQWM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwwQ0FBSTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx3QkFBd0Isc0RBQWM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNENBQUs7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsZ0RBQVU7QUFDdkY7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLG9DQUFvQztBQUMzRTtBQUNBLDZDQUE2QyxvQkFBb0I7QUFDakUsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHNEQUFjO0FBQzlDO0FBQ0Esd0JBQXdCLHNEQUFjO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixzREFBYztBQUNwQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsc0JBQXNCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGdCQUFnQjtBQUNuRTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbURBQWE7QUFDekI7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtREFBYTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsK0NBQVM7QUFDL0IsaUJBQWlCLHNEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0NBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtDQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwrQ0FBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQywrQ0FBUztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHNCQUFzQix1REFBaUI7QUFDdkM7QUFDQSxzQ0FBc0Msd0JBQXdCO0FBQzlELHNDQUFzQyx3QkFBd0I7QUFDOUQsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix1REFBaUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDRDQUE0QyxnREFBVTtBQUN0RDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsbUVBQTRCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtFQUE0QjtBQUMzQztBQUNBO0FBQ0EscUJBQXFCLCtEQUF5QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrQ0FBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrQ0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFhO0FBQ2IsZ0VBQXVCO0FBQ3ZCLGdFQUF1QixtQ0FBbUMsbUVBQW1CO0FBQzdFLGdFQUF1QjtBQUN2QixnRUFBdUIsZ0NBQWdDLGtFQUFrQjtBQUN6RSxnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUIsd0NBQXdDLGtFQUFrQjtBQUNqRixnRUFBdUI7QUFDdkIsZ0VBQXVCLDBDQUEwQyxrRUFBa0I7QUFDbkYsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUIsc0NBQXNDLGtFQUFrQjtBQUMvRSxnRUFBdUI7QUFDdkIsZ0VBQXVCLHVDQUF1QyxrRUFBa0I7QUFDaEYsZ0VBQXVCO0FBQ3ZCLGdFQUF1QixzQ0FBc0Msa0VBQWtCO0FBQy9FLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCLDRCQUE0QixrRUFBa0I7QUFDckUsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLGdFQUF1QjtBQUN2QixnRUFBdUI7QUFDdkIsZ0VBQXVCO0FBQ3ZCLDJEQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2gvQnVDO0FBQ0o7QUFDQztBQUNpQjtBQUNUO0FBQ3RDLG9CQUFvQiw0Q0FBSztBQUNoQztBQUNBO0FBQ0EsNENBQTRDLHNEQUFjO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBYTtBQUNiLGdFQUF1QixxQkFBcUIsa0VBQWtCO0FBQzlELGdFQUF1QixvQkFBb0Isa0VBQWtCO0FBQzdELGdFQUF1QjtBQUN2QiwyREFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7Ozs7OztVQ3JDRDtVQUNBOztVQUVBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBOztVQUVBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBOzs7OztXQ3RCQTtXQUNBO1dBQ0E7V0FDQSxlQUFlLDRCQUE0QjtXQUMzQyxlQUFlO1dBQ2YsaUNBQWlDLFdBQVc7V0FDNUM7V0FDQTs7Ozs7V0NQQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLHlDQUF5Qyx3Q0FBd0M7V0FDakY7V0FDQTtXQUNBOzs7OztXQ1BBLDhDQUE4Qzs7Ozs7V0NBOUM7V0FDQTtXQUNBO1dBQ0EsdURBQXVELGlCQUFpQjtXQUN4RTtXQUNBLGdEQUFnRCxhQUFhO1dBQzdEOzs7Ozs7Ozs7Ozs7Ozs7O0FDTmlEO0FBQzJCO0FBQ2xEOztBQUUxQjs7QUFFQSxrQkFBa0IsaUVBQWlCO0FBQ25DLGdCQUFnQix5RkFBK0M7QUFDL0QsY0FBYywwRkFBc0I7O0FBRXBDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixnQkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQixtREFBVztBQUM3QjtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0Esa0JBQWtCLG1EQUFXOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLG9EQUFZO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGFBQWEsbURBQVc7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGdCQUFnQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7O0FDNUlBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9AaG90d2lyZWQvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzL2Rpc3Qvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMvQGhvdHdpcmVkL3N0aW11bHVzL2Rpc3Qvc3RpbXVsdXMuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9kaXNjbG9zdXJlLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9uYXZpZ2F0aW9uLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9xdWVzdGlvbi1mb3JtLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9zZWFyY2gtd2lkZ2V0LWJ1aWxkZXItY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vd2FndGFpbF9oZWxwZGVzay9zdGF0aWNfc3JjL2pzL2NvbnRyb2xsZXJzL3NvY2lhbC1zaGFyZS1idXR0b25zLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9jb3B5LXRvLWNsaXBib2FyZC9pbmRleC5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL3RvZ2dsZS1zZWxlY3Rpb24vaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy8gc3luYyBcXC5qcyQiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvQW5pbWF0aW9uLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL0JlemllckZ1bmN0aW9ucy5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9DYW52YXMuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvQ29udGFpbmVyLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL0NvbnRleHQuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvRHJhZ0FuZERyb3AuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9GYXN0TGF5ZXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvR2xvYmFsLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL0dyb3VwLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL0xheWVyLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL05vZGUuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvUG9pbnRlckV2ZW50cy5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9TaGFwZS5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9TdGFnZS5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9Ud2Vlbi5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9VdGlsLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL1ZhbGlkYXRvcnMuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvX0NvcmVJbnRlcm5hbHMuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvX0Z1bGxJbnRlcm5hbHMuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9CbHVyLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvQnJpZ2h0ZW4uanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9CcmlnaHRuZXNzLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvQ29udHJhc3QuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9FbWJvc3MuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9FbmhhbmNlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvR3JheXNjYWxlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvSFNMLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvSFNWLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvSW52ZXJ0LmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvS2FsZWlkb3Njb3BlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvTWFzay5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9maWx0ZXJzL05vaXNlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvUGl4ZWxhdGUuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9Qb3N0ZXJpemUuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9SR0IuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9SR0JBLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL2ZpbHRlcnMvU2VwaWEuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvZmlsdGVycy9Tb2xhcml6ZS5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9maWx0ZXJzL1RocmVzaG9sZC5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9pbmRleC5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9zaGFwZXMvQXJjLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9BcnJvdy5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9zaGFwZXMvQ2lyY2xlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9FbGxpcHNlLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9JbWFnZS5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9zaGFwZXMvTGFiZWwuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL0xpbmUuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1BhdGguanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1JlY3QuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1JlZ3VsYXJQb2x5Z29uLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9SaW5nLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9TcHJpdGUuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1N0YXIuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1RleHQuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL25vZGVfbW9kdWxlcy9rb252YS9saWIvc2hhcGVzL1RleHRQYXRoLmpzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi9ub2RlX21vZHVsZXMva29udmEvbGliL3NoYXBlcy9UcmFuc2Zvcm1lci5qcyIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrLy4vbm9kZV9tb2R1bGVzL2tvbnZhL2xpYi9zaGFwZXMvV2VkZ2UuanMiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly93YWd0YWlsLWhlbHBkZXNrL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vd2FndGFpbC1oZWxwZGVzay8uL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9tYWluLnRzIiwid2VicGFjazovL3dhZ3RhaWwtaGVscGRlc2svLi93YWd0YWlsX2hlbHBkZXNrL3N0YXRpY19zcmMvc2Nzcy9tYWluLnNjc3M/MmIwMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuU3RpbXVsdXMgV2VicGFjayBIZWxwZXJzIDEuMC4wXG5Db3B5cmlnaHQgwqkgMjAyMSBCYXNlY2FtcCwgTExDXG4gKi9cbmZ1bmN0aW9uIGRlZmluaXRpb25zRnJvbUNvbnRleHQoY29udGV4dCkge1xuICAgIHJldHVybiBjb250ZXh0LmtleXMoKVxuICAgICAgICAubWFwKChrZXkpID0+IGRlZmluaXRpb25Gb3JNb2R1bGVXaXRoQ29udGV4dEFuZEtleShjb250ZXh0LCBrZXkpKVxuICAgICAgICAuZmlsdGVyKCh2YWx1ZSkgPT4gdmFsdWUpO1xufVxuZnVuY3Rpb24gZGVmaW5pdGlvbkZvck1vZHVsZVdpdGhDb250ZXh0QW5kS2V5KGNvbnRleHQsIGtleSkge1xuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBpZGVudGlmaWVyRm9yQ29udGV4dEtleShrZXkpO1xuICAgIGlmIChpZGVudGlmaWVyKSB7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllcihjb250ZXh0KGtleSksIGlkZW50aWZpZXIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyKG1vZHVsZSwgaWRlbnRpZmllcikge1xuICAgIGNvbnN0IGNvbnRyb2xsZXJDb25zdHJ1Y3RvciA9IG1vZHVsZS5kZWZhdWx0O1xuICAgIGlmICh0eXBlb2YgY29udHJvbGxlckNvbnN0cnVjdG9yID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4geyBpZGVudGlmaWVyLCBjb250cm9sbGVyQ29uc3RydWN0b3IgfTtcbiAgICB9XG59XG5mdW5jdGlvbiBpZGVudGlmaWVyRm9yQ29udGV4dEtleShrZXkpIHtcbiAgICBjb25zdCBsb2dpY2FsTmFtZSA9IChrZXkubWF0Y2goL14oPzpcXC5cXC8pPyguKykoPzpbXy1dY29udHJvbGxlclxcLi4rPykkLykgfHwgW10pWzFdO1xuICAgIGlmIChsb2dpY2FsTmFtZSkge1xuICAgICAgICByZXR1cm4gbG9naWNhbE5hbWUucmVwbGFjZSgvXy9nLCBcIi1cIikucmVwbGFjZSgvXFwvL2csIFwiLS1cIik7XG4gICAgfVxufVxuXG5leHBvcnQgeyBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllciwgZGVmaW5pdGlvbkZvck1vZHVsZVdpdGhDb250ZXh0QW5kS2V5LCBkZWZpbml0aW9uc0Zyb21Db250ZXh0LCBpZGVudGlmaWVyRm9yQ29udGV4dEtleSB9O1xuIiwiLypcblN0aW11bHVzIDMuMi4xXG5Db3B5cmlnaHQgwqkgMjAyMiBCYXNlY2FtcCwgTExDXG4gKi9cbmNsYXNzIEV2ZW50TGlzdGVuZXIge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXQ7XG4gICAgICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgICAgICB0aGlzLmV2ZW50T3B0aW9ucyA9IGV2ZW50T3B0aW9ucztcbiAgICAgICAgdGhpcy51bm9yZGVyZWRCaW5kaW5ncyA9IG5ldyBTZXQoKTtcbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCB0aGlzLCB0aGlzLmV2ZW50T3B0aW9ucyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgdGhpcywgdGhpcy5ldmVudE9wdGlvbnMpO1xuICAgIH1cbiAgICBiaW5kaW5nQ29ubmVjdGVkKGJpbmRpbmcpIHtcbiAgICAgICAgdGhpcy51bm9yZGVyZWRCaW5kaW5ncy5hZGQoYmluZGluZyk7XG4gICAgfVxuICAgIGJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZykge1xuICAgICAgICB0aGlzLnVub3JkZXJlZEJpbmRpbmdzLmRlbGV0ZShiaW5kaW5nKTtcbiAgICB9XG4gICAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZXh0ZW5kZWRFdmVudCA9IGV4dGVuZEV2ZW50KGV2ZW50KTtcbiAgICAgICAgZm9yIChjb25zdCBiaW5kaW5nIG9mIHRoaXMuYmluZGluZ3MpIHtcbiAgICAgICAgICAgIGlmIChleHRlbmRlZEV2ZW50LmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmluZGluZy5oYW5kbGVFdmVudChleHRlbmRlZEV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBoYXNCaW5kaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudW5vcmRlcmVkQmluZGluZ3Muc2l6ZSA+IDA7XG4gICAgfVxuICAgIGdldCBiaW5kaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy51bm9yZGVyZWRCaW5kaW5ncykuc29ydCgobGVmdCwgcmlnaHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxlZnRJbmRleCA9IGxlZnQuaW5kZXgsIHJpZ2h0SW5kZXggPSByaWdodC5pbmRleDtcbiAgICAgICAgICAgIHJldHVybiBsZWZ0SW5kZXggPCByaWdodEluZGV4ID8gLTEgOiBsZWZ0SW5kZXggPiByaWdodEluZGV4ID8gMSA6IDA7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGV4dGVuZEV2ZW50KGV2ZW50KSB7XG4gICAgaWYgKFwiaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkXCIgaW4gZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgeyBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gfSA9IGV2ZW50O1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihldmVudCwge1xuICAgICAgICAgICAgaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiBmYWxzZSxcbiAgICAgICAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNsYXNzIERpc3BhdGNoZXIge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyTWFwcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoZXZlbnRMaXN0ZW5lcikgPT4gZXZlbnRMaXN0ZW5lci5jb25uZWN0KCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKChldmVudExpc3RlbmVyKSA9PiBldmVudExpc3RlbmVyLmRpc2Nvbm5lY3QoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmV2ZW50TGlzdGVuZXJNYXBzLnZhbHVlcygpKS5yZWR1Y2UoKGxpc3RlbmVycywgbWFwKSA9PiBsaXN0ZW5lcnMuY29uY2F0KEFycmF5LmZyb20obWFwLnZhbHVlcygpKSksIFtdKTtcbiAgICB9XG4gICAgYmluZGluZ0Nvbm5lY3RlZChiaW5kaW5nKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKS5iaW5kaW5nQ29ubmVjdGVkKGJpbmRpbmcpO1xuICAgIH1cbiAgICBiaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcsIGNsZWFyRXZlbnRMaXN0ZW5lcnMgPSBmYWxzZSkge1xuICAgICAgICB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lckZvckJpbmRpbmcoYmluZGluZykuYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nKTtcbiAgICAgICAgaWYgKGNsZWFyRXZlbnRMaXN0ZW5lcnMpXG4gICAgICAgICAgICB0aGlzLmNsZWFyRXZlbnRMaXN0ZW5lcnNGb3JCaW5kaW5nKGJpbmRpbmcpO1xuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsID0ge30pIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbi5oYW5kbGVFcnJvcihlcnJvciwgYEVycm9yICR7bWVzc2FnZX1gLCBkZXRhaWwpO1xuICAgIH1cbiAgICBjbGVhckV2ZW50TGlzdGVuZXJzRm9yQmluZGluZyhiaW5kaW5nKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50TGlzdGVuZXIgPSB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lckZvckJpbmRpbmcoYmluZGluZyk7XG4gICAgICAgIGlmICghZXZlbnRMaXN0ZW5lci5oYXNCaW5kaW5ncygpKSB7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTWFwcGVkRXZlbnRMaXN0ZW5lckZvcihiaW5kaW5nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmVNYXBwZWRFdmVudExpc3RlbmVyRm9yKGJpbmRpbmcpIHtcbiAgICAgICAgY29uc3QgeyBldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMgfSA9IGJpbmRpbmc7XG4gICAgICAgIGNvbnN0IGV2ZW50TGlzdGVuZXJNYXAgPSB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lck1hcEZvckV2ZW50VGFyZ2V0KGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmNhY2hlS2V5KGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgZXZlbnRMaXN0ZW5lck1hcC5kZWxldGUoY2FjaGVLZXkpO1xuICAgICAgICBpZiAoZXZlbnRMaXN0ZW5lck1hcC5zaXplID09IDApXG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJNYXBzLmRlbGV0ZShldmVudFRhcmdldCk7XG4gICAgfVxuICAgIGZldGNoRXZlbnRMaXN0ZW5lckZvckJpbmRpbmcoYmluZGluZykge1xuICAgICAgICBjb25zdCB7IGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyB9ID0gYmluZGluZztcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgfVxuICAgIGZldGNoRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lck1hcCA9IHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyTWFwRm9yRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpO1xuICAgICAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuY2FjaGVLZXkoZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgICAgICBsZXQgZXZlbnRMaXN0ZW5lciA9IGV2ZW50TGlzdGVuZXJNYXAuZ2V0KGNhY2hlS2V5KTtcbiAgICAgICAgaWYgKCFldmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyID0gdGhpcy5jcmVhdGVFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyTWFwLnNldChjYWNoZUtleSwgZXZlbnRMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50TGlzdGVuZXI7XG4gICAgfVxuICAgIGNyZWF0ZUV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50TGlzdGVuZXIgPSBuZXcgRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyLmNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRMaXN0ZW5lcjtcbiAgICB9XG4gICAgZmV0Y2hFdmVudExpc3RlbmVyTWFwRm9yRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpIHtcbiAgICAgICAgbGV0IGV2ZW50TGlzdGVuZXJNYXAgPSB0aGlzLmV2ZW50TGlzdGVuZXJNYXBzLmdldChldmVudFRhcmdldCk7XG4gICAgICAgIGlmICghZXZlbnRMaXN0ZW5lck1hcCkge1xuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lck1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMuc2V0KGV2ZW50VGFyZ2V0LCBldmVudExpc3RlbmVyTWFwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRMaXN0ZW5lck1hcDtcbiAgICB9XG4gICAgY2FjaGVLZXkoZXZlbnROYW1lLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgcGFydHMgPSBbZXZlbnROYW1lXTtcbiAgICAgICAgT2JqZWN0LmtleXMoZXZlbnRPcHRpb25zKVxuICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgcGFydHMucHVzaChgJHtldmVudE9wdGlvbnNba2V5XSA/IFwiXCIgOiBcIiFcIn0ke2tleX1gKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKFwiOlwiKTtcbiAgICB9XG59XG5cbmNvbnN0IGRlZmF1bHRBY3Rpb25EZXNjcmlwdG9yRmlsdGVycyA9IHtcbiAgICBzdG9wKHsgZXZlbnQsIHZhbHVlIH0pIHtcbiAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgcHJldmVudCh7IGV2ZW50LCB2YWx1ZSB9KSB7XG4gICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgc2VsZih7IGV2ZW50LCB2YWx1ZSwgZWxlbWVudCB9KSB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQgPT09IGV2ZW50LnRhcmdldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5jb25zdCBkZXNjcmlwdG9yUGF0dGVybiA9IC9eKD86KC4rPykoPzpcXC4oLis/KSk/KD86QCh3aW5kb3d8ZG9jdW1lbnQpKT8tPik/KC4rPykoPzojKFteOl0rPykpKD86OiguKykpPyQvO1xuZnVuY3Rpb24gcGFyc2VBY3Rpb25EZXNjcmlwdG9yU3RyaW5nKGRlc2NyaXB0b3JTdHJpbmcpIHtcbiAgICBjb25zdCBzb3VyY2UgPSBkZXNjcmlwdG9yU3RyaW5nLnRyaW0oKTtcbiAgICBjb25zdCBtYXRjaGVzID0gc291cmNlLm1hdGNoKGRlc2NyaXB0b3JQYXR0ZXJuKSB8fCBbXTtcbiAgICBsZXQgZXZlbnROYW1lID0gbWF0Y2hlc1sxXTtcbiAgICBsZXQga2V5RmlsdGVyID0gbWF0Y2hlc1syXTtcbiAgICBpZiAoa2V5RmlsdGVyICYmICFbXCJrZXlkb3duXCIsIFwia2V5dXBcIiwgXCJrZXlwcmVzc1wiXS5pbmNsdWRlcyhldmVudE5hbWUpKSB7XG4gICAgICAgIGV2ZW50TmFtZSArPSBgLiR7a2V5RmlsdGVyfWA7XG4gICAgICAgIGtleUZpbHRlciA9IFwiXCI7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGV2ZW50VGFyZ2V0OiBwYXJzZUV2ZW50VGFyZ2V0KG1hdGNoZXNbM10pLFxuICAgICAgICBldmVudE5hbWUsXG4gICAgICAgIGV2ZW50T3B0aW9uczogbWF0Y2hlc1s2XSA/IHBhcnNlRXZlbnRPcHRpb25zKG1hdGNoZXNbNl0pIDoge30sXG4gICAgICAgIGlkZW50aWZpZXI6IG1hdGNoZXNbNF0sXG4gICAgICAgIG1ldGhvZE5hbWU6IG1hdGNoZXNbNV0sXG4gICAgICAgIGtleUZpbHRlcixcbiAgICB9O1xufVxuZnVuY3Rpb24gcGFyc2VFdmVudFRhcmdldChldmVudFRhcmdldE5hbWUpIHtcbiAgICBpZiAoZXZlbnRUYXJnZXROYW1lID09IFwid2luZG93XCIpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRUYXJnZXROYW1lID09IFwiZG9jdW1lbnRcIikge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VFdmVudE9wdGlvbnMoZXZlbnRPcHRpb25zKSB7XG4gICAgcmV0dXJuIGV2ZW50T3B0aW9uc1xuICAgICAgICAuc3BsaXQoXCI6XCIpXG4gICAgICAgIC5yZWR1Y2UoKG9wdGlvbnMsIHRva2VuKSA9PiBPYmplY3QuYXNzaWduKG9wdGlvbnMsIHsgW3Rva2VuLnJlcGxhY2UoL14hLywgXCJcIildOiAhL14hLy50ZXN0KHRva2VuKSB9KSwge30pO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5RXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpIHtcbiAgICBpZiAoZXZlbnRUYXJnZXQgPT0gd2luZG93KSB7XG4gICAgICAgIHJldHVybiBcIndpbmRvd1wiO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudFRhcmdldCA9PSBkb2N1bWVudCkge1xuICAgICAgICByZXR1cm4gXCJkb2N1bWVudFwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2FtZWxpemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvKD86W18tXSkoW2EtejAtOV0pL2csIChfLCBjaGFyKSA9PiBjaGFyLnRvVXBwZXJDYXNlKCkpO1xufVxuZnVuY3Rpb24gbmFtZXNwYWNlQ2FtZWxpemUodmFsdWUpIHtcbiAgICByZXR1cm4gY2FtZWxpemUodmFsdWUucmVwbGFjZSgvLS0vZywgXCItXCIpLnJlcGxhY2UoL19fL2csIFwiX1wiKSk7XG59XG5mdW5jdGlvbiBjYXBpdGFsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdmFsdWUuc2xpY2UoMSk7XG59XG5mdW5jdGlvbiBkYXNoZXJpemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvKFtBLVpdKS9nLCAoXywgY2hhcikgPT4gYC0ke2NoYXIudG9Mb3dlckNhc2UoKX1gKTtcbn1cbmZ1bmN0aW9uIHRva2VuaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLm1hdGNoKC9bXlxcc10rL2cpIHx8IFtdO1xufVxuXG5jbGFzcyBBY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGluZGV4LCBkZXNjcmlwdG9yLCBzY2hlbWEpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZGVzY3JpcHRvci5ldmVudFRhcmdldCB8fCBlbGVtZW50O1xuICAgICAgICB0aGlzLmV2ZW50TmFtZSA9IGRlc2NyaXB0b3IuZXZlbnROYW1lIHx8IGdldERlZmF1bHRFdmVudE5hbWVGb3JFbGVtZW50KGVsZW1lbnQpIHx8IGVycm9yKFwibWlzc2luZyBldmVudCBuYW1lXCIpO1xuICAgICAgICB0aGlzLmV2ZW50T3B0aW9ucyA9IGRlc2NyaXB0b3IuZXZlbnRPcHRpb25zIHx8IHt9O1xuICAgICAgICB0aGlzLmlkZW50aWZpZXIgPSBkZXNjcmlwdG9yLmlkZW50aWZpZXIgfHwgZXJyb3IoXCJtaXNzaW5nIGlkZW50aWZpZXJcIik7XG4gICAgICAgIHRoaXMubWV0aG9kTmFtZSA9IGRlc2NyaXB0b3IubWV0aG9kTmFtZSB8fCBlcnJvcihcIm1pc3NpbmcgbWV0aG9kIG5hbWVcIik7XG4gICAgICAgIHRoaXMua2V5RmlsdGVyID0gZGVzY3JpcHRvci5rZXlGaWx0ZXIgfHwgXCJcIjtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgfVxuICAgIHN0YXRpYyBmb3JUb2tlbih0b2tlbiwgc2NoZW1hKSB7XG4gICAgICAgIHJldHVybiBuZXcgdGhpcyh0b2tlbi5lbGVtZW50LCB0b2tlbi5pbmRleCwgcGFyc2VBY3Rpb25EZXNjcmlwdG9yU3RyaW5nKHRva2VuLmNvbnRlbnQpLCBzY2hlbWEpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgZXZlbnRGaWx0ZXIgPSB0aGlzLmtleUZpbHRlciA/IGAuJHt0aGlzLmtleUZpbHRlcn1gIDogXCJcIjtcbiAgICAgICAgY29uc3QgZXZlbnRUYXJnZXQgPSB0aGlzLmV2ZW50VGFyZ2V0TmFtZSA/IGBAJHt0aGlzLmV2ZW50VGFyZ2V0TmFtZX1gIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuZXZlbnROYW1lfSR7ZXZlbnRGaWx0ZXJ9JHtldmVudFRhcmdldH0tPiR7dGhpcy5pZGVudGlmaWVyfSMke3RoaXMubWV0aG9kTmFtZX1gO1xuICAgIH1cbiAgICBpc0ZpbHRlclRhcmdldChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMua2V5RmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsdGVyZXMgPSB0aGlzLmtleUZpbHRlci5zcGxpdChcIitcIik7XG4gICAgICAgIGNvbnN0IG1vZGlmaWVycyA9IFtcIm1ldGFcIiwgXCJjdHJsXCIsIFwiYWx0XCIsIFwic2hpZnRcIl07XG4gICAgICAgIGNvbnN0IFttZXRhLCBjdHJsLCBhbHQsIHNoaWZ0XSA9IG1vZGlmaWVycy5tYXAoKG1vZGlmaWVyKSA9PiBmaWx0ZXJlcy5pbmNsdWRlcyhtb2RpZmllcikpO1xuICAgICAgICBpZiAoZXZlbnQubWV0YUtleSAhPT0gbWV0YSB8fCBldmVudC5jdHJsS2V5ICE9PSBjdHJsIHx8IGV2ZW50LmFsdEtleSAhPT0gYWx0IHx8IGV2ZW50LnNoaWZ0S2V5ICE9PSBzaGlmdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhbmRhcmRGaWx0ZXIgPSBmaWx0ZXJlcy5maWx0ZXIoKGtleSkgPT4gIW1vZGlmaWVycy5pbmNsdWRlcyhrZXkpKVswXTtcbiAgICAgICAgaWYgKCFzdGFuZGFyZEZpbHRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMua2V5TWFwcGluZ3MsIHN0YW5kYXJkRmlsdGVyKSkge1xuICAgICAgICAgICAgZXJyb3IoYGNvbnRhaW5zIHVua25vd24ga2V5IGZpbHRlcjogJHt0aGlzLmtleUZpbHRlcn1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5rZXlNYXBwaW5nc1tzdGFuZGFyZEZpbHRlcl0udG9Mb3dlckNhc2UoKSAhPT0gZXZlbnQua2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICAgIGdldCBwYXJhbXMoKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHt9O1xuICAgICAgICBjb25zdCBwYXR0ZXJuID0gbmV3IFJlZ0V4cChgXmRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LSguKyktcGFyYW0kYCwgXCJpXCIpO1xuICAgICAgICBmb3IgKGNvbnN0IHsgbmFtZSwgdmFsdWUgfSBvZiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5hdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBuYW1lLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2ggJiYgbWF0Y2hbMV07XG4gICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zW2NhbWVsaXplKGtleSldID0gdHlwZWNhc3QodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgfVxuICAgIGdldCBldmVudFRhcmdldE5hbWUoKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdpZnlFdmVudFRhcmdldCh0aGlzLmV2ZW50VGFyZ2V0KTtcbiAgICB9XG4gICAgZ2V0IGtleU1hcHBpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWEua2V5TWFwcGluZ3M7XG4gICAgfVxufVxuY29uc3QgZGVmYXVsdEV2ZW50TmFtZXMgPSB7XG4gICAgYTogKCkgPT4gXCJjbGlja1wiLFxuICAgIGJ1dHRvbjogKCkgPT4gXCJjbGlja1wiLFxuICAgIGZvcm06ICgpID0+IFwic3VibWl0XCIsXG4gICAgZGV0YWlsczogKCkgPT4gXCJ0b2dnbGVcIixcbiAgICBpbnB1dDogKGUpID0+IChlLmdldEF0dHJpYnV0ZShcInR5cGVcIikgPT0gXCJzdWJtaXRcIiA/IFwiY2xpY2tcIiA6IFwiaW5wdXRcIiksXG4gICAgc2VsZWN0OiAoKSA9PiBcImNoYW5nZVwiLFxuICAgIHRleHRhcmVhOiAoKSA9PiBcImlucHV0XCIsXG59O1xuZnVuY3Rpb24gZ2V0RGVmYXVsdEV2ZW50TmFtZUZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAodGFnTmFtZSBpbiBkZWZhdWx0RXZlbnROYW1lcykge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEV2ZW50TmFtZXNbdGFnTmFtZV0oZWxlbWVudCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbn1cbmZ1bmN0aW9uIHR5cGVjYXN0KHZhbHVlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAob19PKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5cbmNsYXNzIEJpbmRpbmcge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG4gICAgZ2V0IGluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uaW5kZXg7XG4gICAgfVxuICAgIGdldCBldmVudFRhcmdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uLmV2ZW50VGFyZ2V0O1xuICAgIH1cbiAgICBnZXQgZXZlbnRPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnRPcHRpb25zO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBpZiAodGhpcy53aWxsQmVJbnZva2VkQnlFdmVudChldmVudCkgJiYgdGhpcy5hcHBseUV2ZW50TW9kaWZpZXJzKGV2ZW50KSkge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VXaXRoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBldmVudE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5ldmVudE5hbWU7XG4gICAgfVxuICAgIGdldCBtZXRob2QoKSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuY29udHJvbGxlclt0aGlzLm1ldGhvZE5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBtZXRob2Q7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY3Rpb24gXCIke3RoaXMuYWN0aW9ufVwiIHJlZmVyZW5jZXMgdW5kZWZpbmVkIG1ldGhvZCBcIiR7dGhpcy5tZXRob2ROYW1lfVwiYCk7XG4gICAgfVxuICAgIGFwcGx5RXZlbnRNb2RpZmllcnMoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50IH0gPSB0aGlzLmFjdGlvbjtcbiAgICAgICAgY29uc3QgeyBhY3Rpb25EZXNjcmlwdG9yRmlsdGVycyB9ID0gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgICAgICBsZXQgcGFzc2VzID0gdHJ1ZTtcbiAgICAgICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuZXZlbnRPcHRpb25zKSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgaW4gYWN0aW9uRGVzY3JpcHRvckZpbHRlcnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXIgPSBhY3Rpb25EZXNjcmlwdG9yRmlsdGVyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICBwYXNzZXMgPSBwYXNzZXMgJiYgZmlsdGVyKHsgbmFtZSwgdmFsdWUsIGV2ZW50LCBlbGVtZW50IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhc3NlcztcbiAgICB9XG4gICAgaW52b2tlV2l0aEV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0LCBjdXJyZW50VGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHsgcGFyYW1zIH0gPSB0aGlzLmFjdGlvbjtcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbkV2ZW50ID0gT2JqZWN0LmFzc2lnbihldmVudCwgeyBwYXJhbXMgfSk7XG4gICAgICAgICAgICB0aGlzLm1ldGhvZC5jYWxsKHRoaXMuY29udHJvbGxlciwgYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmxvZ0RlYnVnQWN0aXZpdHkodGhpcy5tZXRob2ROYW1lLCB7IGV2ZW50LCB0YXJnZXQsIGN1cnJlbnRUYXJnZXQsIGFjdGlvbjogdGhpcy5tZXRob2ROYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50LCBpbmRleCB9ID0gdGhpcztcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbCA9IHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCwgaW5kZXgsIGV2ZW50IH07XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuaGFuZGxlRXJyb3IoZXJyb3IsIGBpbnZva2luZyBhY3Rpb24gXCIke3RoaXMuYWN0aW9ufVwiYCwgZGV0YWlsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aWxsQmVJbnZva2VkQnlFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBldmVudFRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiB0aGlzLmFjdGlvbi5pc0ZpbHRlclRhcmdldChldmVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSBldmVudFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIHRoaXMuZWxlbWVudC5jb250YWlucyhldmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmNvbnRhaW5zRWxlbWVudChldmVudFRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5jb250YWluc0VsZW1lbnQodGhpcy5hY3Rpb24uZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuY29udHJvbGxlcjtcbiAgICB9XG4gICAgZ2V0IG1ldGhvZE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5tZXRob2ROYW1lO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbn1cblxuY2xhc3MgRWxlbWVudE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXJJbml0ID0geyBhdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4gdGhpcy5wcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gbmV3IFNldCh0aGlzLm1hdGNoRWxlbWVudHNJblRyZWUoKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzKSkge1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBBcnJheS5mcm9tKG1hdGNoZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTXV0YXRpb24obXV0YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbikge1xuICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PSBcImF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQXR0cmlidXRlQ2hhbmdlKG11dGF0aW9uLnRhcmdldCwgbXV0YXRpb24uYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PSBcImNoaWxkTGlzdFwiKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NSZW1vdmVkTm9kZXMobXV0YXRpb24ucmVtb3ZlZE5vZGVzKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0FkZGVkTm9kZXMobXV0YXRpb24uYWRkZWROb2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc0F0dHJpYnV0ZUNoYW5nZShub2RlLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBub2RlO1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkICYmIHRoaXMubWF0Y2hFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50QXR0cmlidXRlQ2hhbmdlZChlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLm1hdGNoRWxlbWVudChlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NSZW1vdmVkTm9kZXMobm9kZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIEFycmF5LmZyb20obm9kZXMpKSB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50RnJvbU5vZGUobm9kZSk7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc1RyZWUoZWxlbWVudCwgdGhpcy5yZW1vdmVFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzQWRkZWROb2Rlcyhub2Rlcykge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShub2RlcykpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRGcm9tTm9kZShub2RlKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICYmIHRoaXMuZWxlbWVudElzQWN0aXZlKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzVHJlZShlbGVtZW50LCB0aGlzLmFkZEVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG1hdGNoRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLm1hdGNoRWxlbWVudChlbGVtZW50KTtcbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlID0gdGhpcy5lbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLm1hdGNoRWxlbWVudHNJblRyZWUodHJlZSk7XG4gICAgfVxuICAgIHByb2Nlc3NUcmVlKHRyZWUsIHByb2Nlc3Nvcikge1xuICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5tYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpKSB7XG4gICAgICAgICAgICBwcm9jZXNzb3IuY2FsbCh0aGlzLCBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50RnJvbU5vZGUobm9kZSkge1xuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudElzQWN0aXZlKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQuaXNDb25uZWN0ZWQgIT0gdGhpcy5lbGVtZW50LmlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmNvbnRhaW5zKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZEVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBpZiAoIXRoaXMuZWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50SXNBY3RpdmUoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmFkZChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50TWF0Y2hlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmRlbGV0ZShlbGVtZW50KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWQoZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIEF0dHJpYnV0ZU9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyID0gbmV3IEVsZW1lbnRPYnNlcnZlcihlbGVtZW50LCB0aGlzKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgc2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBgWyR7dGhpcy5hdHRyaWJ1dGVOYW1lfV1gO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIucGF1c2UoY2FsbGJhY2spO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudC5oYXNBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lKTtcbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5tYXRjaEVsZW1lbnQodHJlZSkgPyBbdHJlZV0gOiBbXTtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20odHJlZS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2VsZWN0b3IpKTtcbiAgICAgICAgcmV0dXJuIG1hdGNoLmNvbmNhdChtYXRjaGVzKTtcbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50TWF0Y2hlZEF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50TWF0Y2hlZEF0dHJpYnV0ZShlbGVtZW50LCB0aGlzLmF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50VW5tYXRjaGVkQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUoZWxlbWVudCwgdGhpcy5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlQ2hhbmdlZChlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRBdHRyaWJ1dGVWYWx1ZUNoYW5nZWQgJiYgdGhpcy5hdHRyaWJ1dGVOYW1lID09IGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZVZhbHVlQ2hhbmdlZChlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkKG1hcCwga2V5LCB2YWx1ZSkge1xuICAgIGZldGNoKG1hcCwga2V5KS5hZGQodmFsdWUpO1xufVxuZnVuY3Rpb24gZGVsKG1hcCwga2V5LCB2YWx1ZSkge1xuICAgIGZldGNoKG1hcCwga2V5KS5kZWxldGUodmFsdWUpO1xuICAgIHBydW5lKG1hcCwga2V5KTtcbn1cbmZ1bmN0aW9uIGZldGNoKG1hcCwga2V5KSB7XG4gICAgbGV0IHZhbHVlcyA9IG1hcC5nZXQoa2V5KTtcbiAgICBpZiAoIXZhbHVlcykge1xuICAgICAgICB2YWx1ZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIG1hcC5zZXQoa2V5LCB2YWx1ZXMpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVzO1xufVxuZnVuY3Rpb24gcHJ1bmUobWFwLCBrZXkpIHtcbiAgICBjb25zdCB2YWx1ZXMgPSBtYXAuZ2V0KGtleSk7XG4gICAgaWYgKHZhbHVlcyAhPSBudWxsICYmIHZhbHVlcy5zaXplID09IDApIHtcbiAgICAgICAgbWFwLmRlbGV0ZShrZXkpO1xuICAgIH1cbn1cblxuY2xhc3MgTXVsdGltYXAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnZhbHVlc0J5S2V5ID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXQga2V5cygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleS5rZXlzKCkpO1xuICAgIH1cbiAgICBnZXQgdmFsdWVzKCkge1xuICAgICAgICBjb25zdCBzZXRzID0gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5LnZhbHVlcygpKTtcbiAgICAgICAgcmV0dXJuIHNldHMucmVkdWNlKCh2YWx1ZXMsIHNldCkgPT4gdmFsdWVzLmNvbmNhdChBcnJheS5mcm9tKHNldCkpLCBbXSk7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICBjb25zdCBzZXRzID0gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5LnZhbHVlcygpKTtcbiAgICAgICAgcmV0dXJuIHNldHMucmVkdWNlKChzaXplLCBzZXQpID0+IHNpemUgKyBzZXQuc2l6ZSwgMCk7XG4gICAgfVxuICAgIGFkZChrZXksIHZhbHVlKSB7XG4gICAgICAgIGFkZCh0aGlzLnZhbHVlc0J5S2V5LCBrZXksIHZhbHVlKTtcbiAgICB9XG4gICAgZGVsZXRlKGtleSwgdmFsdWUpIHtcbiAgICAgICAgZGVsKHRoaXMudmFsdWVzQnlLZXksIGtleSwgdmFsdWUpO1xuICAgIH1cbiAgICBoYXMoa2V5LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLnZhbHVlc0J5S2V5LmdldChrZXkpO1xuICAgICAgICByZXR1cm4gdmFsdWVzICE9IG51bGwgJiYgdmFsdWVzLmhhcyh2YWx1ZSk7XG4gICAgfVxuICAgIGhhc0tleShrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVzQnlLZXkuaGFzKGtleSk7XG4gICAgfVxuICAgIGhhc1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHNldHMgPSBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkudmFsdWVzKCkpO1xuICAgICAgICByZXR1cm4gc2V0cy5zb21lKChzZXQpID0+IHNldC5oYXModmFsdWUpKTtcbiAgICB9XG4gICAgZ2V0VmFsdWVzRm9yS2V5KGtleSkge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLnZhbHVlc0J5S2V5LmdldChrZXkpO1xuICAgICAgICByZXR1cm4gdmFsdWVzID8gQXJyYXkuZnJvbSh2YWx1ZXMpIDogW107XG4gICAgfVxuICAgIGdldEtleXNGb3JWYWx1ZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5KVxuICAgICAgICAgICAgLmZpbHRlcigoW19rZXksIHZhbHVlc10pID0+IHZhbHVlcy5oYXModmFsdWUpKVxuICAgICAgICAgICAgLm1hcCgoW2tleSwgX3ZhbHVlc10pID0+IGtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBJbmRleGVkTXVsdGltYXAgZXh0ZW5kcyBNdWx0aW1hcCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMua2V5c0J5VmFsdWUgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMua2V5c0J5VmFsdWUua2V5cygpKTtcbiAgICB9XG4gICAgYWRkKGtleSwgdmFsdWUpIHtcbiAgICAgICAgc3VwZXIuYWRkKGtleSwgdmFsdWUpO1xuICAgICAgICBhZGQodGhpcy5rZXlzQnlWYWx1ZSwgdmFsdWUsIGtleSk7XG4gICAgfVxuICAgIGRlbGV0ZShrZXksIHZhbHVlKSB7XG4gICAgICAgIHN1cGVyLmRlbGV0ZShrZXksIHZhbHVlKTtcbiAgICAgICAgZGVsKHRoaXMua2V5c0J5VmFsdWUsIHZhbHVlLCBrZXkpO1xuICAgIH1cbiAgICBoYXNWYWx1ZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXlzQnlWYWx1ZS5oYXModmFsdWUpO1xuICAgIH1cbiAgICBnZXRLZXlzRm9yVmFsdWUodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgc2V0ID0gdGhpcy5rZXlzQnlWYWx1ZS5nZXQodmFsdWUpO1xuICAgICAgICByZXR1cm4gc2V0ID8gQXJyYXkuZnJvbShzZXQpIDogW107XG4gICAgfVxufVxuXG5jbGFzcyBTZWxlY3Rvck9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBzZWxlY3RvciwgZGVsZWdhdGUsIGRldGFpbHMgPSB7fSkge1xuICAgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyID0gbmV3IEVsZW1lbnRPYnNlcnZlcihlbGVtZW50LCB0aGlzKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQgPSBuZXcgTXVsdGltYXAoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIucGF1c2UoY2FsbGJhY2spO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gZWxlbWVudC5tYXRjaGVzKHRoaXMuc2VsZWN0b3IpO1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMgJiYgdGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoRWxlbWVudChlbGVtZW50LCB0aGlzLmRldGFpbHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXRjaGVzO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLm1hdGNoRWxlbWVudCh0cmVlKSA/IFt0cmVlXSA6IFtdO1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbSh0cmVlLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZWxlY3RvcikpLmZpbHRlcigobWF0Y2gpID0+IHRoaXMubWF0Y2hFbGVtZW50KG1hdGNoKSk7XG4gICAgICAgIHJldHVybiBtYXRjaC5jb25jYXQobWF0Y2hlcyk7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck1hdGNoZWQoZWxlbWVudCk7XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICB0aGlzLnNlbGVjdG9yVW5tYXRjaGVkKGVsZW1lbnQpO1xuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlQ2hhbmdlZChlbGVtZW50LCBfYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gdGhpcy5tYXRjaEVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgIGNvbnN0IG1hdGNoZWRCZWZvcmUgPSB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuaGFzKHRoaXMuc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgICAgICBpZiAoIW1hdGNoZXMgJiYgbWF0Y2hlZEJlZm9yZSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Rvck1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHRoaXMuc2VsZWN0b3IsIHRoaXMuZGV0YWlscyk7XG4gICAgICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuYWRkKHRoaXMuc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdG9yVW5tYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCB0aGlzLnNlbGVjdG9yLCB0aGlzLmRldGFpbHMpO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuZGVsZXRlKHRoaXMuc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgIH1cbn1cblxuY2xhc3MgU3RyaW5nTWFwT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3RyaW5nTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB0aGlzLnByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHRoaXMuZWxlbWVudCwgeyBhdHRyaWJ1dGVzOiB0cnVlLCBhdHRyaWJ1dGVPbGRWYWx1ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci50YWtlUmVjb3JkcygpO1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYXR0cmlidXRlTmFtZSBvZiB0aGlzLmtub3duQXR0cmlidXRlTmFtZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc011dGF0aW9uKG11dGF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSBtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lO1xuICAgICAgICBpZiAoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIG11dGF0aW9uLm9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMuZGVsZWdhdGUuZ2V0U3RyaW5nTWFwS2V5Rm9yQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBpZiAoa2V5ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zdHJpbmdNYXAuaGFzKGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RyaW5nTWFwLmdldChhdHRyaWJ1dGVOYW1lKSAhPSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKHZhbHVlLCBrZXksIG9sZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLnN0cmluZ01hcC5nZXQoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXAuZGVsZXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChvbGRWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXAuc2V0KGF0dHJpYnV0ZU5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwS2V5QWRkZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwS2V5QWRkZWQoa2V5LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBWYWx1ZUNoYW5nZWQodmFsdWUsIGtleSwgb2xkVmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLnN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwga2V5LCBvbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RyaW5nTWFwS2V5UmVtb3ZlZChrZXksIGF0dHJpYnV0ZU5hbWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLnN0cmluZ01hcEtleVJlbW92ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwS2V5UmVtb3ZlZChrZXksIGF0dHJpYnV0ZU5hbWUsIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQga25vd25BdHRyaWJ1dGVOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldCh0aGlzLmN1cnJlbnRBdHRyaWJ1dGVOYW1lcy5jb25jYXQodGhpcy5yZWNvcmRlZEF0dHJpYnV0ZU5hbWVzKSkpO1xuICAgIH1cbiAgICBnZXQgY3VycmVudEF0dHJpYnV0ZU5hbWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQuYXR0cmlidXRlcykubWFwKChhdHRyaWJ1dGUpID0+IGF0dHJpYnV0ZS5uYW1lKTtcbiAgICB9XG4gICAgZ2V0IHJlY29yZGVkQXR0cmlidXRlTmFtZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuc3RyaW5nTWFwLmtleXMoKSk7XG4gICAgfVxufVxuXG5jbGFzcyBUb2tlbkxpc3RPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlciA9IG5ldyBBdHRyaWJ1dGVPYnNlcnZlcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCB0aGlzKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLnRva2Vuc0J5RWxlbWVudCA9IG5ldyBNdWx0aW1hcCgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuc3RhcnRlZDtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5wYXVzZShjYWxsYmFjayk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBhdHRyaWJ1dGVOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5hdHRyaWJ1dGVOYW1lO1xuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZEF0dHJpYnV0ZShlbGVtZW50KSB7XG4gICAgICAgIHRoaXMudG9rZW5zTWF0Y2hlZCh0aGlzLnJlYWRUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpKTtcbiAgICB9XG4gICAgZWxlbWVudEF0dHJpYnV0ZVZhbHVlQ2hhbmdlZChlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IFt1bm1hdGNoZWRUb2tlbnMsIG1hdGNoZWRUb2tlbnNdID0gdGhpcy5yZWZyZXNoVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgdGhpcy50b2tlbnNVbm1hdGNoZWQodW5tYXRjaGVkVG9rZW5zKTtcbiAgICAgICAgdGhpcy50b2tlbnNNYXRjaGVkKG1hdGNoZWRUb2tlbnMpO1xuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy50b2tlbnNVbm1hdGNoZWQodGhpcy50b2tlbnNCeUVsZW1lbnQuZ2V0VmFsdWVzRm9yS2V5KGVsZW1lbnQpKTtcbiAgICB9XG4gICAgdG9rZW5zTWF0Y2hlZCh0b2tlbnMpIHtcbiAgICAgICAgdG9rZW5zLmZvckVhY2goKHRva2VuKSA9PiB0aGlzLnRva2VuTWF0Y2hlZCh0b2tlbikpO1xuICAgIH1cbiAgICB0b2tlbnNVbm1hdGNoZWQodG9rZW5zKSB7XG4gICAgICAgIHRva2Vucy5mb3JFYWNoKCh0b2tlbikgPT4gdGhpcy50b2tlblVubWF0Y2hlZCh0b2tlbikpO1xuICAgIH1cbiAgICB0b2tlbk1hdGNoZWQodG9rZW4pIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS50b2tlbk1hdGNoZWQodG9rZW4pO1xuICAgICAgICB0aGlzLnRva2Vuc0J5RWxlbWVudC5hZGQodG9rZW4uZWxlbWVudCwgdG9rZW4pO1xuICAgIH1cbiAgICB0b2tlblVubWF0Y2hlZCh0b2tlbikge1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnRva2VuVW5tYXRjaGVkKHRva2VuKTtcbiAgICAgICAgdGhpcy50b2tlbnNCeUVsZW1lbnQuZGVsZXRlKHRva2VuLmVsZW1lbnQsIHRva2VuKTtcbiAgICB9XG4gICAgcmVmcmVzaFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBwcmV2aW91c1Rva2VucyA9IHRoaXMudG9rZW5zQnlFbGVtZW50LmdldFZhbHVlc0ZvcktleShlbGVtZW50KTtcbiAgICAgICAgY29uc3QgY3VycmVudFRva2VucyA9IHRoaXMucmVhZFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgIGNvbnN0IGZpcnN0RGlmZmVyaW5nSW5kZXggPSB6aXAocHJldmlvdXNUb2tlbnMsIGN1cnJlbnRUb2tlbnMpLmZpbmRJbmRleCgoW3ByZXZpb3VzVG9rZW4sIGN1cnJlbnRUb2tlbl0pID0+ICF0b2tlbnNBcmVFcXVhbChwcmV2aW91c1Rva2VuLCBjdXJyZW50VG9rZW4pKTtcbiAgICAgICAgaWYgKGZpcnN0RGlmZmVyaW5nSW5kZXggPT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBbW10sIFtdXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbcHJldmlvdXNUb2tlbnMuc2xpY2UoZmlyc3REaWZmZXJpbmdJbmRleCksIGN1cnJlbnRUb2tlbnMuc2xpY2UoZmlyc3REaWZmZXJpbmdJbmRleCldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlYWRUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuYXR0cmlidXRlTmFtZTtcbiAgICAgICAgY29uc3QgdG9rZW5TdHJpbmcgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gcGFyc2VUb2tlblN0cmluZyh0b2tlblN0cmluZywgZWxlbWVudCwgYXR0cmlidXRlTmFtZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VUb2tlblN0cmluZyh0b2tlblN0cmluZywgZWxlbWVudCwgYXR0cmlidXRlTmFtZSkge1xuICAgIHJldHVybiB0b2tlblN0cmluZ1xuICAgICAgICAudHJpbSgpXG4gICAgICAgIC5zcGxpdCgvXFxzKy8pXG4gICAgICAgIC5maWx0ZXIoKGNvbnRlbnQpID0+IGNvbnRlbnQubGVuZ3RoKVxuICAgICAgICAubWFwKChjb250ZW50LCBpbmRleCkgPT4gKHsgZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgY29udGVudCwgaW5kZXggfSkpO1xufVxuZnVuY3Rpb24gemlwKGxlZnQsIHJpZ2h0KSB7XG4gICAgY29uc3QgbGVuZ3RoID0gTWF0aC5tYXgobGVmdC5sZW5ndGgsIHJpZ2h0Lmxlbmd0aCk7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGggfSwgKF8sIGluZGV4KSA9PiBbbGVmdFtpbmRleF0sIHJpZ2h0W2luZGV4XV0pO1xufVxuZnVuY3Rpb24gdG9rZW5zQXJlRXF1YWwobGVmdCwgcmlnaHQpIHtcbiAgICByZXR1cm4gbGVmdCAmJiByaWdodCAmJiBsZWZ0LmluZGV4ID09IHJpZ2h0LmluZGV4ICYmIGxlZnQuY29udGVudCA9PSByaWdodC5jb250ZW50O1xufVxuXG5jbGFzcyBWYWx1ZUxpc3RPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlciA9IG5ldyBUb2tlbkxpc3RPYnNlcnZlcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCB0aGlzKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLnBhcnNlUmVzdWx0c0J5VG9rZW4gPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLnZhbHVlc0J5VG9rZW5CeUVsZW1lbnQgPSBuZXcgV2Vha01hcCgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RhcnRlZDtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuTGlzdE9ic2VydmVyLmF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIHRva2VuTWF0Y2hlZCh0b2tlbikge1xuICAgICAgICBjb25zdCB7IGVsZW1lbnQgfSA9IHRva2VuO1xuICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSB0aGlzLmZldGNoUGFyc2VSZXN1bHRGb3JUb2tlbih0b2tlbik7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5mZXRjaFZhbHVlc0J5VG9rZW5Gb3JFbGVtZW50KGVsZW1lbnQpLnNldCh0b2tlbiwgdmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50TWF0Y2hlZFZhbHVlKGVsZW1lbnQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2tlblVubWF0Y2hlZCh0b2tlbikge1xuICAgICAgICBjb25zdCB7IGVsZW1lbnQgfSA9IHRva2VuO1xuICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSB0aGlzLmZldGNoUGFyc2VSZXN1bHRGb3JUb2tlbih0b2tlbik7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5mZXRjaFZhbHVlc0J5VG9rZW5Gb3JFbGVtZW50KGVsZW1lbnQpLmRlbGV0ZSh0b2tlbik7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hQYXJzZVJlc3VsdEZvclRva2VuKHRva2VuKSB7XG4gICAgICAgIGxldCBwYXJzZVJlc3VsdCA9IHRoaXMucGFyc2VSZXN1bHRzQnlUb2tlbi5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoIXBhcnNlUmVzdWx0KSB7XG4gICAgICAgICAgICBwYXJzZVJlc3VsdCA9IHRoaXMucGFyc2VUb2tlbih0b2tlbik7XG4gICAgICAgICAgICB0aGlzLnBhcnNlUmVzdWx0c0J5VG9rZW4uc2V0KHRva2VuLCBwYXJzZVJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcnNlUmVzdWx0O1xuICAgIH1cbiAgICBmZXRjaFZhbHVlc0J5VG9rZW5Gb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IHZhbHVlc0J5VG9rZW4gPSB0aGlzLnZhbHVlc0J5VG9rZW5CeUVsZW1lbnQuZ2V0KGVsZW1lbnQpO1xuICAgICAgICBpZiAoIXZhbHVlc0J5VG9rZW4pIHtcbiAgICAgICAgICAgIHZhbHVlc0J5VG9rZW4gPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlc0J5VG9rZW5CeUVsZW1lbnQuc2V0KGVsZW1lbnQsIHZhbHVlc0J5VG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZXNCeVRva2VuO1xuICAgIH1cbiAgICBwYXJzZVRva2VuKHRva2VuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGVsZWdhdGUucGFyc2VWYWx1ZUZvclRva2VuKHRva2VuKTtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlcnJvciB9O1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBCaW5kaW5nT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnZhbHVlTGlzdE9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyID0gbmV3IFZhbHVlTGlzdE9ic2VydmVyKHRoaXMuZWxlbWVudCwgdGhpcy5hY3Rpb25BdHRyaWJ1dGUsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlTGlzdE9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlTGlzdE9ic2VydmVyO1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0QWxsQWN0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBhY3Rpb25BdHRyaWJ1dGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVtYS5hY3Rpb25BdHRyaWJ1dGU7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NoZW1hO1xuICAgIH1cbiAgICBnZXQgYmluZGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuYmluZGluZ3NCeUFjdGlvbi52YWx1ZXMoKSk7XG4gICAgfVxuICAgIGNvbm5lY3RBY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgIGNvbnN0IGJpbmRpbmcgPSBuZXcgQmluZGluZyh0aGlzLmNvbnRleHQsIGFjdGlvbik7XG4gICAgICAgIHRoaXMuYmluZGluZ3NCeUFjdGlvbi5zZXQoYWN0aW9uLCBiaW5kaW5nKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5iaW5kaW5nQ29ubmVjdGVkKGJpbmRpbmcpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0QWN0aW9uKGFjdGlvbikge1xuICAgICAgICBjb25zdCBiaW5kaW5nID0gdGhpcy5iaW5kaW5nc0J5QWN0aW9uLmdldChhY3Rpb24pO1xuICAgICAgICBpZiAoYmluZGluZykge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uLmRlbGV0ZShhY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5iaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RBbGxBY3Rpb25zKCkge1xuICAgICAgICB0aGlzLmJpbmRpbmdzLmZvckVhY2goKGJpbmRpbmcpID0+IHRoaXMuZGVsZWdhdGUuYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nLCB0cnVlKSk7XG4gICAgICAgIHRoaXMuYmluZGluZ3NCeUFjdGlvbi5jbGVhcigpO1xuICAgIH1cbiAgICBwYXJzZVZhbHVlRm9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gQWN0aW9uLmZvclRva2VuKHRva2VuLCB0aGlzLnNjaGVtYSk7XG4gICAgICAgIGlmIChhY3Rpb24uaWRlbnRpZmllciA9PSB0aGlzLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWRWYWx1ZShlbGVtZW50LCBhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5jb25uZWN0QWN0aW9uKGFjdGlvbik7XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRWYWx1ZShlbGVtZW50LCBhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0QWN0aW9uKGFjdGlvbik7XG4gICAgfVxufVxuXG5jbGFzcyBWYWx1ZU9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0LCByZWNlaXZlcikge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLnJlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgIHRoaXMuc3RyaW5nTWFwT2JzZXJ2ZXIgPSBuZXcgU3RyaW5nTWFwT2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzKTtcbiAgICAgICAgdGhpcy52YWx1ZURlc2NyaXB0b3JNYXAgPSB0aGlzLmNvbnRyb2xsZXIudmFsdWVEZXNjcmlwdG9yTWFwO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXBPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFja3NGb3JEZWZhdWx0VmFsdWVzKCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuc3RyaW5nTWFwT2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5jb250cm9sbGVyO1xuICAgIH1cbiAgICBnZXRTdHJpbmdNYXBLZXlGb3JBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBpZiAoYXR0cmlidXRlTmFtZSBpbiB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwW2F0dHJpYnV0ZU5hbWVdLm5hbWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RyaW5nTWFwS2V5QWRkZWQoa2V5LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcFthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1ZhbHVlKGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKGtleSwgZGVzY3JpcHRvci53cml0ZXIodGhpcy5yZWNlaXZlcltrZXldKSwgZGVzY3JpcHRvci53cml0ZXIoZGVzY3JpcHRvci5kZWZhdWx0VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBWYWx1ZUNoYW5nZWQodmFsdWUsIG5hbWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck5hbWVNYXBbbmFtZV07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG9sZFZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICBvbGRWYWx1ZSA9IGRlc2NyaXB0b3Iud3JpdGVyKGRlc2NyaXB0b3IuZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFjayhuYW1lLCB2YWx1ZSwgb2xkVmFsdWUpO1xuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFtrZXldO1xuICAgICAgICBpZiAodGhpcy5oYXNWYWx1ZShrZXkpKSB7XG4gICAgICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFjayhrZXksIGRlc2NyaXB0b3Iud3JpdGVyKHRoaXMucmVjZWl2ZXJba2V5XSksIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKGtleSwgZGVzY3JpcHRvci53cml0ZXIoZGVzY3JpcHRvci5kZWZhdWx0VmFsdWUpLCBvbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW52b2tlQ2hhbmdlZENhbGxiYWNrc0ZvckRlZmF1bHRWYWx1ZXMoKSB7XG4gICAgICAgIGZvciAoY29uc3QgeyBrZXksIG5hbWUsIGRlZmF1bHRWYWx1ZSwgd3JpdGVyIH0gb2YgdGhpcy52YWx1ZURlc2NyaXB0b3JzKSB7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlICE9IHVuZGVmaW5lZCAmJiAhdGhpcy5jb250cm9sbGVyLmRhdGEuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFjayhuYW1lLCB3cml0ZXIoZGVmYXVsdFZhbHVlKSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpbnZva2VDaGFuZ2VkQ2FsbGJhY2sobmFtZSwgcmF3VmFsdWUsIHJhd09sZFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRNZXRob2ROYW1lID0gYCR7bmFtZX1DaGFuZ2VkYDtcbiAgICAgICAgY29uc3QgY2hhbmdlZE1ldGhvZCA9IHRoaXMucmVjZWl2ZXJbY2hhbmdlZE1ldGhvZE5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIGNoYW5nZWRNZXRob2QgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JOYW1lTWFwW25hbWVdO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGRlc2NyaXB0b3IucmVhZGVyKHJhd1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBsZXQgb2xkVmFsdWUgPSByYXdPbGRWYWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAocmF3T2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgb2xkVmFsdWUgPSBkZXNjcmlwdG9yLnJlYWRlcihyYXdPbGRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNoYW5nZWRNZXRob2QuY2FsbCh0aGlzLnJlY2VpdmVyLCB2YWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgVHlwZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgPSBgU3RpbXVsdXMgVmFsdWUgXCIke3RoaXMuY29udGV4dC5pZGVudGlmaWVyfS4ke2Rlc2NyaXB0b3IubmFtZX1cIiAtICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgdmFsdWVEZXNjcmlwdG9ycygpIHtcbiAgICAgICAgY29uc3QgeyB2YWx1ZURlc2NyaXB0b3JNYXAgfSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh2YWx1ZURlc2NyaXB0b3JNYXApLm1hcCgoa2V5KSA9PiB2YWx1ZURlc2NyaXB0b3JNYXBba2V5XSk7XG4gICAgfVxuICAgIGdldCB2YWx1ZURlc2NyaXB0b3JOYW1lTWFwKCkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9ycyA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnZhbHVlRGVzY3JpcHRvck1hcCkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JNYXBba2V5XTtcbiAgICAgICAgICAgIGRlc2NyaXB0b3JzW2Rlc2NyaXB0b3IubmFtZV0gPSBkZXNjcmlwdG9yO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3JzO1xuICAgIH1cbiAgICBoYXNWYWx1ZShhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck5hbWVNYXBbYXR0cmlidXRlTmFtZV07XG4gICAgICAgIGNvbnN0IGhhc01ldGhvZE5hbWUgPSBgaGFzJHtjYXBpdGFsaXplKGRlc2NyaXB0b3IubmFtZSl9YDtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZXJbaGFzTWV0aG9kTmFtZV07XG4gICAgfVxufVxuXG5jbGFzcyBUYXJnZXRPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLnRhcmdldHNCeU5hbWUgPSBuZXcgTXVsdGltYXAoKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy50b2tlbkxpc3RPYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlciA9IG5ldyBUb2tlbkxpc3RPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMuYXR0cmlidXRlTmFtZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdEFsbFRhcmdldHMoKTtcbiAgICAgICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9rZW5NYXRjaGVkKHsgZWxlbWVudCwgY29udGVudDogbmFtZSB9KSB7XG4gICAgICAgIGlmICh0aGlzLnNjb3BlLmNvbnRhaW5zRWxlbWVudChlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRva2VuVW5tYXRjaGVkKHsgZWxlbWVudCwgY29udGVudDogbmFtZSB9KSB7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKTtcbiAgICB9XG4gICAgY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldHNCeU5hbWUuaGFzKG5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldHNCeU5hbWUuYWRkKG5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy50b2tlbkxpc3RPYnNlcnZlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUudGFyZ2V0Q29ubmVjdGVkKGVsZW1lbnQsIG5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAodGhpcy50YXJnZXRzQnlOYW1lLmhhcyhuYW1lLCBlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXRzQnlOYW1lLmRlbGV0ZShuYW1lLCBlbGVtZW50KTtcbiAgICAgICAgICAgIChfYSA9IHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXVzZSgoKSA9PiB0aGlzLmRlbGVnYXRlLnRhcmdldERpc2Nvbm5lY3RlZChlbGVtZW50LCBuYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdEFsbFRhcmdldHMoKSB7XG4gICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiB0aGlzLnRhcmdldHNCeU5hbWUua2V5cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMudGFyZ2V0c0J5TmFtZS5nZXRWYWx1ZXNGb3JLZXkobmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiBgZGF0YS0ke3RoaXMuY29udGV4dC5pZGVudGlmaWVyfS10YXJnZXRgO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgc2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NvcGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKSB7XG4gICAgY29uc3QgYW5jZXN0b3JzID0gZ2V0QW5jZXN0b3JzRm9yQ29uc3RydWN0b3IoY29uc3RydWN0b3IpO1xuICAgIHJldHVybiBBcnJheS5mcm9tKGFuY2VzdG9ycy5yZWR1Y2UoKHZhbHVlcywgY29uc3RydWN0b3IpID0+IHtcbiAgICAgICAgZ2V0T3duU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkuZm9yRWFjaCgobmFtZSkgPT4gdmFsdWVzLmFkZChuYW1lKSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfSwgbmV3IFNldCgpKSk7XG59XG5mdW5jdGlvbiByZWFkSW5oZXJpdGFibGVTdGF0aWNPYmplY3RQYWlycyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKSB7XG4gICAgY29uc3QgYW5jZXN0b3JzID0gZ2V0QW5jZXN0b3JzRm9yQ29uc3RydWN0b3IoY29uc3RydWN0b3IpO1xuICAgIHJldHVybiBhbmNlc3RvcnMucmVkdWNlKChwYWlycywgY29uc3RydWN0b3IpID0+IHtcbiAgICAgICAgcGFpcnMucHVzaCguLi5nZXRPd25TdGF0aWNPYmplY3RQYWlycyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKSk7XG4gICAgICAgIHJldHVybiBwYWlycztcbiAgICB9LCBbXSk7XG59XG5mdW5jdGlvbiBnZXRBbmNlc3RvcnNGb3JDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IGFuY2VzdG9ycyA9IFtdO1xuICAgIHdoaWxlIChjb25zdHJ1Y3Rvcikge1xuICAgICAgICBhbmNlc3RvcnMucHVzaChjb25zdHJ1Y3Rvcik7XG4gICAgICAgIGNvbnN0cnVjdG9yID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGNvbnN0cnVjdG9yKTtcbiAgICB9XG4gICAgcmV0dXJuIGFuY2VzdG9ycy5yZXZlcnNlKCk7XG59XG5mdW5jdGlvbiBnZXRPd25TdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKSB7XG4gICAgY29uc3QgZGVmaW5pdGlvbiA9IGNvbnN0cnVjdG9yW3Byb3BlcnR5TmFtZV07XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZGVmaW5pdGlvbikgPyBkZWZpbml0aW9uIDogW107XG59XG5mdW5jdGlvbiBnZXRPd25TdGF0aWNPYmplY3RQYWlycyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKSB7XG4gICAgY29uc3QgZGVmaW5pdGlvbiA9IGNvbnN0cnVjdG9yW3Byb3BlcnR5TmFtZV07XG4gICAgcmV0dXJuIGRlZmluaXRpb24gPyBPYmplY3Qua2V5cyhkZWZpbml0aW9uKS5tYXAoKGtleSkgPT4gW2tleSwgZGVmaW5pdGlvbltrZXldXSkgOiBbXTtcbn1cblxuY2xhc3MgT3V0bGV0T2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5vdXRsZXRzQnlOYW1lID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUgPSBuZXcgTXVsdGltYXAoKTtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5zaXplID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLm91dGxldERlZmluaXRpb25zLmZvckVhY2goKG91dGxldE5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuc2VsZWN0b3Iob3V0bGV0TmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV0YWlscyA9IHsgb3V0bGV0TmFtZSB9O1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuc2V0KG91dGxldE5hbWUsIG5ldyBTZWxlY3Rvck9ic2VydmVyKGRvY3VtZW50LmJvZHksIHNlbGVjdG9yLCB0aGlzLCBkZXRhaWxzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZm9yRWFjaCgob2JzZXJ2ZXIpID0+IG9ic2VydmVyLnN0YXJ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVwZW5kZW50Q29udGV4dHMuZm9yRWFjaCgoY29udGV4dCkgPT4gY29udGV4dC5yZWZyZXNoKCkpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxPdXRsZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZm9yRWFjaCgob2JzZXJ2ZXIpID0+IG9ic2VydmVyLnN0b3AoKSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZm9yRWFjaCgob2JzZXJ2ZXIpID0+IG9ic2VydmVyLnJlZnJlc2goKSk7XG4gICAgfVxuICAgIHNlbGVjdG9yTWF0Y2hlZChlbGVtZW50LCBfc2VsZWN0b3IsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IG91dGxldCA9IHRoaXMuZ2V0T3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgICAgICBpZiAob3V0bGV0KSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBfc2VsZWN0b3IsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IG91dGxldCA9IHRoaXMuZ2V0T3V0bGV0RnJvbU1hcChlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG91dGxldCkge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JNYXRjaEVsZW1lbnQoZWxlbWVudCwgeyBvdXRsZXROYW1lIH0pIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmhhc091dGxldChlbGVtZW50LCBvdXRsZXROYW1lKSAmJlxuICAgICAgICAgICAgZWxlbWVudC5tYXRjaGVzKGBbJHt0aGlzLmNvbnRleHQuYXBwbGljYXRpb24uc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGV9fj0ke291dGxldE5hbWV9XWApKTtcbiAgICB9XG4gICAgY29ubmVjdE91dGxldChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoIXRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuaGFzKG91dGxldE5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm91dGxldHNCeU5hbWUuYWRkKG91dGxldE5hbWUsIG91dGxldCk7XG4gICAgICAgICAgICB0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmFkZChvdXRsZXROYW1lLCBlbGVtZW50KTtcbiAgICAgICAgICAgIChfYSA9IHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5nZXQob3V0bGV0TmFtZSkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXVzZSgoKSA9PiB0aGlzLmRlbGVnYXRlLm91dGxldENvbm5lY3RlZChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmhhcyhvdXRsZXROYW1lLCBlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy5vdXRsZXRzQnlOYW1lLmRlbGV0ZShvdXRsZXROYW1lLCBvdXRsZXQpO1xuICAgICAgICAgICAgdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5kZWxldGUob3V0bGV0TmFtZSwgZWxlbWVudCk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXBcbiAgICAgICAgICAgICAgICAuZ2V0KG91dGxldE5hbWUpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGF1c2UoKCkgPT4gdGhpcy5kZWxlZ2F0ZS5vdXRsZXREaXNjb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdEFsbE91dGxldHMoKSB7XG4gICAgICAgIGZvciAoY29uc3Qgb3V0bGV0TmFtZSBvZiB0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmtleXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0bGV0IG9mIHRoaXMub3V0bGV0c0J5TmFtZS5nZXRWYWx1ZXNGb3JLZXkob3V0bGV0TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdG9yKG91dGxldE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUub3V0bGV0cy5nZXRTZWxlY3RvckZvck91dGxldE5hbWUob3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBNdWx0aW1hcCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5tb2R1bGVzLmZvckVhY2goKG1vZHVsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29uc3RydWN0b3IgPSBtb2R1bGUuZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3I7XG4gICAgICAgICAgICBjb25zdCBvdXRsZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwib3V0bGV0c1wiKTtcbiAgICAgICAgICAgIG91dGxldHMuZm9yRWFjaCgob3V0bGV0KSA9PiBkZXBlbmRlbmNpZXMuYWRkKG91dGxldCwgbW9kdWxlLmlkZW50aWZpZXIpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZXBlbmRlbmNpZXM7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZWZpbml0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0RGVwZW5kZW5jaWVzLmdldEtleXNGb3JWYWx1ZSh0aGlzLmlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXQgZGVwZW5kZW50Q29udHJvbGxlcklkZW50aWZpZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXREZXBlbmRlbmNpZXMuZ2V0VmFsdWVzRm9yS2V5KHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBkZXBlbmRlbnRDb250ZXh0cygpIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllcnMgPSB0aGlzLmRlcGVuZGVudENvbnRyb2xsZXJJZGVudGlmaWVycztcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbnRleHRzLmZpbHRlcigoY29udGV4dCkgPT4gaWRlbnRpZmllcnMuaW5jbHVkZXMoY29udGV4dC5pZGVudGlmaWVyKSk7XG4gICAgfVxuICAgIGhhc091dGxldChlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuZ2V0T3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpIHx8ICEhdGhpcy5nZXRPdXRsZXRGcm9tTWFwKGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBnZXRPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKS5maW5kKChvdXRsZXQpID0+IG91dGxldC5lbGVtZW50ID09PSBlbGVtZW50KTtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgYXBwbGljYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCByb3V0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnJvdXRlcjtcbiAgICB9XG59XG5cbmNsYXNzIENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKG1vZHVsZSwgc2NvcGUpIHtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5ID0gKGZ1bmN0aW9uTmFtZSwgZGV0YWlsID0ge30pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9ID0gdGhpcztcbiAgICAgICAgICAgIGRldGFpbCA9IE9iamVjdC5hc3NpZ24oeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0sIGRldGFpbCk7XG4gICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmxvZ0RlYnVnQWN0aXZpdHkodGhpcy5pZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubW9kdWxlID0gbW9kdWxlO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ldyBtb2R1bGUuY29udHJvbGxlckNvbnN0cnVjdG9yKHRoaXMpO1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlciA9IG5ldyBCaW5kaW5nT2JzZXJ2ZXIodGhpcywgdGhpcy5kaXNwYXRjaGVyKTtcbiAgICAgICAgdGhpcy52YWx1ZU9ic2VydmVyID0gbmV3IFZhbHVlT2JzZXJ2ZXIodGhpcywgdGhpcy5jb250cm9sbGVyKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlciA9IG5ldyBUYXJnZXRPYnNlcnZlcih0aGlzLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlciA9IG5ldyBPdXRsZXRPYnNlcnZlcih0aGlzLCB0aGlzKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5pbml0aWFsaXplKCk7XG4gICAgICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJpbml0aWFsaXplXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgXCJpbml0aWFsaXppbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnZhbHVlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiY29ubmVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIFwiY29ubmVjdGluZyBjb250cm9sbGVyXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMub3V0bGV0T2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBcImRpc2Nvbm5lY3RpbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnN0b3AoKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMudmFsdWVPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMuYmluZGluZ09ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb2R1bGUuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb2R1bGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uc2NoZW1hO1xuICAgIH1cbiAgICBnZXQgZGlzcGF0Y2hlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uZGlzcGF0Y2hlcjtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBwYXJlbnRFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXIsIGVsZW1lbnQgfSA9IHRoaXM7XG4gICAgICAgIGRldGFpbCA9IE9iamVjdC5hc3NpZ24oeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0sIGRldGFpbCk7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24uaGFuZGxlRXJyb3IoZXJyb3IsIGBFcnJvciAke21lc3NhZ2V9YCwgZGV0YWlsKTtcbiAgICB9XG4gICAgdGFyZ2V0Q29ubmVjdGVkKGVsZW1lbnQsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5pbnZva2VDb250cm9sbGVyTWV0aG9kKGAke25hbWV9VGFyZ2V0Q29ubmVjdGVkYCwgZWxlbWVudCk7XG4gICAgfVxuICAgIHRhcmdldERpc2Nvbm5lY3RlZChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lfVRhcmdldERpc2Nvbm5lY3RlZGAsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBvdXRsZXRDb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lc3BhY2VDYW1lbGl6ZShuYW1lKX1PdXRsZXRDb25uZWN0ZWRgLCBvdXRsZXQsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBvdXRsZXREaXNjb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lc3BhY2VDYW1lbGl6ZShuYW1lKX1PdXRsZXREaXNjb25uZWN0ZWRgLCBvdXRsZXQsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBpbnZva2VDb250cm9sbGVyTWV0aG9kKG1ldGhvZE5hbWUsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IHRoaXMuY29udHJvbGxlcjtcbiAgICAgICAgaWYgKHR5cGVvZiBjb250cm9sbGVyW21ldGhvZE5hbWVdID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgY29udHJvbGxlclttZXRob2ROYW1lXSguLi5hcmdzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYmxlc3MoY29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gc2hhZG93KGNvbnN0cnVjdG9yLCBnZXRCbGVzc2VkUHJvcGVydGllcyhjb25zdHJ1Y3RvcikpO1xufVxuZnVuY3Rpb24gc2hhZG93KGNvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgY29uc3Qgc2hhZG93Q29uc3RydWN0b3IgPSBleHRlbmQoY29uc3RydWN0b3IpO1xuICAgIGNvbnN0IHNoYWRvd1Byb3BlcnRpZXMgPSBnZXRTaGFkb3dQcm9wZXJ0aWVzKGNvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvcGVydGllcyk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoc2hhZG93Q29uc3RydWN0b3IucHJvdG90eXBlLCBzaGFkb3dQcm9wZXJ0aWVzKTtcbiAgICByZXR1cm4gc2hhZG93Q29uc3RydWN0b3I7XG59XG5mdW5jdGlvbiBnZXRCbGVzc2VkUHJvcGVydGllcyhjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IGJsZXNzaW5ncyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcImJsZXNzaW5nc1wiKTtcbiAgICByZXR1cm4gYmxlc3NpbmdzLnJlZHVjZSgoYmxlc3NlZFByb3BlcnRpZXMsIGJsZXNzaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBibGVzc2luZyhjb25zdHJ1Y3Rvcik7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBibGVzc2VkUHJvcGVydGllc1trZXldIHx8IHt9O1xuICAgICAgICAgICAgYmxlc3NlZFByb3BlcnRpZXNba2V5XSA9IE9iamVjdC5hc3NpZ24oZGVzY3JpcHRvciwgcHJvcGVydGllc1trZXldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmxlc3NlZFByb3BlcnRpZXM7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0U2hhZG93UHJvcGVydGllcyhwcm90b3R5cGUsIHByb3BlcnRpZXMpIHtcbiAgICByZXR1cm4gZ2V0T3duS2V5cyhwcm9wZXJ0aWVzKS5yZWR1Y2UoKHNoYWRvd1Byb3BlcnRpZXMsIGtleSkgPT4ge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gZ2V0U2hhZG93ZWREZXNjcmlwdG9yKHByb3RvdHlwZSwgcHJvcGVydGllcywga2V5KTtcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oc2hhZG93UHJvcGVydGllcywgeyBba2V5XTogZGVzY3JpcHRvciB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhZG93UHJvcGVydGllcztcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBnZXRTaGFkb3dlZERlc2NyaXB0b3IocHJvdG90eXBlLCBwcm9wZXJ0aWVzLCBrZXkpIHtcbiAgICBjb25zdCBzaGFkb3dpbmdEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm90b3R5cGUsIGtleSk7XG4gICAgY29uc3Qgc2hhZG93ZWRCeVZhbHVlID0gc2hhZG93aW5nRGVzY3JpcHRvciAmJiBcInZhbHVlXCIgaW4gc2hhZG93aW5nRGVzY3JpcHRvcjtcbiAgICBpZiAoIXNoYWRvd2VkQnlWYWx1ZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm9wZXJ0aWVzLCBrZXkpLnZhbHVlO1xuICAgICAgICBpZiAoc2hhZG93aW5nRGVzY3JpcHRvcikge1xuICAgICAgICAgICAgZGVzY3JpcHRvci5nZXQgPSBzaGFkb3dpbmdEZXNjcmlwdG9yLmdldCB8fCBkZXNjcmlwdG9yLmdldDtcbiAgICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0ID0gc2hhZG93aW5nRGVzY3JpcHRvci5zZXQgfHwgZGVzY3JpcHRvci5zZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gICAgfVxufVxuY29uc3QgZ2V0T3duS2V5cyA9ICgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gKG9iamVjdCkgPT4gWy4uLk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iamVjdCksIC4uLk9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7XG4gICAgfVxufSkoKTtcbmNvbnN0IGV4dGVuZCA9ICgoKSA9PiB7XG4gICAgZnVuY3Rpb24gZXh0ZW5kV2l0aFJlZmxlY3QoY29uc3RydWN0b3IpIHtcbiAgICAgICAgZnVuY3Rpb24gZXh0ZW5kZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoY29uc3RydWN0b3IsIGFyZ3VtZW50cywgbmV3LnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZXh0ZW5kZWQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShjb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBleHRlbmRlZCB9LFxuICAgICAgICB9KTtcbiAgICAgICAgUmVmbGVjdC5zZXRQcm90b3R5cGVPZihleHRlbmRlZCwgY29uc3RydWN0b3IpO1xuICAgICAgICByZXR1cm4gZXh0ZW5kZWQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRlc3RSZWZsZWN0RXh0ZW5zaW9uKCkge1xuICAgICAgICBjb25zdCBhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5hLmNhbGwodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGIgPSBleHRlbmRXaXRoUmVmbGVjdChhKTtcbiAgICAgICAgYi5wcm90b3R5cGUuYSA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgcmV0dXJuIG5ldyBiKCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIHRlc3RSZWZsZWN0RXh0ZW5zaW9uKCk7XG4gICAgICAgIHJldHVybiBleHRlbmRXaXRoUmVmbGVjdDtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiAoY29uc3RydWN0b3IpID0+IGNsYXNzIGV4dGVuZGVkIGV4dGVuZHMgY29uc3RydWN0b3Ige1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG5cbmZ1bmN0aW9uIGJsZXNzRGVmaW5pdGlvbihkZWZpbml0aW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWRlbnRpZmllcjogZGVmaW5pdGlvbi5pZGVudGlmaWVyLFxuICAgICAgICBjb250cm9sbGVyQ29uc3RydWN0b3I6IGJsZXNzKGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yKSxcbiAgICB9O1xufVxuXG5jbGFzcyBNb2R1bGUge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uLCBkZWZpbml0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5kZWZpbml0aW9uID0gYmxlc3NEZWZpbml0aW9uKGRlZmluaXRpb24pO1xuICAgICAgICB0aGlzLmNvbnRleHRzQnlTY29wZSA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMgPSBuZXcgU2V0KCk7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZpbml0aW9uLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVyQ29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yO1xuICAgIH1cbiAgICBnZXQgY29udGV4dHMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29ubmVjdGVkQ29udGV4dHMpO1xuICAgIH1cbiAgICBjb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmZldGNoQ29udGV4dEZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDb250ZXh0cy5hZGQoY29udGV4dCk7XG4gICAgICAgIGNvbnRleHQuY29ubmVjdCgpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzQnlTY29wZS5nZXQoc2NvcGUpO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0ZWRDb250ZXh0cy5kZWxldGUoY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBsZXQgY29udGV4dCA9IHRoaXMuY29udGV4dHNCeVNjb3BlLmdldChzY29wZSk7XG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dCA9IG5ldyBDb250ZXh0KHRoaXMsIHNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dHNCeVNjb3BlLnNldChzY29wZSwgY29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxufVxuXG5jbGFzcyBDbGFzc01hcCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBoYXMobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmhhcyh0aGlzLmdldERhdGFLZXkobmFtZSkpO1xuICAgIH1cbiAgICBnZXQobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGwobmFtZSlbMF07XG4gICAgfVxuICAgIGdldEFsbChuYW1lKSB7XG4gICAgICAgIGNvbnN0IHRva2VuU3RyaW5nID0gdGhpcy5kYXRhLmdldCh0aGlzLmdldERhdGFLZXkobmFtZSkpIHx8IFwiXCI7XG4gICAgICAgIHJldHVybiB0b2tlbml6ZSh0b2tlblN0cmluZyk7XG4gICAgfVxuICAgIGdldEF0dHJpYnV0ZU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkodGhpcy5nZXREYXRhS2V5KG5hbWUpKTtcbiAgICB9XG4gICAgZ2V0RGF0YUtleShuYW1lKSB7XG4gICAgICAgIHJldHVybiBgJHtuYW1lfS1jbGFzc2A7XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5kYXRhO1xuICAgIH1cbn1cblxuY2xhc3MgRGF0YU1hcCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldChrZXkpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgICB9XG4gICAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KGtleSk7XG4gICAgfVxuICAgIGhhcyhrZXkpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lmhhc0F0dHJpYnV0ZShuYW1lKTtcbiAgICB9XG4gICAgZGVsZXRlKGtleSkge1xuICAgICAgICBpZiAodGhpcy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KSB7XG4gICAgICAgIHJldHVybiBgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0tJHtkYXNoZXJpemUoa2V5KX1gO1xuICAgIH1cbn1cblxuY2xhc3MgR3VpZGUge1xuICAgIGNvbnN0cnVjdG9yKGxvZ2dlcikge1xuICAgICAgICB0aGlzLndhcm5lZEtleXNCeU9iamVjdCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyO1xuICAgIH1cbiAgICB3YXJuKG9iamVjdCwga2V5LCBtZXNzYWdlKSB7XG4gICAgICAgIGxldCB3YXJuZWRLZXlzID0gdGhpcy53YXJuZWRLZXlzQnlPYmplY3QuZ2V0KG9iamVjdCk7XG4gICAgICAgIGlmICghd2FybmVkS2V5cykge1xuICAgICAgICAgICAgd2FybmVkS2V5cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIHRoaXMud2FybmVkS2V5c0J5T2JqZWN0LnNldChvYmplY3QsIHdhcm5lZEtleXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghd2FybmVkS2V5cy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgd2FybmVkS2V5cy5hZGQoa2V5KTtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4obWVzc2FnZSwgb2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKGF0dHJpYnV0ZU5hbWUsIHRva2VuKSB7XG4gICAgcmV0dXJuIGBbJHthdHRyaWJ1dGVOYW1lfX49XCIke3Rva2VufVwiXWA7XG59XG5cbmNsYXNzIFRhcmdldFNldCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLnNjaGVtYTtcbiAgICB9XG4gICAgaGFzKHRhcmdldE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh0YXJnZXROYW1lKSAhPSBudWxsO1xuICAgIH1cbiAgICBmaW5kKC4uLnRhcmdldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXROYW1lcy5yZWR1Y2UoKHRhcmdldCwgdGFyZ2V0TmFtZSkgPT4gdGFyZ2V0IHx8IHRoaXMuZmluZFRhcmdldCh0YXJnZXROYW1lKSB8fCB0aGlzLmZpbmRMZWdhY3lUYXJnZXQodGFyZ2V0TmFtZSksIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGZpbmRBbGwoLi4udGFyZ2V0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldE5hbWVzLnJlZHVjZSgodGFyZ2V0cywgdGFyZ2V0TmFtZSkgPT4gW1xuICAgICAgICAgICAgLi4udGFyZ2V0cyxcbiAgICAgICAgICAgIC4uLnRoaXMuZmluZEFsbFRhcmdldHModGFyZ2V0TmFtZSksXG4gICAgICAgICAgICAuLi50aGlzLmZpbmRBbGxMZWdhY3lUYXJnZXRzKHRhcmdldE5hbWUpLFxuICAgICAgICBdLCBbXSk7XG4gICAgfVxuICAgIGZpbmRUYXJnZXQodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5maW5kRWxlbWVudChzZWxlY3Rvcik7XG4gICAgfVxuICAgIGZpbmRBbGxUYXJnZXRzKHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICB9XG4gICAgZ2V0U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZUZvclNjb3BlKHRoaXMuaWRlbnRpZmllcik7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVWYWx1ZUNvbnRhaW5zVG9rZW4oYXR0cmlidXRlTmFtZSwgdGFyZ2V0TmFtZSk7XG4gICAgfVxuICAgIGZpbmRMZWdhY3lUYXJnZXQodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0TGVnYWN5U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZXByZWNhdGUodGhpcy5zY29wZS5maW5kRWxlbWVudChzZWxlY3RvciksIHRhcmdldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kQWxsTGVnYWN5VGFyZ2V0cyh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRMZWdhY3lTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmZpbmRBbGxFbGVtZW50cyhzZWxlY3RvcikubWFwKChlbGVtZW50KSA9PiB0aGlzLmRlcHJlY2F0ZShlbGVtZW50LCB0YXJnZXROYW1lKSk7XG4gICAgfVxuICAgIGdldExlZ2FjeVNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldERlc2NyaXB0b3IgPSBgJHt0aGlzLmlkZW50aWZpZXJ9LiR7dGFyZ2V0TmFtZX1gO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZSwgdGFyZ2V0RGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGRlcHJlY2F0ZShlbGVtZW50LCB0YXJnZXROYW1lKSB7XG4gICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIgfSA9IHRoaXM7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEudGFyZ2V0QXR0cmlidXRlO1xuICAgICAgICAgICAgY29uc3QgcmV2aXNlZEF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGVGb3JTY29wZShpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHRoaXMuZ3VpZGUud2FybihlbGVtZW50LCBgdGFyZ2V0OiR7dGFyZ2V0TmFtZX1gLCBgUGxlYXNlIHJlcGxhY2UgJHthdHRyaWJ1dGVOYW1lfT1cIiR7aWRlbnRpZmllcn0uJHt0YXJnZXROYW1lfVwiIHdpdGggJHtyZXZpc2VkQXR0cmlidXRlTmFtZX09XCIke3RhcmdldE5hbWV9XCIuIGAgK1xuICAgICAgICAgICAgICAgIGBUaGUgJHthdHRyaWJ1dGVOYW1lfSBhdHRyaWJ1dGUgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgU3RpbXVsdXMuYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBndWlkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZ3VpZGU7XG4gICAgfVxufVxuXG5jbGFzcyBPdXRsZXRTZXQge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlLCBjb250cm9sbGVyRWxlbWVudCkge1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgIHRoaXMuY29udHJvbGxlckVsZW1lbnQgPSBjb250cm9sbGVyRWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWE7XG4gICAgfVxuICAgIGhhcyhvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQob3V0bGV0TmFtZSkgIT0gbnVsbDtcbiAgICB9XG4gICAgZmluZCguLi5vdXRsZXROYW1lcykge1xuICAgICAgICByZXR1cm4gb3V0bGV0TmFtZXMucmVkdWNlKChvdXRsZXQsIG91dGxldE5hbWUpID0+IG91dGxldCB8fCB0aGlzLmZpbmRPdXRsZXQob3V0bGV0TmFtZSksIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGZpbmRBbGwoLi4ub3V0bGV0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIG91dGxldE5hbWVzLnJlZHVjZSgob3V0bGV0cywgb3V0bGV0TmFtZSkgPT4gWy4uLm91dGxldHMsIC4uLnRoaXMuZmluZEFsbE91dGxldHMob3V0bGV0TmFtZSldLCBbXSk7XG4gICAgfVxuICAgIGdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS5vdXRsZXRBdHRyaWJ1dGVGb3JTY29wZSh0aGlzLmlkZW50aWZpZXIsIG91dGxldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyRWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuICAgIGZpbmRPdXRsZXQob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG91dGxldE5hbWUpO1xuICAgICAgICBpZiAoc2VsZWN0b3IpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kRWxlbWVudChzZWxlY3Rvciwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGZpbmRBbGxPdXRsZXRzKG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yID8gdGhpcy5maW5kQWxsRWxlbWVudHMoc2VsZWN0b3IsIG91dGxldE5hbWUpIDogW107XG4gICAgfVxuICAgIGZpbmRFbGVtZW50KHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5zY29wZS5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4gdGhpcy5tYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkpWzBdO1xuICAgIH1cbiAgICBmaW5kQWxsRWxlbWVudHMoc2VsZWN0b3IsIG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSB0aGlzLnNjb3BlLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpO1xuICAgICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKChlbGVtZW50KSA9PiB0aGlzLm1hdGNoZXNFbGVtZW50KGVsZW1lbnQsIHNlbGVjdG9yLCBvdXRsZXROYW1lKSk7XG4gICAgfVxuICAgIG1hdGNoZXNFbGVtZW50KGVsZW1lbnQsIHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXJBdHRyaWJ1dGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLnNjb3BlLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gZWxlbWVudC5tYXRjaGVzKHNlbGVjdG9yKSAmJiBjb250cm9sbGVyQXR0cmlidXRlLnNwbGl0KFwiIFwiKS5pbmNsdWRlcyhvdXRsZXROYW1lKTtcbiAgICB9XG59XG5cbmNsYXNzIFNjb3BlIHtcbiAgICBjb25zdHJ1Y3RvcihzY2hlbWEsIGVsZW1lbnQsIGlkZW50aWZpZXIsIGxvZ2dlcikge1xuICAgICAgICB0aGlzLnRhcmdldHMgPSBuZXcgVGFyZ2V0U2V0KHRoaXMpO1xuICAgICAgICB0aGlzLmNsYXNzZXMgPSBuZXcgQ2xhc3NNYXAodGhpcyk7XG4gICAgICAgIHRoaXMuZGF0YSA9IG5ldyBEYXRhTWFwKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRhaW5zRWxlbWVudCA9IChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHRoaXMuY29udHJvbGxlclNlbGVjdG9yKSA9PT0gdGhpcy5lbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNjaGVtYSA9IHNjaGVtYTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5pZGVudGlmaWVyID0gaWRlbnRpZmllcjtcbiAgICAgICAgdGhpcy5ndWlkZSA9IG5ldyBHdWlkZShsb2dnZXIpO1xuICAgICAgICB0aGlzLm91dGxldHMgPSBuZXcgT3V0bGV0U2V0KHRoaXMuZG9jdW1lbnRTY29wZSwgZWxlbWVudCk7XG4gICAgfVxuICAgIGZpbmRFbGVtZW50KHNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgPyB0aGlzLmVsZW1lbnQgOiB0aGlzLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpLmZpbmQodGhpcy5jb250YWluc0VsZW1lbnQpO1xuICAgIH1cbiAgICBmaW5kQWxsRWxlbWVudHMoc2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIC4uLih0aGlzLmVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgPyBbdGhpcy5lbGVtZW50XSA6IFtdKSxcbiAgICAgICAgICAgIC4uLnRoaXMucXVlcnlFbGVtZW50cyhzZWxlY3RvcikuZmlsdGVyKHRoaXMuY29udGFpbnNFbGVtZW50KSxcbiAgICAgICAgXTtcbiAgICB9XG4gICAgcXVlcnlFbGVtZW50cyhzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlclNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGUsIHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBpc0RvY3VtZW50U2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQgPT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGRvY3VtZW50U2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzRG9jdW1lbnRTY29wZVxuICAgICAgICAgICAgPyB0aGlzXG4gICAgICAgICAgICA6IG5ldyBTY29wZSh0aGlzLnNjaGVtYSwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB0aGlzLmlkZW50aWZpZXIsIHRoaXMuZ3VpZGUubG9nZ2VyKTtcbiAgICB9XG59XG5cbmNsYXNzIFNjb3BlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNjaGVtYSwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlciA9IG5ldyBWYWx1ZUxpc3RPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMuY29udHJvbGxlckF0dHJpYnV0ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50ID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGU7XG4gICAgfVxuICAgIHBhcnNlVmFsdWVGb3JUb2tlbih0b2tlbikge1xuICAgICAgICBjb25zdCB7IGVsZW1lbnQsIGNvbnRlbnQ6IGlkZW50aWZpZXIgfSA9IHRva2VuO1xuICAgICAgICBjb25zdCBzY29wZXNCeUlkZW50aWZpZXIgPSB0aGlzLmZldGNoU2NvcGVzQnlJZGVudGlmaWVyRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgbGV0IHNjb3BlID0gc2NvcGVzQnlJZGVudGlmaWVyLmdldChpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKCFzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUgPSB0aGlzLmRlbGVnYXRlLmNyZWF0ZVNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgICAgICAgICBzY29wZXNCeUlkZW50aWZpZXIuc2V0KGlkZW50aWZpZXIsIHNjb3BlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlQ291bnQgPSAodGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5nZXQodmFsdWUpIHx8IDApICsgMTtcbiAgICAgICAgdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5zZXQodmFsdWUsIHJlZmVyZW5jZUNvdW50KTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50ID09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc2NvcGVDb25uZWN0ZWQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb3VudCA9IHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMuZ2V0KHZhbHVlKTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlUmVmZXJlbmNlQ291bnRzLnNldCh2YWx1ZSwgcmVmZXJlbmNlQ291bnQgLSAxKTtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2VDb3VudCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zY29wZURpc2Nvbm5lY3RlZCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hTY29wZXNCeUlkZW50aWZpZXJGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IHNjb3Blc0J5SWRlbnRpZmllciA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LmdldChlbGVtZW50KTtcbiAgICAgICAgaWYgKCFzY29wZXNCeUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHNjb3Blc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LnNldChlbGVtZW50LCBzY29wZXNCeUlkZW50aWZpZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29wZXNCeUlkZW50aWZpZXI7XG4gICAgfVxufVxuXG5jbGFzcyBSb3V0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyID0gbmV3IFNjb3BlT2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLnNjaGVtYSwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMubW9kdWxlc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGxvZ2dlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24ubG9nZ2VyO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGU7XG4gICAgfVxuICAgIGdldCBtb2R1bGVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIudmFsdWVzKCkpO1xuICAgIH1cbiAgICBnZXQgY29udGV4dHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZHVsZXMucmVkdWNlKChjb250ZXh0cywgbW9kdWxlKSA9PiBjb250ZXh0cy5jb25jYXQobW9kdWxlLmNvbnRleHRzKSwgW10pO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuc2NvcGVPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGxvYWREZWZpbml0aW9uKGRlZmluaXRpb24pIHtcbiAgICAgICAgdGhpcy51bmxvYWRJZGVudGlmaWVyKGRlZmluaXRpb24uaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IG5ldyBNb2R1bGUodGhpcy5hcHBsaWNhdGlvbiwgZGVmaW5pdGlvbik7XG4gICAgICAgIHRoaXMuY29ubmVjdE1vZHVsZShtb2R1bGUpO1xuICAgICAgICBjb25zdCBhZnRlckxvYWQgPSBkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvci5hZnRlckxvYWQ7XG4gICAgICAgIGlmIChhZnRlckxvYWQpIHtcbiAgICAgICAgICAgIGFmdGVyTG9hZChkZWZpbml0aW9uLmlkZW50aWZpZXIsIHRoaXMuYXBwbGljYXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVubG9hZElkZW50aWZpZXIoaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRDb250ZXh0Rm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNvbnRleHRzLmZpbmQoKGNvbnRleHQpID0+IGNvbnRleHQuZWxlbWVudCA9PSBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24uaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCk7XG4gICAgfVxuICAgIGNyZWF0ZVNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICByZXR1cm4gbmV3IFNjb3BlKHRoaXMuc2NoZW1hLCBlbGVtZW50LCBpZGVudGlmaWVyLCB0aGlzLmxvZ2dlcik7XG4gICAgfVxuICAgIHNjb3BlQ29ubmVjdGVkKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmFkZChzY29wZS5pZGVudGlmaWVyLCBzY29wZSk7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5nZXQoc2NvcGUuaWRlbnRpZmllcik7XG4gICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgIG1vZHVsZS5jb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzY29wZURpc2Nvbm5lY3RlZChzY29wZSkge1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllci5kZWxldGUoc2NvcGUuaWRlbnRpZmllciwgc2NvcGUpO1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KHNjb3BlLmlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICBtb2R1bGUuZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29ubmVjdE1vZHVsZShtb2R1bGUpIHtcbiAgICAgICAgdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLnNldChtb2R1bGUuaWRlbnRpZmllciwgbW9kdWxlKTtcbiAgICAgICAgY29uc3Qgc2NvcGVzID0gdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZ2V0VmFsdWVzRm9yS2V5KG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjb3BlKSA9PiBtb2R1bGUuY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0TW9kdWxlKG1vZHVsZSkge1xuICAgICAgICB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZGVsZXRlKG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgY29uc3Qgc2NvcGVzID0gdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZ2V0VmFsdWVzRm9yS2V5KG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjb3BlKSA9PiBtb2R1bGUuZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkpO1xuICAgIH1cbn1cblxuY29uc3QgZGVmYXVsdFNjaGVtYSA9IHtcbiAgICBjb250cm9sbGVyQXR0cmlidXRlOiBcImRhdGEtY29udHJvbGxlclwiLFxuICAgIGFjdGlvbkF0dHJpYnV0ZTogXCJkYXRhLWFjdGlvblwiLFxuICAgIHRhcmdldEF0dHJpYnV0ZTogXCJkYXRhLXRhcmdldFwiLFxuICAgIHRhcmdldEF0dHJpYnV0ZUZvclNjb3BlOiAoaWRlbnRpZmllcikgPT4gYGRhdGEtJHtpZGVudGlmaWVyfS10YXJnZXRgLFxuICAgIG91dGxldEF0dHJpYnV0ZUZvclNjb3BlOiAoaWRlbnRpZmllciwgb3V0bGV0KSA9PiBgZGF0YS0ke2lkZW50aWZpZXJ9LSR7b3V0bGV0fS1vdXRsZXRgLFxuICAgIGtleU1hcHBpbmdzOiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oeyBlbnRlcjogXCJFbnRlclwiLCB0YWI6IFwiVGFiXCIsIGVzYzogXCJFc2NhcGVcIiwgc3BhY2U6IFwiIFwiLCB1cDogXCJBcnJvd1VwXCIsIGRvd246IFwiQXJyb3dEb3duXCIsIGxlZnQ6IFwiQXJyb3dMZWZ0XCIsIHJpZ2h0OiBcIkFycm93UmlnaHRcIiwgaG9tZTogXCJIb21lXCIsIGVuZDogXCJFbmRcIiB9LCBvYmplY3RGcm9tRW50cmllcyhcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XCIuc3BsaXQoXCJcIikubWFwKChjKSA9PiBbYywgY10pKSksIG9iamVjdEZyb21FbnRyaWVzKFwiMDEyMzQ1Njc4OVwiLnNwbGl0KFwiXCIpLm1hcCgobikgPT4gW24sIG5dKSkpLFxufTtcbmZ1bmN0aW9uIG9iamVjdEZyb21FbnRyaWVzKGFycmF5KSB7XG4gICAgcmV0dXJuIGFycmF5LnJlZHVjZSgobWVtbywgW2ssIHZdKSA9PiAoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBtZW1vKSwgeyBba106IHYgfSkpLCB7fSk7XG59XG5cbmNsYXNzIEFwcGxpY2F0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBzY2hlbWEgPSBkZWZhdWx0U2NoZW1hKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gY29uc29sZTtcbiAgICAgICAgdGhpcy5kZWJ1ZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkgPSAoaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwgPSB7fSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVidWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ0Zvcm1hdHRlZE1lc3NhZ2UoaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnNjaGVtYSA9IHNjaGVtYTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIodGhpcyk7XG4gICAgICAgIHRoaXMucm91dGVyID0gbmV3IFJvdXRlcih0aGlzKTtcbiAgICAgICAgdGhpcy5hY3Rpb25EZXNjcmlwdG9yRmlsdGVycyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRBY3Rpb25EZXNjcmlwdG9yRmlsdGVycyk7XG4gICAgfVxuICAgIHN0YXRpYyBzdGFydChlbGVtZW50LCBzY2hlbWEpIHtcbiAgICAgICAgY29uc3QgYXBwbGljYXRpb24gPSBuZXcgdGhpcyhlbGVtZW50LCBzY2hlbWEpO1xuICAgICAgICBhcHBsaWNhdGlvbi5zdGFydCgpO1xuICAgICAgICByZXR1cm4gYXBwbGljYXRpb247XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0KCkge1xuICAgICAgICBhd2FpdCBkb21SZWFkeSgpO1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0YXJ0aW5nXCIpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5yb3V0ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiYXBwbGljYXRpb25cIiwgXCJzdGFydFwiKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiYXBwbGljYXRpb25cIiwgXCJzdG9wcGluZ1wiKTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnN0b3AoKTtcbiAgICAgICAgdGhpcy5yb3V0ZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0b3BcIik7XG4gICAgfVxuICAgIHJlZ2lzdGVyKGlkZW50aWZpZXIsIGNvbnRyb2xsZXJDb25zdHJ1Y3Rvcikge1xuICAgICAgICB0aGlzLmxvYWQoeyBpZGVudGlmaWVyLCBjb250cm9sbGVyQ29uc3RydWN0b3IgfSk7XG4gICAgfVxuICAgIHJlZ2lzdGVyQWN0aW9uT3B0aW9uKG5hbWUsIGZpbHRlcikge1xuICAgICAgICB0aGlzLmFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzW25hbWVdID0gZmlsdGVyO1xuICAgIH1cbiAgICBsb2FkKGhlYWQsIC4uLnJlc3QpIHtcbiAgICAgICAgY29uc3QgZGVmaW5pdGlvbnMgPSBBcnJheS5pc0FycmF5KGhlYWQpID8gaGVhZCA6IFtoZWFkLCAuLi5yZXN0XTtcbiAgICAgICAgZGVmaW5pdGlvbnMuZm9yRWFjaCgoZGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgICAgaWYgKGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yLnNob3VsZExvYWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5sb2FkRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHVubG9hZChoZWFkLCAuLi5yZXN0KSB7XG4gICAgICAgIGNvbnN0IGlkZW50aWZpZXJzID0gQXJyYXkuaXNBcnJheShoZWFkKSA/IGhlYWQgOiBbaGVhZCwgLi4ucmVzdF07XG4gICAgICAgIGlkZW50aWZpZXJzLmZvckVhY2goKGlkZW50aWZpZXIpID0+IHRoaXMucm91dGVyLnVubG9hZElkZW50aWZpZXIoaWRlbnRpZmllcikpO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlci5jb250ZXh0cy5tYXAoKGNvbnRleHQpID0+IGNvbnRleHQuY29udHJvbGxlcik7XG4gICAgfVxuICAgIGdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLnJvdXRlci5nZXRDb250ZXh0Rm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgICAgIHJldHVybiBjb250ZXh0ID8gY29udGV4dC5jb250cm9sbGVyIDogbnVsbDtcbiAgICB9XG4gICAgaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGAlc1xcblxcbiVvXFxuXFxuJW9gLCBtZXNzYWdlLCBlcnJvciwgZGV0YWlsKTtcbiAgICAgICAgKF9hID0gd2luZG93Lm9uZXJyb3IpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKHdpbmRvdywgbWVzc2FnZSwgXCJcIiwgMCwgMCwgZXJyb3IpO1xuICAgIH1cbiAgICBsb2dGb3JtYXR0ZWRNZXNzYWdlKGlkZW50aWZpZXIsIGZ1bmN0aW9uTmFtZSwgZGV0YWlsID0ge30pIHtcbiAgICAgICAgZGV0YWlsID0gT2JqZWN0LmFzc2lnbih7IGFwcGxpY2F0aW9uOiB0aGlzIH0sIGRldGFpbCk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmdyb3VwQ29sbGFwc2VkKGAke2lkZW50aWZpZXJ9ICMke2Z1bmN0aW9uTmFtZX1gKTtcbiAgICAgICAgdGhpcy5sb2dnZXIubG9nKFwiZGV0YWlsczpcIiwgT2JqZWN0LmFzc2lnbih7fSwgZGV0YWlsKSk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmdyb3VwRW5kKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZG9tUmVhZHkoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09IFwibG9hZGluZ1wiKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIENsYXNzUHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgY2xhc3NlcyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcImNsYXNzZXNcIik7XG4gICAgcmV0dXJuIGNsYXNzZXMucmVkdWNlKChwcm9wZXJ0aWVzLCBjbGFzc0RlZmluaXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0ZvckNsYXNzRGVmaW5pdGlvbihjbGFzc0RlZmluaXRpb24pKTtcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBwcm9wZXJ0aWVzRm9yQ2xhc3NEZWZpbml0aW9uKGtleSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIFtgJHtrZXl9Q2xhc3NgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgY2xhc3NlcyB9ID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3Nlcy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3Nlcy5nZXQoa2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGNsYXNzZXMuZ2V0QXR0cmlidXRlTmFtZShrZXkpO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgYXR0cmlidXRlIFwiJHthdHRyaWJ1dGV9XCJgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7a2V5fUNsYXNzZXNgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsYXNzZXMuZ2V0QWxsKGtleSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYGhhcyR7Y2FwaXRhbGl6ZShrZXkpfUNsYXNzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc2VzLmhhcyhrZXkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBPdXRsZXRQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBvdXRsZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwib3V0bGV0c1wiKTtcbiAgICByZXR1cm4gb3V0bGV0cy5yZWR1Y2UoKHByb3BlcnRpZXMsIG91dGxldERlZmluaXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0Zvck91dGxldERlZmluaXRpb24ob3V0bGV0RGVmaW5pdGlvbikpO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JPdXRsZXREZWZpbml0aW9uKG5hbWUpIHtcbiAgICBjb25zdCBjYW1lbGl6ZWROYW1lID0gbmFtZXNwYWNlQ2FtZWxpemUobmFtZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake2NhbWVsaXplZE5hbWV9T3V0bGV0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLm91dGxldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0bGV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldENvbnRyb2xsZXIgPSB0aGlzLmFwcGxpY2F0aW9uLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihvdXRsZXQsIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3V0bGV0Q29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dGxldENvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgXCJkYXRhLWNvbnRyb2xsZXI9JHtuYW1lfVwiIGF0dHJpYnV0ZSBvbiBvdXRsZXQgZWxlbWVudCBmb3IgXCIke3RoaXMuaWRlbnRpZmllcn1cIiBjb250cm9sbGVyYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIG91dGxldCBlbGVtZW50IFwiJHtuYW1lfVwiIGZvciBcIiR7dGhpcy5pZGVudGlmaWVyfVwiIGNvbnRyb2xsZXJgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtjYW1lbGl6ZWROYW1lfU91dGxldHNgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldHMgPSB0aGlzLm91dGxldHMuZmluZEFsbChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0bGV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKChvdXRsZXQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSB0aGlzLmFwcGxpY2F0aW9uLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihvdXRsZXQsIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udHJvbGxlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVGhlIHByb3ZpZGVkIG91dGxldCBlbGVtZW50IGlzIG1pc3NpbmcgdGhlIG91dGxldCBjb250cm9sbGVyIFwiJHtuYW1lfVwiIGZvciBcIiR7dGhpcy5pZGVudGlmaWVyfVwiYCwgb3V0bGV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGNvbnRyb2xsZXIpID0+IGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRFbGVtZW50YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLm91dGxldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0bGV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3Npbmcgb3V0bGV0IGVsZW1lbnQgXCIke25hbWV9XCIgZm9yIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCIgY29udHJvbGxlcmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtjYW1lbGl6ZWROYW1lfU91dGxldEVsZW1lbnRzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzLmZpbmRBbGwobmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYGhhcyR7Y2FwaXRhbGl6ZShjYW1lbGl6ZWROYW1lKX1PdXRsZXRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm91dGxldHMuaGFzKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBUYXJnZXRQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCB0YXJnZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwidGFyZ2V0c1wiKTtcbiAgICByZXR1cm4gdGFyZ2V0cy5yZWR1Y2UoKHByb3BlcnRpZXMsIHRhcmdldERlZmluaXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0ZvclRhcmdldERlZmluaXRpb24odGFyZ2V0RGVmaW5pdGlvbikpO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JUYXJnZXREZWZpbml0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBbYCR7bmFtZX1UYXJnZXRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMudGFyZ2V0cy5maW5kKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyB0YXJnZXQgZWxlbWVudCBcIiR7bmFtZX1cIiBmb3IgXCIke3RoaXMuaWRlbnRpZmllcn1cIiBjb250cm9sbGVyYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2Ake25hbWV9VGFyZ2V0c2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0cy5maW5kQWxsKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2BoYXMke2NhcGl0YWxpemUobmFtZSl9VGFyZ2V0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRzLmhhcyhuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gVmFsdWVQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCB2YWx1ZURlZmluaXRpb25QYWlycyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBcInZhbHVlc1wiKTtcbiAgICBjb25zdCBwcm9wZXJ0eURlc2NyaXB0b3JNYXAgPSB7XG4gICAgICAgIHZhbHVlRGVzY3JpcHRvck1hcDoge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZURlZmluaXRpb25QYWlycy5yZWR1Y2UoKHJlc3VsdCwgdmFsdWVEZWZpbml0aW9uUGFpcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZURlc2NyaXB0b3IgPSBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgdGhpcy5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuZGF0YS5nZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KHZhbHVlRGVzY3JpcHRvci5rZXkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihyZXN1bHQsIHsgW2F0dHJpYnV0ZU5hbWVdOiB2YWx1ZURlc2NyaXB0b3IgfSk7XG4gICAgICAgICAgICAgICAgfSwge30pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJldHVybiB2YWx1ZURlZmluaXRpb25QYWlycy5yZWR1Y2UoKHByb3BlcnRpZXMsIHZhbHVlRGVmaW5pdGlvblBhaXIpID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0ZvclZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpcikpO1xuICAgIH0sIHByb3BlcnR5RGVzY3JpcHRvck1hcCk7XG59XG5mdW5jdGlvbiBwcm9wZXJ0aWVzRm9yVmFsdWVEZWZpbml0aW9uUGFpcih2YWx1ZURlZmluaXRpb25QYWlyLCBjb250cm9sbGVyKSB7XG4gICAgY29uc3QgZGVmaW5pdGlvbiA9IHBhcnNlVmFsdWVEZWZpbml0aW9uUGFpcih2YWx1ZURlZmluaXRpb25QYWlyLCBjb250cm9sbGVyKTtcbiAgICBjb25zdCB7IGtleSwgbmFtZSwgcmVhZGVyOiByZWFkLCB3cml0ZXI6IHdyaXRlIH0gPSBkZWZpbml0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICAgIFtuYW1lXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5kYXRhLmdldChrZXkpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmaW5pdGlvbi5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5kZWxldGUoa2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5zZXQoa2V5LCB3cml0ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKG5hbWUpfWBdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5oYXMoa2V5KSB8fCBkZWZpbml0aW9uLmhhc0N1c3RvbURlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVEZWZpbml0aW9uUGFpcihbdG9rZW4sIHR5cGVEZWZpbml0aW9uXSwgY29udHJvbGxlcikge1xuICAgIHJldHVybiB2YWx1ZURlc2NyaXB0b3JGb3JUb2tlbkFuZFR5cGVEZWZpbml0aW9uKHtcbiAgICAgICAgY29udHJvbGxlcixcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIHR5cGVEZWZpbml0aW9uLFxuICAgIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVDb25zdGFudChjb25zdGFudCkge1xuICAgIHN3aXRjaCAoY29uc3RhbnQpIHtcbiAgICAgICAgY2FzZSBBcnJheTpcbiAgICAgICAgICAgIHJldHVybiBcImFycmF5XCI7XG4gICAgICAgIGNhc2UgQm9vbGVhbjpcbiAgICAgICAgICAgIHJldHVybiBcImJvb2xlYW5cIjtcbiAgICAgICAgY2FzZSBOdW1iZXI6XG4gICAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgY2FzZSBPYmplY3Q6XG4gICAgICAgICAgICByZXR1cm4gXCJvYmplY3RcIjtcbiAgICAgICAgY2FzZSBTdHJpbmc6XG4gICAgICAgICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlVHlwZURlZmF1bHQoZGVmYXVsdFZhbHVlKSB7XG4gICAgc3dpdGNoICh0eXBlb2YgZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgIGNhc2UgXCJib29sZWFuXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJib29sZWFuXCI7XG4gICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgIHJldHVybiBcIm51bWJlclwiO1xuICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIFwiYXJyYXlcIjtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGRlZmF1bHRWYWx1ZSkgPT09IFwiW29iamVjdCBPYmplY3RdXCIpXG4gICAgICAgIHJldHVybiBcIm9iamVjdFwiO1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVPYmplY3QocGF5bG9hZCkge1xuICAgIGNvbnN0IHR5cGVGcm9tT2JqZWN0ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudChwYXlsb2FkLnR5cGVPYmplY3QudHlwZSk7XG4gICAgaWYgKCF0eXBlRnJvbU9iamVjdClcbiAgICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGRlZmF1bHRWYWx1ZVR5cGUgPSBwYXJzZVZhbHVlVHlwZURlZmF1bHQocGF5bG9hZC50eXBlT2JqZWN0LmRlZmF1bHQpO1xuICAgIGlmICh0eXBlRnJvbU9iamVjdCAhPT0gZGVmYXVsdFZhbHVlVHlwZSkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0eVBhdGggPSBwYXlsb2FkLmNvbnRyb2xsZXIgPyBgJHtwYXlsb2FkLmNvbnRyb2xsZXJ9LiR7cGF5bG9hZC50b2tlbn1gIDogcGF5bG9hZC50b2tlbjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgc3BlY2lmaWVkIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBTdGltdWx1cyBWYWx1ZSBcIiR7cHJvcGVydHlQYXRofVwiIG11c3QgbWF0Y2ggdGhlIGRlZmluZWQgdHlwZSBcIiR7dHlwZUZyb21PYmplY3R9XCIuIFRoZSBwcm92aWRlZCBkZWZhdWx0IHZhbHVlIG9mIFwiJHtwYXlsb2FkLnR5cGVPYmplY3QuZGVmYXVsdH1cIiBpcyBvZiB0eXBlIFwiJHtkZWZhdWx0VmFsdWVUeXBlfVwiLmApO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZUZyb21PYmplY3Q7XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlVHlwZURlZmluaXRpb24ocGF5bG9hZCkge1xuICAgIGNvbnN0IHR5cGVGcm9tT2JqZWN0ID0gcGFyc2VWYWx1ZVR5cGVPYmplY3Qoe1xuICAgICAgICBjb250cm9sbGVyOiBwYXlsb2FkLmNvbnRyb2xsZXIsXG4gICAgICAgIHRva2VuOiBwYXlsb2FkLnRva2VuLFxuICAgICAgICB0eXBlT2JqZWN0OiBwYXlsb2FkLnR5cGVEZWZpbml0aW9uLFxuICAgIH0pO1xuICAgIGNvbnN0IHR5cGVGcm9tRGVmYXVsdFZhbHVlID0gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHBheWxvYWQudHlwZURlZmluaXRpb24pO1xuICAgIGNvbnN0IHR5cGVGcm9tQ29uc3RhbnQgPSBwYXJzZVZhbHVlVHlwZUNvbnN0YW50KHBheWxvYWQudHlwZURlZmluaXRpb24pO1xuICAgIGNvbnN0IHR5cGUgPSB0eXBlRnJvbU9iamVjdCB8fCB0eXBlRnJvbURlZmF1bHRWYWx1ZSB8fCB0eXBlRnJvbUNvbnN0YW50O1xuICAgIGlmICh0eXBlKVxuICAgICAgICByZXR1cm4gdHlwZTtcbiAgICBjb25zdCBwcm9wZXJ0eVBhdGggPSBwYXlsb2FkLmNvbnRyb2xsZXIgPyBgJHtwYXlsb2FkLmNvbnRyb2xsZXJ9LiR7cGF5bG9hZC50eXBlRGVmaW5pdGlvbn1gIDogcGF5bG9hZC50b2tlbjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmFsdWUgdHlwZSBcIiR7cHJvcGVydHlQYXRofVwiIGZvciBcIiR7cGF5bG9hZC50b2tlbn1cIiB2YWx1ZWApO1xufVxuZnVuY3Rpb24gZGVmYXVsdFZhbHVlRm9yRGVmaW5pdGlvbih0eXBlRGVmaW5pdGlvbikge1xuICAgIGNvbnN0IGNvbnN0YW50ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudCh0eXBlRGVmaW5pdGlvbik7XG4gICAgaWYgKGNvbnN0YW50KVxuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlc0J5VHlwZVtjb25zdGFudF07XG4gICAgY29uc3QgZGVmYXVsdFZhbHVlID0gdHlwZURlZmluaXRpb24uZGVmYXVsdDtcbiAgICBpZiAoZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgcmV0dXJuIHR5cGVEZWZpbml0aW9uO1xufVxuZnVuY3Rpb24gdmFsdWVEZXNjcmlwdG9yRm9yVG9rZW5BbmRUeXBlRGVmaW5pdGlvbihwYXlsb2FkKSB7XG4gICAgY29uc3Qga2V5ID0gYCR7ZGFzaGVyaXplKHBheWxvYWQudG9rZW4pfS12YWx1ZWA7XG4gICAgY29uc3QgdHlwZSA9IHBhcnNlVmFsdWVUeXBlRGVmaW5pdGlvbihwYXlsb2FkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlLFxuICAgICAgICBrZXksXG4gICAgICAgIG5hbWU6IGNhbWVsaXplKGtleSksXG4gICAgICAgIGdldCBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm9yRGVmaW5pdGlvbihwYXlsb2FkLnR5cGVEZWZpbml0aW9uKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0IGhhc0N1c3RvbURlZmF1bHRWYWx1ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVZhbHVlVHlwZURlZmF1bHQocGF5bG9hZC50eXBlRGVmaW5pdGlvbikgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgcmVhZGVyOiByZWFkZXJzW3R5cGVdLFxuICAgICAgICB3cml0ZXI6IHdyaXRlcnNbdHlwZV0gfHwgd3JpdGVycy5kZWZhdWx0LFxuICAgIH07XG59XG5jb25zdCBkZWZhdWx0VmFsdWVzQnlUeXBlID0ge1xuICAgIGdldCBhcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH0sXG4gICAgYm9vbGVhbjogZmFsc2UsXG4gICAgbnVtYmVyOiAwLFxuICAgIGdldCBvYmplY3QoKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9LFxuICAgIHN0cmluZzogXCJcIixcbn07XG5jb25zdCByZWFkZXJzID0ge1xuICAgIGFycmF5KHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGFycmF5ID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIHZhbHVlIG9mIHR5cGUgXCJhcnJheVwiIGJ1dCBpbnN0ZWFkIGdvdCB2YWx1ZSBcIiR7dmFsdWV9XCIgb2YgdHlwZSBcIiR7cGFyc2VWYWx1ZVR5cGVEZWZhdWx0KGFycmF5KX1cImApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICB9LFxuICAgIGJvb2xlYW4odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuICEodmFsdWUgPT0gXCIwXCIgfHwgU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpID09IFwiZmFsc2VcIik7XG4gICAgfSxcbiAgICBudW1iZXIodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSk7XG4gICAgfSxcbiAgICBvYmplY3QodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIGlmIChvYmplY3QgPT09IG51bGwgfHwgdHlwZW9mIG9iamVjdCAhPSBcIm9iamVjdFwiIHx8IEFycmF5LmlzQXJyYXkob2JqZWN0KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZXhwZWN0ZWQgdmFsdWUgb2YgdHlwZSBcIm9iamVjdFwiIGJ1dCBpbnN0ZWFkIGdvdCB2YWx1ZSBcIiR7dmFsdWV9XCIgb2YgdHlwZSBcIiR7cGFyc2VWYWx1ZVR5cGVEZWZhdWx0KG9iamVjdCl9XCJgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH0sXG4gICAgc3RyaW5nKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxufTtcbmNvbnN0IHdyaXRlcnMgPSB7XG4gICAgZGVmYXVsdDogd3JpdGVTdHJpbmcsXG4gICAgYXJyYXk6IHdyaXRlSlNPTixcbiAgICBvYmplY3Q6IHdyaXRlSlNPTixcbn07XG5mdW5jdGlvbiB3cml0ZUpTT04odmFsdWUpIHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xufVxuZnVuY3Rpb24gd3JpdGVTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gYCR7dmFsdWV9YDtcbn1cblxuY2xhc3MgQ29udHJvbGxlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IHNob3VsZExvYWQoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBzdGF0aWMgYWZ0ZXJMb2FkKF9pZGVudGlmaWVyLCBfYXBwbGljYXRpb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnZXQgYXBwbGljYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCBzY29wZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgdGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUudGFyZ2V0cztcbiAgICB9XG4gICAgZ2V0IG91dGxldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLm91dGxldHM7XG4gICAgfVxuICAgIGdldCBjbGFzc2VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5jbGFzc2VzO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZGF0YTtcbiAgICB9XG4gICAgaW5pdGlhbGl6ZSgpIHtcbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICB9XG4gICAgZGlzcGF0Y2goZXZlbnROYW1lLCB7IHRhcmdldCA9IHRoaXMuZWxlbWVudCwgZGV0YWlsID0ge30sIHByZWZpeCA9IHRoaXMuaWRlbnRpZmllciwgYnViYmxlcyA9IHRydWUsIGNhbmNlbGFibGUgPSB0cnVlIH0gPSB7fSkge1xuICAgICAgICBjb25zdCB0eXBlID0gcHJlZml4ID8gYCR7cHJlZml4fToke2V2ZW50TmFtZX1gIDogZXZlbnROYW1lO1xuICAgICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCh0eXBlLCB7IGRldGFpbCwgYnViYmxlcywgY2FuY2VsYWJsZSB9KTtcbiAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxufVxuQ29udHJvbGxlci5ibGVzc2luZ3MgPSBbXG4gICAgQ2xhc3NQcm9wZXJ0aWVzQmxlc3NpbmcsXG4gICAgVGFyZ2V0UHJvcGVydGllc0JsZXNzaW5nLFxuICAgIFZhbHVlUHJvcGVydGllc0JsZXNzaW5nLFxuICAgIE91dGxldFByb3BlcnRpZXNCbGVzc2luZyxcbl07XG5Db250cm9sbGVyLnRhcmdldHMgPSBbXTtcbkNvbnRyb2xsZXIub3V0bGV0cyA9IFtdO1xuQ29udHJvbGxlci52YWx1ZXMgPSB7fTtcblxuZXhwb3J0IHsgQXBwbGljYXRpb24sIEF0dHJpYnV0ZU9ic2VydmVyLCBDb250ZXh0LCBDb250cm9sbGVyLCBFbGVtZW50T2JzZXJ2ZXIsIEluZGV4ZWRNdWx0aW1hcCwgTXVsdGltYXAsIFNlbGVjdG9yT2JzZXJ2ZXIsIFN0cmluZ01hcE9ic2VydmVyLCBUb2tlbkxpc3RPYnNlcnZlciwgVmFsdWVMaXN0T2JzZXJ2ZXIsIGFkZCwgZGVmYXVsdFNjaGVtYSwgZGVsLCBmZXRjaCwgcHJ1bmUgfTtcbiIsImltcG9ydCB7Q29udHJvbGxlcn0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gIHN0YXRpYyB0YXJnZXRzID0gW1wicmVnaW9uXCJdXG5cbiAgdG9nZ2xlUmVnaW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICB0aGlzLnJlZ2lvblRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgdHJ1ZSlcbiAgICAgIGV2ZW50LnRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZWdpb25UYXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsIGZhbHNlKVxuICAgICAgZXZlbnQudGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIHRydWUpXG4gICAgfVxuICAgIGNvbnN0IHJlY3QgPSB0aGlzLnJlZ2lvblRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIHdpbmRvdy5zY3JvbGwoeyB0b3A6ICh3aW5kb3cucGFnZVlPZmZzZXQgKyByZWN0LnRvcCkgLSAod2luZG93LmlubmVySGVpZ2h0IC8gMyksIGxlZnQ6IDAsIGJlaGF2aW9yOiAnc21vb3RoJyB9KVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gIHN0YXRpYyB0YXJnZXRzID0gW1wib3ZlcmxheVwiXVxuXG4gIG9wZW4oZXZlbnQpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLm92ZXJsYXlUYXJnZXQuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpO1xuICB9XG5cbiAgY2xvc2UoZXZlbnQpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLm92ZXJsYXlUYXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtdmlzaWJsZScpO1xuICB9XG59XG4iLCJpbXBvcnQge0NvbnRyb2xsZXJ9IGZyb20gXCJAaG90d2lyZWQvc3RpbXVsdXNcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuXG4gIGNvbm5lY3QoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplQnV0dG9ucygpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZUNoZWNrYm94ZXMoKTtcblxuICAgIC8vIFJlcG9wdWxhdGUgaW4gY2FzZSBvZiBpbnZhbGlkIGZvcm0gcmV0dXJuZWRcbiAgICB0aGlzLnNlbGVjdGVkQ2F0ZWdvcmllcyA9IHRoaXMuZ2V0U2VsZWN0ZWRDYXRlZ29yaWVzKCk7XG4gICAgdGhpcy50b2dnbGVTdWdnZXN0aW9uc0RpdigpO1xuICB9XG5cbiAgLy8gVE9ETzogUmVmYWN0b3IgdG8gc3RpbXVsdXNcblxuICBpbml0aWFsaXplQnV0dG9ucygpIHtcbiAgICB2YXIgY29udGludWVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1zdGVwX19jb250aW51ZScpO1xuICAgIHZhciBiYWNrQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0tc3RlcF9fYmFjaycpO1xuXG4gICAgaWYoIWNvbnRpbnVlQnV0dG9uIHx8ICFiYWNrQnV0dG9uKXtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb250aW51ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5hY3RpdmF0ZVN0ZXBUd28uYmluZCh0aGlzKSk7XG4gICAgYmFja0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5hY3RpdmF0ZVN0ZXBPbmUuYmluZCh0aGlzKSk7XG4gIH1cblxuICBpbml0aWFsaXplQ2hlY2tib3hlcygpIHtcbiAgICB2YXIgY2F0ZWdvcmllc0ZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tZmllbGRfX2NhdGVnb3JpZXMnKTtcblxuICAgIGlmKCFjYXRlZ29yaWVzRmllbGQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBXaGVuZXZlciBhIGNoYW5nZSBpcyBkZXRlY3RlZCwgc2hvdyByZWxldmFudCB0aXBzXG4gICAgdmFyIGNoZWNrYm94ZXMgPSBjYXRlZ29yaWVzRmllbGQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTtcbiAgICB2YXIgdGhpc1JlZiA9IHRoaXM7XG4gICAgY2hlY2tib3hlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZih0aGlzLmNoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXNSZWYuc2VsZWN0ZWRDYXRlZ29yaWVzLnB1c2godGhpcy52YWx1ZSk7XG4gICAgICAgICAgICB0aGlzUmVmLnNob3dTdWdnZXN0aW9uQ2F0ZWdvcnkodGhpcy52YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpc1JlZi5zZWxlY3RlZENhdGVnb3JpZXMucG9wKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgdGhpc1JlZi5oaWRlU3VnZ2VzdGlvbkNhdGVnb3J5KHRoaXMudmFsdWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENoZWNrIHdoZXRoZXIgdG8gc2hvdyBzdWdnZXN0aW9ucyBhdCBhbGxcbiAgICAgICAgICB0aGlzUmVmLnRvZ2dsZVN1Z2dlc3Rpb25zRGl2KCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgdG9nZ2xlU3VnZ2VzdGlvbnNEaXYoKSB7XG4gICAgdmFyIHRpcHNEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fdGlwJyk7XG4gICAgaWYodGlwc0Rpdikge1xuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDYXRlZ29yaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aXBzRGl2LmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgICAgICB0aXBzRGl2LmNsYXNzTGlzdC5hZGQoJ2lzLXZpc2libGUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRpcHNEaXYuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpO1xuICAgICAgICB0aXBzRGl2LmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldFNlbGVjdGVkQ2F0ZWdvcmllcygpIHtcbiAgICB2YXIgc2VsZWN0ZWRDYXRlZ29yaWVzID0gW107XG4gICAgdmFyIGNhdGVnb3JpZXNGaWVsZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWZpZWxkX19jYXRlZ29yaWVzJyk7XG4gICAgaWYoIWNhdGVnb3JpZXNGaWVsZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY2hlY2tib3hlcyA9IGNhdGVnb3JpZXNGaWVsZC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgIHZhciB0aGlzUmVmID0gdGhpcztcbiAgICBjaGVja2JveGVzLmZvckVhY2goZnVuY3Rpb24oZSkge1xuICAgICAgaWYoZS5jaGVja2VkKSB7XG4gICAgICAgIHNlbGVjdGVkQ2F0ZWdvcmllcy5wdXNoKGUudmFsdWUpO1xuICAgICAgICB0aGlzUmVmLnNob3dTdWdnZXN0aW9uQ2F0ZWdvcnkoZS52YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHNlbGVjdGVkQ2F0ZWdvcmllcztcbiAgfVxuXG4gIHNob3dTdWdnZXN0aW9uQ2F0ZWdvcnkoY2F0ZWdvcnkpIHtcbiAgICB2YXIgaWROYW1lID0gY2F0ZWdvcnkucmVwbGFjZUFsbCgnICcsICdfJyk7XG4gICAgdmFyIHN1Z2dlc3Rpb25EaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3VnZ2VzdGlvbi1hbnN3ZXJzX18nICsgaWROYW1lKTtcbiAgICBpZiAoIXN1Z2dlc3Rpb25EaXYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdWdnZXN0aW9uRGl2LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgIHN1Z2dlc3Rpb25EaXYuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpO1xuXG4gICAgLy8gTW92ZSB0byB0b3BcbiAgICB2YXIgcGFyZW50ID0gc3VnZ2VzdGlvbkRpdi5wYXJlbnROb2RlO1xuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgIHN1Z2dlc3Rpb25EaXYucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc3VnZ2VzdGlvbkRpdiwgcGFyZW50LmZpcnN0Q2hpbGQpO1xuICAgIH1cbiAgfVxuXG4gIGhpZGVTdWdnZXN0aW9uQ2F0ZWdvcnkoY2F0ZWdvcnkpIHtcbiAgICB2YXIgaWROYW1lID0gY2F0ZWdvcnkucmVwbGFjZUFsbCgnICcsICdfJyk7XG4gICAgdmFyIHN1Z2dlc3Rpb25EaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3VnZ2VzdGlvbi1hbnN3ZXJzX18nICsgaWROYW1lKTtcbiAgICBpZiAoIXN1Z2dlc3Rpb25EaXYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdWdnZXN0aW9uRGl2LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLXZpc2libGUnKTtcbiAgICBzdWdnZXN0aW9uRGl2LmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICB9XG5cbiAgYWN0aXZhdGVTdGVwVHdvKCkge1xuXG4gICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX19vbmVcIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LmFkZCgnaXMtaGlkZGVuJykpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX19vbmVcIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtdmlzaWJsZScpKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX190d29cIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJykpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX190d29cIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpKTtcblxuICAgIC8vIFNldCB0aGUgY2F0ZWdvcnkgdGFncy9idXR0b25zIGluIHN0ZXAgMlxuICAgIHZhciBjYXRlZ29yaWVzU3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybS1zdGVwX19zZWxlY3RlZC1jYXRlZ29yaWVzXCIpO1xuICAgIGNhdGVnb3JpZXNTcGFuLmlubmVySFRNTCA9IHRoaXMuZ2V0U2VsZWN0ZWRDYXRlZ29yaWVzSFRNTCgpO1xuXG4gICAgLy8gQ2F0ZWdvcmllcyBpbiBzdGVwIDIgZnVuY3Rpb24gYXMgYSBiYWNrIGJ1dHRvblxuICAgIHZhciBzZWxlY3RlZENhdGVnb3J5QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWxlY3RlZF9jYXRlZ29yeScpO1xuICAgIGlmKHNlbGVjdGVkQ2F0ZWdvcnlCdXR0b25zKSB7XG4gICAgICB2YXIgdGhpc1JlZiA9IHRoaXM7XG4gICAgICBzZWxlY3RlZENhdGVnb3J5QnV0dG9ucy5mb3JFYWNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpc1JlZi5hY3RpdmF0ZVN0ZXBPbmUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgYWN0aXZhdGVTdGVwT25lKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX190d29cIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LmFkZCgnaXMtaGlkZGVuJykpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX190d29cIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtdmlzaWJsZScpKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX19vbmVcIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJykpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1zdGVwX19vbmVcIikuZm9yRWFjaChlID0+IGUuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpKTtcbiAgfVxuXG4gIGdldFNlbGVjdGVkQ2F0ZWdvcmllc0hUTUwoKSB7XG4gICAgdmFyIGh0bWxTdHJpbmcgPSAnJztcbiAgICAvLyBJbSBub3Qgc3VyZSB0aGlzIGlzIGJlc3QgcHJhY3RpY2UgOkRcbiAgICBpZiAodGhpcy5zZWxlY3RlZENhdGVnb3JpZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zZWxlY3RlZENhdGVnb3JpZXMuZm9yRWFjaChlID0+IChodG1sU3RyaW5nICs9IGA8c3BhbiBjbGFzcz1cInRhZyBzZWxlY3RlZF9jYXRlZ29yeVwiPiR7ZX08L3NwYW4+YCkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGh0bWxTdHJpbmcgPSAnPHNwYW4gY2xhc3M9XCJ0YWcgc2VsZWN0ZWRfY2F0ZWdvcnlcIj5lZW4gbmlldXdlIGNhdGVnb3JpZTwvc3Bhbj4nO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbFN0cmluZztcbiAgfVxufVxuIiwiaW1wb3J0IHtDb250cm9sbGVyfSBmcm9tIFwiQGhvdHdpcmVkL3N0aW11bHVzXCJcbmltcG9ydCBjb3B5IGZyb20gJ2NvcHktdG8tY2xpcGJvYXJkJ1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gIHN0YXRpYyB0YXJnZXRzID0gW1widXJsXCIsIFwidGl0bGVcIiwgXCJjb2RlXCIsIFwiZXhhbXBsZVwiLCBcIm1lc3NhZ2VcIl1cblxuICBjb25uZWN0KCkge1xuICAgIHRoaXMudXBkYXRlQ29kZSgpO1xuICB9XG5cbiAga2V5dXAoZXZlbnQpIHtcbiAgICB0aGlzLnVwZGF0ZUNvZGUoKTtcbiAgfVxuXG4gIGNvcHkoZXZlbnQpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgY29weSh0aGlzLmNvZGVUYXJnZXQudmFsdWUpO1xuXG4gICAgLy8gU2hvdyBjb3B5IG1lc3NhZ2VcbiAgICB0aGlzLm1lc3NhZ2VUYXJnZXQuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLm1lc3NhZ2VUYXJnZXQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH0sIDEyMDApO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy50aXRsZVRhcmdldC52YWx1ZSA9IFwiXCI7XG4gICAgdGhpcy50aXRsZVRhcmdldC5mb2N1cygpO1xuXG4gICAgdGhpcy51cGRhdGVDb2RlKCk7XG4gIH1cblxuICB1cGRhdGVDb2RlKCkge1xuICAgIHRoaXMuY29kZVRhcmdldC52YWx1ZSA9IGA8aWZyYW1lIHNyYz1cIiR7dGhpcy51cmxUYXJnZXQudmFsdWV9P3RpdGxlPSR7dGhpcy50aXRsZVRhcmdldC52YWx1ZX1cIiBzdHlsZT1cIndpZHRoOiAxMDAlOyBoZWlnaHQ6IDEyMHB4O1wiPjwvaWZyYW1lPmBcbiAgICB0aGlzLmV4YW1wbGVUYXJnZXQuaW5uZXJIVE1MID0gdGhpcy5jb2RlVGFyZ2V0LnZhbHVlO1xuICB9XG59IiwiaW1wb3J0IHtDb250cm9sbGVyfSBmcm9tIFwiQGhvdHdpcmVkL3N0aW11bHVzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgc3RhdGljIHRhcmdldHMgPSBbXCJsaW5rXCJdXG5cbiAgY29ubmVjdCgpIHtcbiAgICBjb25zdCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnRpdGxlO1xuICAgIHRoaXMubGlua1RhcmdldHMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgIGNvbnN0IHNvY2lhbE1lZGlhUGxhdGZvcm0gPSBlbGVtZW50LmRhdGFzZXQuc29jaWFsUGxhdGZvcm07XG4gICAgICBsZXQgbGluayA9IFwiXCJcbiAgICAgIGlmIChzb2NpYWxNZWRpYVBsYXRmb3JtID09PSBcImZhY2Vib29rXCIpIHtcbiAgICAgICAgbGluayA9IGBodHRwczovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT0ke3VybH1gXG4gICAgICB9IGVsc2UgaWYgKHNvY2lhbE1lZGlhUGxhdGZvcm0gPT09IFwidHdpdHRlclwiKSB7XG4gICAgICAgIGxpbmsgPSBgaHR0cDovL3R3aXR0ZXIuY29tL3NoYXJlPyZ1cmw9JHt1cmx9YFxuICAgICAgfSBlbHNlIGlmIChzb2NpYWxNZWRpYVBsYXRmb3JtID09PSBcImxpbmtlZGluXCIpIHtcbiAgICAgICAgbGluayA9IGBodHRwczovL3d3dy5saW5rZWRpbi5jb20vc2hhcmVBcnRpY2xlP21pbmk9dHJ1ZSZ1cmw9JHt1cmx9JnRpdGxlPSR7dGl0bGV9YFxuICAgICAgfSBlbHNlIGlmIChzb2NpYWxNZWRpYVBsYXRmb3JtID09PSBcIndoYXRzYXBwXCIpIHtcbiAgICAgICAgbGluayA9IGBodHRwczovL3dhLm1lLz90ZXh0PSR7dXJsfWA7XG4gICAgICB9XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImhyZWZcIiwgbGluayk7XG4gICAgfSlcbiAgfVxufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgZGVzZWxlY3RDdXJyZW50ID0gcmVxdWlyZShcInRvZ2dsZS1zZWxlY3Rpb25cIik7XG5cbnZhciBjbGlwYm9hcmRUb0lFMTFGb3JtYXR0aW5nID0ge1xuICBcInRleHQvcGxhaW5cIjogXCJUZXh0XCIsXG4gIFwidGV4dC9odG1sXCI6IFwiVXJsXCIsXG4gIFwiZGVmYXVsdFwiOiBcIlRleHRcIlxufVxuXG52YXIgZGVmYXVsdE1lc3NhZ2UgPSBcIkNvcHkgdG8gY2xpcGJvYXJkOiAje2tleX0sIEVudGVyXCI7XG5cbmZ1bmN0aW9uIGZvcm1hdChtZXNzYWdlKSB7XG4gIHZhciBjb3B5S2V5ID0gKC9tYWMgb3MgeC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgPyBcIuKMmFwiIDogXCJDdHJsXCIpICsgXCIrQ1wiO1xuICByZXR1cm4gbWVzc2FnZS5yZXBsYWNlKC8je1xccyprZXlcXHMqfS9nLCBjb3B5S2V5KTtcbn1cblxuZnVuY3Rpb24gY29weSh0ZXh0LCBvcHRpb25zKSB7XG4gIHZhciBkZWJ1ZyxcbiAgICBtZXNzYWdlLFxuICAgIHJlc2VsZWN0UHJldmlvdXMsXG4gICAgcmFuZ2UsXG4gICAgc2VsZWN0aW9uLFxuICAgIG1hcmssXG4gICAgc3VjY2VzcyA9IGZhbHNlO1xuICBpZiAoIW9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cbiAgZGVidWcgPSBvcHRpb25zLmRlYnVnIHx8IGZhbHNlO1xuICB0cnkge1xuICAgIHJlc2VsZWN0UHJldmlvdXMgPSBkZXNlbGVjdEN1cnJlbnQoKTtcblxuICAgIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcbiAgICBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcblxuICAgIG1hcmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBtYXJrLnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAvLyBhdm9pZCBzY3JlZW4gcmVhZGVycyBmcm9tIHJlYWRpbmcgb3V0IGxvdWQgdGhlIHRleHRcbiAgICBtYXJrLmFyaWFIaWRkZW4gPSBcInRydWVcIlxuICAgIC8vIHJlc2V0IHVzZXIgc3R5bGVzIGZvciBzcGFuIGVsZW1lbnRcbiAgICBtYXJrLnN0eWxlLmFsbCA9IFwidW5zZXRcIjtcbiAgICAvLyBwcmV2ZW50cyBzY3JvbGxpbmcgdG8gdGhlIGVuZCBvZiB0aGUgcGFnZVxuICAgIG1hcmsuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XG4gICAgbWFyay5zdHlsZS50b3AgPSAwO1xuICAgIG1hcmsuc3R5bGUuY2xpcCA9IFwicmVjdCgwLCAwLCAwLCAwKVwiO1xuICAgIC8vIHVzZWQgdG8gcHJlc2VydmUgc3BhY2VzIGFuZCBsaW5lIGJyZWFrc1xuICAgIG1hcmsuc3R5bGUud2hpdGVTcGFjZSA9IFwicHJlXCI7XG4gICAgLy8gZG8gbm90IGluaGVyaXQgdXNlci1zZWxlY3QgKGl0IG1heSBiZSBgbm9uZWApXG4gICAgbWFyay5zdHlsZS53ZWJraXRVc2VyU2VsZWN0ID0gXCJ0ZXh0XCI7XG4gICAgbWFyay5zdHlsZS5Nb3pVc2VyU2VsZWN0ID0gXCJ0ZXh0XCI7XG4gICAgbWFyay5zdHlsZS5tc1VzZXJTZWxlY3QgPSBcInRleHRcIjtcbiAgICBtYXJrLnN0eWxlLnVzZXJTZWxlY3QgPSBcInRleHRcIjtcbiAgICBtYXJrLmFkZEV2ZW50TGlzdGVuZXIoXCJjb3B5XCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBpZiAob3B0aW9ucy5mb3JtYXQpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAodHlwZW9mIGUuY2xpcGJvYXJkRGF0YSA9PT0gXCJ1bmRlZmluZWRcIikgeyAvLyBJRSAxMVxuICAgICAgICAgIGRlYnVnICYmIGNvbnNvbGUud2FybihcInVuYWJsZSB0byB1c2UgZS5jbGlwYm9hcmREYXRhXCIpO1xuICAgICAgICAgIGRlYnVnICYmIGNvbnNvbGUud2FybihcInRyeWluZyBJRSBzcGVjaWZpYyBzdHVmZlwiKTtcbiAgICAgICAgICB3aW5kb3cuY2xpcGJvYXJkRGF0YS5jbGVhckRhdGEoKTtcbiAgICAgICAgICB2YXIgZm9ybWF0ID0gY2xpcGJvYXJkVG9JRTExRm9ybWF0dGluZ1tvcHRpb25zLmZvcm1hdF0gfHwgY2xpcGJvYXJkVG9JRTExRm9ybWF0dGluZ1tcImRlZmF1bHRcIl1cbiAgICAgICAgICB3aW5kb3cuY2xpcGJvYXJkRGF0YS5zZXREYXRhKGZvcm1hdCwgdGV4dCk7XG4gICAgICAgIH0gZWxzZSB7IC8vIGFsbCBvdGhlciBicm93c2Vyc1xuICAgICAgICAgIGUuY2xpcGJvYXJkRGF0YS5jbGVhckRhdGEoKTtcbiAgICAgICAgICBlLmNsaXBib2FyZERhdGEuc2V0RGF0YShvcHRpb25zLmZvcm1hdCwgdGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm9uQ29weSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIG9wdGlvbnMub25Db3B5KGUuY2xpcGJvYXJkRGF0YSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1hcmspO1xuXG4gICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKG1hcmspO1xuICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG5cbiAgICB2YXIgc3VjY2Vzc2Z1bCA9IGRvY3VtZW50LmV4ZWNDb21tYW5kKFwiY29weVwiKTtcbiAgICBpZiAoIXN1Y2Nlc3NmdWwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcImNvcHkgY29tbWFuZCB3YXMgdW5zdWNjZXNzZnVsXCIpO1xuICAgIH1cbiAgICBzdWNjZXNzID0gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZGVidWcgJiYgY29uc29sZS5lcnJvcihcInVuYWJsZSB0byBjb3B5IHVzaW5nIGV4ZWNDb21tYW5kOiBcIiwgZXJyKTtcbiAgICBkZWJ1ZyAmJiBjb25zb2xlLndhcm4oXCJ0cnlpbmcgSUUgc3BlY2lmaWMgc3R1ZmZcIik7XG4gICAgdHJ5IHtcbiAgICAgIHdpbmRvdy5jbGlwYm9hcmREYXRhLnNldERhdGEob3B0aW9ucy5mb3JtYXQgfHwgXCJ0ZXh0XCIsIHRleHQpO1xuICAgICAgb3B0aW9ucy5vbkNvcHkgJiYgb3B0aW9ucy5vbkNvcHkod2luZG93LmNsaXBib2FyZERhdGEpO1xuICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBkZWJ1ZyAmJiBjb25zb2xlLmVycm9yKFwidW5hYmxlIHRvIGNvcHkgdXNpbmcgY2xpcGJvYXJkRGF0YTogXCIsIGVycik7XG4gICAgICBkZWJ1ZyAmJiBjb25zb2xlLmVycm9yKFwiZmFsbGluZyBiYWNrIHRvIHByb21wdFwiKTtcbiAgICAgIG1lc3NhZ2UgPSBmb3JtYXQoXCJtZXNzYWdlXCIgaW4gb3B0aW9ucyA/IG9wdGlvbnMubWVzc2FnZSA6IGRlZmF1bHRNZXNzYWdlKTtcbiAgICAgIHdpbmRvdy5wcm9tcHQobWVzc2FnZSwgdGV4dCk7XG4gICAgfVxuICB9IGZpbmFsbHkge1xuICAgIGlmIChzZWxlY3Rpb24pIHtcbiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0aW9uLnJlbW92ZVJhbmdlID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlUmFuZ2UocmFuZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChtYXJrKSB7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG1hcmspO1xuICAgIH1cbiAgICByZXNlbGVjdFByZXZpb3VzKCk7XG4gIH1cblxuICByZXR1cm4gc3VjY2Vzcztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjb3B5O1xuIiwiXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICBpZiAoIXNlbGVjdGlvbi5yYW5nZUNvdW50KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHt9O1xuICB9XG4gIHZhciBhY3RpdmUgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXG4gIHZhciByYW5nZXMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3Rpb24ucmFuZ2VDb3VudDsgaSsrKSB7XG4gICAgcmFuZ2VzLnB1c2goc2VsZWN0aW9uLmdldFJhbmdlQXQoaSkpO1xuICB9XG5cbiAgc3dpdGNoIChhY3RpdmUudGFnTmFtZS50b1VwcGVyQ2FzZSgpKSB7IC8vIC50b1VwcGVyQ2FzZSBoYW5kbGVzIFhIVE1MXG4gICAgY2FzZSAnSU5QVVQnOlxuICAgIGNhc2UgJ1RFWFRBUkVBJzpcbiAgICAgIGFjdGl2ZS5ibHVyKCk7XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICBhY3RpdmUgPSBudWxsO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgc2VsZWN0aW9uLnR5cGUgPT09ICdDYXJldCcgJiZcbiAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cbiAgICBpZiAoIXNlbGVjdGlvbi5yYW5nZUNvdW50KSB7XG4gICAgICByYW5nZXMuZm9yRWFjaChmdW5jdGlvbihyYW5nZSkge1xuICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWN0aXZlICYmXG4gICAgYWN0aXZlLmZvY3VzKCk7XG4gIH07XG59O1xuIiwidmFyIG1hcCA9IHtcblx0XCIuL2Rpc2Nsb3N1cmUtY29udHJvbGxlci5qc1wiOiBcIi4vd2FndGFpbF9oZWxwZGVzay9zdGF0aWNfc3JjL2pzL2NvbnRyb2xsZXJzL2Rpc2Nsb3N1cmUtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vbmF2aWdhdGlvbi1jb250cm9sbGVyLmpzXCI6IFwiLi93YWd0YWlsX2hlbHBkZXNrL3N0YXRpY19zcmMvanMvY29udHJvbGxlcnMvbmF2aWdhdGlvbi1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9xdWVzdGlvbi1mb3JtLWNvbnRyb2xsZXIuanNcIjogXCIuL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9xdWVzdGlvbi1mb3JtLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3NlYXJjaC13aWRnZXQtYnVpbGRlci1jb250cm9sbGVyLmpzXCI6IFwiLi93YWd0YWlsX2hlbHBkZXNrL3N0YXRpY19zcmMvanMvY29udHJvbGxlcnMvc2VhcmNoLXdpZGdldC1idWlsZGVyLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3NvY2lhbC1zaGFyZS1idXR0b25zLWNvbnRyb2xsZXIuanNcIjogXCIuL3dhZ3RhaWxfaGVscGRlc2svc3RhdGljX3NyYy9qcy9jb250cm9sbGVycy9zb2NpYWwtc2hhcmUtYnV0dG9ucy1jb250cm9sbGVyLmpzXCJcbn07XG5cblxuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHZhciBpZCA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpO1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhpZCk7XG59XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8obWFwLCByZXEpKSB7XG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBtYXBbcmVxXTtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vd2FndGFpbF9oZWxwZGVzay9zdGF0aWNfc3JjL2pzL2NvbnRyb2xsZXJzIHN5bmMgcmVjdXJzaXZlIFxcXFwuanMkXCI7IiwiaW1wb3J0IHsgZ2xvYiB9IGZyb20gXCIuL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuL1V0aWwuanNcIjtcbmNvbnN0IG5vdyA9IChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGdsb2IucGVyZm9ybWFuY2UgJiYgZ2xvYi5wZXJmb3JtYW5jZS5ub3cpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnbG9iLnBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgfTtcbn0pKCk7XG5leHBvcnQgY2xhc3MgQW5pbWF0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihmdW5jLCBsYXllcnMpIHtcbiAgICAgICAgdGhpcy5pZCA9IEFuaW1hdGlvbi5hbmltSWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMuZnJhbWUgPSB7XG4gICAgICAgICAgICB0aW1lOiAwLFxuICAgICAgICAgICAgdGltZURpZmY6IDAsXG4gICAgICAgICAgICBsYXN0VGltZTogbm93KCksXG4gICAgICAgICAgICBmcmFtZVJhdGU6IDAsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZnVuYyA9IGZ1bmM7XG4gICAgICAgIHRoaXMuc2V0TGF5ZXJzKGxheWVycyk7XG4gICAgfVxuICAgIHNldExheWVycyhsYXllcnMpIHtcbiAgICAgICAgbGV0IGxheXMgPSBbXTtcbiAgICAgICAgaWYgKGxheWVycykge1xuICAgICAgICAgICAgbGF5cyA9IEFycmF5LmlzQXJyYXkobGF5ZXJzKSA/IGxheWVycyA6IFtsYXllcnNdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGF5ZXJzID0gbGF5cztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGdldExheWVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGF5ZXJzO1xuICAgIH1cbiAgICBhZGRMYXllcihsYXllcikge1xuICAgICAgICBjb25zdCBsYXllcnMgPSB0aGlzLmxheWVycztcbiAgICAgICAgY29uc3QgbGVuID0gbGF5ZXJzLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgaWYgKGxheWVyc1tuXS5faWQgPT09IGxheWVyLl9pZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxheWVycy5wdXNoKGxheWVyKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlzUnVubmluZygpIHtcbiAgICAgICAgY29uc3QgYSA9IEFuaW1hdGlvbjtcbiAgICAgICAgY29uc3QgYW5pbWF0aW9ucyA9IGEuYW5pbWF0aW9ucztcbiAgICAgICAgY29uc3QgbGVuID0gYW5pbWF0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25zW25dLmlkID09PSB0aGlzLmlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIHRoaXMuZnJhbWUudGltZURpZmYgPSAwO1xuICAgICAgICB0aGlzLmZyYW1lLmxhc3RUaW1lID0gbm93KCk7XG4gICAgICAgIEFuaW1hdGlvbi5fYWRkQW5pbWF0aW9uKHRoaXMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgQW5pbWF0aW9uLl9yZW1vdmVBbmltYXRpb24odGhpcyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBfdXBkYXRlRnJhbWVPYmplY3QodGltZSkge1xuICAgICAgICB0aGlzLmZyYW1lLnRpbWVEaWZmID0gdGltZSAtIHRoaXMuZnJhbWUubGFzdFRpbWU7XG4gICAgICAgIHRoaXMuZnJhbWUubGFzdFRpbWUgPSB0aW1lO1xuICAgICAgICB0aGlzLmZyYW1lLnRpbWUgKz0gdGhpcy5mcmFtZS50aW1lRGlmZjtcbiAgICAgICAgdGhpcy5mcmFtZS5mcmFtZVJhdGUgPSAxMDAwIC8gdGhpcy5mcmFtZS50aW1lRGlmZjtcbiAgICB9XG4gICAgc3RhdGljIF9hZGRBbmltYXRpb24oYW5pbSkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvbnMucHVzaChhbmltKTtcbiAgICAgICAgdGhpcy5faGFuZGxlQW5pbWF0aW9uKCk7XG4gICAgfVxuICAgIHN0YXRpYyBfcmVtb3ZlQW5pbWF0aW9uKGFuaW0pIHtcbiAgICAgICAgY29uc3QgaWQgPSBhbmltLmlkO1xuICAgICAgICBjb25zdCBhbmltYXRpb25zID0gdGhpcy5hbmltYXRpb25zO1xuICAgICAgICBjb25zdCBsZW4gPSBhbmltYXRpb25zLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbnNbbl0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zLnNwbGljZShuLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgX3J1bkZyYW1lcygpIHtcbiAgICAgICAgY29uc3QgbGF5ZXJIYXNoID0ge307XG4gICAgICAgIGNvbnN0IGFuaW1hdGlvbnMgPSB0aGlzLmFuaW1hdGlvbnM7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgYW5pbWF0aW9ucy5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgY29uc3QgYW5pbSA9IGFuaW1hdGlvbnNbbl07XG4gICAgICAgICAgICBjb25zdCBsYXllcnMgPSBhbmltLmxheWVycztcbiAgICAgICAgICAgIGNvbnN0IGZ1bmMgPSBhbmltLmZ1bmM7XG4gICAgICAgICAgICBhbmltLl91cGRhdGVGcmFtZU9iamVjdChub3coKSk7XG4gICAgICAgICAgICBjb25zdCBsYXllcnNMZW4gPSBsYXllcnMubGVuZ3RoO1xuICAgICAgICAgICAgbGV0IG5lZWRSZWRyYXc7XG4gICAgICAgICAgICBpZiAoZnVuYykge1xuICAgICAgICAgICAgICAgIG5lZWRSZWRyYXcgPSBmdW5jLmNhbGwoYW5pbSwgYW5pbS5mcmFtZSkgIT09IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmVlZFJlZHJhdyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW5lZWRSZWRyYXcpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5ZXJzTGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXllciA9IGxheWVyc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIuX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJIYXNoW2xheWVyLl9pZF0gPSBsYXllcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbGF5ZXJIYXNoKSB7XG4gICAgICAgICAgICBpZiAoIWxheWVySGFzaC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYXllckhhc2hba2V5XS5iYXRjaERyYXcoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgX2FuaW1hdGlvbkxvb3AoKSB7XG4gICAgICAgIGNvbnN0IEFuaW0gPSBBbmltYXRpb247XG4gICAgICAgIGlmIChBbmltLmFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBBbmltLl9ydW5GcmFtZXMoKTtcbiAgICAgICAgICAgIFV0aWwucmVxdWVzdEFuaW1GcmFtZShBbmltLl9hbmltYXRpb25Mb29wKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEFuaW0uYW5pbVJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgX2hhbmRsZUFuaW1hdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmFuaW1SdW5uaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmFuaW1SdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIFV0aWwucmVxdWVzdEFuaW1GcmFtZSh0aGlzLl9hbmltYXRpb25Mb29wKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbkFuaW1hdGlvbi5hbmltYXRpb25zID0gW107XG5BbmltYXRpb24uYW5pbUlkQ291bnRlciA9IDA7XG5BbmltYXRpb24uYW5pbVJ1bm5pbmcgPSBmYWxzZTtcbiIsImV4cG9ydCBjb25zdCB0VmFsdWVzID0gW1xuICAgIFtdLFxuICAgIFtdLFxuICAgIFtcbiAgICAgICAgLTAuNTc3MzUwMjY5MTg5NjI1NzY0NTA5MTQ4NzgwNTAxOTU3NDU1NjQ3NixcbiAgICAgICAgMC41NzczNTAyNjkxODk2MjU3NjQ1MDkxNDg3ODA1MDE5NTc0NTU2NDc2LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC43NzQ1OTY2NjkyNDE0ODMzNzcwMzU4NTMwNzk5NTY0Nzk5MjIxNjY1LFxuICAgICAgICAwLjc3NDU5NjY2OTI0MTQ4MzM3NzAzNTg1MzA3OTk1NjQ3OTkyMjE2NjUsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjMzOTk4MTA0MzU4NDg1NjI2NDgwMjY2NTc1OTEwMzI0NDY4NzIwMDUsXG4gICAgICAgIDAuMzM5OTgxMDQzNTg0ODU2MjY0ODAyNjY1NzU5MTAzMjQ0Njg3MjAwNSxcbiAgICAgICAgLTAuODYxMTM2MzExNTk0MDUyNTc1MjIzOTQ2NDg4ODkyODA5NTA1MDk1NyxcbiAgICAgICAgMC44NjExMzYzMTE1OTQwNTI1NzUyMjM5NDY0ODg4OTI4MDk1MDUwOTU3LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC41Mzg0NjkzMTAxMDU2ODMwOTEwMzYzMTQ0MjA3MDAyMDg4MDQ5NjcyLFxuICAgICAgICAwLjUzODQ2OTMxMDEwNTY4MzA5MTAzNjMxNDQyMDcwMDIwODgwNDk2NzIsXG4gICAgICAgIC0wLjkwNjE3OTg0NTkzODY2Mzk5Mjc5NzYyNjg3ODI5OTM5Mjk2NTEyNTYsXG4gICAgICAgIDAuOTA2MTc5ODQ1OTM4NjYzOTkyNzk3NjI2ODc4Mjk5MzkyOTY1MTI1NixcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMC42NjEyMDkzODY0NjYyNjQ1MTM2NjEzOTk1OTUwMTk5MDUzNDcwMDY0LFxuICAgICAgICAtMC42NjEyMDkzODY0NjYyNjQ1MTM2NjEzOTk1OTUwMTk5MDUzNDcwMDY0LFxuICAgICAgICAtMC4yMzg2MTkxODYwODMxOTY5MDg2MzA1MDE3MjE2ODA3MTE5MzU0MTg2LFxuICAgICAgICAwLjIzODYxOTE4NjA4MzE5NjkwODYzMDUwMTcyMTY4MDcxMTkzNTQxODYsXG4gICAgICAgIC0wLjkzMjQ2OTUxNDIwMzE1MjAyNzgxMjMwMTU1NDQ5Mzk5NDYwOTEzNDcsXG4gICAgICAgIDAuOTMyNDY5NTE0MjAzMTUyMDI3ODEyMzAxNTU0NDkzOTk0NjA5MTM0NyxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMCwgMC40MDU4NDUxNTEzNzczOTcxNjY5MDY2MDY0MTIwNzY5NjE0NjMzNDczLFxuICAgICAgICAtMC40MDU4NDUxNTEzNzczOTcxNjY5MDY2MDY0MTIwNzY5NjE0NjMzNDczLFxuICAgICAgICAtMC43NDE1MzExODU1OTkzOTQ0Mzk4NjM4NjQ3NzMyODA3ODg0MDcwNzQxLFxuICAgICAgICAwLjc0MTUzMTE4NTU5OTM5NDQzOTg2Mzg2NDc3MzI4MDc4ODQwNzA3NDEsXG4gICAgICAgIC0wLjk0OTEwNzkxMjM0Mjc1ODUyNDUyNjE4OTY4NDA0Nzg1MTI2MjQwMDcsXG4gICAgICAgIDAuOTQ5MTA3OTEyMzQyNzU4NTI0NTI2MTg5Njg0MDQ3ODUxMjYyNDAwNyxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgLTAuMTgzNDM0NjQyNDk1NjQ5ODA0OTM5NDc2MTQyMzYwMTgzOTgwNjY2NyxcbiAgICAgICAgMC4xODM0MzQ2NDI0OTU2NDk4MDQ5Mzk0NzYxNDIzNjAxODM5ODA2NjY3LFxuICAgICAgICAtMC41MjU1MzI0MDk5MTYzMjg5ODU4MTc3MzkwNDkxODkyNDYzNDkwNDE5LFxuICAgICAgICAwLjUyNTUzMjQwOTkxNjMyODk4NTgxNzczOTA0OTE4OTI0NjM0OTA0MTksXG4gICAgICAgIC0wLjc5NjY2NjQ3NzQxMzYyNjczOTU5MTU1MzkzNjQ3NTgzMDQzNjgzNzEsXG4gICAgICAgIDAuNzk2NjY2NDc3NDEzNjI2NzM5NTkxNTUzOTM2NDc1ODMwNDM2ODM3MSxcbiAgICAgICAgLTAuOTYwMjg5ODU2NDk3NTM2MjMxNjgzNTYwODY4NTY5NDcyOTkwNDI4MixcbiAgICAgICAgMC45NjAyODk4NTY0OTc1MzYyMzE2ODM1NjA4Njg1Njk0NzI5OTA0MjgyLFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC44MzYwMzExMDczMjY2MzU3OTQyOTk0Mjk3ODgwNjk3MzQ4NzY1NDQxLFxuICAgICAgICAwLjgzNjAzMTEwNzMyNjYzNTc5NDI5OTQyOTc4ODA2OTczNDg3NjU0NDEsXG4gICAgICAgIC0wLjk2ODE2MDIzOTUwNzYyNjA4OTgzNTU3NjIwMjkwMzY3Mjg3MDA0OTQsXG4gICAgICAgIDAuOTY4MTYwMjM5NTA3NjI2MDg5ODM1NTc2MjAyOTAzNjcyODcwMDQ5NCxcbiAgICAgICAgLTAuMzI0MjUzNDIzNDAzODA4OTI5MDM4NTM4MDE0NjQzMzM2NjA4NTcxOSxcbiAgICAgICAgMC4zMjQyNTM0MjM0MDM4MDg5MjkwMzg1MzgwMTQ2NDMzMzY2MDg1NzE5LFxuICAgICAgICAtMC42MTMzNzE0MzI3MDA1OTAzOTczMDg3MDIwMzkzNDE0NzQxODQ3ODU3LFxuICAgICAgICAwLjYxMzM3MTQzMjcwMDU5MDM5NzMwODcwMjAzOTM0MTQ3NDE4NDc4NTcsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjE0ODg3NDMzODk4MTYzMTIxMDg4NDgyNjAwMTEyOTcxOTk4NDYxNzUsXG4gICAgICAgIDAuMTQ4ODc0MzM4OTgxNjMxMjEwODg0ODI2MDAxMTI5NzE5OTg0NjE3NSxcbiAgICAgICAgLTAuNDMzMzk1Mzk0MTI5MjQ3MTkwNzk5MjY1OTQzMTY1Nzg0MTYyMixcbiAgICAgICAgMC40MzMzOTUzOTQxMjkyNDcxOTA3OTkyNjU5NDMxNjU3ODQxNjIyLFxuICAgICAgICAtMC42Nzk0MDk1NjgyOTkwMjQ0MDYyMzQzMjczNjUxMTQ4NzM1NzU3NjkyLFxuICAgICAgICAwLjY3OTQwOTU2ODI5OTAyNDQwNjIzNDMyNzM2NTExNDg3MzU3NTc2OTIsXG4gICAgICAgIC0wLjg2NTA2MzM2NjY4ODk4NDUxMDczMjA5NjY4ODQyMzQ5MzA0ODUyNzUsXG4gICAgICAgIDAuODY1MDYzMzY2Njg4OTg0NTEwNzMyMDk2Njg4NDIzNDkzMDQ4NTI3NSxcbiAgICAgICAgLTAuOTczOTA2NTI4NTE3MTcxNzIwMDc3OTY0MDEyMDg0NDUyMDUzNDI4MixcbiAgICAgICAgMC45NzM5MDY1Mjg1MTcxNzE3MjAwNzc5NjQwMTIwODQ0NTIwNTM0MjgyLFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC4yNjk1NDMxNTU5NTIzNDQ5NzIzMzE1MzE5ODU0MDA4NjE1MjQ2Nzk2LFxuICAgICAgICAwLjI2OTU0MzE1NTk1MjM0NDk3MjMzMTUzMTk4NTQwMDg2MTUyNDY3OTYsXG4gICAgICAgIC0wLjUxOTA5NjEyOTIwNjgxMTgxNTkyNTcyNTY2OTQ1ODYwOTU1NDQ4MDIsXG4gICAgICAgIDAuNTE5MDk2MTI5MjA2ODExODE1OTI1NzI1NjY5NDU4NjA5NTU0NDgwMixcbiAgICAgICAgLTAuNzMwMTUyMDA1NTc0MDQ5MzI0MDkzNDE2MjUyMDMxMTUzNDU4MDQ5NixcbiAgICAgICAgMC43MzAxNTIwMDU1NzQwNDkzMjQwOTM0MTYyNTIwMzExNTM0NTgwNDk2LFxuICAgICAgICAtMC44ODcwNjI1OTk3NjgwOTUyOTkwNzUxNTc3NjkzMDM5MjcyNjY2MzE2LFxuICAgICAgICAwLjg4NzA2MjU5OTc2ODA5NTI5OTA3NTE1Nzc2OTMwMzkyNzI2NjYzMTYsXG4gICAgICAgIC0wLjk3ODIyODY1ODE0NjA1Njk5MjgwMzkzODAwMTEyMjg1NzM5MDc3MTQsXG4gICAgICAgIDAuOTc4MjI4NjU4MTQ2MDU2OTkyODAzOTM4MDAxMTIyODU3MzkwNzcxNCxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgLTAuMTI1MjMzNDA4NTExNDY4OTE1NDcyNDQxMzY5NDYzODUzMTI5OTgzMyxcbiAgICAgICAgMC4xMjUyMzM0MDg1MTE0Njg5MTU0NzI0NDEzNjk0NjM4NTMxMjk5ODMzLFxuICAgICAgICAtMC4zNjc4MzE0OTg5OTgxODAxOTM3NTI2OTE1MzY2NDM3MTc1NjEyNTYzLFxuICAgICAgICAwLjM2NzgzMTQ5ODk5ODE4MDE5Mzc1MjY5MTUzNjY0MzcxNzU2MTI1NjMsXG4gICAgICAgIC0wLjU4NzMxNzk1NDI4NjYxNzQ0NzI5NjcwMjQxODk0MDUzNDI4MDM2OSxcbiAgICAgICAgMC41ODczMTc5NTQyODY2MTc0NDcyOTY3MDI0MTg5NDA1MzQyODAzNjksXG4gICAgICAgIC0wLjc2OTkwMjY3NDE5NDMwNDY4NzAzNjg5MzgzMzIxMjgxODA3NTk4NDksXG4gICAgICAgIDAuNzY5OTAyNjc0MTk0MzA0Njg3MDM2ODkzODMzMjEyODE4MDc1OTg0OSxcbiAgICAgICAgLTAuOTA0MTE3MjU2MzcwNDc0ODU2Njc4NDY1ODY2MTE5MDk2MTkyNTM3NSxcbiAgICAgICAgMC45MDQxMTcyNTYzNzA0NzQ4NTY2Nzg0NjU4NjYxMTkwOTYxOTI1Mzc1LFxuICAgICAgICAtMC45ODE1NjA2MzQyNDY3MTkyNTA2OTA1NDkwOTAxNDkyODA4MjI5NjAxLFxuICAgICAgICAwLjk4MTU2MDYzNDI0NjcxOTI1MDY5MDU0OTA5MDE0OTI4MDgyMjk2MDEsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAsIC0wLjIzMDQ1ODMxNTk1NTEzNDc5NDA2NTUyODEyMTA5Nzk4ODgzNTIxMTUsXG4gICAgICAgIDAuMjMwNDU4MzE1OTU1MTM0Nzk0MDY1NTI4MTIxMDk3OTg4ODM1MjExNSxcbiAgICAgICAgLTAuNDQ4NDkyNzUxMDM2NDQ2ODUyODc3OTEyODUyMTI3NjM5ODY3ODAxOSxcbiAgICAgICAgMC40NDg0OTI3NTEwMzY0NDY4NTI4Nzc5MTI4NTIxMjc2Mzk4Njc4MDE5LFxuICAgICAgICAtMC42NDIzNDkzMzk0NDAzNDAyMjA2NDM5ODQ2MDY5OTU1MTU2NTAwNzE2LFxuICAgICAgICAwLjY0MjM0OTMzOTQ0MDM0MDIyMDY0Mzk4NDYwNjk5NTUxNTY1MDA3MTYsXG4gICAgICAgIC0wLjgwMTU3ODA5MDczMzMwOTkxMjc5NDIwNjQ4OTU4Mjg1OTg5MDMwNTYsXG4gICAgICAgIDAuODAxNTc4MDkwNzMzMzA5OTEyNzk0MjA2NDg5NTgyODU5ODkwMzA1NixcbiAgICAgICAgLTAuOTE3NTk4Mzk5MjIyOTc3OTY1MjA2NTQ3ODM2NTAwNzE5NTEyMzkwNCxcbiAgICAgICAgMC45MTc1OTgzOTkyMjI5Nzc5NjUyMDY1NDc4MzY1MDA3MTk1MTIzOTA0LFxuICAgICAgICAtMC45ODQxODMwNTQ3MTg1ODgxNDk0NzI4Mjk0NDg4MDcxMDk2MTEwNjQ5LFxuICAgICAgICAwLjk4NDE4MzA1NDcxODU4ODE0OTQ3MjgyOTQ0ODgwNzEwOTYxMTA2NDksXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjEwODA1NDk0ODcwNzM0MzY2MjA2NjI0NDY1MDIxOTgzNDc0NzYxMTksXG4gICAgICAgIDAuMTA4MDU0OTQ4NzA3MzQzNjYyMDY2MjQ0NjUwMjE5ODM0NzQ3NjExOSxcbiAgICAgICAgLTAuMzE5MTEyMzY4OTI3ODg5NzYwNDM1NjcxODI0MTY4NDc1NDY2ODM0MixcbiAgICAgICAgMC4zMTkxMTIzNjg5Mjc4ODk3NjA0MzU2NzE4MjQxNjg0NzU0NjY4MzQyLFxuICAgICAgICAtMC41MTUyNDg2MzYzNTgxNTQwOTE5NjUyOTA3MTg1NTExODg2NjIzMDg4LFxuICAgICAgICAwLjUxNTI0ODYzNjM1ODE1NDA5MTk2NTI5MDcxODU1MTE4ODY2MjMwODgsXG4gICAgICAgIC0wLjY4NzI5MjkwNDgxMTY4NTQ3MDE0ODAxOTgwMzAxOTMzNDEzNzUzODQsXG4gICAgICAgIDAuNjg3MjkyOTA0ODExNjg1NDcwMTQ4MDE5ODAzMDE5MzM0MTM3NTM4NCxcbiAgICAgICAgLTAuODI3MjAxMzE1MDY5NzY0OTkzMTg5Nzk0NzQyNjUwMzk0OTYxMDM5NyxcbiAgICAgICAgMC44MjcyMDEzMTUwNjk3NjQ5OTMxODk3OTQ3NDI2NTAzOTQ5NjEwMzk3LFxuICAgICAgICAtMC45Mjg0MzQ4ODM2NjM1NzM1MTczMzYzOTExMzkzNzc4NzQyNjQ0NzcsXG4gICAgICAgIDAuOTI4NDM0ODgzNjYzNTczNTE3MzM2MzkxMTM5Mzc3ODc0MjY0NDc3LFxuICAgICAgICAtMC45ODYyODM4MDg2OTY4MTIzMzg4NDE1OTcyNjY3MDQwNTI4MDE2NzYsXG4gICAgICAgIDAuOTg2MjgzODA4Njk2ODEyMzM4ODQxNTk3MjY2NzA0MDUyODAxNjc2LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC4yMDExOTQwOTM5OTc0MzQ1MjIzMDA2MjgzMDMzOTQ1OTYyMDc4MTI4LFxuICAgICAgICAwLjIwMTE5NDA5Mzk5NzQzNDUyMjMwMDYyODMwMzM5NDU5NjIwNzgxMjgsXG4gICAgICAgIC0wLjM5NDE1MTM0NzA3NzU2MzM2OTg5NzIwNzM3MDk4MTA0NTQ2ODM2MjcsXG4gICAgICAgIDAuMzk0MTUxMzQ3MDc3NTYzMzY5ODk3MjA3MzcwOTgxMDQ1NDY4MzYyNyxcbiAgICAgICAgLTAuNTcwOTcyMTcyNjA4NTM4ODQ3NTM3MjI2NzM3MjUzOTEwNjQxMjM4MyxcbiAgICAgICAgMC41NzA5NzIxNzI2MDg1Mzg4NDc1MzcyMjY3MzcyNTM5MTA2NDEyMzgzLFxuICAgICAgICAtMC43MjQ0MTc3MzEzNjAxNzAwNDc0MTYxODYwNTQ2MTM5MzgwMDk2MzA4LFxuICAgICAgICAwLjcyNDQxNzczMTM2MDE3MDA0NzQxNjE4NjA1NDYxMzkzODAwOTYzMDgsXG4gICAgICAgIC0wLjg0ODIwNjU4MzQxMDQyNzIxNjIwMDY0ODMyMDc3NDIxNjg1MTM2NjIsXG4gICAgICAgIDAuODQ4MjA2NTgzNDEwNDI3MjE2MjAwNjQ4MzIwNzc0MjE2ODUxMzY2MixcbiAgICAgICAgLTAuOTM3MjczMzkyNDAwNzA1OTA0MzA3NzU4OTQ3NzEwMjA5NDcxMjQzOSxcbiAgICAgICAgMC45MzcyNzMzOTI0MDA3MDU5MDQzMDc3NTg5NDc3MTAyMDk0NzEyNDM5LFxuICAgICAgICAtMC45ODc5OTI1MTgwMjA0ODU0Mjg0ODk1NjU3MTg1ODY2MTI1ODExNDY5LFxuICAgICAgICAwLjk4Nzk5MjUxODAyMDQ4NTQyODQ4OTU2NTcxODU4NjYxMjU4MTE0NjksXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjA5NTAxMjUwOTgzNzYzNzQ0MDE4NTMxOTMzNTQyNDk1ODA2MzEzMDMsXG4gICAgICAgIDAuMDk1MDEyNTA5ODM3NjM3NDQwMTg1MzE5MzM1NDI0OTU4MDYzMTMwMyxcbiAgICAgICAgLTAuMjgxNjAzNTUwNzc5MjU4OTEzMjMwNDYwNTAxNDYwNDk2MTA2NDg2LFxuICAgICAgICAwLjI4MTYwMzU1MDc3OTI1ODkxMzIzMDQ2MDUwMTQ2MDQ5NjEwNjQ4NixcbiAgICAgICAgLTAuNDU4MDE2Nzc3NjU3MjI3Mzg2MzQyNDE5NDQyOTgzNTc3NTczNTQsXG4gICAgICAgIDAuNDU4MDE2Nzc3NjU3MjI3Mzg2MzQyNDE5NDQyOTgzNTc3NTczNTQsXG4gICAgICAgIC0wLjYxNzg3NjI0NDQwMjY0Mzc0ODQ0NjY3MTc2NDA0ODc5MTAxODk5MTgsXG4gICAgICAgIDAuNjE3ODc2MjQ0NDAyNjQzNzQ4NDQ2NjcxNzY0MDQ4NzkxMDE4OTkxOCxcbiAgICAgICAgLTAuNzU1NDA0NDA4MzU1MDAzMDMzODk1MTAxMTk0ODQ3NDQyMjY4MzUzOCxcbiAgICAgICAgMC43NTU0MDQ0MDgzNTUwMDMwMzM4OTUxMDExOTQ4NDc0NDIyNjgzNTM4LFxuICAgICAgICAtMC44NjU2MzEyMDIzODc4MzE3NDM4ODA0Njc4OTc3MTIzOTMxMzIzODczLFxuICAgICAgICAwLjg2NTYzMTIwMjM4NzgzMTc0Mzg4MDQ2Nzg5NzcxMjM5MzEzMjM4NzMsXG4gICAgICAgIC0wLjk0NDU3NTAyMzA3MzIzMjU3NjA3Nzk4ODQxNTUzNDYwODM0NTA5MTEsXG4gICAgICAgIDAuOTQ0NTc1MDIzMDczMjMyNTc2MDc3OTg4NDE1NTM0NjA4MzQ1MDkxMSxcbiAgICAgICAgLTAuOTg5NDAwOTM0OTkxNjQ5OTMyNTk2MTU0MTczNDUwMzMyNjI3NDI2MixcbiAgICAgICAgMC45ODk0MDA5MzQ5OTE2NDk5MzI1OTYxNTQxNzM0NTAzMzI2Mjc0MjYyLFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC4xNzg0ODQxODE0OTU4NDc4NTU4NTA2Nzc0OTM2NTQwNjU1NTc0NzU0LFxuICAgICAgICAwLjE3ODQ4NDE4MTQ5NTg0Nzg1NTg1MDY3NzQ5MzY1NDA2NTU1NzQ3NTQsXG4gICAgICAgIC0wLjM1MTIzMTc2MzQ1Mzg3NjMxNTI5NzE4NTUxNzA5NTM0NjAwNTA0MDUsXG4gICAgICAgIDAuMzUxMjMxNzYzNDUzODc2MzE1Mjk3MTg1NTE3MDk1MzQ2MDA1MDQwNSxcbiAgICAgICAgLTAuNTEyNjkwNTM3MDg2NDc2OTY3ODg2MjQ2NTY4NjI5NTUxODc0NTgyOSxcbiAgICAgICAgMC41MTI2OTA1MzcwODY0NzY5Njc4ODYyNDY1Njg2Mjk1NTE4NzQ1ODI5LFxuICAgICAgICAtMC42NTc2NzExNTkyMTY2OTA3NjU4NTAzMDIyMTY2NDMwMDIzMzUxNDc4LFxuICAgICAgICAwLjY1NzY3MTE1OTIxNjY5MDc2NTg1MDMwMjIxNjY0MzAwMjMzNTE0NzgsXG4gICAgICAgIC0wLjc4MTUxNDAwMzg5NjgwMTQwNjkyNTIzMDA1NTUyMDQ3NjA1MDIyMzksXG4gICAgICAgIDAuNzgxNTE0MDAzODk2ODAxNDA2OTI1MjMwMDU1NTIwNDc2MDUwMjIzOSxcbiAgICAgICAgLTAuODgwMjM5MTUzNzI2OTg1OTAyMTIyOTU1Njk0NDg4MTU1NjkyNjIzNCxcbiAgICAgICAgMC44ODAyMzkxNTM3MjY5ODU5MDIxMjI5NTU2OTQ0ODgxNTU2OTI2MjM0LFxuICAgICAgICAtMC45NTA2NzU1MjE3Njg3Njc3NjEyMjI3MTY5NTc4OTU4MDMwMjE0NDMzLFxuICAgICAgICAwLjk1MDY3NTUyMTc2ODc2Nzc2MTIyMjcxNjk1Nzg5NTgwMzAyMTQ0MzMsXG4gICAgICAgIC0wLjk5MDU3NTQ3NTMxNDQxNzMzNTY3NTQzNDAxOTk0MDY2NTI3NjUwNzcsXG4gICAgICAgIDAuOTkwNTc1NDc1MzE0NDE3MzM1Njc1NDM0MDE5OTQwNjY1Mjc2NTA3NyxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgLTAuMDg0Nzc1MDEzMDQxNzM1MzAxMjQyMjYxODUyOTM1NzgzODExNzMzMyxcbiAgICAgICAgMC4wODQ3NzUwMTMwNDE3MzUzMDEyNDIyNjE4NTI5MzU3ODM4MTE3MzMzLFxuICAgICAgICAtMC4yNTE4ODYyMjU2OTE1MDU1MDk1ODg5NzI4NTQ4Nzc5MTEyMzAxNjI4LFxuICAgICAgICAwLjI1MTg4NjIyNTY5MTUwNTUwOTU4ODk3Mjg1NDg3NzkxMTIzMDE2MjgsXG4gICAgICAgIC0wLjQxMTc1MTE2MTQ2Mjg0MjY0NjAzNTkzMTc5MzgzMzA1MTYzNzA3ODksXG4gICAgICAgIDAuNDExNzUxMTYxNDYyODQyNjQ2MDM1OTMxNzkzODMzMDUxNjM3MDc4OSxcbiAgICAgICAgLTAuNTU5NzcwODMxMDczOTQ3NTM0NjA3ODcxNTQ4NTI1MzI5MTM2OTI3NixcbiAgICAgICAgMC41NTk3NzA4MzEwNzM5NDc1MzQ2MDc4NzE1NDg1MjUzMjkxMzY5Mjc2LFxuICAgICAgICAtMC42OTE2ODcwNDMwNjAzNTMyMDc4NzQ4OTEwODEyODg4NDgzODk0NTIyLFxuICAgICAgICAwLjY5MTY4NzA0MzA2MDM1MzIwNzg3NDg5MTA4MTI4ODg0ODM4OTQ1MjIsXG4gICAgICAgIC0wLjgwMzcwNDk1ODk3MjUyMzExNTY4MjQxNzQ1NTAxNDU5MDc5NzEwMzIsXG4gICAgICAgIDAuODAzNzA0OTU4OTcyNTIzMTE1NjgyNDE3NDU1MDE0NTkwNzk3MTAzMixcbiAgICAgICAgLTAuODkyNjAyNDY2NDk3NTU1NzM5MjA2MDYwNTkxMTI3MTQ1NTE1NDA3OCxcbiAgICAgICAgMC44OTI2MDI0NjY0OTc1NTU3MzkyMDYwNjA1OTExMjcxNDU1MTU0MDc4LFxuICAgICAgICAtMC45NTU4MjM5NDk1NzEzOTc3NTUxODExOTU4OTI5Mjk3NzYzMDk5NzI4LFxuICAgICAgICAwLjk1NTgyMzk0OTU3MTM5Nzc1NTE4MTE5NTg5MjkyOTc3NjMwOTk3MjgsXG4gICAgICAgIC0wLjk5MTU2NTE2ODQyMDkzMDk0NjczMDAxNjAwNDcwNjE1MDc3MDI1MjUsXG4gICAgICAgIDAuOTkxNTY1MTY4NDIwOTMwOTQ2NzMwMDE2MDA0NzA2MTUwNzcwMjUyNSxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMCwgLTAuMTYwMzU4NjQ1NjQwMjI1Mzc1ODY4MDk2MTE1NzQwNzQzNTQ5NTA0OCxcbiAgICAgICAgMC4xNjAzNTg2NDU2NDAyMjUzNzU4NjgwOTYxMTU3NDA3NDM1NDk1MDQ4LFxuICAgICAgICAtMC4zMTY1NjQwOTk5NjM2Mjk4MzE5OTAxMTczMjg4NDk4NDQ5MTc4OTIyLFxuICAgICAgICAwLjMxNjU2NDA5OTk2MzYyOTgzMTk5MDExNzMyODg0OTg0NDkxNzg5MjIsXG4gICAgICAgIC0wLjQ2NDU3MDc0MTM3NTk2MDk0NTcxNzI2NzE0ODEwNDEwMjM2Nzk3NjIsXG4gICAgICAgIDAuNDY0NTcwNzQxMzc1OTYwOTQ1NzE3MjY3MTQ4MTA0MTAyMzY3OTc2MixcbiAgICAgICAgLTAuNjAwNTQ1MzA0NjYxNjgxMDIzNDY5NjM4MTY0OTQ2MjM5Mjc5ODY4MyxcbiAgICAgICAgMC42MDA1NDUzMDQ2NjE2ODEwMjM0Njk2MzgxNjQ5NDYyMzkyNzk4NjgzLFxuICAgICAgICAtMC43MjA5NjYxNzczMzUyMjkzNzg2MTcwOTU4NjA4MjM3ODE2Mjk2NTcxLFxuICAgICAgICAwLjcyMDk2NjE3NzMzNTIyOTM3ODYxNzA5NTg2MDgyMzc4MTYyOTY1NzEsXG4gICAgICAgIC0wLjgyMjcxNDY1NjUzNzE0MjgyNDk3ODkyMjQ4NjcxMjcxMzkwMTc3NDUsXG4gICAgICAgIDAuODIyNzE0NjU2NTM3MTQyODI0OTc4OTIyNDg2NzEyNzEzOTAxNzc0NSxcbiAgICAgICAgLTAuOTAzMTU1OTAzNjE0ODE3OTAxNjQyNjYwOTI4NTMyMzEyNDg3ODA5MyxcbiAgICAgICAgMC45MDMxNTU5MDM2MTQ4MTc5MDE2NDI2NjA5Mjg1MzIzMTI0ODc4MDkzLFxuICAgICAgICAtMC45NjAyMDgxNTIxMzQ4MzAwMzA4NTI3Nzg4NDA2ODc2NTE1MjY2MTUsXG4gICAgICAgIDAuOTYwMjA4MTUyMTM0ODMwMDMwODUyNzc4ODQwNjg3NjUxNTI2NjE1LFxuICAgICAgICAtMC45OTI0MDY4NDM4NDM1ODQ0MDMxODkwMTc2NzAyNTMyNjA0OTM1ODkzLFxuICAgICAgICAwLjk5MjQwNjg0Mzg0MzU4NDQwMzE4OTAxNzY3MDI1MzI2MDQ5MzU4OTMsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjA3NjUyNjUyMTEzMzQ5NzMzMzc1NDY0MDQwOTM5ODgzODIxMTAwNDcsXG4gICAgICAgIDAuMDc2NTI2NTIxMTMzNDk3MzMzNzU0NjQwNDA5Mzk4ODM4MjExMDA0NyxcbiAgICAgICAgLTAuMjI3Nzg1ODUxMTQxNjQ1MDc4MDgwNDk2MTk1MzY4NTc0NjI0NzQzLFxuICAgICAgICAwLjIyNzc4NTg1MTE0MTY0NTA3ODA4MDQ5NjE5NTM2ODU3NDYyNDc0MyxcbiAgICAgICAgLTAuMzczNzA2MDg4NzE1NDE5NTYwNjcyNTQ4MTc3MDI0OTI3MjM3Mzk1NyxcbiAgICAgICAgMC4zNzM3MDYwODg3MTU0MTk1NjA2NzI1NDgxNzcwMjQ5MjcyMzczOTU3LFxuICAgICAgICAtMC41MTA4NjcwMDE5NTA4MjcwOTgwMDQzNjQwNTA5NTUyNTA5OTg0MjU0LFxuICAgICAgICAwLjUxMDg2NzAwMTk1MDgyNzA5ODAwNDM2NDA1MDk1NTI1MDk5ODQyNTQsXG4gICAgICAgIC0wLjYzNjA1MzY4MDcyNjUxNTAyNTQ1MjgzNjY5NjIyNjI4NTkzNjc0MzMsXG4gICAgICAgIDAuNjM2MDUzNjgwNzI2NTE1MDI1NDUyODM2Njk2MjI2Mjg1OTM2NzQzMyxcbiAgICAgICAgLTAuNzQ2MzMxOTA2NDYwMTUwNzkyNjE0MzA1MDcwMzU1NjQxNTkwMzEwNyxcbiAgICAgICAgMC43NDYzMzE5MDY0NjAxNTA3OTI2MTQzMDUwNzAzNTU2NDE1OTAzMTA3LFxuICAgICAgICAtMC44MzkxMTY5NzE4MjIyMTg4MjMzOTQ1MjkwNjE3MDE1MjA2ODUzMjk2LFxuICAgICAgICAwLjgzOTExNjk3MTgyMjIxODgyMzM5NDUyOTA2MTcwMTUyMDY4NTMyOTYsXG4gICAgICAgIC0wLjkxMjIzNDQyODI1MTMyNTkwNTg2Nzc1MjQ0MTIwMzI5ODExMzA0OTEsXG4gICAgICAgIDAuOTEyMjM0NDI4MjUxMzI1OTA1ODY3NzUyNDQxMjAzMjk4MTEzMDQ5MSxcbiAgICAgICAgLTAuOTYzOTcxOTI3Mjc3OTEzNzkxMjY3NjY2MTMxMTk3Mjc3MjIxOTEyLFxuICAgICAgICAwLjk2Mzk3MTkyNzI3NzkxMzc5MTI2NzY2NjEzMTE5NzI3NzIyMTkxMixcbiAgICAgICAgLTAuOTkzMTI4NTk5MTg1MDk0OTI0Nzg2MTIyMzg4NDcxMzIwMjc4MjIyNixcbiAgICAgICAgMC45OTMxMjg1OTkxODUwOTQ5MjQ3ODYxMjIzODg0NzEzMjAyNzgyMjI2LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLCAtMC4xNDU1NjE4NTQxNjA4OTUwOTA5MzcwMzA5ODIzMzg2ODYzMzAxMTYzLFxuICAgICAgICAwLjE0NTU2MTg1NDE2MDg5NTA5MDkzNzAzMDk4MjMzODY4NjMzMDExNjMsXG4gICAgICAgIC0wLjI4ODAyMTMxNjgwMjQwMTA5NjYwMDc5MjUxNjA2NDYwMDMxOTkwOSxcbiAgICAgICAgMC4yODgwMjEzMTY4MDI0MDEwOTY2MDA3OTI1MTYwNjQ2MDAzMTk5MDksXG4gICAgICAgIC0wLjQyNDM0MjEyMDIwNzQzODc4MzU3MzY2ODg4ODU0Mzc4ODA1MjA5NjQsXG4gICAgICAgIDAuNDI0MzQyMTIwMjA3NDM4NzgzNTczNjY4ODg4NTQzNzg4MDUyMDk2NCxcbiAgICAgICAgLTAuNTUxNjE4ODM1ODg3MjE5ODA3MDU5MDE4Nzk2NzI0MzEzMjg2NjIyLFxuICAgICAgICAwLjU1MTYxODgzNTg4NzIxOTgwNzA1OTAxODc5NjcyNDMxMzI4NjYyMixcbiAgICAgICAgLTAuNjY3MTM4ODA0MTk3NDEyMzE5MzA1OTY2NjY5OTkwMzM5MTYyNTk3LFxuICAgICAgICAwLjY2NzEzODgwNDE5NzQxMjMxOTMwNTk2NjY2OTk5MDMzOTE2MjU5NyxcbiAgICAgICAgLTAuNzY4NDM5OTYzNDc1Njc3OTA4NjE1ODc3ODUxMzA2MjI4MDM0ODIwOSxcbiAgICAgICAgMC43Njg0Mzk5NjM0NzU2Nzc5MDg2MTU4Nzc4NTEzMDYyMjgwMzQ4MjA5LFxuICAgICAgICAtMC44NTMzNjMzNjQ1ODMzMTcyODM2NDcyNTA2Mzg1ODc1Njc2NzAyNzYxLFxuICAgICAgICAwLjg1MzM2MzM2NDU4MzMxNzI4MzY0NzI1MDYzODU4NzU2NzY3MDI3NjEsXG4gICAgICAgIC0wLjkyMDA5OTMzNDE1MDQwMDgyODc5MDE4NzEzMzcxNDk2ODg5NDE1OTEsXG4gICAgICAgIDAuOTIwMDk5MzM0MTUwNDAwODI4NzkwMTg3MTMzNzE0OTY4ODk0MTU5MSxcbiAgICAgICAgLTAuOTY3MjI2ODM4NTY2MzA2Mjk0MzE2NjIyMjE0OTA3Njk1MTYxNDI0NixcbiAgICAgICAgMC45NjcyMjY4Mzg1NjYzMDYyOTQzMTY2MjIyMTQ5MDc2OTUxNjE0MjQ2LFxuICAgICAgICAtMC45OTM3NTIxNzA2MjAzODk1MDAyNjAyNDIwMzU5Mzc5NDA5MjkxOTMzLFxuICAgICAgICAwLjk5Mzc1MjE3MDYyMDM4OTUwMDI2MDI0MjAzNTkzNzk0MDkyOTE5MzMsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIC0wLjA2OTczOTI3MzMxOTcyMjIyMTIxMzg0MTc5NjExODYyODA4MTgyMjIsXG4gICAgICAgIDAuMDY5NzM5MjczMzE5NzIyMjIxMjEzODQxNzk2MTE4NjI4MDgxODIyMixcbiAgICAgICAgLTAuMjA3ODYwNDI2Njg4MjIxMjg1NDc4ODQ2NTMzOTE5NTQ1NzM0MjE1NixcbiAgICAgICAgMC4yMDc4NjA0MjY2ODgyMjEyODU0Nzg4NDY1MzM5MTk1NDU3MzQyMTU2LFxuICAgICAgICAtMC4zNDE5MzU4MjA4OTIwODQyMjUxNTgxNDc0MjA0MjczNzk2MTk1NTkxLFxuICAgICAgICAwLjM0MTkzNTgyMDg5MjA4NDIyNTE1ODE0NzQyMDQyNzM3OTYxOTU1OTEsXG4gICAgICAgIC0wLjQ2OTM1NTgzNzk4Njc1NzAyNjQwNjMzMDcxMDk2NjQwNjM0NjA5NTMsXG4gICAgICAgIDAuNDY5MzU1ODM3OTg2NzU3MDI2NDA2MzMwNzEwOTY2NDA2MzQ2MDk1MyxcbiAgICAgICAgLTAuNTg3NjQwNDAzNTA2OTExNTkyOTU4ODc2OTI3NjM4NjQ3MzQ4ODc3NixcbiAgICAgICAgMC41ODc2NDA0MDM1MDY5MTE1OTI5NTg4NzY5Mjc2Mzg2NDczNDg4Nzc2LFxuICAgICAgICAtMC42OTQ0ODcyNjMxODY2ODI3ODAwNTA2ODk4MzU3NjIyNTY3NzEyNjczLFxuICAgICAgICAwLjY5NDQ4NzI2MzE4NjY4Mjc4MDA1MDY4OTgzNTc2MjI1Njc3MTI2NzMsXG4gICAgICAgIC0wLjc4NzgxNjgwNTk3OTIwODE2MjAwNDI3Nzk1NTQwODM1MTUyMTM4ODEsXG4gICAgICAgIDAuNzg3ODE2ODA1OTc5MjA4MTYyMDA0Mjc3OTU1NDA4MzUxNTIxMzg4MSxcbiAgICAgICAgLTAuODY1ODEyNTc3NzIwMzAwMTM2NTM2NDI1NjM3MDE5Mzc4NzI5MDg0NyxcbiAgICAgICAgMC44NjU4MTI1Nzc3MjAzMDAxMzY1MzY0MjU2MzcwMTkzNzg3MjkwODQ3LFxuICAgICAgICAtMC45MjY5NTY3NzIxODcxNzQwMDA1MjA2OTI5MzkyNTkwNTMxOTY2MzUzLFxuICAgICAgICAwLjkyNjk1Njc3MjE4NzE3NDAwMDUyMDY5MjkzOTI1OTA1MzE5NjYzNTMsXG4gICAgICAgIC0wLjk3MDA2MDQ5NzgzNTQyODcyNzEyMzk1MDk4Njc2NTI2ODcxMDgwNTksXG4gICAgICAgIDAuOTcwMDYwNDk3ODM1NDI4NzI3MTIzOTUwOTg2NzY1MjY4NzEwODA1OSxcbiAgICAgICAgLTAuOTk0Mjk0NTg1NDgyMzk5MjkyMDczMDMxNDIxMTYxMjk4OTgwMzkzLFxuICAgICAgICAwLjk5NDI5NDU4NTQ4MjM5OTI5MjA3MzAzMTQyMTE2MTI5ODk4MDM5MyxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMCwgLTAuMTMzMjU2ODI0Mjk4NDY2MTEwOTMxNzQyNjgyMjQxNzY2MTM3MDEwNCxcbiAgICAgICAgMC4xMzMyNTY4MjQyOTg0NjYxMTA5MzE3NDI2ODIyNDE3NjYxMzcwMTA0LFxuICAgICAgICAtMC4yNjQxMzU2ODA5NzAzNDQ5MzA1MzM4Njk1MzgyODMzMDk2MDI5NzksXG4gICAgICAgIDAuMjY0MTM1NjgwOTcwMzQ0OTMwNTMzODY5NTM4MjgzMzA5NjAyOTc5LFxuICAgICAgICAtMC4zOTAzMDEwMzgwMzAyOTA4MzE0MjE0ODg4NzI4ODA2MDU0NTg1NzgsXG4gICAgICAgIDAuMzkwMzAxMDM4MDMwMjkwODMxNDIxNDg4ODcyODgwNjA1NDU4NTc4LFxuICAgICAgICAtMC41MDk1MDE0Nzc4NDYwMDc1NDk2ODk3OTMwNDc4NjY4NDY0MzA1NDQ4LFxuICAgICAgICAwLjUwOTUwMTQ3Nzg0NjAwNzU0OTY4OTc5MzA0Nzg2Njg0NjQzMDU0NDgsXG4gICAgICAgIC0wLjYxOTYwOTg3NTc2MzY0NjE1NjM4NTA5NzMxMTY0OTU5NTY1MzM4NzEsXG4gICAgICAgIDAuNjE5NjA5ODc1NzYzNjQ2MTU2Mzg1MDk3MzExNjQ5NTk1NjUzMzg3MSxcbiAgICAgICAgLTAuNzE4NjYxMzYzMTMxOTUwMTk0NDYxNjI0NDgzNzQ4NjE4ODQ4MzI5OSxcbiAgICAgICAgMC43MTg2NjEzNjMxMzE5NTAxOTQ0NjE2MjQ0ODM3NDg2MTg4NDgzMjk5LFxuICAgICAgICAtMC44MDQ4ODg0MDE2MTg4Mzk4OTIxNTExMTg0MDY5OTY3Nzg1NTc5NDE0LFxuICAgICAgICAwLjgwNDg4ODQwMTYxODgzOTg5MjE1MTExODQwNjk5Njc3ODU1Nzk0MTQsXG4gICAgICAgIC0wLjg3Njc1MjM1ODI3MDQ0MTY2NzM3ODE1Njg4NTkzNDE0NTY3MTYzODksXG4gICAgICAgIDAuODc2NzUyMzU4MjcwNDQxNjY3Mzc4MTU2ODg1OTM0MTQ1NjcxNjM4OSxcbiAgICAgICAgLTAuOTMyOTcxMDg2ODI2MDE2MTAyMzQ5MTk2OTg5MDM4NDIyOTc4MjM1NyxcbiAgICAgICAgMC45MzI5NzEwODY4MjYwMTYxMDIzNDkxOTY5ODkwMzg0MjI5NzgyMzU3LFxuICAgICAgICAtMC45NzI1NDI0NzEyMTgxMTUyMzE5NTYwMjQwNzY4MjA3NzczNzUxODE2LFxuICAgICAgICAwLjk3MjU0MjQ3MTIxODExNTIzMTk1NjAyNDA3NjgyMDc3NzM3NTE4MTYsXG4gICAgICAgIC0wLjk5NDc2OTMzNDk5NzU1MjEyMzUyMzkyNTcxNTQ0NTU3NDM2MDU3MzYsXG4gICAgICAgIDAuOTk0NzY5MzM0OTk3NTUyMTIzNTIzOTI1NzE1NDQ1NTc0MzYwNTczNixcbiAgICBdLFxuICAgIFtcbiAgICAgICAgLTAuMDY0MDU2ODkyODYyNjA1NjI2MDg1MDQzMDgyNjI0NzQ1MDM4NTkwOSxcbiAgICAgICAgMC4wNjQwNTY4OTI4NjI2MDU2MjYwODUwNDMwODI2MjQ3NDUwMzg1OTA5LFxuICAgICAgICAtMC4xOTExMTg4Njc0NzM2MTYzMDkxNTg2Mzk4MjA3NTcwNjk2MzE4NDA0LFxuICAgICAgICAwLjE5MTExODg2NzQ3MzYxNjMwOTE1ODYzOTgyMDc1NzA2OTYzMTg0MDQsXG4gICAgICAgIC0wLjMxNTA0MjY3OTY5NjE2MzM3NDM4Njc5MzI5MTMxOTgxMDI0MDc4NjQsXG4gICAgICAgIDAuMzE1MDQyNjc5Njk2MTYzMzc0Mzg2NzkzMjkxMzE5ODEwMjQwNzg2NCxcbiAgICAgICAgLTAuNDMzNzkzNTA3NjI2MDQ1MTM4NDg3MDg0MjMxOTEzMzQ5NzEyNDUyNCxcbiAgICAgICAgMC40MzM3OTM1MDc2MjYwNDUxMzg0ODcwODQyMzE5MTMzNDk3MTI0NTI0LFxuICAgICAgICAtMC41NDU0MjE0NzEzODg4Mzk1MzU2NTgzNzU2MTcyMTgzNzIzNzAwMTA3LFxuICAgICAgICAwLjU0NTQyMTQ3MTM4ODgzOTUzNTY1ODM3NTYxNzIxODM3MjM3MDAxMDcsXG4gICAgICAgIC0wLjY0ODA5MzY1MTkzNjk3NTU2OTI1MjQ5NTc4NjkxMDc0NzYyNjY2OTYsXG4gICAgICAgIDAuNjQ4MDkzNjUxOTM2OTc1NTY5MjUyNDk1Nzg2OTEwNzQ3NjI2NjY5NixcbiAgICAgICAgLTAuNzQwMTI0MTkxNTc4NTU0MzY0MjQzODI4MTAzMDk5OTc4NDI1NTIzMixcbiAgICAgICAgMC43NDAxMjQxOTE1Nzg1NTQzNjQyNDM4MjgxMDMwOTk5Nzg0MjU1MjMyLFxuICAgICAgICAtMC44MjAwMDE5ODU5NzM5MDI5MjE5NTM5NDk4NzI2Njk3NDUyMDgwNzYxLFxuICAgICAgICAwLjgyMDAwMTk4NTk3MzkwMjkyMTk1Mzk0OTg3MjY2OTc0NTIwODA3NjEsXG4gICAgICAgIC0wLjg4NjQxNTUyNzAwNDQwMTAzNDIxMzE1NDM0MTk4MjE5Njc1NTA4NzMsXG4gICAgICAgIDAuODg2NDE1NTI3MDA0NDAxMDM0MjEzMTU0MzQxOTgyMTk2NzU1MDg3MyxcbiAgICAgICAgLTAuOTM4Mjc0NTUyMDAyNzMyNzU4NTIzNjQ5MDAxNzA4NzIxNDQ5NjU0OCxcbiAgICAgICAgMC45MzgyNzQ1NTIwMDI3MzI3NTg1MjM2NDkwMDE3MDg3MjE0NDk2NTQ4LFxuICAgICAgICAtMC45NzQ3Mjg1NTU5NzEzMDk0OTgxOTgzOTE5OTMwMDgxNjkwNjE3NDExLFxuICAgICAgICAwLjk3NDcyODU1NTk3MTMwOTQ5ODE5ODM5MTk5MzAwODE2OTA2MTc0MTEsXG4gICAgICAgIC0wLjk5NTE4NzIxOTk5NzAyMTM2MDE3OTk5NzQwOTcwMDczNjgxMTg3NDUsXG4gICAgICAgIDAuOTk1MTg3MjE5OTk3MDIxMzYwMTc5OTk3NDA5NzAwNzM2ODExODc0NSxcbiAgICBdLFxuXTtcbmV4cG9ydCBjb25zdCBjVmFsdWVzID0gW1xuICAgIFtdLFxuICAgIFtdLFxuICAgIFsxLjAsIDEuMF0sXG4gICAgW1xuICAgICAgICAwLjg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODgsXG4gICAgICAgIDAuNTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NSxcbiAgICAgICAgMC41NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjY1MjE0NTE1NDg2MjU0NjE0MjYyNjkzNjA1MDc3ODAwMDU5Mjc2NDYsXG4gICAgICAgIDAuNjUyMTQ1MTU0ODYyNTQ2MTQyNjI2OTM2MDUwNzc4MDAwNTkyNzY0NixcbiAgICAgICAgMC4zNDc4NTQ4NDUxMzc0NTM4NTczNzMwNjM5NDkyMjE5OTk0MDcyMzUzLFxuICAgICAgICAwLjM0Nzg1NDg0NTEzNzQ1Mzg1NzM3MzA2Mzk0OTIyMTk5OTQwNzIzNTMsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuNTY4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4OCxcbiAgICAgICAgMC40Nzg2Mjg2NzA0OTkzNjY0NjgwNDEyOTE1MTQ4MzU2MzgxOTI5MTIyLFxuICAgICAgICAwLjQ3ODYyODY3MDQ5OTM2NjQ2ODA0MTI5MTUxNDgzNTYzODE5MjkxMjIsXG4gICAgICAgIDAuMjM2OTI2ODg1MDU2MTg5MDg3NTE0MjY0MDQwNzE5OTE3MzYyNjQzMixcbiAgICAgICAgMC4yMzY5MjY4ODUwNTYxODkwODc1MTQyNjQwNDA3MTk5MTczNjI2NDMyLFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjM2MDc2MTU3MzA0ODEzODYwNzU2OTgzMzUxMzgzNzcxNjExMTY2MTUsXG4gICAgICAgIDAuMzYwNzYxNTczMDQ4MTM4NjA3NTY5ODMzNTEzODM3NzE2MTExNjYxNSxcbiAgICAgICAgMC40Njc5MTM5MzQ1NzI2OTEwNDczODk4NzAzNDM5ODk1NTA5OTQ4MTE2LFxuICAgICAgICAwLjQ2NzkxMzkzNDU3MjY5MTA0NzM4OTg3MDM0Mzk4OTU1MDk5NDgxMTYsXG4gICAgICAgIDAuMTcxMzI0NDkyMzc5MTcwMzQ1MDQwMjk2MTQyMTcyNzMyODkzNTI2OCxcbiAgICAgICAgMC4xNzEzMjQ0OTIzNzkxNzAzNDUwNDAyOTYxNDIxNzI3MzI4OTM1MjY4LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjQxNzk1OTE4MzY3MzQ2OTM4Nzc1NTEwMjA0MDgxNjMyNjUzMDYxMjIsXG4gICAgICAgIDAuMzgxODMwMDUwNTA1MTE4OTQ0OTUwMzY5Nzc1NDg4OTc1MTMzODc4MyxcbiAgICAgICAgMC4zODE4MzAwNTA1MDUxMTg5NDQ5NTAzNjk3NzU0ODg5NzUxMzM4NzgzLFxuICAgICAgICAwLjI3OTcwNTM5MTQ4OTI3NjY2NzkwMTQ2Nzc3MTQyMzc3OTU4MjQ4NjksXG4gICAgICAgIDAuMjc5NzA1MzkxNDg5Mjc2NjY3OTAxNDY3NzcxNDIzNzc5NTgyNDg2OSxcbiAgICAgICAgMC4xMjk0ODQ5NjYxNjg4Njk2OTMyNzA2MTE0MzI2NzkwODIwMTgzMjg1LFxuICAgICAgICAwLjEyOTQ4NDk2NjE2ODg2OTY5MzI3MDYxMTQzMjY3OTA4MjAxODMyODUsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMzYyNjgzNzgzMzc4MzYxOTgyOTY1MTUwNDQ5Mjc3MTk1NjEyMTk0MSxcbiAgICAgICAgMC4zNjI2ODM3ODMzNzgzNjE5ODI5NjUxNTA0NDkyNzcxOTU2MTIxOTQxLFxuICAgICAgICAwLjMxMzcwNjY0NTg3Nzg4NzI4NzMzNzk2MjIwMTk4NjYwMTMxMzI2MDMsXG4gICAgICAgIDAuMzEzNzA2NjQ1ODc3ODg3Mjg3MzM3OTYyMjAxOTg2NjAxMzEzMjYwMyxcbiAgICAgICAgMC4yMjIzODEwMzQ0NTMzNzQ0NzA1NDQzNTU5OTQ0MjYyNDA4ODQ0MzAxLFxuICAgICAgICAwLjIyMjM4MTAzNDQ1MzM3NDQ3MDU0NDM1NTk5NDQyNjI0MDg4NDQzMDEsXG4gICAgICAgIDAuMTAxMjI4NTM2MjkwMzc2MjU5MTUyNTMxMzU0MzA5OTYyMTkwMTE1MyxcbiAgICAgICAgMC4xMDEyMjg1MzYyOTAzNzYyNTkxNTI1MzEzNTQzMDk5NjIxOTAxMTUzLFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjMzMDIzOTM1NTAwMTI1OTc2MzE2NDUyNTA2OTI4Njk3NDA0ODg3ODgsXG4gICAgICAgIDAuMTgwNjQ4MTYwNjk0ODU3NDA0MDU4NDcyMDMxMjQyOTEyODA5NTE0MyxcbiAgICAgICAgMC4xODA2NDgxNjA2OTQ4NTc0MDQwNTg0NzIwMzEyNDI5MTI4MDk1MTQzLFxuICAgICAgICAwLjA4MTI3NDM4ODM2MTU3NDQxMTk3MTg5MjE1ODExMDUyMzY1MDY3NTYsXG4gICAgICAgIDAuMDgxMjc0Mzg4MzYxNTc0NDExOTcxODkyMTU4MTEwNTIzNjUwNjc1NixcbiAgICAgICAgMC4zMTIzNDcwNzcwNDAwMDI4NDAwNjg2MzA0MDY1ODQ0NDM2NjU1OTg3LFxuICAgICAgICAwLjMxMjM0NzA3NzA0MDAwMjg0MDA2ODYzMDQwNjU4NDQ0MzY2NTU5ODcsXG4gICAgICAgIDAuMjYwNjEwNjk2NDAyOTM1NDYyMzE4NzQyODY5NDE4NjMyODQ5NzcxOCxcbiAgICAgICAgMC4yNjA2MTA2OTY0MDI5MzU0NjIzMTg3NDI4Njk0MTg2MzI4NDk3NzE4LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjI5NTUyNDIyNDcxNDc1Mjg3MDE3Mzg5Mjk5NDY1MTMzODMyOTQyMSxcbiAgICAgICAgMC4yOTU1MjQyMjQ3MTQ3NTI4NzAxNzM4OTI5OTQ2NTEzMzgzMjk0MjEsXG4gICAgICAgIDAuMjY5MjY2NzE5MzA5OTk2MzU1MDkxMjI2OTIxNTY5NDY5MzUyODU5NyxcbiAgICAgICAgMC4yNjkyNjY3MTkzMDk5OTYzNTUwOTEyMjY5MjE1Njk0NjkzNTI4NTk3LFxuICAgICAgICAwLjIxOTA4NjM2MjUxNTk4MjA0Mzk5NTUzNDkzNDIyODE2MzE5MjQ1ODcsXG4gICAgICAgIDAuMjE5MDg2MzYyNTE1OTgyMDQzOTk1NTM0OTM0MjI4MTYzMTkyNDU4NyxcbiAgICAgICAgMC4xNDk0NTEzNDkxNTA1ODA1OTMxNDU3NzYzMzk2NTc2OTczMzI0MDI1LFxuICAgICAgICAwLjE0OTQ1MTM0OTE1MDU4MDU5MzE0NTc3NjMzOTY1NzY5NzMzMjQwMjUsXG4gICAgICAgIDAuMDY2NjcxMzQ0MzA4Njg4MTM3NTkzNTY4ODA5ODkzMzMxNzkyODU3OCxcbiAgICAgICAgMC4wNjY2NzEzNDQzMDg2ODgxMzc1OTM1Njg4MDk4OTMzMzE3OTI4NTc4LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjI3MjkyNTA4Njc3NzkwMDYzMDcxNDQ4MzUyODMzNjM0MjE4OTE1NixcbiAgICAgICAgMC4yNjI4MDQ1NDQ1MTAyNDY2NjIxODA2ODg4Njk4OTA1MDkxOTUzNzI3LFxuICAgICAgICAwLjI2MjgwNDU0NDUxMDI0NjY2MjE4MDY4ODg2OTg5MDUwOTE5NTM3MjcsXG4gICAgICAgIDAuMjMzMTkzNzY0NTkxOTkwNDc5OTE4NTIzNzA0ODQzMTc1MTM5NDMxNyxcbiAgICAgICAgMC4yMzMxOTM3NjQ1OTE5OTA0Nzk5MTg1MjM3MDQ4NDMxNzUxMzk0MzE3LFxuICAgICAgICAwLjE4NjI5MDIxMDkyNzczNDI1MTQyNjA5NzY0MTQzMTY1NTg5MTY5MTIsXG4gICAgICAgIDAuMTg2MjkwMjEwOTI3NzM0MjUxNDI2MDk3NjQxNDMxNjU1ODkxNjkxMixcbiAgICAgICAgMC4xMjU1ODAzNjk0NjQ5MDQ2MjQ2MzQ2OTQyOTkyMjM5NDAxMDAxOTc2LFxuICAgICAgICAwLjEyNTU4MDM2OTQ2NDkwNDYyNDYzNDY5NDI5OTIyMzk0MDEwMDE5NzYsXG4gICAgICAgIDAuMDU1NjY4NTY3MTE2MTczNjY2NDgyNzUzNzIwNDQyNTQ4NTc4NzI4NSxcbiAgICAgICAgMC4wNTU2Njg1NjcxMTYxNzM2NjY0ODI3NTM3MjA0NDI1NDg1Nzg3Mjg1LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjI0OTE0NzA0NTgxMzQwMjc4NTAwMDU2MjQzNjA0Mjk1MTIxMDgzMDQsXG4gICAgICAgIDAuMjQ5MTQ3MDQ1ODEzNDAyNzg1MDAwNTYyNDM2MDQyOTUxMjEwODMwNCxcbiAgICAgICAgMC4yMzM0OTI1MzY1MzgzNTQ4MDg3NjA4NDk4OTg5MjQ4NzgwNTYyNTk0LFxuICAgICAgICAwLjIzMzQ5MjUzNjUzODM1NDgwODc2MDg0OTg5ODkyNDg3ODA1NjI1OTQsXG4gICAgICAgIDAuMjAzMTY3NDI2NzIzMDY1OTIxNzQ5MDY0NDU1ODA5Nzk4Mzc2NTA2NSxcbiAgICAgICAgMC4yMDMxNjc0MjY3MjMwNjU5MjE3NDkwNjQ0NTU4MDk3OTgzNzY1MDY1LFxuICAgICAgICAwLjE2MDA3ODMyODU0MzM0NjIyNjMzNDY1MjUyOTU0MzM1OTA3MTg3MixcbiAgICAgICAgMC4xNjAwNzgzMjg1NDMzNDYyMjYzMzQ2NTI1Mjk1NDMzNTkwNzE4NzIsXG4gICAgICAgIDAuMTA2OTM5MzI1OTk1MzE4NDMwOTYwMjU0NzE4MTkzOTk2MjI0MjE0NSxcbiAgICAgICAgMC4xMDY5MzkzMjU5OTUzMTg0MzA5NjAyNTQ3MTgxOTM5OTYyMjQyMTQ1LFxuICAgICAgICAwLjA0NzE3NTMzNjM4NjUxMTgyNzE5NDYxNTk2MTQ4NTAxNzA2MDMxNyxcbiAgICAgICAgMC4wNDcxNzUzMzYzODY1MTE4MjcxOTQ2MTU5NjE0ODUwMTcwNjAzMTcsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMjMyNTUxNTUzMjMwODczOTEwMTk0NTg5NTE1MjY4ODM1OTQ4MTU2NixcbiAgICAgICAgMC4yMjYyODMxODAyNjI4OTcyMzg0MTIwOTAxODYwMzk3NzY2MTg0MzQ3LFxuICAgICAgICAwLjIyNjI4MzE4MDI2Mjg5NzIzODQxMjA5MDE4NjAzOTc3NjYxODQzNDcsXG4gICAgICAgIDAuMjA3ODE2MDQ3NTM2ODg4NTAyMzEyNTIzMjE5MzA2MDUyNzYzMzg2NSxcbiAgICAgICAgMC4yMDc4MTYwNDc1MzY4ODg1MDIzMTI1MjMyMTkzMDYwNTI3NjMzODY1LFxuICAgICAgICAwLjE3ODE0NTk4MDc2MTk0NTczODI4MDA0NjY5MTk5NjA5Nzk5NTUxMjgsXG4gICAgICAgIDAuMTc4MTQ1OTgwNzYxOTQ1NzM4MjgwMDQ2NjkxOTk2MDk3OTk1NTEyOCxcbiAgICAgICAgMC4xMzg4NzM1MTAyMTk3ODcyMzg0NjM2MDE3NzY4Njg4NzE0Njc2MjE4LFxuICAgICAgICAwLjEzODg3MzUxMDIxOTc4NzIzODQ2MzYwMTc3Njg2ODg3MTQ2NzYyMTgsXG4gICAgICAgIDAuMDkyMTIxNDk5ODM3NzI4NDQ3OTE0NDIxNzc1OTUzNzk3MTIwOTIzNixcbiAgICAgICAgMC4wOTIxMjE0OTk4Mzc3Mjg0NDc5MTQ0MjE3NzU5NTM3OTcxMjA5MjM2LFxuICAgICAgICAwLjA0MDQ4NDAwNDc2NTMxNTg3OTUyMDAyMTU5MjIwMDk4NjA2MDA0MTksXG4gICAgICAgIDAuMDQwNDg0MDA0NzY1MzE1ODc5NTIwMDIxNTkyMjAwOTg2MDYwMDQxOSxcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMC4yMTUyNjM4NTM0NjMxNTc3OTAxOTU4NzY0NDMzMTYyNjAwMzUyNzQ5LFxuICAgICAgICAwLjIxNTI2Mzg1MzQ2MzE1Nzc5MDE5NTg3NjQ0MzMxNjI2MDAzNTI3NDksXG4gICAgICAgIDAuMjA1MTk4NDYzNzIxMjk1NjAzOTY1OTI0MDY1NjYxMjE4MDU1NzEwMyxcbiAgICAgICAgMC4yMDUxOTg0NjM3MjEyOTU2MDM5NjU5MjQwNjU2NjEyMTgwNTU3MTAzLFxuICAgICAgICAwLjE4NTUzODM5NzQ3NzkzNzgxMzc0MTcxNjU5MDEyNTE1NzAzNjI0ODksXG4gICAgICAgIDAuMTg1NTM4Mzk3NDc3OTM3ODEzNzQxNzE2NTkwMTI1MTU3MDM2MjQ4OSxcbiAgICAgICAgMC4xNTcyMDMxNjcxNTgxOTM1MzQ1Njk2MDE5Mzg2MjM4NDIxNTY2MDU2LFxuICAgICAgICAwLjE1NzIwMzE2NzE1ODE5MzUzNDU2OTYwMTkzODYyMzg0MjE1NjYwNTYsXG4gICAgICAgIDAuMTIxNTE4NTcwNjg3OTAzMTg0Njg5NDE0ODA5MDcyNDc2NjI1OTU2NixcbiAgICAgICAgMC4xMjE1MTg1NzA2ODc5MDMxODQ2ODk0MTQ4MDkwNzI0NzY2MjU5NTY2LFxuICAgICAgICAwLjA4MDE1ODA4NzE1OTc2MDIwOTgwNTYzMzI3NzA2Mjg1NDMwOTU4MzYsXG4gICAgICAgIDAuMDgwMTU4MDg3MTU5NzYwMjA5ODA1NjMzMjc3MDYyODU0MzA5NTgzNixcbiAgICAgICAgMC4wMzUxMTk0NjAzMzE3NTE4NjMwMzE4MzI4NzYxMzgxOTE3ODA2MTk3LFxuICAgICAgICAwLjAzNTExOTQ2MDMzMTc1MTg2MzAzMTgzMjg3NjEzODE5MTc4MDYxOTcsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMjAyNTc4MjQxOTI1NTYxMjcyODgwNjIwMTk5OTY3NTE5MzE0ODM4NixcbiAgICAgICAgMC4xOTg0MzE0ODUzMjcxMTE1NzY0NTYxMTgzMjY0NDM4MzkzMjQ4MTg2LFxuICAgICAgICAwLjE5ODQzMTQ4NTMyNzExMTU3NjQ1NjExODMyNjQ0MzgzOTMyNDgxODYsXG4gICAgICAgIDAuMTg2MTYxMDAwMDE1NTYyMjExMDI2ODAwNTYxODY2NDIyODI0NTA2MixcbiAgICAgICAgMC4xODYxNjEwMDAwMTU1NjIyMTEwMjY4MDA1NjE4NjY0MjI4MjQ1MDYyLFxuICAgICAgICAwLjE2NjI2OTIwNTgxNjk5MzkzMzU1MzIwMDg2MDQ4MTIwODgxMTEzMDksXG4gICAgICAgIDAuMTY2MjY5MjA1ODE2OTkzOTMzNTUzMjAwODYwNDgxMjA4ODExMTMwOSxcbiAgICAgICAgMC4xMzk1NzA2Nzc5MjYxNTQzMTQ0NDc4MDQ3OTQ1MTEwMjgzMjI1MjA4LFxuICAgICAgICAwLjEzOTU3MDY3NzkyNjE1NDMxNDQ0NzgwNDc5NDUxMTAyODMyMjUyMDgsXG4gICAgICAgIDAuMTA3MTU5MjIwNDY3MTcxOTM1MDExODY5NTQ2Njg1ODY5MzAzNDE1NSxcbiAgICAgICAgMC4xMDcxNTkyMjA0NjcxNzE5MzUwMTE4Njk1NDY2ODU4NjkzMDM0MTU1LFxuICAgICAgICAwLjA3MDM2NjA0NzQ4ODEwODEyNDcwOTI2NzQxNjQ1MDY2NzMzODQ2NjcsXG4gICAgICAgIDAuMDcwMzY2MDQ3NDg4MTA4MTI0NzA5MjY3NDE2NDUwNjY3MzM4NDY2NyxcbiAgICAgICAgMC4wMzA3NTMyNDE5OTYxMTcyNjgzNTQ2MjgzOTM1NzcyMDQ0MTc3MjE3LFxuICAgICAgICAwLjAzMDc1MzI0MTk5NjExNzI2ODM1NDYyODM5MzU3NzIwNDQxNzcyMTcsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTg5NDUwNjEwNDU1MDY4NDk2Mjg1Mzk2NzIzMjA4MjgzMTA1MTQ2OSxcbiAgICAgICAgMC4xODk0NTA2MTA0NTUwNjg0OTYyODUzOTY3MjMyMDgyODMxMDUxNDY5LFxuICAgICAgICAwLjE4MjYwMzQxNTA0NDkyMzU4ODg2Njc2MzY2Nzk2OTIxOTkzOTM4MzUsXG4gICAgICAgIDAuMTgyNjAzNDE1MDQ0OTIzNTg4ODY2NzYzNjY3OTY5MjE5OTM5MzgzNSxcbiAgICAgICAgMC4xNjkxNTY1MTkzOTUwMDI1MzgxODkzMTIwNzkwMzAzNTk5NjIyMTE2LFxuICAgICAgICAwLjE2OTE1NjUxOTM5NTAwMjUzODE4OTMxMjA3OTAzMDM1OTk2MjIxMTYsXG4gICAgICAgIDAuMTQ5NTk1OTg4ODE2NTc2NzMyMDgxNTAxNzMwNTQ3NDc4NTQ4OTcwNCxcbiAgICAgICAgMC4xNDk1OTU5ODg4MTY1NzY3MzIwODE1MDE3MzA1NDc0Nzg1NDg5NzA0LFxuICAgICAgICAwLjEyNDYyODk3MTI1NTUzMzg3MjA1MjQ3NjI4MjE5MjAxNjQyMDE0NDgsXG4gICAgICAgIDAuMTI0NjI4OTcxMjU1NTMzODcyMDUyNDc2MjgyMTkyMDE2NDIwMTQ0OCxcbiAgICAgICAgMC4wOTUxNTg1MTE2ODI0OTI3ODQ4MDk5MjUxMDc2MDIyNDYyMjYzNTUyLFxuICAgICAgICAwLjA5NTE1ODUxMTY4MjQ5Mjc4NDgwOTkyNTEwNzYwMjI0NjIyNjM1NTIsXG4gICAgICAgIDAuMDYyMjUzNTIzOTM4NjQ3ODkyODYyODQzODM2OTk0Mzc3Njk0Mjc0OSxcbiAgICAgICAgMC4wNjIyNTM1MjM5Mzg2NDc4OTI4NjI4NDM4MzY5OTQzNzc2OTQyNzQ5LFxuICAgICAgICAwLjAyNzE1MjQ1OTQxMTc1NDA5NDg1MTc4MDU3MjQ1NjAxODEwMzUxMjIsXG4gICAgICAgIDAuMDI3MTUyNDU5NDExNzU0MDk0ODUxNzgwNTcyNDU2MDE4MTAzNTEyMixcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMC4xNzk0NDY0NzAzNTYyMDY1MjU0NTgyNjU2NDQyNjE4ODU2MjE0NDg3LFxuICAgICAgICAwLjE3NjU2MjcwNTM2Njk5MjY0NjMyNTI3MDk5MDExMzE5NzIzOTE1MDksXG4gICAgICAgIDAuMTc2NTYyNzA1MzY2OTkyNjQ2MzI1MjcwOTkwMTEzMTk3MjM5MTUwOSxcbiAgICAgICAgMC4xNjgwMDQxMDIxNTY0NTAwNDQ1MDk5NzA2NjM3ODgzMjMxNTUwMjExLFxuICAgICAgICAwLjE2ODAwNDEwMjE1NjQ1MDA0NDUwOTk3MDY2Mzc4ODMyMzE1NTAyMTEsXG4gICAgICAgIDAuMTU0MDQ1NzYxMDc2ODEwMjg4MDgxNDMxNTk0ODAxOTU4NjExOTQwNCxcbiAgICAgICAgMC4xNTQwNDU3NjEwNzY4MTAyODgwODE0MzE1OTQ4MDE5NTg2MTE5NDA0LFxuICAgICAgICAwLjEzNTEzNjM2ODQ2ODUyNTQ3MzI4NjMxOTk4MTcwMjM1MDE5NzM3MjEsXG4gICAgICAgIDAuMTM1MTM2MzY4NDY4NTI1NDczMjg2MzE5OTgxNzAyMzUwMTk3MzcyMSxcbiAgICAgICAgMC4xMTE4ODM4NDcxOTM0MDM5NzEwOTQ3ODgzODU2MjYzNTU5MjY3MzU4LFxuICAgICAgICAwLjExMTg4Mzg0NzE5MzQwMzk3MTA5NDc4ODM4NTYyNjM1NTkyNjczNTgsXG4gICAgICAgIDAuMDg1MDM2MTQ4MzE3MTc5MTgwODgzNTM1MzcwMTkxMDYyMDczODUwNCxcbiAgICAgICAgMC4wODUwMzYxNDgzMTcxNzkxODA4ODM1MzUzNzAxOTEwNjIwNzM4NTA0LFxuICAgICAgICAwLjA1NTQ1OTUyOTM3Mzk4NzIwMTEyOTQ0MDE2NTM1ODI0NDY2MDUxMjgsXG4gICAgICAgIDAuMDU1NDU5NTI5MzczOTg3MjAxMTI5NDQwMTY1MzU4MjQ0NjYwNTEyOCxcbiAgICAgICAgMC4wMjQxNDgzMDI4Njg1NDc5MzE5NjAxMTAwMjYyODc1NjUzMjQ2OTE2LFxuICAgICAgICAwLjAyNDE0ODMwMjg2ODU0NzkzMTk2MDExMDAyNjI4NzU2NTMyNDY5MTYsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTY5MTQyMzgyOTYzMTQzNTkxODQwNjU2NDcwMTM0OTg2NjEwMzM0MSxcbiAgICAgICAgMC4xNjkxNDIzODI5NjMxNDM1OTE4NDA2NTY0NzAxMzQ5ODY2MTAzMzQxLFxuICAgICAgICAwLjE2NDI3NjQ4Mzc0NTgzMjcyMjk4NjA1Mzc3NjQ2NTkyNzU5MDQxMjMsXG4gICAgICAgIDAuMTY0Mjc2NDgzNzQ1ODMyNzIyOTg2MDUzNzc2NDY1OTI3NTkwNDEyMyxcbiAgICAgICAgMC4xNTQ2ODQ2NzUxMjYyNjUyNDQ5MjU0MTgwMDM4MzYzNzQ3NzIxOTMyLFxuICAgICAgICAwLjE1NDY4NDY3NTEyNjI2NTI0NDkyNTQxODAwMzgzNjM3NDc3MjE5MzIsXG4gICAgICAgIDAuMTQwNjQyOTE0NjcwNjUwNjUxMjA0NzMxMzAzNzUxOTQ3MjI4MDk1NSxcbiAgICAgICAgMC4xNDA2NDI5MTQ2NzA2NTA2NTEyMDQ3MzEzMDM3NTE5NDcyMjgwOTU1LFxuICAgICAgICAwLjEyMjU1NTIwNjcxMTQ3ODQ2MDE4NDUxOTEyNjgwMDIwMTU1NTIyODEsXG4gICAgICAgIDAuMTIyNTU1MjA2NzExNDc4NDYwMTg0NTE5MTI2ODAwMjAxNTU1MjI4MSxcbiAgICAgICAgMC4xMDA5NDIwNDQxMDYyODcxNjU1NjI4MTM5ODQ5MjQ4MzQ2MDcwNjI4LFxuICAgICAgICAwLjEwMDk0MjA0NDEwNjI4NzE2NTU2MjgxMzk4NDkyNDgzNDYwNzA2MjgsXG4gICAgICAgIDAuMDc2NDI1NzMwMjU0ODg5MDU2NTI5MTI5Njc3NjE2NjM2NTI1NjA1MyxcbiAgICAgICAgMC4wNzY0MjU3MzAyNTQ4ODkwNTY1MjkxMjk2Nzc2MTY2MzY1MjU2MDUzLFxuICAgICAgICAwLjA0OTcxNDU0ODg5NDk2OTc5NjQ1MzMzNDk0NjIwMjYzODY0MTY4MDgsXG4gICAgICAgIDAuMDQ5NzE0NTQ4ODk0OTY5Nzk2NDUzMzM0OTQ2MjAyNjM4NjQxNjgwOCxcbiAgICAgICAgMC4wMjE2MTYwMTM1MjY0ODMzMTAzMTMzNDI3MTAyNjY0NTI0NjkzODc2LFxuICAgICAgICAwLjAyMTYxNjAxMzUyNjQ4MzMxMDMxMzM0MjcxMDI2NjQ1MjQ2OTM4NzYsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTYxMDU0NDQ5ODQ4NzgzNjk1OTc5MTYzNjI1MzIwOTE2NzM1MDM5OSxcbiAgICAgICAgMC4xNTg5Njg4NDMzOTM5NTQzNDc2NDk5NTY0Mzk0NjUwNDcyMDE2Nzg3LFxuICAgICAgICAwLjE1ODk2ODg0MzM5Mzk1NDM0NzY0OTk1NjQzOTQ2NTA0NzIwMTY3ODcsXG4gICAgICAgIDAuMTUyNzY2MDQyMDY1ODU5NjY2Nzc4ODU1NDAwODk3NjYyOTk4NDYxLFxuICAgICAgICAwLjE1Mjc2NjA0MjA2NTg1OTY2Njc3ODg1NTQwMDg5NzY2Mjk5ODQ2MSxcbiAgICAgICAgMC4xNDI2MDY3MDIxNzM2MDY2MTE3NzU3NDYxMDk0NDE5MDI5NzI0NzU2LFxuICAgICAgICAwLjE0MjYwNjcwMjE3MzYwNjYxMTc3NTc0NjEwOTQ0MTkwMjk3MjQ3NTYsXG4gICAgICAgIDAuMTI4NzUzOTYyNTM5MzM2MjI3Njc1NTE1Nzg0ODU2ODc3MTE3MDU1OCxcbiAgICAgICAgMC4xMjg3NTM5NjI1MzkzMzYyMjc2NzU1MTU3ODQ4NTY4NzcxMTcwNTU4LFxuICAgICAgICAwLjExMTU2NjY0NTU0NzMzMzk5NDcxNjAyMzkwMTY4MTc2NTk5NzQ4MTMsXG4gICAgICAgIDAuMTExNTY2NjQ1NTQ3MzMzOTk0NzE2MDIzOTAxNjgxNzY1OTk3NDgxMyxcbiAgICAgICAgMC4wOTE0OTAwMjE2MjI0NDk5OTk0NjQ0NjIwOTQxMjM4Mzk2NTI2NjA5LFxuICAgICAgICAwLjA5MTQ5MDAyMTYyMjQ0OTk5OTQ2NDQ2MjA5NDEyMzgzOTY1MjY2MDksXG4gICAgICAgIDAuMDY5MDQ0NTQyNzM3NjQxMjI2NTgwNzA4MjU4MDA2MDEzMDQ0OTYxOCxcbiAgICAgICAgMC4wNjkwNDQ1NDI3Mzc2NDEyMjY1ODA3MDgyNTgwMDYwMTMwNDQ5NjE4LFxuICAgICAgICAwLjA0NDgxNDIyNjc2NTY5OTYwMDMzMjgzODE1NzQwMTk5NDIxMTk1MTcsXG4gICAgICAgIDAuMDQ0ODE0MjI2NzY1Njk5NjAwMzMyODM4MTU3NDAxOTk0MjExOTUxNyxcbiAgICAgICAgMC4wMTk0NjE3ODgyMjk3MjY0NzcwMzYzMTIwNDE0NjQ0Mzg0MzU3NTI5LFxuICAgICAgICAwLjAxOTQ2MTc4ODIyOTcyNjQ3NzAzNjMxMjA0MTQ2NDQzODQzNTc1MjksXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTUyNzUzMzg3MTMwNzI1ODUwNjk4MDg0MzMxOTU1MDk3NTkzNDkxOSxcbiAgICAgICAgMC4xNTI3NTMzODcxMzA3MjU4NTA2OTgwODQzMzE5NTUwOTc1OTM0OTE5LFxuICAgICAgICAwLjE0OTE3Mjk4NjQ3MjYwMzc0Njc4NzgyODczNzAwMTk2OTQzNjY5MjYsXG4gICAgICAgIDAuMTQ5MTcyOTg2NDcyNjAzNzQ2Nzg3ODI4NzM3MDAxOTY5NDM2NjkyNixcbiAgICAgICAgMC4xNDIwOTYxMDkzMTgzODIwNTEzMjkyOTgzMjUwNjcxNjQ5MzMwMzQ1LFxuICAgICAgICAwLjE0MjA5NjEwOTMxODM4MjA1MTMyOTI5ODMyNTA2NzE2NDkzMzAzNDUsXG4gICAgICAgIDAuMTMxNjg4NjM4NDQ5MTc2NjI2ODk4NDk0NDk5NzQ4MTYzMTM0OTE2MSxcbiAgICAgICAgMC4xMzE2ODg2Mzg0NDkxNzY2MjY4OTg0OTQ0OTk3NDgxNjMxMzQ5MTYxLFxuICAgICAgICAwLjExODE5NDUzMTk2MTUxODQxNzMxMjM3NzM3NzcxMTM4MjI4NzAwNSxcbiAgICAgICAgMC4xMTgxOTQ1MzE5NjE1MTg0MTczMTIzNzczNzc3MTEzODIyODcwMDUsXG4gICAgICAgIDAuMTAxOTMwMTE5ODE3MjQwNDM1MDM2NzUwMTM1NDgwMzQ5ODc2MTY2NixcbiAgICAgICAgMC4xMDE5MzAxMTk4MTcyNDA0MzUwMzY3NTAxMzU0ODAzNDk4NzYxNjY2LFxuICAgICAgICAwLjA4MzI3Njc0MTU3NjcwNDc0ODcyNDc1ODE0MzIyMjA0NjIwNjEwMDEsXG4gICAgICAgIDAuMDgzMjc2NzQxNTc2NzA0NzQ4NzI0NzU4MTQzMjIyMDQ2MjA2MTAwMSxcbiAgICAgICAgMC4wNjI2NzIwNDgzMzQxMDkwNjM1Njk1MDY1MzUxODcwNDE2MDYzNTE2LFxuICAgICAgICAwLjA2MjY3MjA0ODMzNDEwOTA2MzU2OTUwNjUzNTE4NzA0MTYwNjM1MTYsXG4gICAgICAgIDAuMDQwNjAxNDI5ODAwMzg2OTQxMzMxMDM5OTUyMjc0OTMyMTA5ODc5LFxuICAgICAgICAwLjA0MDYwMTQyOTgwMDM4Njk0MTMzMTAzOTk1MjI3NDkzMjEwOTg3OSxcbiAgICAgICAgMC4wMTc2MTQwMDcxMzkxNTIxMTgzMTE4NjE5NjIzNTE4NTI4MTYzNjIxLFxuICAgICAgICAwLjAxNzYxNDAwNzEzOTE1MjExODMxMTg2MTk2MjM1MTg1MjgxNjM2MjEsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTQ2MDgxMTMzNjQ5NjkwNDI3MTkxOTg1MTQ3NjgzMzcxMTg4MjQ0OCxcbiAgICAgICAgMC4xNDQ1MjQ0MDM5ODk5NzAwNTkwNjM4MjcxNjY1NTM3NTI1NDM2MDk5LFxuICAgICAgICAwLjE0NDUyNDQwMzk4OTk3MDA1OTA2MzgyNzE2NjU1Mzc1MjU0MzYwOTksXG4gICAgICAgIDAuMTM5ODg3Mzk0NzkxMDczMTU0NzIyMTMzNDIzODY3NTgzMTEwODkyNyxcbiAgICAgICAgMC4xMzk4ODczOTQ3OTEwNzMxNTQ3MjIxMzM0MjM4Njc1ODMxMTA4OTI3LFxuICAgICAgICAwLjEzMjI2ODkzODYzMzMzNzQ2MTc4MTA1MjU3NDQ5Njc3NTYwNDMyOSxcbiAgICAgICAgMC4xMzIyNjg5Mzg2MzMzMzc0NjE3ODEwNTI1NzQ0OTY3NzU2MDQzMjksXG4gICAgICAgIDAuMTIxODMxNDE2MDUzNzI4NTM0MTk1MzY3MTc3MTI1NzMzNTk4MzU2MyxcbiAgICAgICAgMC4xMjE4MzE0MTYwNTM3Mjg1MzQxOTUzNjcxNzcxMjU3MzM1OTgzNTYzLFxuICAgICAgICAwLjEwODc5NzI5OTE2NzE0ODM3NzY2MzQ3NDU3ODA3MDEwNTY0MjAzMzYsXG4gICAgICAgIDAuMTA4Nzk3Mjk5MTY3MTQ4Mzc3NjYzNDc0NTc4MDcwMTA1NjQyMDMzNixcbiAgICAgICAgMC4wOTM0NDQ0MjM0NTYwMzM4NjE1NTMyODk3NDExMTM5MzIwODg0ODM1LFxuICAgICAgICAwLjA5MzQ0NDQyMzQ1NjAzMzg2MTU1MzI4OTc0MTExMzkzMjA4ODQ4MzUsXG4gICAgICAgIDAuMDc2MTAwMTEzNjI4Mzc5MzAyMDE3MDUxNjUzMzAwMTgzMTc5MjI2MSxcbiAgICAgICAgMC4wNzYxMDAxMTM2MjgzNzkzMDIwMTcwNTE2NTMzMDAxODMxNzkyMjYxLFxuICAgICAgICAwLjA1NzEzNDQyNTQyNjg1NzIwODI4MzYzNTgyNjQ3MjQ0Nzk1NzQ5MTIsXG4gICAgICAgIDAuMDU3MTM0NDI1NDI2ODU3MjA4MjgzNjM1ODI2NDcyNDQ3OTU3NDkxMixcbiAgICAgICAgMC4wMzY5NTM3ODk3NzA4NTI0OTM3OTk5NTA2NjgyOTkzMjk2NjYxODg5LFxuICAgICAgICAwLjAzNjk1Mzc4OTc3MDg1MjQ5Mzc5OTk1MDY2ODI5OTMyOTY2NjE4ODksXG4gICAgICAgIDAuMDE2MDE3MjI4MjU3Nzc0MzMzMzI0MjI0NjE2ODU4NDcxMDE1MjY1OCxcbiAgICAgICAgMC4wMTYwMTcyMjgyNTc3NzQzMzMzMjQyMjQ2MTY4NTg0NzEwMTUyNjU4LFxuICAgIF0sXG4gICAgW1xuICAgICAgICAwLjEzOTI1MTg3Mjg1NTYzMTk5MzM3NTQxMDI0ODM0MTgwOTk1Nzg3MzksXG4gICAgICAgIDAuMTM5MjUxODcyODU1NjMxOTkzMzc1NDEwMjQ4MzQxODA5OTU3ODczOSxcbiAgICAgICAgMC4xMzY1NDE0OTgzNDYwMTUxNzEzNTI1NzM4MzEyMzE1MTczOTY1ODYzLFxuICAgICAgICAwLjEzNjU0MTQ5ODM0NjAxNTE3MTM1MjU3MzgzMTIzMTUxNzM5NjU4NjMsXG4gICAgICAgIDAuMTMxMTczNTA0Nzg3MDYyMzcwNzMyOTY0OTkyNTMwMzA3NDQ1ODc1NyxcbiAgICAgICAgMC4xMzExNzM1MDQ3ODcwNjIzNzA3MzI5NjQ5OTI1MzAzMDc0NDU4NzU3LFxuICAgICAgICAwLjEyMzI1MjM3NjgxMDUxMjQyNDI4NTU2MDk4NjE1NDgxNDQ3MTk1OTQsXG4gICAgICAgIDAuMTIzMjUyMzc2ODEwNTEyNDI0Mjg1NTYwOTg2MTU0ODE0NDcxOTU5NCxcbiAgICAgICAgMC4xMTI5MzIyOTYwODA1MzkyMTgzOTM0MDA2MDc0MjE3ODQzMTkxMTQyLFxuICAgICAgICAwLjExMjkzMjI5NjA4MDUzOTIxODM5MzQwMDYwNzQyMTc4NDMxOTExNDIsXG4gICAgICAgIDAuMTAwNDE0MTQ0NDQyODgwOTY0OTMyMDc4ODM3ODMwNTM2MjgyMzUwOCxcbiAgICAgICAgMC4xMDA0MTQxNDQ0NDI4ODA5NjQ5MzIwNzg4Mzc4MzA1MzYyODIzNTA4LFxuICAgICAgICAwLjA4NTk0MTYwNjIxNzA2NzcyNzQxNDQ0MzY4MTM3MjcwMjg2NjE4OTEsXG4gICAgICAgIDAuMDg1OTQxNjA2MjE3MDY3NzI3NDE0NDQzNjgxMzcyNzAyODY2MTg5MSxcbiAgICAgICAgMC4wNjk3OTY0Njg0MjQ1MjA0ODgwOTQ5NjE0MTg5MzAyMTc2NTczOTg3LFxuICAgICAgICAwLjA2OTc5NjQ2ODQyNDUyMDQ4ODA5NDk2MTQxODkzMDIxNzY1NzM5ODcsXG4gICAgICAgIDAuMDUyMjkzMzM1MTUyNjgzMjg1OTQwMzEyMDUxMjczMjExMjU2MTEyMSxcbiAgICAgICAgMC4wNTIyOTMzMzUxNTI2ODMyODU5NDAzMTIwNTEyNzMyMTEyNTYxMTIxLFxuICAgICAgICAwLjAzMzc3NDkwMTU4NDgxNDE1NDc5MzMwMjI0Njg2NTkxMjkwMTM0OTEsXG4gICAgICAgIDAuMDMzNzc0OTAxNTg0ODE0MTU0NzkzMzAyMjQ2ODY1OTEyOTAxMzQ5MSxcbiAgICAgICAgMC4wMTQ2Mjc5OTUyOTgyNzIyMDA2ODQ5OTEwOTgwNDcxODU0NDUxOTAyLFxuICAgICAgICAwLjAxNDYyNzk5NTI5ODI3MjIwMDY4NDk5MTA5ODA0NzE4NTQ0NTE5MDIsXG4gICAgXSxcbiAgICBbXG4gICAgICAgIDAuMTMzNjU0NTcyMTg2MTA2MTc1MzUxNDU3MTEwNTQ1ODQ0MzM4NTgzMSxcbiAgICAgICAgMC4xMzI0NjIwMzk0MDQ2OTY2MTczNzE2NDI0NjQ3MDMzMTY5MjU4MDUsXG4gICAgICAgIDAuMTMyNDYyMDM5NDA0Njk2NjE3MzcxNjQyNDY0NzAzMzE2OTI1ODA1LFxuICAgICAgICAwLjEyODkwNTcyMjE4ODA4MjE0OTk3ODU5NTMzOTM5OTc5MzY1MzI1OTcsXG4gICAgICAgIDAuMTI4OTA1NzIyMTg4MDgyMTQ5OTc4NTk1MzM5Mzk5NzkzNjUzMjU5NyxcbiAgICAgICAgMC4xMjMwNDkwODQzMDY3Mjk1MzA0Njc1Nzg0MDA2NzIwMDk2NTQ4MTU4LFxuICAgICAgICAwLjEyMzA0OTA4NDMwNjcyOTUzMDQ2NzU3ODQwMDY3MjAwOTY1NDgxNTgsXG4gICAgICAgIDAuMTE0OTk2NjQwMjIyNDExMzY0OTQxNjQzNTEyOTMzOTYxMzAxNDkxNCxcbiAgICAgICAgMC4xMTQ5OTY2NDAyMjI0MTEzNjQ5NDE2NDM1MTI5MzM5NjEzMDE0OTE0LFxuICAgICAgICAwLjEwNDg5MjA5MTQ2NDU0MTQxMDA3NDA4NjE4NTAxNDc0Mzg1NDg1ODQsXG4gICAgICAgIDAuMTA0ODkyMDkxNDY0NTQxNDEwMDc0MDg2MTg1MDE0NzQzODU0ODU4NCxcbiAgICAgICAgMC4wOTI5MTU3NjYwNjAwMzUxNDc0NzcwMTg2MTczNjk3NjQ2NDg2MDM0LFxuICAgICAgICAwLjA5MjkxNTc2NjA2MDAzNTE0NzQ3NzAxODYxNzM2OTc2NDY0ODYwMzQsXG4gICAgICAgIDAuMDc5MjgxNDExNzc2NzE4OTU0OTIyODkyNTI0NzQyMDQzMjI2OTEzNyxcbiAgICAgICAgMC4wNzkyODE0MTE3NzY3MTg5NTQ5MjI4OTI1MjQ3NDIwNDMyMjY5MTM3LFxuICAgICAgICAwLjA2NDIzMjQyMTQwODUyNTg1MjEyNzE2OTYxNTE1ODkxMDk5ODAzOTEsXG4gICAgICAgIDAuMDY0MjMyNDIxNDA4NTI1ODUyMTI3MTY5NjE1MTU4OTEwOTk4MDM5MSxcbiAgICAgICAgMC4wNDgwMzc2NzE3MzEwODQ2Njg1NzE2NDEwNzE2MzIwMzM5OTY1NjEyLFxuICAgICAgICAwLjA0ODAzNzY3MTczMTA4NDY2ODU3MTY0MTA3MTYzMjAzMzk5NjU2MTIsXG4gICAgICAgIDAuMDMwOTg4MDA1ODU2OTc5NDQ0MzEwNjk0MjE5NjQxODg0NTA1MzgzNyxcbiAgICAgICAgMC4wMzA5ODgwMDU4NTY5Nzk0NDQzMTA2OTQyMTk2NDE4ODQ1MDUzODM3LFxuICAgICAgICAwLjAxMzQxMTg1OTQ4NzE0MTc3MjA4MTMwOTQ5MzQ1ODYxNTA2NDk3NjYsXG4gICAgICAgIDAuMDEzNDExODU5NDg3MTQxNzcyMDgxMzA5NDkzNDU4NjE1MDY0OTc2NixcbiAgICBdLFxuICAgIFtcbiAgICAgICAgMC4xMjc5MzgxOTUzNDY3NTIxNTY5NzQwNTYxNjUyMjQ2OTUzNzE4NTE3LFxuICAgICAgICAwLjEyNzkzODE5NTM0Njc1MjE1Njk3NDA1NjE2NTIyNDY5NTM3MTg1MTcsXG4gICAgICAgIDAuMTI1ODM3NDU2MzQ2ODI4Mjk2MTIxMzc1MzgyNTExMTgzNjg4NzI2NCxcbiAgICAgICAgMC4xMjU4Mzc0NTYzNDY4MjgyOTYxMjEzNzUzODI1MTExODM2ODg3MjY0LFxuICAgICAgICAwLjEyMTY3MDQ3MjkyNzgwMzM5MTIwNDQ2MzE1MzQ3NjI2MjQyNTYwNyxcbiAgICAgICAgMC4xMjE2NzA0NzI5Mjc4MDMzOTEyMDQ0NjMxNTM0NzYyNjI0MjU2MDcsXG4gICAgICAgIDAuMTE1NTA1NjY4MDUzNzI1NjAxMzUzMzQ0NDgzOTA2NzgzNTU5ODYyMixcbiAgICAgICAgMC4xMTU1MDU2NjgwNTM3MjU2MDEzNTMzNDQ0ODM5MDY3ODM1NTk4NjIyLFxuICAgICAgICAwLjEwNzQ0NDI3MDExNTk2NTYzNDc4MjU3NzM0MjQ0NjYwNjIyMjc5NDYsXG4gICAgICAgIDAuMTA3NDQ0MjcwMTE1OTY1NjM0NzgyNTc3MzQyNDQ2NjA2MjIyNzk0NixcbiAgICAgICAgMC4wOTc2MTg2NTIxMDQxMTM4ODgyNjk4ODA2NjQ0NjQyNDcxNTQ0Mjc5LFxuICAgICAgICAwLjA5NzYxODY1MjEwNDExMzg4ODI2OTg4MDY2NDQ2NDI0NzE1NDQyNzksXG4gICAgICAgIDAuMDg2MTkwMTYxNTMxOTUzMjc1OTE3MTg1MjAyOTgzNzQyNjY3MTg1LFxuICAgICAgICAwLjA4NjE5MDE2MTUzMTk1MzI3NTkxNzE4NTIwMjk4Mzc0MjY2NzE4NSxcbiAgICAgICAgMC4wNzMzNDY0ODE0MTEwODAzMDU3MzQwMzM2MTUyNTMxMTY1MTgxMTkzLFxuICAgICAgICAwLjA3MzM0NjQ4MTQxMTA4MDMwNTczNDAzMzYxNTI1MzExNjUxODExOTMsXG4gICAgICAgIDAuMDU5Mjk4NTg0OTE1NDM2NzgwNzQ2MzY3NzU4NTAwMTA4NTg0NTQxMixcbiAgICAgICAgMC4wNTkyOTg1ODQ5MTU0MzY3ODA3NDYzNjc3NTg1MDAxMDg1ODQ1NDEyLFxuICAgICAgICAwLjA0NDI3NzQzODgxNzQxOTgwNjE2ODYwMjc0ODIxMTMzODIyODg1OTMsXG4gICAgICAgIDAuMDQ0Mjc3NDM4ODE3NDE5ODA2MTY4NjAyNzQ4MjExMzM4MjI4ODU5MyxcbiAgICAgICAgMC4wMjg1MzEzODg2Mjg5MzM2NjMxODEzMDc4MTU5NTE4NzgyODY0NDkxLFxuICAgICAgICAwLjAyODUzMTM4ODYyODkzMzY2MzE4MTMwNzgxNTk1MTg3ODI4NjQ0OTEsXG4gICAgICAgIDAuMDEyMzQxMjI5Nzk5OTg3MTk5NTQ2ODA1NjY3MDcwMDM3MjkxNTc1OSxcbiAgICAgICAgMC4wMTIzNDEyMjk3OTk5ODcxOTk1NDY4MDU2NjcwNzAwMzcyOTE1NzU5LFxuICAgIF0sXG5dO1xuZXhwb3J0IGNvbnN0IGJpbm9taWFsQ29lZmZpY2llbnRzID0gW1sxXSwgWzEsIDFdLCBbMSwgMiwgMV0sIFsxLCAzLCAzLCAxXV07XG5leHBvcnQgY29uc3QgZ2V0Q3ViaWNBcmNMZW5ndGggPSAoeHMsIHlzLCB0KSA9PiB7XG4gICAgbGV0IHN1bTtcbiAgICBsZXQgY29ycmVjdGVkVDtcbiAgICBjb25zdCBuID0gMjA7XG4gICAgY29uc3QgeiA9IHQgLyAyO1xuICAgIHN1bSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgY29ycmVjdGVkVCA9IHogKiB0VmFsdWVzW25dW2ldICsgejtcbiAgICAgICAgc3VtICs9IGNWYWx1ZXNbbl1baV0gKiBCRnVuYyh4cywgeXMsIGNvcnJlY3RlZFQpO1xuICAgIH1cbiAgICByZXR1cm4geiAqIHN1bTtcbn07XG5leHBvcnQgY29uc3QgZ2V0UXVhZHJhdGljQXJjTGVuZ3RoID0gKHhzLCB5cywgdCkgPT4ge1xuICAgIGlmICh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdCA9IDE7XG4gICAgfVxuICAgIGNvbnN0IGF4ID0geHNbMF0gLSAyICogeHNbMV0gKyB4c1syXTtcbiAgICBjb25zdCBheSA9IHlzWzBdIC0gMiAqIHlzWzFdICsgeXNbMl07XG4gICAgY29uc3QgYnggPSAyICogeHNbMV0gLSAyICogeHNbMF07XG4gICAgY29uc3QgYnkgPSAyICogeXNbMV0gLSAyICogeXNbMF07XG4gICAgY29uc3QgQSA9IDQgKiAoYXggKiBheCArIGF5ICogYXkpO1xuICAgIGNvbnN0IEIgPSA0ICogKGF4ICogYnggKyBheSAqIGJ5KTtcbiAgICBjb25zdCBDID0gYnggKiBieCArIGJ5ICogYnk7XG4gICAgaWYgKEEgPT09IDApIHtcbiAgICAgICAgcmV0dXJuICh0ICogTWF0aC5zcXJ0KE1hdGgucG93KHhzWzJdIC0geHNbMF0sIDIpICsgTWF0aC5wb3coeXNbMl0gLSB5c1swXSwgMikpKTtcbiAgICB9XG4gICAgY29uc3QgYiA9IEIgLyAoMiAqIEEpO1xuICAgIGNvbnN0IGMgPSBDIC8gQTtcbiAgICBjb25zdCB1ID0gdCArIGI7XG4gICAgY29uc3QgayA9IGMgLSBiICogYjtcbiAgICBjb25zdCB1dWsgPSB1ICogdSArIGsgPiAwID8gTWF0aC5zcXJ0KHUgKiB1ICsgaykgOiAwO1xuICAgIGNvbnN0IGJiayA9IGIgKiBiICsgayA+IDAgPyBNYXRoLnNxcnQoYiAqIGIgKyBrKSA6IDA7XG4gICAgY29uc3QgdGVybSA9IGIgKyBNYXRoLnNxcnQoYiAqIGIgKyBrKSAhPT0gMFxuICAgICAgICA/IGsgKiBNYXRoLmxvZyhNYXRoLmFicygodSArIHV1aykgLyAoYiArIGJiaykpKVxuICAgICAgICA6IDA7XG4gICAgcmV0dXJuIChNYXRoLnNxcnQoQSkgLyAyKSAqICh1ICogdXVrIC0gYiAqIGJiayArIHRlcm0pO1xufTtcbmZ1bmN0aW9uIEJGdW5jKHhzLCB5cywgdCkge1xuICAgIGNvbnN0IHhiYXNlID0gZ2V0RGVyaXZhdGl2ZSgxLCB0LCB4cyk7XG4gICAgY29uc3QgeWJhc2UgPSBnZXREZXJpdmF0aXZlKDEsIHQsIHlzKTtcbiAgICBjb25zdCBjb21iaW5lZCA9IHhiYXNlICogeGJhc2UgKyB5YmFzZSAqIHliYXNlO1xuICAgIHJldHVybiBNYXRoLnNxcnQoY29tYmluZWQpO1xufVxuY29uc3QgZ2V0RGVyaXZhdGl2ZSA9IChkZXJpdmF0aXZlLCB0LCB2cykgPT4ge1xuICAgIGNvbnN0IG4gPSB2cy5sZW5ndGggLSAxO1xuICAgIGxldCBfdnM7XG4gICAgbGV0IHZhbHVlO1xuICAgIGlmIChuID09PSAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAoZGVyaXZhdGl2ZSA9PT0gMCkge1xuICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDw9IG47IGsrKykge1xuICAgICAgICAgICAgdmFsdWUgKz1cbiAgICAgICAgICAgICAgICBiaW5vbWlhbENvZWZmaWNpZW50c1tuXVtrXSAqXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucG93KDEgLSB0LCBuIC0gaykgKlxuICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyh0LCBrKSAqXG4gICAgICAgICAgICAgICAgICAgIHZzW2tdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIF92cyA9IG5ldyBBcnJheShuKTtcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBuOyBrKyspIHtcbiAgICAgICAgICAgIF92c1trXSA9IG4gKiAodnNbayArIDFdIC0gdnNba10pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnZXREZXJpdmF0aXZlKGRlcml2YXRpdmUgLSAxLCB0LCBfdnMpO1xuICAgIH1cbn07XG5leHBvcnQgY29uc3QgdDJsZW5ndGggPSAobGVuZ3RoLCB0b3RhbExlbmd0aCwgZnVuYykgPT4ge1xuICAgIGxldCBlcnJvciA9IDE7XG4gICAgbGV0IHQgPSBsZW5ndGggLyB0b3RhbExlbmd0aDtcbiAgICBsZXQgc3RlcCA9IChsZW5ndGggLSBmdW5jKHQpKSAvIHRvdGFsTGVuZ3RoO1xuICAgIGxldCBudW1JdGVyYXRpb25zID0gMDtcbiAgICB3aGlsZSAoZXJyb3IgPiAwLjAwMSkge1xuICAgICAgICBjb25zdCBpbmNyZWFzZWRUTGVuZ3RoID0gZnVuYyh0ICsgc3RlcCk7XG4gICAgICAgIGNvbnN0IGluY3JlYXNlZFRFcnJvciA9IE1hdGguYWJzKGxlbmd0aCAtIGluY3JlYXNlZFRMZW5ndGgpIC8gdG90YWxMZW5ndGg7XG4gICAgICAgIGlmIChpbmNyZWFzZWRURXJyb3IgPCBlcnJvcikge1xuICAgICAgICAgICAgZXJyb3IgPSBpbmNyZWFzZWRURXJyb3I7XG4gICAgICAgICAgICB0ICs9IHN0ZXA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkZWNyZWFzZWRUTGVuZ3RoID0gZnVuYyh0IC0gc3RlcCk7XG4gICAgICAgICAgICBjb25zdCBkZWNyZWFzZWRURXJyb3IgPSBNYXRoLmFicyhsZW5ndGggLSBkZWNyZWFzZWRUTGVuZ3RoKSAvIHRvdGFsTGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGRlY3JlYXNlZFRFcnJvciA8IGVycm9yKSB7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSBkZWNyZWFzZWRURXJyb3I7XG4gICAgICAgICAgICAgICAgdCAtPSBzdGVwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RlcCAvPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG51bUl0ZXJhdGlvbnMrKztcbiAgICAgICAgaWYgKG51bUl0ZXJhdGlvbnMgPiA1MDApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0O1xufTtcbiIsImltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBTY2VuZUNvbnRleHQsIEhpdENvbnRleHQgfSBmcm9tIFwiLi9Db250ZXh0LmpzXCI7XG5pbXBvcnQgeyBLb252YSB9IGZyb20gXCIuL0dsb2JhbC5qc1wiO1xubGV0IF9waXhlbFJhdGlvO1xuZnVuY3Rpb24gZ2V0RGV2aWNlUGl4ZWxSYXRpbygpIHtcbiAgICBpZiAoX3BpeGVsUmF0aW8pIHtcbiAgICAgICAgcmV0dXJuIF9waXhlbFJhdGlvO1xuICAgIH1cbiAgICBjb25zdCBjYW52YXMgPSBVdGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKTtcbiAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgX3BpeGVsUmF0aW8gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBkZXZpY2VQaXhlbFJhdGlvID0gS29udmEuX2dsb2JhbC5kZXZpY2VQaXhlbFJhdGlvIHx8IDEsIGJhY2tpbmdTdG9yZVJhdGlvID0gY29udGV4dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8XG4gICAgICAgICAgICBjb250ZXh0Lm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgIGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8XG4gICAgICAgICAgICBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8XG4gICAgICAgICAgICBjb250ZXh0LmJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgIDE7XG4gICAgICAgIHJldHVybiBkZXZpY2VQaXhlbFJhdGlvIC8gYmFja2luZ1N0b3JlUmF0aW87XG4gICAgfSkoKTtcbiAgICBVdGlsLnJlbGVhc2VDYW52YXMoY2FudmFzKTtcbiAgICByZXR1cm4gX3BpeGVsUmF0aW87XG59XG5leHBvcnQgY2xhc3MgQ2FudmFzIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgdGhpcy5waXhlbFJhdGlvID0gMTtcbiAgICAgICAgdGhpcy53aWR0aCA9IDA7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy5pc0NhY2hlID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IGNvbmYgPSBjb25maWcgfHwge307XG4gICAgICAgIGNvbnN0IHBpeGVsUmF0aW8gPSBjb25mLnBpeGVsUmF0aW8gfHwgS29udmEucGl4ZWxSYXRpbyB8fCBnZXREZXZpY2VQaXhlbFJhdGlvKCk7XG4gICAgICAgIHRoaXMucGl4ZWxSYXRpbyA9IHBpeGVsUmF0aW87XG4gICAgICAgIHRoaXMuX2NhbnZhcyA9IFV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpO1xuICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUucGFkZGluZyA9ICcwJztcbiAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLm1hcmdpbiA9ICcwJztcbiAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLmJvcmRlciA9ICcwJztcbiAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUudG9wID0gJzAnO1xuICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUubGVmdCA9ICcwJztcbiAgICB9XG4gICAgZ2V0Q29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dDtcbiAgICB9XG4gICAgZ2V0UGl4ZWxSYXRpbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGl4ZWxSYXRpbztcbiAgICB9XG4gICAgc2V0UGl4ZWxSYXRpbyhwaXhlbFJhdGlvKSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzUmF0aW8gPSB0aGlzLnBpeGVsUmF0aW87XG4gICAgICAgIHRoaXMucGl4ZWxSYXRpbyA9IHBpeGVsUmF0aW87XG4gICAgICAgIHRoaXMuc2V0U2l6ZSh0aGlzLmdldFdpZHRoKCkgLyBwcmV2aW91c1JhdGlvLCB0aGlzLmdldEhlaWdodCgpIC8gcHJldmlvdXNSYXRpbyk7XG4gICAgfVxuICAgIHNldFdpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLl9jYW52YXMud2lkdGggPSB3aWR0aCAqIHRoaXMucGl4ZWxSYXRpbztcbiAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgICBjb25zdCBwaXhlbFJhdGlvID0gdGhpcy5waXhlbFJhdGlvLCBfY29udGV4dCA9IHRoaXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0O1xuICAgICAgICBfY29udGV4dC5zY2FsZShwaXhlbFJhdGlvLCBwaXhlbFJhdGlvKTtcbiAgICB9XG4gICAgc2V0SGVpZ2h0KGhlaWdodCkge1xuICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuX2NhbnZhcy5oZWlnaHQgPSBoZWlnaHQgKiB0aGlzLnBpeGVsUmF0aW87XG4gICAgICAgIHRoaXMuX2NhbnZhcy5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuICAgICAgICBjb25zdCBwaXhlbFJhdGlvID0gdGhpcy5waXhlbFJhdGlvLCBfY29udGV4dCA9IHRoaXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0O1xuICAgICAgICBfY29udGV4dC5zY2FsZShwaXhlbFJhdGlvLCBwaXhlbFJhdGlvKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndpZHRoO1xuICAgIH1cbiAgICBnZXRIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhlaWdodDtcbiAgICB9XG4gICAgc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuc2V0V2lkdGgod2lkdGggfHwgMCk7XG4gICAgICAgIHRoaXMuc2V0SGVpZ2h0KGhlaWdodCB8fCAwKTtcbiAgICB9XG4gICAgdG9EYXRhVVJMKG1pbWVUeXBlLCBxdWFsaXR5KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FudmFzLnRvRGF0YVVSTChtaW1lVHlwZSwgcXVhbGl0eSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhbnZhcy50b0RhdGFVUkwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBVdGlsLmVycm9yKCdVbmFibGUgdG8gZ2V0IGRhdGEgVVJMLiAnICtcbiAgICAgICAgICAgICAgICAgICAgZXJyLm1lc3NhZ2UgK1xuICAgICAgICAgICAgICAgICAgICAnIEZvciBtb3JlIGluZm8gcmVhZCBodHRwczovL2tvbnZhanMub3JnL2RvY3MvcG9zdHMvVGFpbnRlZF9DYW52YXMuaHRtbC4nKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU2NlbmVDYW52YXMgZXh0ZW5kcyBDYW52YXMge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHsgd2lkdGg6IDAsIGhlaWdodDogMCwgd2lsbFJlYWRGcmVxdWVudGx5OiBmYWxzZSB9KSB7XG4gICAgICAgIHN1cGVyKGNvbmZpZyk7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IG5ldyBTY2VuZUNvbnRleHQodGhpcywge1xuICAgICAgICAgICAgd2lsbFJlYWRGcmVxdWVudGx5OiBjb25maWcud2lsbFJlYWRGcmVxdWVudGx5LFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTaXplKGNvbmZpZy53aWR0aCwgY29uZmlnLmhlaWdodCk7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNDYW52YXNGYXJibGluZ0FjdGl2ZSgpIHtcbiAgICBjb25zdCBjID0gVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG4gICAgYy53aWR0aCA9IDE7XG4gICAgYy5oZWlnaHQgPSAxO1xuICAgIGNvbnN0IGN0eCA9IGMuZ2V0Q29udGV4dCgnMmQnLCB7XG4gICAgICAgIHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSxcbiAgICB9KTtcbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIDEsIDEpO1xuICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgyNTUsMCwyNTUsMSknO1xuICAgIGN0eC5maWxsUmVjdCgwLCAwLCAxLCAxKTtcbiAgICBjb25zdCBkID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCAxLCAxKS5kYXRhO1xuICAgIGNvbnN0IGV4YWN0ID0gZFswXSA9PT0gMjU1ICYmIGRbMV0gPT09IDAgJiYgZFsyXSA9PT0gMjU1ICYmIGRbM10gPT09IDI1NTtcbiAgICByZXR1cm4gIWV4YWN0O1xufVxuZnVuY3Rpb24gaXNCcmF2ZUJyb3dzZXIoKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gKF9iID0gKF9hID0gbmF2aWdhdG9yLmJyYXZlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaXNCcmF2ZSgpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBmYWxzZTtcbn1cbmxldCB3YXJuZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIGNoZWNrSGl0Q2FudmFzU3VwcG9ydCgpIHtcbiAgICBpZiAoaXNCcmF2ZUJyb3dzZXIoKSAmJiBpc0NhbnZhc0ZhcmJsaW5nQWN0aXZlKCkgJiYgIXdhcm5lZCkge1xuICAgICAgICB3YXJuZWQgPSB0cnVlO1xuICAgICAgICBVdGlsLmVycm9yKCdMb29rcyBsaWtlIHlvdSBoYXZlIFwiQnJhdmUgc2hpZWxkXCIgZW5hYmxlZCBpbiB5b3VyIGJyb3dzZXIuIEl0IGJyZWFrcyBLb252YUpTIGludGVybmFscy4gUGxlYXNlIGRpc2FibGUgaXQuIFlvdSBtYXkgbmVlZCB0byBhc2sgeW91ciB1c2VycyB0byBkbyB0aGUgc2FtZS4nKTtcbiAgICB9XG4gICAgcmV0dXJuIGlzQnJhdmVCcm93c2VyKCkgJiYgaXNDYW52YXNGYXJibGluZ0FjdGl2ZSgpO1xufVxuZXhwb3J0IGNsYXNzIEhpdENhbnZhcyBleHRlbmRzIENhbnZhcyB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnID0geyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0pIHtcbiAgICAgICAgc3VwZXIoY29uZmlnKTtcbiAgICAgICAgdGhpcy5oaXRDYW52YXMgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBuZXcgSGl0Q29udGV4dCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRTaXplKGNvbmZpZy53aWR0aCwgY29uZmlnLmhlaWdodCk7XG4gICAgICAgIGNoZWNrSGl0Q2FudmFzU3VwcG9ydCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4vVmFsaWRhdG9ycy5qc1wiO1xuZXhwb3J0IGNsYXNzIENvbnRhaW5lciBleHRlbmRzIE5vZGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLmNoaWxkcmVuID0gW107XG4gICAgfVxuICAgIGdldENoaWxkcmVuKGZpbHRlckZ1bmMpIHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICBpZiAoZmlsdGVyRnVuYykge1xuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLmZpbHRlcihmaWx0ZXJGdW5jKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxuICAgIGhhc0NoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIHJlbW92ZUNoaWxkcmVuKCkge1xuICAgICAgICB0aGlzLmdldENoaWxkcmVuKCkuZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICAgIGNoaWxkLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICBjaGlsZC5pbmRleCA9IDA7XG4gICAgICAgICAgICBjaGlsZC5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdERyYXcoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRlc3Ryb3lDaGlsZHJlbigpIHtcbiAgICAgICAgdGhpcy5nZXRDaGlsZHJlbigpLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgY2hpbGQuaW5kZXggPSAwO1xuICAgICAgICAgICAgY2hpbGQuZGVzdHJveSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0RHJhdygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYWRkKC4uLmNoaWxkcmVuKSB7XG4gICAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGQoY2hpbGRyZW5baV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlblswXTtcbiAgICAgICAgaWYgKGNoaWxkLmdldFBhcmVudCgpKSB7XG4gICAgICAgICAgICBjaGlsZC5tb3ZlVG8odGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl92YWxpZGF0ZUFkZChjaGlsZCk7XG4gICAgICAgIGNoaWxkLmluZGV4ID0gdGhpcy5nZXRDaGlsZHJlbigpLmxlbmd0aDtcbiAgICAgICAgY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICAgICAgY2hpbGQuX2NsZWFyQ2FjaGVzKCk7XG4gICAgICAgIHRoaXMuZ2V0Q2hpbGRyZW4oKS5wdXNoKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fZmlyZSgnYWRkJywge1xuICAgICAgICAgICAgY2hpbGQ6IGNoaWxkLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdERyYXcoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveUNoaWxkcmVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZmluZChzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2VuZXJhbEZpbmQoc2VsZWN0b3IsIGZhbHNlKTtcbiAgICB9XG4gICAgZmluZE9uZShzZWxlY3Rvcikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9nZW5lcmFsRmluZChzZWxlY3RvciwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdFswXSA6IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgX2dlbmVyYWxGaW5kKHNlbGVjdG9yLCBmaW5kT25lKSB7XG4gICAgICAgIGNvbnN0IHJldEFyciA9IFtdO1xuICAgICAgICB0aGlzLl9kZXNjZW5kYW50cygobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsaWQgPSBub2RlLl9pc01hdGNoKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldEFyci5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbGlkICYmIGZpbmRPbmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXRBcnI7XG4gICAgfVxuICAgIF9kZXNjZW5kYW50cyhmbikge1xuICAgICAgICBsZXQgc2hvdWxkU3RvcCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuZ2V0Q2hpbGRyZW4oKTtcbiAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuICAgICAgICAgICAgc2hvdWxkU3RvcCA9IGZuKGNoaWxkKTtcbiAgICAgICAgICAgIGlmIChzaG91bGRTdG9wKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNoaWxkLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNob3VsZFN0b3AgPSBjaGlsZC5fZGVzY2VuZGFudHMoZm4pO1xuICAgICAgICAgICAgaWYgKHNob3VsZFN0b3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRvT2JqZWN0KCkge1xuICAgICAgICBjb25zdCBvYmogPSBOb2RlLnByb3RvdHlwZS50b09iamVjdC5jYWxsKHRoaXMpO1xuICAgICAgICBvYmouY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdGhpcy5nZXRDaGlsZHJlbigpLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICAgICAgICBvYmouY2hpbGRyZW4ucHVzaChjaGlsZC50b09iamVjdCgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIGlzQW5jZXN0b3JPZihub2RlKSB7XG4gICAgICAgIGxldCBwYXJlbnQgPSBub2RlLmdldFBhcmVudCgpO1xuICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgICBpZiAocGFyZW50Ll9pZCA9PT0gdGhpcy5faWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5nZXRQYXJlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNsb25lKG9iaikge1xuICAgICAgICBjb25zdCBub2RlID0gTm9kZS5wcm90b3R5cGUuY2xvbmUuY2FsbCh0aGlzLCBvYmopO1xuICAgICAgICB0aGlzLmdldENoaWxkcmVuKCkuZm9yRWFjaChmdW5jdGlvbiAobm8pIHtcbiAgICAgICAgICAgIG5vZGUuYWRkKG5vLmNsb25lKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuICAgIGdldEFsbEludGVyc2VjdGlvbnMocG9zKSB7XG4gICAgICAgIGNvbnN0IGFyciA9IFtdO1xuICAgICAgICB0aGlzLmZpbmQoJ1NoYXBlJykuZm9yRWFjaCgoc2hhcGUpID0+IHtcbiAgICAgICAgICAgIGlmIChzaGFwZS5pc1Zpc2libGUoKSAmJiBzaGFwZS5pbnRlcnNlY3RzKHBvcykpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaChzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXJyO1xuICAgIH1cbiAgICBfY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKGF0dHIpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBzdXBlci5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKGF0dHIpO1xuICAgICAgICBpZiAodGhpcy5pc0NhY2hlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgKF9hID0gdGhpcy5jaGlsZHJlbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG5vZGUuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShhdHRyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9zZXRDaGlsZHJlbkluZGljZXMoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5jaGlsZHJlbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBuKSB7XG4gICAgICAgICAgICBjaGlsZC5pbmRleCA9IG47XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0RHJhdygpO1xuICAgIH1cbiAgICBkcmF3U2NlbmUoY2FuLCB0b3AsIGJ1ZmZlckNhbnZhcykge1xuICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSwgY2FudmFzID0gY2FuIHx8IChsYXllciAmJiBsYXllci5nZXRDYW52YXMoKSksIGNvbnRleHQgPSBjYW52YXMgJiYgY2FudmFzLmdldENvbnRleHQoKSwgY2FjaGVkQ2FudmFzID0gdGhpcy5fZ2V0Q2FudmFzQ2FjaGUoKSwgY2FjaGVkU2NlbmVDYW52YXMgPSBjYWNoZWRDYW52YXMgJiYgY2FjaGVkQ2FudmFzLnNjZW5lO1xuICAgICAgICBjb25zdCBjYWNoaW5nID0gY2FudmFzICYmIGNhbnZhcy5pc0NhY2hlO1xuICAgICAgICBpZiAoIXRoaXMuaXNWaXNpYmxlKCkgJiYgIWNhY2hpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYWNoZWRTY2VuZUNhbnZhcykge1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBjb25zdCBtID0gdGhpcy5nZXRBYnNvbHV0ZVRyYW5zZm9ybSh0b3ApLmdldE1hdHJpeCgpO1xuICAgICAgICAgICAgY29udGV4dC50cmFuc2Zvcm0obVswXSwgbVsxXSwgbVsyXSwgbVszXSwgbVs0XSwgbVs1XSk7XG4gICAgICAgICAgICB0aGlzLl9kcmF3Q2FjaGVkU2NlbmVDYW52YXMoY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2RyYXdDaGlsZHJlbignZHJhd1NjZW5lJywgY2FudmFzLCB0b3AsIGJ1ZmZlckNhbnZhcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRyYXdIaXQoY2FuLCB0b3ApIHtcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZERyYXdIaXQodG9wKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyKCksIGNhbnZhcyA9IGNhbiB8fCAobGF5ZXIgJiYgbGF5ZXIuaGl0Q2FudmFzKSwgY29udGV4dCA9IGNhbnZhcyAmJiBjYW52YXMuZ2V0Q29udGV4dCgpLCBjYWNoZWRDYW52YXMgPSB0aGlzLl9nZXRDYW52YXNDYWNoZSgpLCBjYWNoZWRIaXRDYW52YXMgPSBjYWNoZWRDYW52YXMgJiYgY2FjaGVkQ2FudmFzLmhpdDtcbiAgICAgICAgaWYgKGNhY2hlZEhpdENhbnZhcykge1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBjb25zdCBtID0gdGhpcy5nZXRBYnNvbHV0ZVRyYW5zZm9ybSh0b3ApLmdldE1hdHJpeCgpO1xuICAgICAgICAgICAgY29udGV4dC50cmFuc2Zvcm0obVswXSwgbVsxXSwgbVsyXSwgbVszXSwgbVs0XSwgbVs1XSk7XG4gICAgICAgICAgICB0aGlzLl9kcmF3Q2FjaGVkSGl0Q2FudmFzKGNvbnRleHQpO1xuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9kcmF3Q2hpbGRyZW4oJ2RyYXdIaXQnLCBjYW52YXMsIHRvcCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIF9kcmF3Q2hpbGRyZW4oZHJhd01ldGhvZCwgY2FudmFzLCB0b3AsIGJ1ZmZlckNhbnZhcykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMgJiYgY2FudmFzLmdldENvbnRleHQoKSwgY2xpcFdpZHRoID0gdGhpcy5jbGlwV2lkdGgoKSwgY2xpcEhlaWdodCA9IHRoaXMuY2xpcEhlaWdodCgpLCBjbGlwRnVuYyA9IHRoaXMuY2xpcEZ1bmMoKSwgaGFzQ2xpcCA9ICh0eXBlb2YgY2xpcFdpZHRoID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgY2xpcEhlaWdodCA9PT0gJ251bWJlcicpIHx8XG4gICAgICAgICAgICBjbGlwRnVuYztcbiAgICAgICAgY29uc3Qgc2VsZkNhY2hlID0gdG9wID09PSB0aGlzO1xuICAgICAgICBpZiAoaGFzQ2xpcCkge1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCk7XG4gICAgICAgICAgICBsZXQgbSA9IHRyYW5zZm9ybS5nZXRNYXRyaXgoKTtcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKG1bMF0sIG1bMV0sIG1bMl0sIG1bM10sIG1bNF0sIG1bNV0pO1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGxldCBjbGlwQXJncztcbiAgICAgICAgICAgIGlmIChjbGlwRnVuYykge1xuICAgICAgICAgICAgICAgIGNsaXBBcmdzID0gY2xpcEZ1bmMuY2FsbCh0aGlzLCBjb250ZXh0LCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsaXBYID0gdGhpcy5jbGlwWCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsaXBZID0gdGhpcy5jbGlwWSgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdChjbGlwWCB8fCAwLCBjbGlwWSB8fCAwLCBjbGlwV2lkdGgsIGNsaXBIZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5jbGlwLmFwcGx5KGNvbnRleHQsIGNsaXBBcmdzKTtcbiAgICAgICAgICAgIG0gPSB0cmFuc2Zvcm0uY29weSgpLmludmVydCgpLmdldE1hdHJpeCgpO1xuICAgICAgICAgICAgY29udGV4dC50cmFuc2Zvcm0obVswXSwgbVsxXSwgbVsyXSwgbVszXSwgbVs0XSwgbVs1XSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzQ29tcG9zaXRpb24gPSAhc2VsZkNhY2hlICYmXG4gICAgICAgICAgICB0aGlzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbigpICE9PSAnc291cmNlLW92ZXInICYmXG4gICAgICAgICAgICBkcmF3TWV0aG9kID09PSAnZHJhd1NjZW5lJztcbiAgICAgICAgaWYgKGhhc0NvbXBvc2l0aW9uKSB7XG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIGNvbnRleHQuX2FwcGx5R2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IHRoaXMuY2hpbGRyZW4pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGRbZHJhd01ldGhvZF0oY2FudmFzLCB0b3AsIGJ1ZmZlckNhbnZhcyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaGFzQ29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNDbGlwKSB7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRDbGllbnRSZWN0KGNvbmZpZyA9IHt9KSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3Qgc2tpcFRyYW5zZm9ybSA9IGNvbmZpZy5za2lwVHJhbnNmb3JtO1xuICAgICAgICBjb25zdCByZWxhdGl2ZVRvID0gY29uZmlnLnJlbGF0aXZlVG87XG4gICAgICAgIGxldCBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZO1xuICAgICAgICBsZXQgc2VsZlJlY3QgPSB7XG4gICAgICAgICAgICB4OiBJbmZpbml0eSxcbiAgICAgICAgICAgIHk6IEluZmluaXR5LFxuICAgICAgICAgICAgd2lkdGg6IDAsXG4gICAgICAgICAgICBoZWlnaHQ6IDAsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgICAgICAoX2EgPSB0aGlzLmNoaWxkcmVuKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmICghY2hpbGQudmlzaWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVjdCA9IGNoaWxkLmdldENsaWVudFJlY3Qoe1xuICAgICAgICAgICAgICAgIHJlbGF0aXZlVG86IHRoYXQsXG4gICAgICAgICAgICAgICAgc2tpcFNoYWRvdzogY29uZmlnLnNraXBTaGFkb3csXG4gICAgICAgICAgICAgICAgc2tpcFN0cm9rZTogY29uZmlnLnNraXBTdHJva2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWN0LndpZHRoID09PSAwICYmIHJlY3QuaGVpZ2h0ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1pblggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG1pblggPSByZWN0Lng7XG4gICAgICAgICAgICAgICAgbWluWSA9IHJlY3QueTtcbiAgICAgICAgICAgICAgICBtYXhYID0gcmVjdC54ICsgcmVjdC53aWR0aDtcbiAgICAgICAgICAgICAgICBtYXhZID0gcmVjdC55ICsgcmVjdC5oZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgcmVjdC54KTtcbiAgICAgICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgcmVjdC55KTtcbiAgICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgcmVjdC54ICsgcmVjdC53aWR0aCk7XG4gICAgICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHJlY3QueSArIHJlY3QuaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuZmluZCgnU2hhcGUnKTtcbiAgICAgICAgbGV0IGhhc1Zpc2libGUgPSBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGFwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldO1xuICAgICAgICAgICAgaWYgKHNoYXBlLl9pc1Zpc2libGUodGhpcykpIHtcbiAgICAgICAgICAgICAgICBoYXNWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzVmlzaWJsZSAmJiBtaW5YICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGZSZWN0ID0ge1xuICAgICAgICAgICAgICAgIHg6IG1pblgsXG4gICAgICAgICAgICAgICAgeTogbWluWSxcbiAgICAgICAgICAgICAgICB3aWR0aDogbWF4WCAtIG1pblgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBtYXhZIC0gbWluWSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmUmVjdCA9IHtcbiAgICAgICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNraXBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmFuc2Zvcm1lZFJlY3Qoc2VsZlJlY3QsIHJlbGF0aXZlVG8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxmUmVjdDtcbiAgICB9XG59XG5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoQ29udGFpbmVyLCAnY2xpcCcsIFtcbiAgICAneCcsXG4gICAgJ3knLFxuICAgICd3aWR0aCcsXG4gICAgJ2hlaWdodCcsXG5dKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKENvbnRhaW5lciwgJ2NsaXBYJywgdW5kZWZpbmVkLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihDb250YWluZXIsICdjbGlwWScsIHVuZGVmaW5lZCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoQ29udGFpbmVyLCAnY2xpcFdpZHRoJywgdW5kZWZpbmVkLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihDb250YWluZXIsICdjbGlwSGVpZ2h0JywgdW5kZWZpbmVkLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihDb250YWluZXIsICdjbGlwRnVuYycpO1xuIiwiaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuL1V0aWwuanNcIjtcbmltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5mdW5jdGlvbiBzaW1wbGlmeUFycmF5KGFycikge1xuICAgIGNvbnN0IHJldEFyciA9IFtdLCBsZW4gPSBhcnIubGVuZ3RoLCB1dGlsID0gVXRpbDtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgIGxldCB2YWwgPSBhcnJbbl07XG4gICAgICAgIGlmICh1dGlsLl9pc051bWJlcih2YWwpKSB7XG4gICAgICAgICAgICB2YWwgPSBNYXRoLnJvdW5kKHZhbCAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdXRpbC5faXNTdHJpbmcodmFsKSkge1xuICAgICAgICAgICAgdmFsID0gdmFsICsgJyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0QXJyLnB1c2godmFsKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldEFycjtcbn1cbmNvbnN0IENPTU1BID0gJywnLCBPUEVOX1BBUkVOID0gJygnLCBDTE9TRV9QQVJFTiA9ICcpJywgT1BFTl9QQVJFTl9CUkFDS0VUID0gJyhbJywgQ0xPU0VfQlJBQ0tFVF9QQVJFTiA9ICddKScsIFNFTUlDT0xPTiA9ICc7JywgRE9VQkxFX1BBUkVOID0gJygpJywgRVFVQUxTID0gJz0nLCBDT05URVhUX01FVEhPRFMgPSBbXG4gICAgJ2FyYycsXG4gICAgJ2FyY1RvJyxcbiAgICAnYmVnaW5QYXRoJyxcbiAgICAnYmV6aWVyQ3VydmVUbycsXG4gICAgJ2NsZWFyUmVjdCcsXG4gICAgJ2NsaXAnLFxuICAgICdjbG9zZVBhdGgnLFxuICAgICdjcmVhdGVMaW5lYXJHcmFkaWVudCcsXG4gICAgJ2NyZWF0ZVBhdHRlcm4nLFxuICAgICdjcmVhdGVSYWRpYWxHcmFkaWVudCcsXG4gICAgJ2RyYXdJbWFnZScsXG4gICAgJ2VsbGlwc2UnLFxuICAgICdmaWxsJyxcbiAgICAnZmlsbFRleHQnLFxuICAgICdnZXRJbWFnZURhdGEnLFxuICAgICdjcmVhdGVJbWFnZURhdGEnLFxuICAgICdsaW5lVG8nLFxuICAgICdtb3ZlVG8nLFxuICAgICdwdXRJbWFnZURhdGEnLFxuICAgICdxdWFkcmF0aWNDdXJ2ZVRvJyxcbiAgICAncmVjdCcsXG4gICAgJ3JvdW5kUmVjdCcsXG4gICAgJ3Jlc3RvcmUnLFxuICAgICdyb3RhdGUnLFxuICAgICdzYXZlJyxcbiAgICAnc2NhbGUnLFxuICAgICdzZXRMaW5lRGFzaCcsXG4gICAgJ3NldFRyYW5zZm9ybScsXG4gICAgJ3N0cm9rZScsXG4gICAgJ3N0cm9rZVRleHQnLFxuICAgICd0cmFuc2Zvcm0nLFxuICAgICd0cmFuc2xhdGUnLFxuXTtcbmNvbnN0IENPTlRFWFRfUFJPUEVSVElFUyA9IFtcbiAgICAnZmlsbFN0eWxlJyxcbiAgICAnc3Ryb2tlU3R5bGUnLFxuICAgICdzaGFkb3dDb2xvcicsXG4gICAgJ3NoYWRvd0JsdXInLFxuICAgICdzaGFkb3dPZmZzZXRYJyxcbiAgICAnc2hhZG93T2Zmc2V0WScsXG4gICAgJ2xldHRlclNwYWNpbmcnLFxuICAgICdsaW5lQ2FwJyxcbiAgICAnbGluZURhc2hPZmZzZXQnLFxuICAgICdsaW5lSm9pbicsXG4gICAgJ2xpbmVXaWR0aCcsXG4gICAgJ21pdGVyTGltaXQnLFxuICAgICdkaXJlY3Rpb24nLFxuICAgICdmb250JyxcbiAgICAndGV4dEFsaWduJyxcbiAgICAndGV4dEJhc2VsaW5lJyxcbiAgICAnZ2xvYmFsQWxwaGEnLFxuICAgICdnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24nLFxuICAgICdpbWFnZVNtb290aGluZ0VuYWJsZWQnLFxuICAgICdmaWx0ZXInLFxuXTtcbmNvbnN0IHRyYWNlQXJyTWF4ID0gMTAwO1xubGV0IF9jc3NGaWx0ZXJzU3VwcG9ydGVkID0gbnVsbDtcbmV4cG9ydCBmdW5jdGlvbiBpc0NTU0ZpbHRlcnNTdXBwb3J0ZWQoKSB7XG4gICAgaWYgKF9jc3NGaWx0ZXJzU3VwcG9ydGVkICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBfY3NzRmlsdGVyc1N1cHBvcnRlZDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY2FudmFzID0gVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG4gICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBpZiAoIWN0eCkge1xuICAgICAgICAgICAgX2Nzc0ZpbHRlcnNTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gISFjdHggJiYgJ2ZpbHRlcicgaW4gY3R4O1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBfY3NzRmlsdGVyc1N1cHBvcnRlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKGNhbnZhcykge1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgaWYgKEtvbnZhLmVuYWJsZVRyYWNlKSB7XG4gICAgICAgICAgICB0aGlzLnRyYWNlQXJyID0gW107XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVUcmFjZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpbGxTaGFwZShzaGFwZSkge1xuICAgICAgICBpZiAoc2hhcGUuZmlsbEVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5fZmlsbChzaGFwZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZpbGwoc2hhcGUpIHtcbiAgICB9XG4gICAgc3Ryb2tlU2hhcGUoc2hhcGUpIHtcbiAgICAgICAgaWYgKHNoYXBlLmhhc1N0cm9rZSgpKSB7XG4gICAgICAgICAgICB0aGlzLl9zdHJva2Uoc2hhcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zdHJva2Uoc2hhcGUpIHtcbiAgICB9XG4gICAgZmlsbFN0cm9rZVNoYXBlKHNoYXBlKSB7XG4gICAgICAgIGlmIChzaGFwZS5hdHRycy5maWxsQWZ0ZXJTdHJva2VFbmFibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0cm9rZVNoYXBlKHNoYXBlKTtcbiAgICAgICAgICAgIHRoaXMuZmlsbFNoYXBlKHNoYXBlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmlsbFNoYXBlKHNoYXBlKTtcbiAgICAgICAgICAgIHRoaXMuc3Ryb2tlU2hhcGUoc2hhcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFRyYWNlKHJlbGF4ZWQsIHJvdW5kZWQpIHtcbiAgICAgICAgbGV0IHRyYWNlQXJyID0gdGhpcy50cmFjZUFyciwgbGVuID0gdHJhY2VBcnIubGVuZ3RoLCBzdHIgPSAnJywgbiwgdHJhY2UsIG1ldGhvZCwgYXJncztcbiAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICB0cmFjZSA9IHRyYWNlQXJyW25dO1xuICAgICAgICAgICAgbWV0aG9kID0gdHJhY2UubWV0aG9kO1xuICAgICAgICAgICAgaWYgKG1ldGhvZCkge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSB0cmFjZS5hcmdzO1xuICAgICAgICAgICAgICAgIHN0ciArPSBtZXRob2Q7XG4gICAgICAgICAgICAgICAgaWYgKHJlbGF4ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9IERPVUJMRV9QQVJFTjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChVdGlsLl9pc0FycmF5KGFyZ3NbMF0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gT1BFTl9QQVJFTl9CUkFDS0VUICsgYXJncy5qb2luKENPTU1BKSArIENMT1NFX0JSQUNLRVRfUEFSRU47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocm91bmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBhcmdzLm1hcCgoYSkgPT4gdHlwZW9mIGEgPT09ICdudW1iZXInID8gTWF0aC5mbG9vcihhKSA6IGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IE9QRU5fUEFSRU4gKyBhcmdzLmpvaW4oQ09NTUEpICsgQ0xPU0VfUEFSRU47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gdHJhY2UucHJvcGVydHk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWxheGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSBFUVVBTFMgKyB0cmFjZS52YWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RyICs9IFNFTUlDT0xPTjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgICBjbGVhclRyYWNlKCkge1xuICAgICAgICB0aGlzLnRyYWNlQXJyID0gW107XG4gICAgfVxuICAgIF90cmFjZShzdHIpIHtcbiAgICAgICAgbGV0IHRyYWNlQXJyID0gdGhpcy50cmFjZUFyciwgbGVuO1xuICAgICAgICB0cmFjZUFyci5wdXNoKHN0cik7XG4gICAgICAgIGxlbiA9IHRyYWNlQXJyLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA+PSB0cmFjZUFyck1heCkge1xuICAgICAgICAgICAgdHJhY2VBcnIuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXNldCgpIHtcbiAgICAgICAgY29uc3QgcGl4ZWxSYXRpbyA9IHRoaXMuZ2V0Q2FudmFzKCkuZ2V0UGl4ZWxSYXRpbygpO1xuICAgICAgICB0aGlzLnNldFRyYW5zZm9ybSgxICogcGl4ZWxSYXRpbywgMCwgMCwgMSAqIHBpeGVsUmF0aW8sIDAsIDApO1xuICAgIH1cbiAgICBnZXRDYW52YXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcbiAgICB9XG4gICAgY2xlYXIoYm91bmRzKSB7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzKCk7XG4gICAgICAgIGlmIChib3VuZHMpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJSZWN0KGJvdW5kcy54IHx8IDAsIGJvdW5kcy55IHx8IDAsIGJvdW5kcy53aWR0aCB8fCAwLCBib3VuZHMuaGVpZ2h0IHx8IDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbGVhclJlY3QoMCwgMCwgY2FudmFzLmdldFdpZHRoKCkgLyBjYW52YXMucGl4ZWxSYXRpbywgY2FudmFzLmdldEhlaWdodCgpIC8gY2FudmFzLnBpeGVsUmF0aW8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9hcHBseUxpbmVDYXAoc2hhcGUpIHtcbiAgICAgICAgY29uc3QgbGluZUNhcCA9IHNoYXBlLmF0dHJzLmxpbmVDYXA7XG4gICAgICAgIGlmIChsaW5lQ2FwKSB7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ2xpbmVDYXAnLCBsaW5lQ2FwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfYXBwbHlPcGFjaXR5KHNoYXBlKSB7XG4gICAgICAgIGNvbnN0IGFic09wYWNpdHkgPSBzaGFwZS5nZXRBYnNvbHV0ZU9wYWNpdHkoKTtcbiAgICAgICAgaWYgKGFic09wYWNpdHkgIT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignZ2xvYmFsQWxwaGEnLCBhYnNPcGFjaXR5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfYXBwbHlMaW5lSm9pbihzaGFwZSkge1xuICAgICAgICBjb25zdCBsaW5lSm9pbiA9IHNoYXBlLmF0dHJzLmxpbmVKb2luO1xuICAgICAgICBpZiAobGluZUpvaW4pIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignbGluZUpvaW4nLCBsaW5lSm9pbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FwcGx5TWl0ZXJMaW1pdChzaGFwZSkge1xuICAgICAgICBjb25zdCBtaXRlckxpbWl0ID0gc2hhcGUuYXR0cnMubWl0ZXJMaW1pdDtcbiAgICAgICAgaWYgKG1pdGVyTGltaXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdtaXRlckxpbWl0JywgbWl0ZXJMaW1pdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0QXR0cihhdHRyLCB2YWwpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dFthdHRyXSA9IHZhbDtcbiAgICB9XG4gICAgYXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGNvdW50ZXJDbG9ja3dpc2UpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgY291bnRlckNsb2Nrd2lzZSk7XG4gICAgfVxuICAgIGFyY1RvKHgxLCB5MSwgeDIsIHkyLCByYWRpdXMpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5hcmNUbyh4MSwgeTEsIHgyLCB5MiwgcmFkaXVzKTtcbiAgICB9XG4gICAgYmVnaW5QYXRoKCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIH1cbiAgICBiZXppZXJDdXJ2ZVRvKGNwMXgsIGNwMXksIGNwMngsIGNwMnksIHgsIHkpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5iZXppZXJDdXJ2ZVRvKGNwMXgsIGNwMXksIGNwMngsIGNwMnksIHgsIHkpO1xuICAgIH1cbiAgICBjbGVhclJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LmNsZWFyUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgY2xpcCguLi5hcmdzKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuY2xpcC5hcHBseSh0aGlzLl9jb250ZXh0LCBhcmdzKTtcbiAgICB9XG4gICAgY2xvc2VQYXRoKCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgIH1cbiAgICBjcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCkge1xuICAgICAgICBjb25zdCBhID0gYXJndW1lbnRzO1xuICAgICAgICBpZiAoYS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUltYWdlRGF0YSh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlSW1hZ2VEYXRhKHdpZHRoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVMaW5lYXJHcmFkaWVudCh4MCwgeTAsIHgxLCB5MSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCh4MCwgeTAsIHgxLCB5MSk7XG4gICAgfVxuICAgIGNyZWF0ZVBhdHRlcm4oaW1hZ2UsIHJlcGV0aXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlUGF0dGVybihpbWFnZSwgcmVwZXRpdGlvbik7XG4gICAgfVxuICAgIGNyZWF0ZVJhZGlhbEdyYWRpZW50KHgwLCB5MCwgcjAsIHgxLCB5MSwgcjEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlUmFkaWFsR3JhZGllbnQoeDAsIHkwLCByMCwgeDEsIHkxLCByMSk7XG4gICAgfVxuICAgIGRyYXdJbWFnZShpbWFnZSwgc3gsIHN5LCBzV2lkdGgsIHNIZWlnaHQsIGR4LCBkeSwgZFdpZHRoLCBkSGVpZ2h0KSB7XG4gICAgICAgIGNvbnN0IGEgPSBhcmd1bWVudHMsIF9jb250ZXh0ID0gdGhpcy5fY29udGV4dDtcbiAgICAgICAgaWYgKGEubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICBfY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIHN4LCBzeSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYS5sZW5ndGggPT09IDUpIHtcbiAgICAgICAgICAgIF9jb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgc3gsIHN5LCBzV2lkdGgsIHNIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGEubGVuZ3RoID09PSA5KSB7XG4gICAgICAgICAgICBfY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIHN4LCBzeSwgc1dpZHRoLCBzSGVpZ2h0LCBkeCwgZHksIGRXaWR0aCwgZEhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxsaXBzZSh4LCB5LCByYWRpdXNYLCByYWRpdXNZLCByb3RhdGlvbiwgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGNvdW50ZXJjbG9ja3dpc2UpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5lbGxpcHNlKHgsIHksIHJhZGl1c1gsIHJhZGl1c1ksIHJvdGF0aW9uLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgY291bnRlcmNsb2Nrd2lzZSk7XG4gICAgfVxuICAgIGlzUG9pbnRJblBhdGgoeCwgeSwgcGF0aCwgZmlsbFJ1bGUpIHtcbiAgICAgICAgaWYgKHBhdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmlzUG9pbnRJblBhdGgocGF0aCwgeCwgeSwgZmlsbFJ1bGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmlzUG9pbnRJblBhdGgoeCwgeSwgZmlsbFJ1bGUpO1xuICAgIH1cbiAgICBmaWxsKC4uLmFyZ3MpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5maWxsLmFwcGx5KHRoaXMuX2NvbnRleHQsIGFyZ3MpO1xuICAgIH1cbiAgICBmaWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuZmlsbFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIHN0cm9rZVJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZVJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGZpbGxUZXh0KHRleHQsIHgsIHksIG1heFdpZHRoKSB7XG4gICAgICAgIGlmIChtYXhXaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5maWxsVGV4dCh0ZXh0LCB4LCB5LCBtYXhXaWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LmZpbGxUZXh0KHRleHQsIHgsIHkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1lYXN1cmVUZXh0KHRleHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQubWVhc3VyZVRleHQodGV4dCk7XG4gICAgfVxuICAgIGdldEltYWdlRGF0YShzeCwgc3ksIHN3LCBzaCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5nZXRJbWFnZURhdGEoc3gsIHN5LCBzdywgc2gpO1xuICAgIH1cbiAgICBsaW5lVG8oeCwgeSkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyh4LCB5KTtcbiAgICB9XG4gICAgbW92ZVRvKHgsIHkpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5tb3ZlVG8oeCwgeSk7XG4gICAgfVxuICAgIHJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIHJvdW5kUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0LCByYWRpaSkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnJvdW5kUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0LCByYWRpaSk7XG4gICAgfVxuICAgIHB1dEltYWdlRGF0YShpbWFnZURhdGEsIGR4LCBkeSkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIGR4LCBkeSk7XG4gICAgfVxuICAgIHF1YWRyYXRpY0N1cnZlVG8oY3B4LCBjcHksIHgsIHkpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKGNweCwgY3B5LCB4LCB5KTtcbiAgICB9XG4gICAgcmVzdG9yZSgpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5yZXN0b3JlKCk7XG4gICAgfVxuICAgIHJvdGF0ZShhbmdsZSkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnJvdGF0ZShhbmdsZSk7XG4gICAgfVxuICAgIHNhdmUoKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuc2F2ZSgpO1xuICAgIH1cbiAgICBzY2FsZSh4LCB5KSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuc2NhbGUoeCwgeSk7XG4gICAgfVxuICAgIHNldExpbmVEYXNoKHNlZ21lbnRzKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0LnNldExpbmVEYXNoKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnNldExpbmVEYXNoKHNlZ21lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgnbW96RGFzaCcgaW4gdGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dFsnbW96RGFzaCddID0gc2VnbWVudHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoJ3dlYmtpdExpbmVEYXNoJyBpbiB0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0Wyd3ZWJraXRMaW5lRGFzaCddID0gc2VnbWVudHM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0TGluZURhc2goKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmdldExpbmVEYXNoKCk7XG4gICAgfVxuICAgIHNldFRyYW5zZm9ybShhLCBiLCBjLCBkLCBlLCBmKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuc2V0VHJhbnNmb3JtKGEsIGIsIGMsIGQsIGUsIGYpO1xuICAgIH1cbiAgICBzdHJva2UocGF0aDJkKSB7XG4gICAgICAgIGlmIChwYXRoMmQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlKHBhdGgyZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cm9rZVRleHQodGV4dCwgeCwgeSwgbWF4V2lkdGgpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VUZXh0KHRleHQsIHgsIHksIG1heFdpZHRoKTtcbiAgICB9XG4gICAgdHJhbnNmb3JtKGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgICAgICAgdGhpcy5fY29udGV4dC50cmFuc2Zvcm0oYSwgYiwgYywgZCwgZSwgZik7XG4gICAgfVxuICAgIHRyYW5zbGF0ZSh4LCB5KSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQudHJhbnNsYXRlKHgsIHkpO1xuICAgIH1cbiAgICBfZW5hYmxlVHJhY2UoKSB7XG4gICAgICAgIGxldCB0aGF0ID0gdGhpcywgbGVuID0gQ09OVEVYVF9NRVRIT0RTLmxlbmd0aCwgb3JpZ1NldHRlciA9IHRoaXMuc2V0QXR0ciwgbiwgYXJncztcbiAgICAgICAgY29uc3QgZnVuYyA9IGZ1bmN0aW9uIChtZXRob2ROYW1lKSB7XG4gICAgICAgICAgICBsZXQgb3JpZ01ldGhvZCA9IHRoYXRbbWV0aG9kTmFtZV0sIHJldDtcbiAgICAgICAgICAgIHRoYXRbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXJncyA9IHNpbXBsaWZ5QXJyYXkoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgICAgICAgICAgICAgcmV0ID0gb3JpZ01ldGhvZC5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIHRoYXQuX3RyYWNlKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2ROYW1lLFxuICAgICAgICAgICAgICAgICAgICBhcmdzOiBhcmdzLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGZ1bmMoQ09OVEVYVF9NRVRIT0RTW25dKTtcbiAgICAgICAgfVxuICAgICAgICB0aGF0LnNldEF0dHIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBvcmlnU2V0dGVyLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgbGV0IHZhbCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnc2hhZG93T2Zmc2V0WCcgfHxcbiAgICAgICAgICAgICAgICBwcm9wID09PSAnc2hhZG93T2Zmc2V0WScgfHxcbiAgICAgICAgICAgICAgICBwcm9wID09PSAnc2hhZG93Qmx1cicpIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWwgLyB0aGlzLmNhbnZhcy5nZXRQaXhlbFJhdGlvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGF0Ll90cmFjZSh7XG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3AsXG4gICAgICAgICAgICAgICAgdmFsOiB2YWwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2FwcGx5R2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKG5vZGUpIHtcbiAgICAgICAgY29uc3Qgb3AgPSBub2RlLmF0dHJzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjtcbiAgICAgICAgY29uc3QgZGVmID0gIW9wIHx8IG9wID09PSAnc291cmNlLW92ZXInO1xuICAgICAgICBpZiAoIWRlZikge1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24nLCBvcCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5DT05URVhUX1BST1BFUlRJRVMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250ZXh0LnByb3RvdHlwZSwgcHJvcCwge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dFtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0KHZhbCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dFtwcm9wXSA9IHZhbDtcbiAgICAgICAgfSxcbiAgICB9KTtcbn0pO1xuZXhwb3J0IGNsYXNzIFNjZW5lQ29udGV4dCBleHRlbmRzIENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKGNhbnZhcywgeyB3aWxsUmVhZEZyZXF1ZW50bHkgPSBmYWxzZSB9ID0ge30pIHtcbiAgICAgICAgc3VwZXIoY2FudmFzKTtcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IGNhbnZhcy5fY2FudmFzLmdldENvbnRleHQoJzJkJywge1xuICAgICAgICAgICAgd2lsbFJlYWRGcmVxdWVudGx5LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgX2ZpbGxDb2xvcihzaGFwZSkge1xuICAgICAgICBjb25zdCBmaWxsID0gc2hhcGUuZmlsbCgpO1xuICAgICAgICB0aGlzLnNldEF0dHIoJ2ZpbGxTdHlsZScsIGZpbGwpO1xuICAgICAgICBzaGFwZS5fZmlsbEZ1bmModGhpcyk7XG4gICAgfVxuICAgIF9maWxsUGF0dGVybihzaGFwZSkge1xuICAgICAgICB0aGlzLnNldEF0dHIoJ2ZpbGxTdHlsZScsIHNoYXBlLl9nZXRGaWxsUGF0dGVybigpKTtcbiAgICAgICAgc2hhcGUuX2ZpbGxGdW5jKHRoaXMpO1xuICAgIH1cbiAgICBfZmlsbExpbmVhckdyYWRpZW50KHNoYXBlKSB7XG4gICAgICAgIGNvbnN0IGdyZCA9IHNoYXBlLl9nZXRMaW5lYXJHcmFkaWVudCgpO1xuICAgICAgICBpZiAoZ3JkKSB7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ2ZpbGxTdHlsZScsIGdyZCk7XG4gICAgICAgICAgICBzaGFwZS5fZmlsbEZ1bmModGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZpbGxSYWRpYWxHcmFkaWVudChzaGFwZSkge1xuICAgICAgICBjb25zdCBncmQgPSBzaGFwZS5fZ2V0UmFkaWFsR3JhZGllbnQoKTtcbiAgICAgICAgaWYgKGdyZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdmaWxsU3R5bGUnLCBncmQpO1xuICAgICAgICAgICAgc2hhcGUuX2ZpbGxGdW5jKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9maWxsKHNoYXBlKSB7XG4gICAgICAgIGNvbnN0IGhhc0NvbG9yID0gc2hhcGUuZmlsbCgpLCBmaWxsUHJpb3JpdHkgPSBzaGFwZS5nZXRGaWxsUHJpb3JpdHkoKTtcbiAgICAgICAgaWYgKGhhc0NvbG9yICYmIGZpbGxQcmlvcml0eSA9PT0gJ2NvbG9yJykge1xuICAgICAgICAgICAgdGhpcy5fZmlsbENvbG9yKHNoYXBlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNQYXR0ZXJuID0gc2hhcGUuZ2V0RmlsbFBhdHRlcm5JbWFnZSgpO1xuICAgICAgICBpZiAoaGFzUGF0dGVybiAmJiBmaWxsUHJpb3JpdHkgPT09ICdwYXR0ZXJuJykge1xuICAgICAgICAgICAgdGhpcy5fZmlsbFBhdHRlcm4oc2hhcGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhhc0xpbmVhckdyYWRpZW50ID0gc2hhcGUuZ2V0RmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wcygpO1xuICAgICAgICBpZiAoaGFzTGluZWFyR3JhZGllbnQgJiYgZmlsbFByaW9yaXR5ID09PSAnbGluZWFyLWdyYWRpZW50Jykge1xuICAgICAgICAgICAgdGhpcy5fZmlsbExpbmVhckdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNSYWRpYWxHcmFkaWVudCA9IHNoYXBlLmdldEZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHMoKTtcbiAgICAgICAgaWYgKGhhc1JhZGlhbEdyYWRpZW50ICYmIGZpbGxQcmlvcml0eSA9PT0gJ3JhZGlhbC1ncmFkaWVudCcpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbGxSYWRpYWxHcmFkaWVudChzaGFwZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc0NvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLl9maWxsQ29sb3Ioc2hhcGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGhhc1BhdHRlcm4pIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbGxQYXR0ZXJuKHNoYXBlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChoYXNMaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgdGhpcy5fZmlsbExpbmVhckdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChoYXNSYWRpYWxHcmFkaWVudCkge1xuICAgICAgICAgICAgdGhpcy5fZmlsbFJhZGlhbEdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc3Ryb2tlTGluZWFyR3JhZGllbnQoc2hhcGUpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBzaGFwZS5nZXRTdHJva2VMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnQoKSwgZW5kID0gc2hhcGUuZ2V0U3Ryb2tlTGluZWFyR3JhZGllbnRFbmRQb2ludCgpLCBjb2xvclN0b3BzID0gc2hhcGUuZ2V0U3Ryb2tlTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKCksIGdyZCA9IHRoaXMuY3JlYXRlTGluZWFyR3JhZGllbnQoc3RhcnQueCwgc3RhcnQueSwgZW5kLngsIGVuZC55KTtcbiAgICAgICAgaWYgKGNvbG9yU3RvcHMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgY29sb3JTdG9wcy5sZW5ndGg7IG4gKz0gMikge1xuICAgICAgICAgICAgICAgIGdyZC5hZGRDb2xvclN0b3AoY29sb3JTdG9wc1tuXSwgY29sb3JTdG9wc1tuICsgMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdzdHJva2VTdHlsZScsIGdyZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3N0cm9rZShzaGFwZSkge1xuICAgICAgICBjb25zdCBkYXNoID0gc2hhcGUuZGFzaCgpLCBzdHJva2VTY2FsZUVuYWJsZWQgPSBzaGFwZS5nZXRTdHJva2VTY2FsZUVuYWJsZWQoKTtcbiAgICAgICAgaWYgKHNoYXBlLmhhc1N0cm9rZSgpKSB7XG4gICAgICAgICAgICBpZiAoIXN0cm9rZVNjYWxlRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBpeGVsUmF0aW8gPSB0aGlzLmdldENhbnZhcygpLmdldFBpeGVsUmF0aW8oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zZm9ybShwaXhlbFJhdGlvLCAwLCAwLCBwaXhlbFJhdGlvLCAwLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2FwcGx5TGluZUNhcChzaGFwZSk7XG4gICAgICAgICAgICBpZiAoZGFzaCAmJiBzaGFwZS5kYXNoRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMaW5lRGFzaChkYXNoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHIoJ2xpbmVEYXNoT2Zmc2V0Jywgc2hhcGUuZGFzaE9mZnNldCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignbGluZVdpZHRoJywgc2hhcGUuc3Ryb2tlV2lkdGgoKSk7XG4gICAgICAgICAgICBpZiAoIXNoYXBlLmdldFNoYWRvd0ZvclN0cm9rZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignc2hhZG93Q29sb3InLCAncmdiYSgwLDAsMCwwKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGFzTGluZWFyR3JhZGllbnQgPSBzaGFwZS5nZXRTdHJva2VMaW5lYXJHcmFkaWVudENvbG9yU3RvcHMoKTtcbiAgICAgICAgICAgIGlmIChoYXNMaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0cm9rZUxpbmVhckdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignc3Ryb2tlU3R5bGUnLCBzaGFwZS5zdHJva2UoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaGFwZS5fc3Ryb2tlRnVuYyh0aGlzKTtcbiAgICAgICAgICAgIGlmICghc3Ryb2tlU2NhbGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FwcGx5U2hhZG93KHNoYXBlKSB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jO1xuICAgICAgICBjb25zdCBjb2xvciA9IChfYSA9IHNoYXBlLmdldFNoYWRvd1JHQkEoKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogJ2JsYWNrJywgYmx1ciA9IChfYiA9IHNoYXBlLmdldFNoYWRvd0JsdXIoKSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogNSwgb2Zmc2V0ID0gKF9jID0gc2hhcGUuZ2V0U2hhZG93T2Zmc2V0KCkpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IHtcbiAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICB5OiAwLFxuICAgICAgICB9LCBzY2FsZSA9IHNoYXBlLmdldEFic29sdXRlU2NhbGUoKSwgcmF0aW8gPSB0aGlzLmNhbnZhcy5nZXRQaXhlbFJhdGlvKCksIHNjYWxlWCA9IHNjYWxlLnggKiByYXRpbywgc2NhbGVZID0gc2NhbGUueSAqIHJhdGlvO1xuICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd0NvbG9yJywgY29sb3IpO1xuICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd0JsdXInLCBibHVyICogTWF0aC5taW4oTWF0aC5hYnMoc2NhbGVYKSwgTWF0aC5hYnMoc2NhbGVZKSkpO1xuICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd09mZnNldFgnLCBvZmZzZXQueCAqIHNjYWxlWCk7XG4gICAgICAgIHRoaXMuc2V0QXR0cignc2hhZG93T2Zmc2V0WScsIG9mZnNldC55ICogc2NhbGVZKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgSGl0Q29udGV4dCBleHRlbmRzIENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKGNhbnZhcykge1xuICAgICAgICBzdXBlcihjYW52YXMpO1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gY2FudmFzLl9jYW52YXMuZ2V0Q29udGV4dCgnMmQnLCB7XG4gICAgICAgICAgICB3aWxsUmVhZEZyZXF1ZW50bHk6IHRydWUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZmlsbChzaGFwZSkge1xuICAgICAgICB0aGlzLnNhdmUoKTtcbiAgICAgICAgdGhpcy5zZXRBdHRyKCdmaWxsU3R5bGUnLCBzaGFwZS5jb2xvcktleSk7XG4gICAgICAgIHNoYXBlLl9maWxsRnVuY0hpdCh0aGlzKTtcbiAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgfVxuICAgIHN0cm9rZVNoYXBlKHNoYXBlKSB7XG4gICAgICAgIGlmIChzaGFwZS5oYXNIaXRTdHJva2UoKSkge1xuICAgICAgICAgICAgdGhpcy5fc3Ryb2tlKHNoYXBlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc3Ryb2tlKHNoYXBlKSB7XG4gICAgICAgIGlmIChzaGFwZS5oYXNIaXRTdHJva2UoKSkge1xuICAgICAgICAgICAgY29uc3Qgc3Ryb2tlU2NhbGVFbmFibGVkID0gc2hhcGUuZ2V0U3Ryb2tlU2NhbGVFbmFibGVkKCk7XG4gICAgICAgICAgICBpZiAoIXN0cm9rZVNjYWxlRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBpeGVsUmF0aW8gPSB0aGlzLmdldENhbnZhcygpLmdldFBpeGVsUmF0aW8oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zZm9ybShwaXhlbFJhdGlvLCAwLCAwLCBwaXhlbFJhdGlvLCAwLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2FwcGx5TGluZUNhcChzaGFwZSk7XG4gICAgICAgICAgICBjb25zdCBoaXRTdHJva2VXaWR0aCA9IHNoYXBlLmhpdFN0cm9rZVdpZHRoKCk7XG4gICAgICAgICAgICBjb25zdCBzdHJva2VXaWR0aCA9IGhpdFN0cm9rZVdpZHRoID09PSAnYXV0bycgPyBzaGFwZS5zdHJva2VXaWR0aCgpIDogaGl0U3Ryb2tlV2lkdGg7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ2xpbmVXaWR0aCcsIHN0cm9rZVdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignc3Ryb2tlU3R5bGUnLCBzaGFwZS5jb2xvcktleSk7XG4gICAgICAgICAgICBzaGFwZS5fc3Ryb2tlRnVuY0hpdCh0aGlzKTtcbiAgICAgICAgICAgIGlmICghc3Ryb2tlU2NhbGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBLb252YSB9IGZyb20gXCIuL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuL1V0aWwuanNcIjtcbmV4cG9ydCBjb25zdCBERCA9IHtcbiAgICBnZXQgaXNEcmFnZ2luZygpIHtcbiAgICAgICAgbGV0IGZsYWcgPSBmYWxzZTtcbiAgICAgICAgREQuX2RyYWdFbGVtZW50cy5mb3JFYWNoKChlbGVtKSA9PiB7XG4gICAgICAgICAgICBpZiAoZWxlbS5kcmFnU3RhdHVzID09PSAnZHJhZ2dpbmcnKSB7XG4gICAgICAgICAgICAgICAgZmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmxhZztcbiAgICB9LFxuICAgIGp1c3REcmFnZ2VkOiBmYWxzZSxcbiAgICBnZXQgbm9kZSgpIHtcbiAgICAgICAgbGV0IG5vZGU7XG4gICAgICAgIERELl9kcmFnRWxlbWVudHMuZm9yRWFjaCgoZWxlbSkgPT4ge1xuICAgICAgICAgICAgbm9kZSA9IGVsZW0ubm9kZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG4gICAgX2RyYWdFbGVtZW50czogbmV3IE1hcCgpLFxuICAgIF9kcmFnKGV2dCkge1xuICAgICAgICBjb25zdCBub2Rlc1RvRmlyZUV2ZW50cyA9IFtdO1xuICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLmZvckVhY2goKGVsZW0sIGtleSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBub2RlIH0gPSBlbGVtO1xuICAgICAgICAgICAgY29uc3Qgc3RhZ2UgPSBub2RlLmdldFN0YWdlKCk7XG4gICAgICAgICAgICBzdGFnZS5zZXRQb2ludGVyc1Bvc2l0aW9ucyhldnQpO1xuICAgICAgICAgICAgaWYgKGVsZW0ucG9pbnRlcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBlbGVtLnBvaW50ZXJJZCA9IFV0aWwuX2dldEZpcnN0UG9pbnRlcklkKGV2dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwb3MgPSBzdGFnZS5fY2hhbmdlZFBvaW50ZXJQb3NpdGlvbnMuZmluZCgocG9zKSA9PiBwb3MuaWQgPT09IGVsZW0ucG9pbnRlcklkKTtcbiAgICAgICAgICAgIGlmICghcG9zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW0uZHJhZ1N0YXR1cyAhPT0gJ2RyYWdnaW5nJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRyYWdEaXN0YW5jZSA9IG5vZGUuZHJhZ0Rpc3RhbmNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBNYXRoLm1heChNYXRoLmFicyhwb3MueCAtIGVsZW0uc3RhcnRQb2ludGVyUG9zLngpLCBNYXRoLmFicyhwb3MueSAtIGVsZW0uc3RhcnRQb2ludGVyUG9zLnkpKTtcbiAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPCBkcmFnRGlzdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBub2RlLnN0YXJ0RHJhZyh7IGV2dCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIW5vZGUuaXNEcmFnZ2luZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLl9zZXREcmFnUG9zaXRpb24oZXZ0LCBlbGVtKTtcbiAgICAgICAgICAgIG5vZGVzVG9GaXJlRXZlbnRzLnB1c2gobm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBub2Rlc1RvRmlyZUV2ZW50cy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBub2RlLmZpcmUoJ2RyYWdtb3ZlJywge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdkcmFnbW92ZScsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBub2RlLFxuICAgICAgICAgICAgICAgIGV2dDogZXZ0LFxuICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgX2VuZERyYWdCZWZvcmUoZXZ0KSB7XG4gICAgICAgIGNvbnN0IGRyYXdOb2RlcyA9IFtdO1xuICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLmZvckVhY2goKGVsZW0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbm9kZSB9ID0gZWxlbTtcbiAgICAgICAgICAgIGNvbnN0IHN0YWdlID0gbm9kZS5nZXRTdGFnZSgpO1xuICAgICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgICAgIHN0YWdlLnNldFBvaW50ZXJzUG9zaXRpb25zKGV2dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwb3MgPSBzdGFnZS5fY2hhbmdlZFBvaW50ZXJQb3NpdGlvbnMuZmluZCgocG9zKSA9PiBwb3MuaWQgPT09IGVsZW0ucG9pbnRlcklkKTtcbiAgICAgICAgICAgIGlmICghcG9zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW0uZHJhZ1N0YXR1cyA9PT0gJ2RyYWdnaW5nJyB8fCBlbGVtLmRyYWdTdGF0dXMgPT09ICdzdG9wcGVkJykge1xuICAgICAgICAgICAgICAgIERELmp1c3REcmFnZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBLb252YS5fbW91c2VMaXN0ZW5DbGljayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIEtvbnZhLl90b3VjaExpc3RlbkNsaWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgS29udmEuX3BvaW50ZXJMaXN0ZW5DbGljayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVsZW0uZHJhZ1N0YXR1cyA9ICdzdG9wcGVkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRyYXdOb2RlID0gZWxlbS5ub2RlLmdldExheWVyKCkgfHxcbiAgICAgICAgICAgICAgICAoZWxlbS5ub2RlIGluc3RhbmNlb2YgS29udmFbJ1N0YWdlJ10gJiYgZWxlbS5ub2RlKTtcbiAgICAgICAgICAgIGlmIChkcmF3Tm9kZSAmJiBkcmF3Tm9kZXMuaW5kZXhPZihkcmF3Tm9kZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZHJhd05vZGVzLnB1c2goZHJhd05vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZHJhd05vZGVzLmZvckVhY2goKGRyYXdOb2RlKSA9PiB7XG4gICAgICAgICAgICBkcmF3Tm9kZS5kcmF3KCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgX2VuZERyYWdBZnRlcihldnQpIHtcbiAgICAgICAgREQuX2RyYWdFbGVtZW50cy5mb3JFYWNoKChlbGVtLCBrZXkpID0+IHtcbiAgICAgICAgICAgIGlmIChlbGVtLmRyYWdTdGF0dXMgPT09ICdzdG9wcGVkJykge1xuICAgICAgICAgICAgICAgIGVsZW0ubm9kZS5maXJlKCdkcmFnZW5kJywge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZHJhZ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogZWxlbS5ub2RlLFxuICAgICAgICAgICAgICAgICAgICBldnQ6IGV2dCxcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtLmRyYWdTdGF0dXMgIT09ICdkcmFnZ2luZycpIHtcbiAgICAgICAgICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLmRlbGV0ZShrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxufTtcbmlmIChLb252YS5pc0Jyb3dzZXIpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIERELl9lbmREcmFnQmVmb3JlLCB0cnVlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBERC5fZW5kRHJhZ0JlZm9yZSwgdHJ1ZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgREQuX2VuZERyYWdCZWZvcmUsIHRydWUpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBERC5fZHJhZyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIERELl9kcmFnKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIERELl9lbmREcmFnQWZ0ZXIsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBERC5fZW5kRHJhZ0FmdGVyLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgREQuX2VuZERyYWdBZnRlciwgZmFsc2UpO1xufVxuIiwiaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuL1V0aWwuanNcIjtcbmltcG9ydCB7IGdldENvbXBvbmVudFZhbGlkYXRvciB9IGZyb20gXCIuL1ZhbGlkYXRvcnMuanNcIjtcbmNvbnN0IEdFVCA9ICdnZXQnO1xuY29uc3QgU0VUID0gJ3NldCc7XG5leHBvcnQgY29uc3QgRmFjdG9yeSA9IHtcbiAgICBhZGRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIsIGRlZiwgdmFsaWRhdG9yLCBhZnRlcikge1xuICAgICAgICBGYWN0b3J5LmFkZEdldHRlcihjb25zdHJ1Y3RvciwgYXR0ciwgZGVmKTtcbiAgICAgICAgRmFjdG9yeS5hZGRTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIsIHZhbGlkYXRvciwgYWZ0ZXIpO1xuICAgICAgICBGYWN0b3J5LmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIpO1xuICAgIH0sXG4gICAgYWRkR2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCBkZWYpIHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gR0VUICsgVXRpbC5fY2FwaXRhbGl6ZShhdHRyKTtcbiAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlW21ldGhvZF0gPVxuICAgICAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlW21ldGhvZF0gfHxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuYXR0cnNbYXR0cl07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWwgPT09IHVuZGVmaW5lZCA/IGRlZiA6IHZhbDtcbiAgICAgICAgICAgICAgICB9O1xuICAgIH0sXG4gICAgYWRkU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGFmdGVyKSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IFNFVCArIFV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG4gICAgICAgIGlmICghY29uc3RydWN0b3IucHJvdG90eXBlW21ldGhvZF0pIHtcbiAgICAgICAgICAgIEZhY3Rvcnkub3ZlcldyaXRlU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGFmdGVyKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgb3ZlcldyaXRlU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGFmdGVyKSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IFNFVCArIFV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG4gICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgaWYgKHZhbGlkYXRvciAmJiB2YWwgIT09IHVuZGVmaW5lZCAmJiB2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWxpZGF0b3IuY2FsbCh0aGlzLCB2YWwsIGF0dHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc2V0QXR0cihhdHRyLCB2YWwpO1xuICAgICAgICAgICAgaWYgKGFmdGVyKSB7XG4gICAgICAgICAgICAgICAgYWZ0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgIH0sXG4gICAgYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihjb25zdHJ1Y3RvciwgYXR0ciwgY29tcG9uZW50cywgdmFsaWRhdG9yLCBhZnRlcikge1xuICAgICAgICBjb25zdCBsZW4gPSBjb21wb25lbnRzLmxlbmd0aCwgY2FwaXRhbGl6ZSA9IFV0aWwuX2NhcGl0YWxpemUsIGdldHRlciA9IEdFVCArIGNhcGl0YWxpemUoYXR0ciksIHNldHRlciA9IFNFVCArIGNhcGl0YWxpemUoYXR0cik7XG4gICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtnZXR0ZXJdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3QgcmV0ID0ge307XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gY29tcG9uZW50c1tuXTtcbiAgICAgICAgICAgICAgICByZXRbY29tcG9uZW50XSA9IHRoaXMuZ2V0QXR0cihhdHRyICsgY2FwaXRhbGl6ZShjb21wb25lbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGJhc2ljVmFsaWRhdG9yID0gZ2V0Q29tcG9uZW50VmFsaWRhdG9yKGNvbXBvbmVudHMpO1xuICAgICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGVbc2V0dGVyXSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIGNvbnN0IG9sZFZhbCA9IHRoaXMuYXR0cnNbYXR0cl07XG4gICAgICAgICAgICBpZiAodmFsaWRhdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsaWRhdG9yLmNhbGwodGhpcywgdmFsLCBhdHRyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiYXNpY1ZhbGlkYXRvcikge1xuICAgICAgICAgICAgICAgIGJhc2ljVmFsaWRhdG9yLmNhbGwodGhpcywgdmFsLCBhdHRyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHZhbCkge1xuICAgICAgICAgICAgICAgIGlmICghdmFsLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEF0dHIoYXR0ciArIGNhcGl0YWxpemUoa2V5KSwgdmFsW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF2YWwpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRzLmZvckVhY2goKGNvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyKGF0dHIgKyBjYXBpdGFsaXplKGNvbXBvbmVudCksIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlRXZlbnQoYXR0ciwgb2xkVmFsLCB2YWwpO1xuICAgICAgICAgICAgaWYgKGFmdGVyKSB7XG4gICAgICAgICAgICAgICAgYWZ0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBGYWN0b3J5LmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIpO1xuICAgIH0sXG4gICAgYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihjb25zdHJ1Y3RvciwgYXR0cikge1xuICAgICAgICBjb25zdCBjYXBpdGFsaXplZEF0dHIgPSBVdGlsLl9jYXBpdGFsaXplKGF0dHIpLCBzZXR0ZXIgPSBTRVQgKyBjYXBpdGFsaXplZEF0dHIsIGdldHRlciA9IEdFVCArIGNhcGl0YWxpemVkQXR0cjtcbiAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlW2F0dHJdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzW3NldHRlcl0oYXJndW1lbnRzWzBdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzW2dldHRlcl0oKTtcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIsIGRlZiwgdmFsaWRhdG9yKSB7XG4gICAgICAgIFV0aWwuZXJyb3IoJ0FkZGluZyBkZXByZWNhdGVkICcgKyBhdHRyKTtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gR0VUICsgVXRpbC5fY2FwaXRhbGl6ZShhdHRyKTtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGF0dHIgK1xuICAgICAgICAgICAgJyBwcm9wZXJ0eSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgc29vbi4gTG9vayBhdCBLb252YSBjaGFuZ2UgbG9nIGZvciBtb3JlIGluZm9ybWF0aW9uLic7XG4gICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgVXRpbC5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuYXR0cnNbYXR0cl07XG4gICAgICAgICAgICByZXR1cm4gdmFsID09PSB1bmRlZmluZWQgPyBkZWYgOiB2YWw7XG4gICAgICAgIH07XG4gICAgICAgIEZhY3RvcnkuYWRkU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFV0aWwuZXJyb3IobWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBGYWN0b3J5LmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIpO1xuICAgIH0sXG4gICAgYmFja0NvbXBhdChjb25zdHJ1Y3RvciwgbWV0aG9kcykge1xuICAgICAgICBVdGlsLmVhY2gobWV0aG9kcywgZnVuY3Rpb24gKG9sZE1ldGhvZE5hbWUsIG5ld01ldGhvZE5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1ldGhvZCA9IGNvbnN0cnVjdG9yLnByb3RvdHlwZVtuZXdNZXRob2ROYW1lXTtcbiAgICAgICAgICAgIGNvbnN0IG9sZEdldHRlciA9IEdFVCArIFV0aWwuX2NhcGl0YWxpemUob2xkTWV0aG9kTmFtZSk7XG4gICAgICAgICAgICBjb25zdCBvbGRTZXR0ZXIgPSBTRVQgKyBVdGlsLl9jYXBpdGFsaXplKG9sZE1ldGhvZE5hbWUpO1xuICAgICAgICAgICAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHtcbiAgICAgICAgICAgICAgICBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICBVdGlsLmVycm9yKCdcIicgK1xuICAgICAgICAgICAgICAgICAgICBvbGRNZXRob2ROYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIG1ldGhvZCBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgc29vbi4gVXNlIFwiXCInICtcbiAgICAgICAgICAgICAgICAgICAgbmV3TWV0aG9kTmFtZSArXG4gICAgICAgICAgICAgICAgICAgICdcIiBpbnN0ZWFkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlW29sZE1ldGhvZE5hbWVdID0gZGVwcmVjYXRlZDtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtvbGRHZXR0ZXJdID0gZGVwcmVjYXRlZDtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtvbGRTZXR0ZXJdID0gZGVwcmVjYXRlZDtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBhZnRlclNldEZpbHRlcigpIHtcbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICB9LFxufTtcbiIsImltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBMYXllciB9IGZyb20gXCIuL0xheWVyLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5leHBvcnQgY2xhc3MgRmFzdExheWVyIGV4dGVuZHMgTGF5ZXIge1xuICAgIGNvbnN0cnVjdG9yKGF0dHJzKSB7XG4gICAgICAgIHN1cGVyKGF0dHJzKTtcbiAgICAgICAgdGhpcy5saXN0ZW5pbmcoZmFsc2UpO1xuICAgICAgICBVdGlsLndhcm4oJ0tvbnZhLkZhc3QgbGF5ZXIgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBcIm5ldyBLb252YS5MYXllcih7IGxpc3RlbmluZzogZmFsc2UgfSlcIiBpbnN0ZWFkLicpO1xuICAgIH1cbn1cbkZhc3RMYXllci5wcm90b3R5cGUubm9kZVR5cGUgPSAnRmFzdExheWVyJztcbl9yZWdpc3Rlck5vZGUoRmFzdExheWVyKTtcbiIsImNvbnN0IFBJX09WRVJfMTgwID0gTWF0aC5QSSAvIDE4MDtcbmZ1bmN0aW9uIGRldGVjdEJyb3dzZXIoKSB7XG4gICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAoe30udG9TdHJpbmcuY2FsbCh3aW5kb3cpID09PSAnW29iamVjdCBXaW5kb3ddJyB8fFxuICAgICAgICAgICAge30udG9TdHJpbmcuY2FsbCh3aW5kb3cpID09PSAnW29iamVjdCBnbG9iYWxdJykpO1xufVxuZXhwb3J0IGNvbnN0IGdsb2IgPSB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJ1xuICAgID8gZ2xvYmFsXG4gICAgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IHdpbmRvd1xuICAgICAgICA6IHR5cGVvZiBXb3JrZXJHbG9iYWxTY29wZSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgID8gc2VsZlxuICAgICAgICAgICAgOiB7fTtcbmV4cG9ydCBjb25zdCBLb252YSA9IHtcbiAgICBfZ2xvYmFsOiBnbG9iLFxuICAgIHZlcnNpb246ICcxMC4wLjInLFxuICAgIGlzQnJvd3NlcjogZGV0ZWN0QnJvd3NlcigpLFxuICAgIGlzVW5taW5pZmllZDogL3BhcmFtLy50ZXN0KGZ1bmN0aW9uIChwYXJhbSkgeyB9LnRvU3RyaW5nKCkpLFxuICAgIGRibENsaWNrV2luZG93OiA0MDAsXG4gICAgZ2V0QW5nbGUoYW5nbGUpIHtcbiAgICAgICAgcmV0dXJuIEtvbnZhLmFuZ2xlRGVnID8gYW5nbGUgKiBQSV9PVkVSXzE4MCA6IGFuZ2xlO1xuICAgIH0sXG4gICAgZW5hYmxlVHJhY2U6IGZhbHNlLFxuICAgIHBvaW50ZXJFdmVudHNFbmFibGVkOiB0cnVlLFxuICAgIGF1dG9EcmF3RW5hYmxlZDogdHJ1ZSxcbiAgICBoaXRPbkRyYWdFbmFibGVkOiBmYWxzZSxcbiAgICBjYXB0dXJlUG9pbnRlckV2ZW50c0VuYWJsZWQ6IGZhbHNlLFxuICAgIF9tb3VzZUxpc3RlbkNsaWNrOiBmYWxzZSxcbiAgICBfdG91Y2hMaXN0ZW5DbGljazogZmFsc2UsXG4gICAgX3BvaW50ZXJMaXN0ZW5DbGljazogZmFsc2UsXG4gICAgX21vdXNlSW5EYmxDbGlja1dpbmRvdzogZmFsc2UsXG4gICAgX3RvdWNoSW5EYmxDbGlja1dpbmRvdzogZmFsc2UsXG4gICAgX3BvaW50ZXJJbkRibENsaWNrV2luZG93OiBmYWxzZSxcbiAgICBfbW91c2VEYmxDbGlja1BvaW50ZXJJZDogbnVsbCxcbiAgICBfdG91Y2hEYmxDbGlja1BvaW50ZXJJZDogbnVsbCxcbiAgICBfcG9pbnRlckRibENsaWNrUG9pbnRlcklkOiBudWxsLFxuICAgIF9yZW5kZXJCYWNrZW5kOiAnd2ViJyxcbiAgICBsZWdhY3lUZXh0UmVuZGVyaW5nOiBmYWxzZSxcbiAgICBwaXhlbFJhdGlvOiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmRldmljZVBpeGVsUmF0aW8pIHx8IDEsXG4gICAgZHJhZ0Rpc3RhbmNlOiAzLFxuICAgIGFuZ2xlRGVnOiB0cnVlLFxuICAgIHNob3dXYXJuaW5nczogdHJ1ZSxcbiAgICBkcmFnQnV0dG9uczogWzAsIDFdLFxuICAgIGlzRHJhZ2dpbmcoKSB7XG4gICAgICAgIHJldHVybiBLb252YVsnREQnXS5pc0RyYWdnaW5nO1xuICAgIH0sXG4gICAgaXNUcmFuc2Zvcm1pbmcoKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiAoX2IgPSAoX2EgPSBLb252YVsnVHJhbnNmb3JtZXInXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlzVHJhbnNmb3JtaW5nKCkpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IGZhbHNlO1xuICAgIH0sXG4gICAgaXNEcmFnUmVhZHkoKSB7XG4gICAgICAgIHJldHVybiAhIUtvbnZhWydERCddLm5vZGU7XG4gICAgfSxcbiAgICByZWxlYXNlQ2FudmFzT25EZXN0cm95OiB0cnVlLFxuICAgIGRvY3VtZW50OiBnbG9iLmRvY3VtZW50LFxuICAgIF9pbmplY3RHbG9iYWwoS29udmEpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBnbG9iLktvbnZhICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2V2ZXJhIEtvbnZhIGluc3RhbmNlcyBkZXRlY3RlZC4gSXQgaXMgbm90IHJlY29tbWVuZGVkIHRvIHVzZSBtdWx0aXBsZSBLb252YSBpbnN0YW5jZXMgaW4gdGhlIHNhbWUgZW52aXJvbm1lbnQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZ2xvYi5Lb252YSA9IEtvbnZhO1xuICAgIH0sXG59O1xuZXhwb3J0IGNvbnN0IF9yZWdpc3Rlck5vZGUgPSAoTm9kZUNsYXNzKSA9PiB7XG4gICAgS29udmFbTm9kZUNsYXNzLnByb3RvdHlwZS5nZXRDbGFzc05hbWUoKV0gPSBOb2RlQ2xhc3M7XG59O1xuS29udmEuX2luamVjdEdsb2JhbChLb252YSk7XG4iLCJpbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4vVXRpbC5qc1wiO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSBcIi4vQ29udGFpbmVyLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5leHBvcnQgY2xhc3MgR3JvdXAgZXh0ZW5kcyBDb250YWluZXIge1xuICAgIF92YWxpZGF0ZUFkZChjaGlsZCkge1xuICAgICAgICBjb25zdCB0eXBlID0gY2hpbGQuZ2V0VHlwZSgpO1xuICAgICAgICBpZiAodHlwZSAhPT0gJ0dyb3VwJyAmJiB0eXBlICE9PSAnU2hhcGUnKSB7XG4gICAgICAgICAgICBVdGlsLnRocm93KCdZb3UgbWF5IG9ubHkgYWRkIGdyb3VwcyBhbmQgc2hhcGVzIHRvIGdyb3Vwcy4nKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbkdyb3VwLnByb3RvdHlwZS5ub2RlVHlwZSA9ICdHcm91cCc7XG5fcmVnaXN0ZXJOb2RlKEdyb3VwKTtcbiIsImltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tIFwiLi9Db250YWluZXIuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgU2NlbmVDYW52YXMsIEhpdENhbnZhcyB9IGZyb20gXCIuL0NhbnZhcy5qc1wiO1xuaW1wb3J0IHsgZ2V0Qm9vbGVhblZhbGlkYXRvciB9IGZyb20gXCIuL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IHNoYXBlcyB9IGZyb20gXCIuL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5jb25zdCBIQVNIID0gJyMnLCBCRUZPUkVfRFJBVyA9ICdiZWZvcmVEcmF3JywgRFJBVyA9ICdkcmF3JywgSU5URVJTRUNUSU9OX09GRlNFVFMgPSBbXG4gICAgeyB4OiAwLCB5OiAwIH0sXG4gICAgeyB4OiAtMSwgeTogLTEgfSxcbiAgICB7IHg6IDEsIHk6IC0xIH0sXG4gICAgeyB4OiAxLCB5OiAxIH0sXG4gICAgeyB4OiAtMSwgeTogMSB9LFxuXSwgSU5URVJTRUNUSU9OX09GRlNFVFNfTEVOID0gSU5URVJTRUNUSU9OX09GRlNFVFMubGVuZ3RoO1xuZXhwb3J0IGNsYXNzIExheWVyIGV4dGVuZHMgQ29udGFpbmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgc3VwZXIoY29uZmlnKTtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBuZXcgU2NlbmVDYW52YXMoKTtcbiAgICAgICAgdGhpcy5oaXRDYW52YXMgPSBuZXcgSGl0Q2FudmFzKHtcbiAgICAgICAgICAgIHBpeGVsUmF0aW86IDEsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl93YWl0aW5nRm9yRHJhdyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9uKCd2aXNpYmxlQ2hhbmdlLmtvbnZhJywgdGhpcy5fY2hlY2tWaXNpYmlsaXR5KTtcbiAgICAgICAgdGhpcy5fY2hlY2tWaXNpYmlsaXR5KCk7XG4gICAgICAgIHRoaXMub24oJ2ltYWdlU21vb3RoaW5nRW5hYmxlZENoYW5nZS5rb252YScsIHRoaXMuX3NldFNtb290aEVuYWJsZWQpO1xuICAgICAgICB0aGlzLl9zZXRTbW9vdGhFbmFibGVkKCk7XG4gICAgfVxuICAgIGNyZWF0ZVBOR1N0cmVhbSgpIHtcbiAgICAgICAgY29uc3QgYyA9IHRoaXMuY2FudmFzLl9jYW52YXM7XG4gICAgICAgIHJldHVybiBjLmNyZWF0ZVBOR1N0cmVhbSgpO1xuICAgIH1cbiAgICBnZXRDYW52YXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcbiAgICB9XG4gICAgZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLl9jYW52YXM7XG4gICAgfVxuICAgIGdldEhpdENhbnZhcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0Q2FudmFzO1xuICAgIH1cbiAgICBnZXRDb250ZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDYW52YXMoKS5nZXRDb250ZXh0KCk7XG4gICAgfVxuICAgIGNsZWFyKGJvdW5kcykge1xuICAgICAgICB0aGlzLmdldENvbnRleHQoKS5jbGVhcihib3VuZHMpO1xuICAgICAgICB0aGlzLmdldEhpdENhbnZhcygpLmdldENvbnRleHQoKS5jbGVhcihib3VuZHMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgc2V0WkluZGV4KGluZGV4KSB7XG4gICAgICAgIHN1cGVyLnNldFpJbmRleChpbmRleCk7XG4gICAgICAgIGNvbnN0IHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpO1xuICAgICAgICBpZiAoc3RhZ2UgJiYgc3RhZ2UuY29udGVudCkge1xuICAgICAgICAgICAgc3RhZ2UuY29udGVudC5yZW1vdmVDaGlsZCh0aGlzLmdldE5hdGl2ZUNhbnZhc0VsZW1lbnQoKSk7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBzdGFnZS5jaGlsZHJlbi5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5pbnNlcnRCZWZvcmUodGhpcy5nZXROYXRpdmVDYW52YXNFbGVtZW50KCksIHN0YWdlLmNoaWxkcmVuW2luZGV4ICsgMV0uZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGFnZS5jb250ZW50LmFwcGVuZENoaWxkKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgbW92ZVRvVG9wKCkge1xuICAgICAgICBOb2RlLnByb3RvdHlwZS5tb3ZlVG9Ub3AuY2FsbCh0aGlzKTtcbiAgICAgICAgY29uc3Qgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgIGlmIChzdGFnZSAmJiBzdGFnZS5jb250ZW50KSB7XG4gICAgICAgICAgICBzdGFnZS5jb250ZW50LnJlbW92ZUNoaWxkKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpKTtcbiAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQuYXBwZW5kQ2hpbGQodGhpcy5nZXROYXRpdmVDYW52YXNFbGVtZW50KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBtb3ZlVXAoKSB7XG4gICAgICAgIGNvbnN0IG1vdmVkID0gTm9kZS5wcm90b3R5cGUubW92ZVVwLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICghbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgaWYgKCFzdGFnZSB8fCAhc3RhZ2UuY29udGVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHN0YWdlLmNvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5nZXROYXRpdmVDYW52YXNFbGVtZW50KCkpO1xuICAgICAgICBpZiAodGhpcy5pbmRleCA8IHN0YWdlLmNoaWxkcmVuLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQuaW5zZXJ0QmVmb3JlKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpLCBzdGFnZS5jaGlsZHJlblt0aGlzLmluZGV4ICsgMV0uZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdGFnZS5jb250ZW50LmFwcGVuZENoaWxkKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgbW92ZURvd24oKSB7XG4gICAgICAgIGlmIChOb2RlLnByb3RvdHlwZS5tb3ZlRG93bi5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIGlmIChzdGFnZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gc3RhZ2UuY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgaWYgKHN0YWdlLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5yZW1vdmVDaGlsZCh0aGlzLmdldE5hdGl2ZUNhbnZhc0VsZW1lbnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQuaW5zZXJ0QmVmb3JlKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpLCBjaGlsZHJlblt0aGlzLmluZGV4ICsgMV0uZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBtb3ZlVG9Cb3R0b20oKSB7XG4gICAgICAgIGlmIChOb2RlLnByb3RvdHlwZS5tb3ZlVG9Cb3R0b20uY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgICAgICBpZiAoc3RhZ2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHN0YWdlLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgIGlmIChzdGFnZS5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5nZXROYXRpdmVDYW52YXNFbGVtZW50KCkpO1xuICAgICAgICAgICAgICAgICAgICBzdGFnZS5jb250ZW50Lmluc2VydEJlZm9yZSh0aGlzLmdldE5hdGl2ZUNhbnZhc0VsZW1lbnQoKSwgY2hpbGRyZW5bMV0uZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBnZXRMYXllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHJlbW92ZSgpIHtcbiAgICAgICAgY29uc3QgX2NhbnZhcyA9IHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpO1xuICAgICAgICBOb2RlLnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKF9jYW52YXMgJiYgX2NhbnZhcy5wYXJlbnROb2RlICYmIFV0aWwuX2lzSW5Eb2N1bWVudChfY2FudmFzKSkge1xuICAgICAgICAgICAgX2NhbnZhcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF9jYW52YXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBnZXRTdGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICAgIH1cbiAgICBzZXRTaXplKHsgd2lkdGgsIGhlaWdodCB9KSB7XG4gICAgICAgIHRoaXMuY2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHRoaXMuaGl0Q2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHRoaXMuX3NldFNtb290aEVuYWJsZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIF92YWxpZGF0ZUFkZChjaGlsZCkge1xuICAgICAgICBjb25zdCB0eXBlID0gY2hpbGQuZ2V0VHlwZSgpO1xuICAgICAgICBpZiAodHlwZSAhPT0gJ0dyb3VwJyAmJiB0eXBlICE9PSAnU2hhcGUnKSB7XG4gICAgICAgICAgICBVdGlsLnRocm93KCdZb3UgbWF5IG9ubHkgYWRkIGdyb3VwcyBhbmQgc2hhcGVzIHRvIGEgbGF5ZXIuJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3RvS29udmFDYW52YXMoY29uZmlnKSB7XG4gICAgICAgIGNvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gICAgICAgIGNvbmZpZy53aWR0aCA9IGNvbmZpZy53aWR0aCB8fCB0aGlzLmdldFdpZHRoKCk7XG4gICAgICAgIGNvbmZpZy5oZWlnaHQgPSBjb25maWcuaGVpZ2h0IHx8IHRoaXMuZ2V0SGVpZ2h0KCk7XG4gICAgICAgIGNvbmZpZy54ID0gY29uZmlnLnggIT09IHVuZGVmaW5lZCA/IGNvbmZpZy54IDogdGhpcy54KCk7XG4gICAgICAgIGNvbmZpZy55ID0gY29uZmlnLnkgIT09IHVuZGVmaW5lZCA/IGNvbmZpZy55IDogdGhpcy55KCk7XG4gICAgICAgIHJldHVybiBOb2RlLnByb3RvdHlwZS5fdG9Lb252YUNhbnZhcy5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgfVxuICAgIF9jaGVja1Zpc2liaWxpdHkoKSB7XG4gICAgICAgIGNvbnN0IHZpc2libGUgPSB0aGlzLnZpc2libGUoKTtcbiAgICAgICAgaWYgKHZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLl9jYW52YXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5fY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3NldFNtb290aEVuYWJsZWQoKSB7XG4gICAgICAgIHRoaXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9XG4gICAgICAgICAgICB0aGlzLmltYWdlU21vb3RoaW5nRW5hYmxlZCgpO1xuICAgIH1cbiAgICBnZXRXaWR0aCgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQud2lkdGgoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRXaWR0aCgpIHtcbiAgICAgICAgVXRpbC53YXJuKCdDYW4gbm90IGNoYW5nZSB3aWR0aCBvZiBsYXllci4gVXNlIFwic3RhZ2Uud2lkdGgodmFsdWUpXCIgZnVuY3Rpb24gaW5zdGVhZC4nKTtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5oZWlnaHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRIZWlnaHQoKSB7XG4gICAgICAgIFV0aWwud2FybignQ2FuIG5vdCBjaGFuZ2UgaGVpZ2h0IG9mIGxheWVyLiBVc2UgXCJzdGFnZS5oZWlnaHQodmFsdWUpXCIgZnVuY3Rpb24gaW5zdGVhZC4nKTtcbiAgICB9XG4gICAgYmF0Y2hEcmF3KCkge1xuICAgICAgICBpZiAoIXRoaXMuX3dhaXRpbmdGb3JEcmF3KSB7XG4gICAgICAgICAgICB0aGlzLl93YWl0aW5nRm9yRHJhdyA9IHRydWU7XG4gICAgICAgICAgICBVdGlsLnJlcXVlc3RBbmltRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dhaXRpbmdGb3JEcmF3ID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0SW50ZXJzZWN0aW9uKHBvcykge1xuICAgICAgICBpZiAoIXRoaXMuaXNMaXN0ZW5pbmcoKSB8fCAhdGhpcy5pc1Zpc2libGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNwaXJhbFNlYXJjaERpc3RhbmNlID0gMTtcbiAgICAgICAgbGV0IGNvbnRpbnVlU2VhcmNoID0gZmFsc2U7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IElOVEVSU0VDVElPTl9PRkZTRVRTX0xFTjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW50ZXJzZWN0aW9uT2Zmc2V0ID0gSU5URVJTRUNUSU9OX09GRlNFVFNbaV07XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5fZ2V0SW50ZXJzZWN0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgeDogcG9zLnggKyBpbnRlcnNlY3Rpb25PZmZzZXQueCAqIHNwaXJhbFNlYXJjaERpc3RhbmNlLFxuICAgICAgICAgICAgICAgICAgICB5OiBwb3MueSArIGludGVyc2VjdGlvbk9mZnNldC55ICogc3BpcmFsU2VhcmNoRGlzdGFuY2UsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2hhcGUgPSBvYmouc2hhcGU7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWVTZWFyY2ggPSAhIW9iai5hbnRpYWxpYXNlZDtcbiAgICAgICAgICAgICAgICBpZiAoIW9iai5hbnRpYWxpYXNlZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29udGludWVTZWFyY2gpIHtcbiAgICAgICAgICAgICAgICBzcGlyYWxTZWFyY2hEaXN0YW5jZSArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2dldEludGVyc2VjdGlvbihwb3MpIHtcbiAgICAgICAgY29uc3QgcmF0aW8gPSB0aGlzLmhpdENhbnZhcy5waXhlbFJhdGlvO1xuICAgICAgICBjb25zdCBwID0gdGhpcy5oaXRDYW52YXMuY29udGV4dC5nZXRJbWFnZURhdGEoTWF0aC5yb3VuZChwb3MueCAqIHJhdGlvKSwgTWF0aC5yb3VuZChwb3MueSAqIHJhdGlvKSwgMSwgMSkuZGF0YTtcbiAgICAgICAgY29uc3QgcDMgPSBwWzNdO1xuICAgICAgICBpZiAocDMgPT09IDI1NSkge1xuICAgICAgICAgICAgY29uc3QgY29sb3JLZXkgPSBVdGlsLl9yZ2JUb0hleChwWzBdLCBwWzFdLCBwWzJdKTtcbiAgICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW0hBU0ggKyBjb2xvcktleV07XG4gICAgICAgICAgICBpZiAoc2hhcGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZTogc2hhcGUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYW50aWFsaWFzZWQ6IHRydWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHAzID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhbnRpYWxpYXNlZDogdHJ1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBkcmF3U2NlbmUoY2FuLCB0b3AsIGJ1ZmZlckNhbnZhcykge1xuICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSwgY2FudmFzID0gY2FuIHx8IChsYXllciAmJiBsYXllci5nZXRDYW52YXMoKSk7XG4gICAgICAgIHRoaXMuX2ZpcmUoQkVGT1JFX0RSQVcsIHtcbiAgICAgICAgICAgIG5vZGU6IHRoaXMsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5jbGVhckJlZm9yZURyYXcoKSkge1xuICAgICAgICAgICAgY2FudmFzLmdldENvbnRleHQoKS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIENvbnRhaW5lci5wcm90b3R5cGUuZHJhd1NjZW5lLmNhbGwodGhpcywgY2FudmFzLCB0b3AsIGJ1ZmZlckNhbnZhcyk7XG4gICAgICAgIHRoaXMuX2ZpcmUoRFJBVywge1xuICAgICAgICAgICAgbm9kZTogdGhpcyxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBkcmF3SGl0KGNhbiwgdG9wKSB7XG4gICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRMYXllcigpLCBjYW52YXMgPSBjYW4gfHwgKGxheWVyICYmIGxheWVyLmhpdENhbnZhcyk7XG4gICAgICAgIGlmIChsYXllciAmJiBsYXllci5jbGVhckJlZm9yZURyYXcoKSkge1xuICAgICAgICAgICAgbGF5ZXIuZ2V0SGl0Q2FudmFzKCkuZ2V0Q29udGV4dCgpLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgQ29udGFpbmVyLnByb3RvdHlwZS5kcmF3SGl0LmNhbGwodGhpcywgY2FudmFzLCB0b3ApO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZW5hYmxlSGl0R3JhcGgoKSB7XG4gICAgICAgIHRoaXMuaGl0R3JhcGhFbmFibGVkKHRydWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZGlzYWJsZUhpdEdyYXBoKCkge1xuICAgICAgICB0aGlzLmhpdEdyYXBoRW5hYmxlZChmYWxzZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRIaXRHcmFwaEVuYWJsZWQodmFsKSB7XG4gICAgICAgIFV0aWwud2FybignaGl0R3JhcGhFbmFibGVkIG1ldGhvZCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIGxheWVyLmxpc3RlbmluZygpIGluc3RlYWQuJyk7XG4gICAgICAgIHRoaXMubGlzdGVuaW5nKHZhbCk7XG4gICAgfVxuICAgIGdldEhpdEdyYXBoRW5hYmxlZCh2YWwpIHtcbiAgICAgICAgVXRpbC53YXJuKCdoaXRHcmFwaEVuYWJsZWQgbWV0aG9kIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgbGF5ZXIubGlzdGVuaW5nKCkgaW5zdGVhZC4nKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuaW5nKCk7XG4gICAgfVxuICAgIHRvZ2dsZUhpdENhbnZhcygpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCB8fCAhdGhpcy5wYXJlbnRbJ2NvbnRlbnQnXSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBjb25zdCBhZGRlZCA9ICEhdGhpcy5oaXRDYW52YXMuX2NhbnZhcy5wYXJlbnROb2RlO1xuICAgICAgICBpZiAoYWRkZWQpIHtcbiAgICAgICAgICAgIHBhcmVudC5jb250ZW50LnJlbW92ZUNoaWxkKHRoaXMuaGl0Q2FudmFzLl9jYW52YXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50LmNvbnRlbnQuYXBwZW5kQ2hpbGQodGhpcy5oaXRDYW52YXMuX2NhbnZhcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgVXRpbC5yZWxlYXNlQ2FudmFzKHRoaXMuZ2V0TmF0aXZlQ2FudmFzRWxlbWVudCgpLCB0aGlzLmdldEhpdENhbnZhcygpLl9jYW52YXMpO1xuICAgICAgICByZXR1cm4gc3VwZXIuZGVzdHJveSgpO1xuICAgIH1cbn1cbkxheWVyLnByb3RvdHlwZS5ub2RlVHlwZSA9ICdMYXllcic7XG5fcmVnaXN0ZXJOb2RlKExheWVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKExheWVyLCAnaW1hZ2VTbW9vdGhpbmdFbmFibGVkJywgdHJ1ZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihMYXllciwgJ2NsZWFyQmVmb3JlRHJhdycsIHRydWUpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTGF5ZXIsICdoaXRHcmFwaEVuYWJsZWQnLCB0cnVlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuIiwiaW1wb3J0IHsgSGl0Q2FudmFzLCBTY2VuZUNhbnZhcyB9IGZyb20gXCIuL0NhbnZhcy5qc1wiO1xuaW1wb3J0IHsgaXNDU1NGaWx0ZXJzU3VwcG9ydGVkIH0gZnJvbSBcIi4vQ29udGV4dC5qc1wiO1xuaW1wb3J0IHsgREQgfSBmcm9tIFwiLi9EcmFnQW5kRHJvcC5qc1wiO1xuaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBUcmFuc2Zvcm0sIFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBnZXRCb29sZWFuVmFsaWRhdG9yLCBnZXROdW1iZXJWYWxpZGF0b3IsIGdldFN0cmluZ1ZhbGlkYXRvciwgfSBmcm9tIFwiLi9WYWxpZGF0b3JzLmpzXCI7XG5mdW5jdGlvbiBwYXJzZUNTU0ZpbHRlcnMoY3NzRmlsdGVyKSB7XG4gICAgY29uc3QgZmlsdGVyUmVnZXggPSAvKFxcdyspXFwoKFteKV0rKVxcKS9nO1xuICAgIGxldCBtYXRjaDtcbiAgICB3aGlsZSAoKG1hdGNoID0gZmlsdGVyUmVnZXguZXhlYyhjc3NGaWx0ZXIpKSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBbLCBmaWx0ZXJOYW1lLCBmaWx0ZXJWYWx1ZV0gPSBtYXRjaDtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdibHVyJzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsdXJSYWRpdXMgPSBwYXJzZUZsb2F0KGZpbHRlclZhbHVlLnJlcGxhY2UoJ3B4JywgJycpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJsdXJSYWRpdXMoYmx1clJhZGl1cyAqIDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IEtvbnZhRmlsdGVycyA9IEtvbnZhLkZpbHRlcnM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChLb252YUZpbHRlcnMgJiYgS29udmFGaWx0ZXJzLkJsdXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEtvbnZhRmlsdGVycy5CbHVyLmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdicmlnaHRuZXNzJzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJyaWdodG5lc3MgPSBmaWx0ZXJWYWx1ZS5pbmNsdWRlcygnJScpXG4gICAgICAgICAgICAgICAgICAgID8gcGFyc2VGbG9hdChmaWx0ZXJWYWx1ZSkgLyAxMDBcbiAgICAgICAgICAgICAgICAgICAgOiBwYXJzZUZsb2F0KGZpbHRlclZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyaWdodG5lc3MoYnJpZ2h0bmVzcyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IEtvbnZhRmlsdGVycyA9IEtvbnZhLkZpbHRlcnM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChLb252YUZpbHRlcnMgJiYgS29udmFGaWx0ZXJzLkJyaWdodG5lc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEtvbnZhRmlsdGVycy5CcmlnaHRuZXNzLmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdjb250cmFzdCc6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250cmFzdCA9IHBhcnNlRmxvYXQoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtvbnZhQ29udHJhc3QgPSAxMDAgKiAoTWF0aC5zcXJ0KGNvbnRyYXN0KSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRyYXN0KGtvbnZhQ29udHJhc3QpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBLb252YUZpbHRlcnMgPSBLb252YS5GaWx0ZXJzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoS29udmFGaWx0ZXJzICYmIEtvbnZhRmlsdGVycy5Db250cmFzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgS29udmFGaWx0ZXJzLkNvbnRyYXN0LmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdncmF5c2NhbGUnOiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgS29udmFGaWx0ZXJzID0gS29udmEuRmlsdGVycztcbiAgICAgICAgICAgICAgICAgICAgaWYgKEtvbnZhRmlsdGVycyAmJiBLb252YUZpbHRlcnMuR3JheXNjYWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBLb252YUZpbHRlcnMuR3JheXNjYWxlLmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdzZXBpYSc6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBLb252YUZpbHRlcnMgPSBLb252YS5GaWx0ZXJzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoS29udmFGaWx0ZXJzICYmIEtvbnZhRmlsdGVycy5TZXBpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgS29udmFGaWx0ZXJzLlNlcGlhLmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdpbnZlcnQnOiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgS29udmFGaWx0ZXJzID0gS29udmEuRmlsdGVycztcbiAgICAgICAgICAgICAgICAgICAgaWYgKEtvbnZhRmlsdGVycyAmJiBLb252YUZpbHRlcnMuSW52ZXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBLb252YUZpbHRlcnMuSW52ZXJ0LmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIFV0aWwud2FybihgQ1NTIGZpbHRlciBcIiR7ZmlsdGVyTmFtZX1cIiBpcyBub3Qgc3VwcG9ydGVkIGluIGZhbGxiYWNrIG1vZGUuIENvbnNpZGVyIHVzaW5nIGZ1bmN0aW9uIGZpbHRlcnMgZm9yIGJldHRlciBjb21wYXRpYmlsaXR5LmApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoKSA9PiB7IH07XG59XG5jb25zdCBBQlNPTFVURV9PUEFDSVRZID0gJ2Fic29sdXRlT3BhY2l0eScsIEFMTF9MSVNURU5FUlMgPSAnYWxsRXZlbnRMaXN0ZW5lcnMnLCBBQlNPTFVURV9UUkFOU0ZPUk0gPSAnYWJzb2x1dGVUcmFuc2Zvcm0nLCBBQlNPTFVURV9TQ0FMRSA9ICdhYnNvbHV0ZVNjYWxlJywgQ0FOVkFTID0gJ2NhbnZhcycsIENIQU5HRSA9ICdDaGFuZ2UnLCBDSElMRFJFTiA9ICdjaGlsZHJlbicsIEtPTlZBID0gJ2tvbnZhJywgTElTVEVOSU5HID0gJ2xpc3RlbmluZycsIE1PVVNFRU5URVIgPSAnbW91c2VlbnRlcicsIE1PVVNFTEVBVkUgPSAnbW91c2VsZWF2ZScsIFBPSU5URVJFTlRFUiA9ICdwb2ludGVyZW50ZXInLCBQT0lOVEVSTEVBVkUgPSAncG9pbnRlcmxlYXZlJywgVE9VQ0hFTlRFUiA9ICd0b3VjaGVudGVyJywgVE9VQ0hMRUFWRSA9ICd0b3VjaGxlYXZlJywgTkFNRSA9ICduYW1lJywgU0VUID0gJ3NldCcsIFNIQVBFID0gJ1NoYXBlJywgU1BBQ0UgPSAnICcsIFNUQUdFID0gJ3N0YWdlJywgVFJBTlNGT1JNID0gJ3RyYW5zZm9ybScsIFVQUEVSX1NUQUdFID0gJ1N0YWdlJywgVklTSUJMRSA9ICd2aXNpYmxlJywgVFJBTlNGT1JNX0NIQU5HRV9TVFIgPSBbXG4gICAgJ3hDaGFuZ2Uua29udmEnLFxuICAgICd5Q2hhbmdlLmtvbnZhJyxcbiAgICAnc2NhbGVYQ2hhbmdlLmtvbnZhJyxcbiAgICAnc2NhbGVZQ2hhbmdlLmtvbnZhJyxcbiAgICAnc2tld1hDaGFuZ2Uua29udmEnLFxuICAgICdza2V3WUNoYW5nZS5rb252YScsXG4gICAgJ3JvdGF0aW9uQ2hhbmdlLmtvbnZhJyxcbiAgICAnb2Zmc2V0WENoYW5nZS5rb252YScsXG4gICAgJ29mZnNldFlDaGFuZ2Uua29udmEnLFxuICAgICd0cmFuc2Zvcm1zRW5hYmxlZENoYW5nZS5rb252YScsXG5dLmpvaW4oU1BBQ0UpO1xubGV0IGlkQ291bnRlciA9IDE7XG5leHBvcnQgY2xhc3MgTm9kZSB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX2lkID0gaWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSB7fTtcbiAgICAgICAgdGhpcy5hdHRycyA9IHt9O1xuICAgICAgICB0aGlzLmluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fYWxsRXZlbnRMaXN0ZW5lcnMgPSBudWxsO1xuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLl9hdHRhY2hlZERlcHNMaXN0ZW5lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuX2xhc3RQb3MgPSBudWxsO1xuICAgICAgICB0aGlzLl9iYXRjaGluZ1RyYW5zZm9ybUNoYW5nZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9uZWVkQ2xlYXJUcmFuc2Zvcm1DYWNoZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9pc1VuZGVyQ2FjaGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fZHJhZ0V2ZW50SWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9zaG91bGRGaXJlQ2hhbmdlRXZlbnRzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2V0QXR0cnMoY29uZmlnKTtcbiAgICAgICAgdGhpcy5fc2hvdWxkRmlyZUNoYW5nZUV2ZW50cyA9IHRydWU7XG4gICAgfVxuICAgIGhhc0NoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIF9jbGVhckNhY2hlKGF0dHIpIHtcbiAgICAgICAgaWYgKChhdHRyID09PSBUUkFOU0ZPUk0gfHwgYXR0ciA9PT0gQUJTT0xVVEVfVFJBTlNGT1JNKSAmJlxuICAgICAgICAgICAgdGhpcy5fY2FjaGUuZ2V0KGF0dHIpKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZS5nZXQoYXR0cikuZGlydHkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLmRlbGV0ZShhdHRyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2dldENhY2hlKGF0dHIsIHByaXZhdGVHZXR0ZXIpIHtcbiAgICAgICAgbGV0IGNhY2hlID0gdGhpcy5fY2FjaGUuZ2V0KGF0dHIpO1xuICAgICAgICBjb25zdCBpc1RyYW5zZm9ybSA9IGF0dHIgPT09IFRSQU5TRk9STSB8fCBhdHRyID09PSBBQlNPTFVURV9UUkFOU0ZPUk07XG4gICAgICAgIGNvbnN0IGludmFsaWQgPSBjYWNoZSA9PT0gdW5kZWZpbmVkIHx8IChpc1RyYW5zZm9ybSAmJiBjYWNoZS5kaXJ0eSA9PT0gdHJ1ZSk7XG4gICAgICAgIGlmIChpbnZhbGlkKSB7XG4gICAgICAgICAgICBjYWNoZSA9IHByaXZhdGVHZXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLnNldChhdHRyLCBjYWNoZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhY2hlO1xuICAgIH1cbiAgICBfY2FsY3VsYXRlKG5hbWUsIGRlcHMsIGdldHRlcikge1xuICAgICAgICBpZiAoIXRoaXMuX2F0dGFjaGVkRGVwc0xpc3RlbmVycy5nZXQobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlcHNTdHJpbmcgPSBkZXBzLm1hcCgoZGVwKSA9PiBkZXAgKyAnQ2hhbmdlLmtvbnZhJykuam9pbihTUEFDRSk7XG4gICAgICAgICAgICB0aGlzLm9uKGRlcHNTdHJpbmcsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKG5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9hdHRhY2hlZERlcHNMaXN0ZW5lcnMuc2V0KG5hbWUsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShuYW1lLCBnZXR0ZXIpO1xuICAgIH1cbiAgICBfZ2V0Q2FudmFzQ2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZS5nZXQoQ0FOVkFTKTtcbiAgICB9XG4gICAgX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShhdHRyKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyQ2FjaGUoYXR0cik7XG4gICAgICAgIGlmIChhdHRyID09PSBBQlNPTFVURV9UUkFOU0ZPUk0pIHtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnYWJzb2x1dGVUcmFuc2Zvcm1DaGFuZ2UnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGVhckNhY2hlKCkge1xuICAgICAgICBpZiAodGhpcy5fY2FjaGUuaGFzKENBTlZBUykpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc2NlbmUsIGZpbHRlciwgaGl0LCBidWZmZXIgfSA9IHRoaXMuX2NhY2hlLmdldChDQU5WQVMpO1xuICAgICAgICAgICAgVXRpbC5yZWxlYXNlQ2FudmFzKHNjZW5lLCBmaWx0ZXIsIGhpdCwgYnVmZmVyKTtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLmRlbGV0ZShDQU5WQVMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZSgpO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0RHJhdygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgY2FjaGUoY29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGNvbmYgPSBjb25maWcgfHwge307XG4gICAgICAgIGxldCByZWN0ID0ge307XG4gICAgICAgIGlmIChjb25mLnggPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgY29uZi55ID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgIGNvbmYud2lkdGggPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgY29uZi5oZWlnaHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVjdCA9IHRoaXMuZ2V0Q2xpZW50UmVjdCh7XG4gICAgICAgICAgICAgICAgc2tpcFRyYW5zZm9ybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICByZWxhdGl2ZVRvOiB0aGlzLmdldFBhcmVudCgpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGxldCB3aWR0aCA9IE1hdGguY2VpbChjb25mLndpZHRoIHx8IHJlY3Qud2lkdGgpLCBoZWlnaHQgPSBNYXRoLmNlaWwoY29uZi5oZWlnaHQgfHwgcmVjdC5oZWlnaHQpLCBwaXhlbFJhdGlvID0gY29uZi5waXhlbFJhdGlvLCB4ID0gY29uZi54ID09PSB1bmRlZmluZWQgPyBNYXRoLmZsb29yKHJlY3QueCkgOiBjb25mLngsIHkgPSBjb25mLnkgPT09IHVuZGVmaW5lZCA/IE1hdGguZmxvb3IocmVjdC55KSA6IGNvbmYueSwgb2Zmc2V0ID0gY29uZi5vZmZzZXQgfHwgMCwgZHJhd0JvcmRlciA9IGNvbmYuZHJhd0JvcmRlciB8fCBmYWxzZSwgaGl0Q2FudmFzUGl4ZWxSYXRpbyA9IGNvbmYuaGl0Q2FudmFzUGl4ZWxSYXRpbyB8fCAxO1xuICAgICAgICBpZiAoIXdpZHRoIHx8ICFoZWlnaHQpIHtcbiAgICAgICAgICAgIFV0aWwuZXJyb3IoJ0NhbiBub3QgY2FjaGUgdGhlIG5vZGUuIFdpZHRoIG9yIGhlaWdodCBvZiB0aGUgbm9kZSBlcXVhbHMgMC4gQ2FjaGluZyBpcyBza2lwcGVkLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV4dHJhUGFkZGluZ1ggPSBNYXRoLmFicyhNYXRoLnJvdW5kKHJlY3QueCkgLSB4KSA+IDAuNSA/IDEgOiAwO1xuICAgICAgICBjb25zdCBleHRyYVBhZGRpbmdZID0gTWF0aC5hYnMoTWF0aC5yb3VuZChyZWN0LnkpIC0geSkgPiAwLjUgPyAxIDogMDtcbiAgICAgICAgd2lkdGggKz0gb2Zmc2V0ICogMiArIGV4dHJhUGFkZGluZ1g7XG4gICAgICAgIGhlaWdodCArPSBvZmZzZXQgKiAyICsgZXh0cmFQYWRkaW5nWTtcbiAgICAgICAgeCAtPSBvZmZzZXQ7XG4gICAgICAgIHkgLT0gb2Zmc2V0O1xuICAgICAgICBjb25zdCBjYWNoZWRTY2VuZUNhbnZhcyA9IG5ldyBTY2VuZUNhbnZhcyh7XG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBwaXhlbFJhdGlvLFxuICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgIH0pLCBjYWNoZWRGaWx0ZXJDYW52YXMgPSBuZXcgU2NlbmVDYW52YXMoe1xuICAgICAgICAgICAgcGl4ZWxSYXRpbzogcGl4ZWxSYXRpbyxcbiAgICAgICAgICAgIHdpZHRoOiAwLFxuICAgICAgICAgICAgaGVpZ2h0OiAwLFxuICAgICAgICAgICAgd2lsbFJlYWRGcmVxdWVudGx5OiB0cnVlLFxuICAgICAgICB9KSwgY2FjaGVkSGl0Q2FudmFzID0gbmV3IEhpdENhbnZhcyh7XG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBoaXRDYW52YXNQaXhlbFJhdGlvLFxuICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgIH0pLCBzY2VuZUNvbnRleHQgPSBjYWNoZWRTY2VuZUNhbnZhcy5nZXRDb250ZXh0KCksIGhpdENvbnRleHQgPSBjYWNoZWRIaXRDYW52YXMuZ2V0Q29udGV4dCgpO1xuICAgICAgICBjb25zdCBidWZmZXJDYW52YXMgPSBuZXcgU2NlbmVDYW52YXMoe1xuICAgICAgICAgICAgd2lkdGg6IGNhY2hlZFNjZW5lQ2FudmFzLndpZHRoIC8gY2FjaGVkU2NlbmVDYW52YXMucGl4ZWxSYXRpbyArIE1hdGguYWJzKHgpLFxuICAgICAgICAgICAgaGVpZ2h0OiBjYWNoZWRTY2VuZUNhbnZhcy5oZWlnaHQgLyBjYWNoZWRTY2VuZUNhbnZhcy5waXhlbFJhdGlvICsgTWF0aC5hYnMoeSksXG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBjYWNoZWRTY2VuZUNhbnZhcy5waXhlbFJhdGlvLFxuICAgICAgICB9KSwgYnVmZmVyQ29udGV4dCA9IGJ1ZmZlckNhbnZhcy5nZXRDb250ZXh0KCk7XG4gICAgICAgIGNhY2hlZEhpdENhbnZhcy5pc0NhY2hlID0gdHJ1ZTtcbiAgICAgICAgY2FjaGVkU2NlbmVDYW52YXMuaXNDYWNoZSA9IHRydWU7XG4gICAgICAgIHRoaXMuX2NhY2hlLmRlbGV0ZShDQU5WQVMpO1xuICAgICAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgICAgICBpZiAoY29uZi5pbWFnZVNtb290aGluZ0VuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBjYWNoZWRTY2VuZUNhbnZhcy5nZXRDb250ZXh0KCkuX2NvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICBjYWNoZWRGaWx0ZXJDYW52YXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHNjZW5lQ29udGV4dC5zYXZlKCk7XG4gICAgICAgIGhpdENvbnRleHQuc2F2ZSgpO1xuICAgICAgICBidWZmZXJDb250ZXh0LnNhdmUoKTtcbiAgICAgICAgc2NlbmVDb250ZXh0LnRyYW5zbGF0ZSgteCwgLXkpO1xuICAgICAgICBoaXRDb250ZXh0LnRyYW5zbGF0ZSgteCwgLXkpO1xuICAgICAgICBidWZmZXJDb250ZXh0LnRyYW5zbGF0ZSgteCwgLXkpO1xuICAgICAgICBidWZmZXJDYW52YXMueCA9IHg7XG4gICAgICAgIGJ1ZmZlckNhbnZhcy55ID0geTtcbiAgICAgICAgdGhpcy5faXNVbmRlckNhY2hlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKEFCU09MVVRFX09QQUNJVFkpO1xuICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfU0NBTEUpO1xuICAgICAgICB0aGlzLmRyYXdTY2VuZShjYWNoZWRTY2VuZUNhbnZhcywgdGhpcywgYnVmZmVyQ2FudmFzKTtcbiAgICAgICAgdGhpcy5kcmF3SGl0KGNhY2hlZEhpdENhbnZhcywgdGhpcyk7XG4gICAgICAgIHRoaXMuX2lzVW5kZXJDYWNoZSA9IGZhbHNlO1xuICAgICAgICBzY2VuZUNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICBoaXRDb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgaWYgKGRyYXdCb3JkZXIpIHtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBzY2VuZUNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzY2VuZUNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zZXRBdHRyKCdzdHJva2VTdHlsZScsICdyZWQnKTtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zZXRBdHRyKCdsaW5lV2lkdGgnLCA1KTtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2FjaGUuc2V0KENBTlZBUywge1xuICAgICAgICAgICAgc2NlbmU6IGNhY2hlZFNjZW5lQ2FudmFzLFxuICAgICAgICAgICAgZmlsdGVyOiBjYWNoZWRGaWx0ZXJDYW52YXMsXG4gICAgICAgICAgICBoaXQ6IGNhY2hlZEhpdENhbnZhcyxcbiAgICAgICAgICAgIGJ1ZmZlcjogYnVmZmVyQ2FudmFzLFxuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHksXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0RHJhdygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaXNDYWNoZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZS5oYXMoQ0FOVkFTKTtcbiAgICB9XG4gICAgZ2V0Q2xpZW50UmVjdChjb25maWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdhYnN0cmFjdCBcImdldENsaWVudFJlY3RcIiBtZXRob2QgY2FsbCcpO1xuICAgIH1cbiAgICBfdHJhbnNmb3JtZWRSZWN0KHJlY3QsIHRvcCkge1xuICAgICAgICBjb25zdCBwb2ludHMgPSBbXG4gICAgICAgICAgICB7IHg6IHJlY3QueCwgeTogcmVjdC55IH0sXG4gICAgICAgICAgICB7IHg6IHJlY3QueCArIHJlY3Qud2lkdGgsIHk6IHJlY3QueSB9LFxuICAgICAgICAgICAgeyB4OiByZWN0LnggKyByZWN0LndpZHRoLCB5OiByZWN0LnkgKyByZWN0LmhlaWdodCB9LFxuICAgICAgICAgICAgeyB4OiByZWN0LngsIHk6IHJlY3QueSArIHJlY3QuaGVpZ2h0IH0sXG4gICAgICAgIF07XG4gICAgICAgIGxldCBtaW5YID0gSW5maW5pdHksIG1pblkgPSBJbmZpbml0eSwgbWF4WCA9IC1JbmZpbml0eSwgbWF4WSA9IC1JbmZpbml0eTtcbiAgICAgICAgY29uc3QgdHJhbnMgPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCk7XG4gICAgICAgIHBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFucy5wb2ludChwb2ludCk7XG4gICAgICAgICAgICBpZiAobWluWCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbWluWCA9IG1heFggPSB0cmFuc2Zvcm1lZC54O1xuICAgICAgICAgICAgICAgIG1pblkgPSBtYXhZID0gdHJhbnNmb3JtZWQueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCB0cmFuc2Zvcm1lZC54KTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB0cmFuc2Zvcm1lZC55KTtcbiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCB0cmFuc2Zvcm1lZC54KTtcbiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCB0cmFuc2Zvcm1lZC55KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBtaW5YLFxuICAgICAgICAgICAgeTogbWluWSxcbiAgICAgICAgICAgIHdpZHRoOiBtYXhYIC0gbWluWCxcbiAgICAgICAgICAgIGhlaWdodDogbWF4WSAtIG1pblksXG4gICAgICAgIH07XG4gICAgfVxuICAgIF9kcmF3Q2FjaGVkU2NlbmVDYW52YXMoY29udGV4dCkge1xuICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgY29udGV4dC5fYXBwbHlPcGFjaXR5KHRoaXMpO1xuICAgICAgICBjb250ZXh0Ll9hcHBseUdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbih0aGlzKTtcbiAgICAgICAgY29uc3QgY2FudmFzQ2FjaGUgPSB0aGlzLl9nZXRDYW52YXNDYWNoZSgpO1xuICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShjYW52YXNDYWNoZS54LCBjYW52YXNDYWNoZS55KTtcbiAgICAgICAgY29uc3QgY2FjaGVDYW52YXMgPSB0aGlzLl9nZXRDYWNoZWRTY2VuZUNhbnZhcygpO1xuICAgICAgICBjb25zdCByYXRpbyA9IGNhY2hlQ2FudmFzLnBpeGVsUmF0aW87XG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGNhY2hlQ2FudmFzLl9jYW52YXMsIDAsIDAsIGNhY2hlQ2FudmFzLndpZHRoIC8gcmF0aW8sIGNhY2hlQ2FudmFzLmhlaWdodCAvIHJhdGlvKTtcbiAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgfVxuICAgIF9kcmF3Q2FjaGVkSGl0Q2FudmFzKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgY2FudmFzQ2FjaGUgPSB0aGlzLl9nZXRDYW52YXNDYWNoZSgpLCBoaXRDYW52YXMgPSBjYW52YXNDYWNoZS5oaXQ7XG4gICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShjYW52YXNDYWNoZS54LCBjYW52YXNDYWNoZS55KTtcbiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaGl0Q2FudmFzLl9jYW52YXMsIDAsIDAsIGhpdENhbnZhcy53aWR0aCAvIGhpdENhbnZhcy5waXhlbFJhdGlvLCBoaXRDYW52YXMuaGVpZ2h0IC8gaGl0Q2FudmFzLnBpeGVsUmF0aW8pO1xuICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICB9XG4gICAgX2dldENhY2hlZFNjZW5lQ2FudmFzKCkge1xuICAgICAgICBsZXQgZmlsdGVycyA9IHRoaXMuZmlsdGVycygpLCBjYWNoZWRDYW52YXMgPSB0aGlzLl9nZXRDYW52YXNDYWNoZSgpLCBzY2VuZUNhbnZhcyA9IGNhY2hlZENhbnZhcy5zY2VuZSwgZmlsdGVyQ2FudmFzID0gY2FjaGVkQ2FudmFzLmZpbHRlciwgZmlsdGVyQ29udGV4dCA9IGZpbHRlckNhbnZhcy5nZXRDb250ZXh0KCksIGxlbiwgaW1hZ2VEYXRhLCBuLCBmaWx0ZXI7XG4gICAgICAgIGlmICghZmlsdGVycyB8fCBmaWx0ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHNjZW5lQ2FudmFzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9maWx0ZXJVcFRvRGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlckNhbnZhcztcbiAgICAgICAgfVxuICAgICAgICBsZXQgdXNlTmF0aXZlT25seSA9IHRydWU7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tSZXF1aXJlZCA9IHR5cGVvZiBmaWx0ZXJzW2ldID09PSAnc3RyaW5nJyAmJiAhaXNDU1NGaWx0ZXJzU3VwcG9ydGVkKCk7XG4gICAgICAgICAgICBpZiAoZmFsbGJhY2tSZXF1aXJlZCkge1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWx0ZXJzW2ldICE9PSAnc3RyaW5nJyB8fCAhaXNDU1NGaWx0ZXJzU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgICAgICAgICB1c2VOYXRpdmVPbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmF0aW8gPSBzY2VuZUNhbnZhcy5waXhlbFJhdGlvO1xuICAgICAgICBmaWx0ZXJDYW52YXMuc2V0U2l6ZShzY2VuZUNhbnZhcy53aWR0aCAvIHNjZW5lQ2FudmFzLnBpeGVsUmF0aW8sIHNjZW5lQ2FudmFzLmhlaWdodCAvIHNjZW5lQ2FudmFzLnBpeGVsUmF0aW8pO1xuICAgICAgICBpZiAodXNlTmF0aXZlT25seSkge1xuICAgICAgICAgICAgY29uc3QgZmluYWxGaWx0ZXIgPSBmaWx0ZXJzLmpvaW4oJyAnKTtcbiAgICAgICAgICAgIGZpbHRlckNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgZmlsdGVyQ29udGV4dC5zZXRBdHRyKCdmaWx0ZXInLCBmaW5hbEZpbHRlcik7XG4gICAgICAgICAgICBmaWx0ZXJDb250ZXh0LmRyYXdJbWFnZShzY2VuZUNhbnZhcy5fY2FudmFzLCAwLCAwLCBzY2VuZUNhbnZhcy5nZXRXaWR0aCgpIC8gcmF0aW8sIHNjZW5lQ2FudmFzLmdldEhlaWdodCgpIC8gcmF0aW8pO1xuICAgICAgICAgICAgZmlsdGVyQ29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyQ2FudmFzO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZW4gPSBmaWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgICAgIGZpbHRlckNvbnRleHQuY2xlYXIoKTtcbiAgICAgICAgICAgIGZpbHRlckNvbnRleHQuZHJhd0ltYWdlKHNjZW5lQ2FudmFzLl9jYW52YXMsIDAsIDAsIHNjZW5lQ2FudmFzLmdldFdpZHRoKCkgLyByYXRpbywgc2NlbmVDYW52YXMuZ2V0SGVpZ2h0KCkgLyByYXRpbyk7XG4gICAgICAgICAgICBpbWFnZURhdGEgPSBmaWx0ZXJDb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBmaWx0ZXJDYW52YXMuZ2V0V2lkdGgoKSwgZmlsdGVyQ2FudmFzLmdldEhlaWdodCgpKTtcbiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIGZpbHRlciA9IGZpbHRlcnNbbl07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWx0ZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IHBhcnNlQ1NTRmlsdGVycyhmaWx0ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWx0ZXIuY2FsbCh0aGlzLCBpbWFnZURhdGEpO1xuICAgICAgICAgICAgICAgIGZpbHRlckNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIFV0aWwuZXJyb3IoJ1VuYWJsZSB0byBhcHBseSBmaWx0ZXIuICcgK1xuICAgICAgICAgICAgICAgIGUubWVzc2FnZSArXG4gICAgICAgICAgICAgICAgJyBUaGlzIHBvc3QgbXkgaGVscCB5b3UgaHR0cHM6Ly9rb252YWpzLm9yZy9kb2NzL3Bvc3RzL1RhaW50ZWRfQ2FudmFzLmh0bWwuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gZmlsdGVyQ2FudmFzO1xuICAgIH1cbiAgICBvbihldnRTdHIsIGhhbmRsZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NhY2hlKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZS5kZWxldGUoQUxMX0xJU1RFTkVSUyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IGV2dFN0ci5zcGxpdChTUEFDRSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgZXZlbnRzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGV2ZW50c1tuXTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2VFdmVudCA9IHBhcnRzWzBdO1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IHBhcnRzWzFdIHx8ICcnO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmV2ZW50TGlzdGVuZXJzW2Jhc2VFdmVudF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzW2Jhc2VFdmVudF0gPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnNbYmFzZUV2ZW50XS5wdXNoKHsgbmFtZSwgaGFuZGxlciB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgb2ZmKGV2dFN0ciwgY2FsbGJhY2spIHtcbiAgICAgICAgbGV0IGV2ZW50cyA9IChldnRTdHIgfHwgJycpLnNwbGl0KFNQQUNFKSwgbGVuID0gZXZlbnRzLmxlbmd0aCwgbiwgdCwgZXZlbnQsIHBhcnRzLCBiYXNlRXZlbnQsIG5hbWU7XG4gICAgICAgIHRoaXMuX2NhY2hlICYmIHRoaXMuX2NhY2hlLmRlbGV0ZShBTExfTElTVEVORVJTKTtcbiAgICAgICAgaWYgKCFldnRTdHIpIHtcbiAgICAgICAgICAgIGZvciAodCBpbiB0aGlzLmV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2ZmKHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgZXZlbnQgPSBldmVudHNbbl07XG4gICAgICAgICAgICBwYXJ0cyA9IGV2ZW50LnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBiYXNlRXZlbnQgPSBwYXJ0c1swXTtcbiAgICAgICAgICAgIG5hbWUgPSBwYXJ0c1sxXTtcbiAgICAgICAgICAgIGlmIChiYXNlRXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ldmVudExpc3RlbmVyc1tiYXNlRXZlbnRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29mZihiYXNlRXZlbnQsIG5hbWUsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHQgaW4gdGhpcy5ldmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vZmYodCwgbmFtZSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZGlzcGF0Y2hFdmVudChldnQpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIHRhcmdldDogdGhpcyxcbiAgICAgICAgICAgIHR5cGU6IGV2dC50eXBlLFxuICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmlyZShldnQudHlwZSwgZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBhZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5vbih0eXBlLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgZXZ0LmV2dCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlKSB7XG4gICAgICAgIHRoaXMub2ZmKHR5cGUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgX2RlbGVnYXRlKGV2ZW50LCBzZWxlY3RvciwgaGFuZGxlcikge1xuICAgICAgICBjb25zdCBzdG9wTm9kZSA9IHRoaXM7XG4gICAgICAgIHRoaXMub24oZXZlbnQsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldHMgPSBldnQudGFyZ2V0LmZpbmRBbmNlc3RvcnMoc2VsZWN0b3IsIHRydWUsIHN0b3BOb2RlKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGV2dCA9IFV0aWwuY2xvbmVPYmplY3QoZXZ0KTtcbiAgICAgICAgICAgICAgICBldnQuY3VycmVudFRhcmdldCA9IHRhcmdldHNbaV07XG4gICAgICAgICAgICAgICAgaGFuZGxlci5jYWxsKHRhcmdldHNbaV0sIGV2dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZW1vdmUoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcoKSkge1xuICAgICAgICAgICAgdGhpcy5zdG9wRHJhZygpO1xuICAgICAgICB9XG4gICAgICAgIERELl9kcmFnRWxlbWVudHMuZGVsZXRlKHRoaXMuX2lkKTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBfY2xlYXJDYWNoZXMoKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShBQlNPTFVURV9UUkFOU0ZPUk0pO1xuICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfT1BBQ0lUWSk7XG4gICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShBQlNPTFVURV9TQ0FMRSk7XG4gICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShTVEFHRSk7XG4gICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShWSVNJQkxFKTtcbiAgICAgICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKExJU1RFTklORyk7XG4gICAgfVxuICAgIF9yZW1vdmUoKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyQ2FjaGVzKCk7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCk7XG4gICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4uc3BsaWNlKHRoaXMuaW5kZXgsIDEpO1xuICAgICAgICAgICAgcGFyZW50Ll9zZXRDaGlsZHJlbkluZGljZXMoKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmNsZWFyQ2FjaGUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGdldEF0dHIoYXR0cikge1xuICAgICAgICBjb25zdCBtZXRob2QgPSAnZ2V0JyArIFV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG4gICAgICAgIGlmIChVdGlsLl9pc0Z1bmN0aW9uKHRoaXNbbWV0aG9kXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzW21ldGhvZF0oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hdHRyc1thdHRyXTtcbiAgICB9XG4gICAgZ2V0QW5jZXN0b3JzKCkge1xuICAgICAgICBsZXQgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKSwgYW5jZXN0b3JzID0gW107XG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHBhcmVudCk7XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQuZ2V0UGFyZW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFuY2VzdG9ycztcbiAgICB9XG4gICAgZ2V0QXR0cnMoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5hdHRycyB8fCB7fSk7XG4gICAgfVxuICAgIHNldEF0dHJzKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9iYXRjaFRyYW5zZm9ybUNoYW5nZXMoKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGtleSwgbWV0aG9kO1xuICAgICAgICAgICAgaWYgKCFjb25maWcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoa2V5IGluIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IENISUxEUkVOKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZXRob2QgPSBTRVQgKyBVdGlsLl9jYXBpdGFsaXplKGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKFV0aWwuX2lzRnVuY3Rpb24odGhpc1ttZXRob2RdKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW21ldGhvZF0oY29uZmlnW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0QXR0cihrZXksIGNvbmZpZ1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaXNMaXN0ZW5pbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShMSVNURU5JTkcsIHRoaXMuX2lzTGlzdGVuaW5nKTtcbiAgICB9XG4gICAgX2lzTGlzdGVuaW5nKHJlbGF0aXZlVG8pIHtcbiAgICAgICAgY29uc3QgbGlzdGVuaW5nID0gdGhpcy5saXN0ZW5pbmcoKTtcbiAgICAgICAgaWYgKCFsaXN0ZW5pbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpO1xuICAgICAgICBpZiAocGFyZW50ICYmIHBhcmVudCAhPT0gcmVsYXRpdmVUbyAmJiB0aGlzICE9PSByZWxhdGl2ZVRvKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50Ll9pc0xpc3RlbmluZyhyZWxhdGl2ZVRvKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzVmlzaWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKFZJU0lCTEUsIHRoaXMuX2lzVmlzaWJsZSk7XG4gICAgfVxuICAgIF9pc1Zpc2libGUocmVsYXRpdmVUbykge1xuICAgICAgICBjb25zdCB2aXNpYmxlID0gdGhpcy52aXNpYmxlKCk7XG4gICAgICAgIGlmICghdmlzaWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCk7XG4gICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50ICE9PSByZWxhdGl2ZVRvICYmIHRoaXMgIT09IHJlbGF0aXZlVG8pIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuX2lzVmlzaWJsZShyZWxhdGl2ZVRvKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNob3VsZERyYXdIaXQodG9wLCBza2lwRHJhZ0NoZWNrID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKHRvcCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzVmlzaWJsZSh0b3ApICYmIHRoaXMuX2lzTGlzdGVuaW5nKHRvcCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyKCk7XG4gICAgICAgIGxldCBsYXllclVuZGVyRHJhZyA9IGZhbHNlO1xuICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLmZvckVhY2goKGVsZW0pID0+IHtcbiAgICAgICAgICAgIGlmIChlbGVtLmRyYWdTdGF0dXMgIT09ICdkcmFnZ2luZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbGVtLm5vZGUubm9kZVR5cGUgPT09ICdTdGFnZScpIHtcbiAgICAgICAgICAgICAgICBsYXllclVuZGVyRHJhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbGVtLm5vZGUuZ2V0TGF5ZXIoKSA9PT0gbGF5ZXIpIHtcbiAgICAgICAgICAgICAgICBsYXllclVuZGVyRHJhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkcmFnU2tpcCA9ICFza2lwRHJhZ0NoZWNrICYmXG4gICAgICAgICAgICAhS29udmEuaGl0T25EcmFnRW5hYmxlZCAmJlxuICAgICAgICAgICAgKGxheWVyVW5kZXJEcmFnIHx8IEtvbnZhLmlzVHJhbnNmb3JtaW5nKCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5pc0xpc3RlbmluZygpICYmIHRoaXMuaXNWaXNpYmxlKCkgJiYgIWRyYWdTa2lwO1xuICAgIH1cbiAgICBzaG93KCkge1xuICAgICAgICB0aGlzLnZpc2libGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBoaWRlKCkge1xuICAgICAgICB0aGlzLnZpc2libGUoZmFsc2UpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0WkluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleCB8fCAwO1xuICAgIH1cbiAgICBnZXRBYnNvbHV0ZVpJbmRleCgpIHtcbiAgICAgICAgbGV0IGRlcHRoID0gdGhpcy5nZXREZXB0aCgpLCB0aGF0ID0gdGhpcywgaW5kZXggPSAwLCBub2RlcywgbGVuLCBuLCBjaGlsZDtcbiAgICAgICAgZnVuY3Rpb24gYWRkQ2hpbGRyZW4oY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIG5vZGVzID0gW107XG4gICAgICAgICAgICBsZW4gPSBjaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICBjaGlsZCA9IGNoaWxkcmVuW25dO1xuICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlICE9PSBTSEFQRSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlcyA9IG5vZGVzLmNvbmNhdChjaGlsZC5nZXRDaGlsZHJlbigpLnNsaWNlKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuX2lkID09PSB0aGF0Ll9pZCkge1xuICAgICAgICAgICAgICAgICAgICBuID0gbGVuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPiAwICYmIG5vZGVzWzBdLmdldERlcHRoKCkgPD0gZGVwdGgpIHtcbiAgICAgICAgICAgICAgICBhZGRDaGlsZHJlbihub2Rlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgIGlmICh0aGF0Lm5vZGVUeXBlICE9PSBVUFBFUl9TVEFHRSAmJiBzdGFnZSkge1xuICAgICAgICAgICAgYWRkQ2hpbGRyZW4oc3RhZ2UuZ2V0Q2hpbGRyZW4oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cbiAgICBnZXREZXB0aCgpIHtcbiAgICAgICAgbGV0IGRlcHRoID0gMCwgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXB0aDtcbiAgICB9XG4gICAgX2JhdGNoVHJhbnNmb3JtQ2hhbmdlcyhmdW5jKSB7XG4gICAgICAgIHRoaXMuX2JhdGNoaW5nVHJhbnNmb3JtQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgZnVuYygpO1xuICAgICAgICB0aGlzLl9iYXRjaGluZ1RyYW5zZm9ybUNoYW5nZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5fbmVlZENsZWFyVHJhbnNmb3JtQ2FjaGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ2FjaGUoVFJBTlNGT1JNKTtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShBQlNPTFVURV9UUkFOU0ZPUk0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25lZWRDbGVhclRyYW5zZm9ybUNhY2hlID0gZmFsc2U7XG4gICAgfVxuICAgIHNldFBvc2l0aW9uKHBvcykge1xuICAgICAgICB0aGlzLl9iYXRjaFRyYW5zZm9ybUNoYW5nZXMoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy54KHBvcy54KTtcbiAgICAgICAgICAgIHRoaXMueShwb3MueSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0UG9zaXRpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB0aGlzLngoKSxcbiAgICAgICAgICAgIHk6IHRoaXMueSgpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXRSZWxhdGl2ZVBvaW50ZXJQb3NpdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgIGlmICghc3RhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBvcyA9IHN0YWdlLmdldFBvaW50ZXJQb3NpdGlvbigpO1xuICAgICAgICBpZiAoIXBvcykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gdGhpcy5nZXRBYnNvbHV0ZVRyYW5zZm9ybSgpLmNvcHkoKTtcbiAgICAgICAgdHJhbnNmb3JtLmludmVydCgpO1xuICAgICAgICByZXR1cm4gdHJhbnNmb3JtLnBvaW50KHBvcyk7XG4gICAgfVxuICAgIGdldEFic29sdXRlUG9zaXRpb24odG9wKSB7XG4gICAgICAgIGxldCBoYXZlQ2FjaGVkUGFyZW50ID0gZmFsc2U7XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgaWYgKHBhcmVudC5pc0NhY2hlZCgpKSB7XG4gICAgICAgICAgICAgICAgaGF2ZUNhY2hlZFBhcmVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXZlQ2FjaGVkUGFyZW50ICYmICF0b3ApIHtcbiAgICAgICAgICAgIHRvcCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWJzb2x1dGVNYXRyaXggPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCksIGFic29sdXRlVHJhbnNmb3JtID0gbmV3IFRyYW5zZm9ybSgpLCBvZmZzZXQgPSB0aGlzLm9mZnNldCgpO1xuICAgICAgICBhYnNvbHV0ZVRyYW5zZm9ybS5tID0gYWJzb2x1dGVNYXRyaXguc2xpY2UoKTtcbiAgICAgICAgYWJzb2x1dGVUcmFuc2Zvcm0udHJhbnNsYXRlKG9mZnNldC54LCBvZmZzZXQueSk7XG4gICAgICAgIHJldHVybiBhYnNvbHV0ZVRyYW5zZm9ybS5nZXRUcmFuc2xhdGlvbigpO1xuICAgIH1cbiAgICBzZXRBYnNvbHV0ZVBvc2l0aW9uKHBvcykge1xuICAgICAgICBjb25zdCB7IHgsIHksIC4uLm9yaWdUcmFucyB9ID0gdGhpcy5fY2xlYXJUcmFuc2Zvcm0oKTtcbiAgICAgICAgdGhpcy5hdHRycy54ID0geDtcbiAgICAgICAgdGhpcy5hdHRycy55ID0geTtcbiAgICAgICAgdGhpcy5fY2xlYXJDYWNoZShUUkFOU0ZPUk0pO1xuICAgICAgICBjb25zdCBpdCA9IHRoaXMuX2dldEFic29sdXRlVHJhbnNmb3JtKCkuY29weSgpO1xuICAgICAgICBpdC5pbnZlcnQoKTtcbiAgICAgICAgaXQudHJhbnNsYXRlKHBvcy54LCBwb3MueSk7XG4gICAgICAgIHBvcyA9IHtcbiAgICAgICAgICAgIHg6IHRoaXMuYXR0cnMueCArIGl0LmdldFRyYW5zbGF0aW9uKCkueCxcbiAgICAgICAgICAgIHk6IHRoaXMuYXR0cnMueSArIGl0LmdldFRyYW5zbGF0aW9uKCkueSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fc2V0VHJhbnNmb3JtKG9yaWdUcmFucyk7XG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb24oeyB4OiBwb3MueCwgeTogcG9zLnkgfSk7XG4gICAgICAgIHRoaXMuX2NsZWFyQ2FjaGUoVFJBTlNGT1JNKTtcbiAgICAgICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKEFCU09MVVRFX1RSQU5TRk9STSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBfc2V0VHJhbnNmb3JtKHRyYW5zKSB7XG4gICAgICAgIGxldCBrZXk7XG4gICAgICAgIGZvciAoa2V5IGluIHRyYW5zKSB7XG4gICAgICAgICAgICB0aGlzLmF0dHJzW2tleV0gPSB0cmFuc1trZXldO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9jbGVhclRyYW5zZm9ybSgpIHtcbiAgICAgICAgY29uc3QgdHJhbnMgPSB7XG4gICAgICAgICAgICB4OiB0aGlzLngoKSxcbiAgICAgICAgICAgIHk6IHRoaXMueSgpLFxuICAgICAgICAgICAgcm90YXRpb246IHRoaXMucm90YXRpb24oKSxcbiAgICAgICAgICAgIHNjYWxlWDogdGhpcy5zY2FsZVgoKSxcbiAgICAgICAgICAgIHNjYWxlWTogdGhpcy5zY2FsZVkoKSxcbiAgICAgICAgICAgIG9mZnNldFg6IHRoaXMub2Zmc2V0WCgpLFxuICAgICAgICAgICAgb2Zmc2V0WTogdGhpcy5vZmZzZXRZKCksXG4gICAgICAgICAgICBza2V3WDogdGhpcy5za2V3WCgpLFxuICAgICAgICAgICAgc2tld1k6IHRoaXMuc2tld1koKSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5hdHRycy54ID0gMDtcbiAgICAgICAgdGhpcy5hdHRycy55ID0gMDtcbiAgICAgICAgdGhpcy5hdHRycy5yb3RhdGlvbiA9IDA7XG4gICAgICAgIHRoaXMuYXR0cnMuc2NhbGVYID0gMTtcbiAgICAgICAgdGhpcy5hdHRycy5zY2FsZVkgPSAxO1xuICAgICAgICB0aGlzLmF0dHJzLm9mZnNldFggPSAwO1xuICAgICAgICB0aGlzLmF0dHJzLm9mZnNldFkgPSAwO1xuICAgICAgICB0aGlzLmF0dHJzLnNrZXdYID0gMDtcbiAgICAgICAgdGhpcy5hdHRycy5za2V3WSA9IDA7XG4gICAgICAgIHJldHVybiB0cmFucztcbiAgICB9XG4gICAgbW92ZShjaGFuZ2UpIHtcbiAgICAgICAgbGV0IGNoYW5nZVggPSBjaGFuZ2UueCwgY2hhbmdlWSA9IGNoYW5nZS55LCB4ID0gdGhpcy54KCksIHkgPSB0aGlzLnkoKTtcbiAgICAgICAgaWYgKGNoYW5nZVggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgeCArPSBjaGFuZ2VYO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFuZ2VZICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHkgKz0gY2hhbmdlWTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFBvc2l0aW9uKHsgeDogeCwgeTogeSB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIF9lYWNoQW5jZXN0b3JSZXZlcnNlKGZ1bmMsIHRvcCkge1xuICAgICAgICBsZXQgZmFtaWx5ID0gW10sIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCksIGxlbiwgbjtcbiAgICAgICAgaWYgKHRvcCAmJiB0b3AuX2lkID09PSB0aGlzLl9pZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZhbWlseS51bnNoaWZ0KHRoaXMpO1xuICAgICAgICB3aGlsZSAocGFyZW50ICYmICghdG9wIHx8IHBhcmVudC5faWQgIT09IHRvcC5faWQpKSB7XG4gICAgICAgICAgICBmYW1pbHkudW5zaGlmdChwYXJlbnQpO1xuICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICBsZW4gPSBmYW1pbHkubGVuZ3RoO1xuICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGZ1bmMoZmFtaWx5W25dKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByb3RhdGUodGhldGEpIHtcbiAgICAgICAgdGhpcy5yb3RhdGlvbih0aGlzLnJvdGF0aW9uKCkgKyB0aGV0YSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBtb3ZlVG9Ub3AoKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIFV0aWwud2FybignTm9kZSBoYXMgbm8gcGFyZW50LiBtb3ZlVG9Ub3AgZnVuY3Rpb24gaXMgaWdub3JlZC4nKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5kZXgsIGxlbiA9IHRoaXMucGFyZW50LmdldENoaWxkcmVuKCkubGVuZ3RoO1xuICAgICAgICBpZiAoaW5kZXggPCBsZW4gLSAxKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4ucHVzaCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Ll9zZXRDaGlsZHJlbkluZGljZXMoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbW92ZVVwKCkge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICBVdGlsLndhcm4oJ05vZGUgaGFzIG5vIHBhcmVudC4gbW92ZVVwIGZ1bmN0aW9uIGlzIGlnbm9yZWQuJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmluZGV4LCBsZW4gPSB0aGlzLnBhcmVudC5nZXRDaGlsZHJlbigpLmxlbmd0aDtcbiAgICAgICAgaWYgKGluZGV4IDwgbGVuIC0gMSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCArIDEsIDAsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3NldENoaWxkcmVuSW5kaWNlcygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBtb3ZlRG93bigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgVXRpbC53YXJuKCdOb2RlIGhhcyBubyBwYXJlbnQuIG1vdmVEb3duIGZ1bmN0aW9uIGlzIGlnbm9yZWQuJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICBpZiAoaW5kZXggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKGluZGV4IC0gMSwgMCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRyZW5JbmRpY2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIG1vdmVUb0JvdHRvbSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgVXRpbC53YXJuKCdOb2RlIGhhcyBubyBwYXJlbnQuIG1vdmVUb0JvdHRvbSBmdW5jdGlvbiBpcyBpZ25vcmVkLicpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgaWYgKGluZGV4ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmNoaWxkcmVuLnVuc2hpZnQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRyZW5JbmRpY2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHNldFpJbmRleCh6SW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgVXRpbC53YXJuKCdOb2RlIGhhcyBubyBwYXJlbnQuIHpJbmRleCBwYXJhbWV0ZXIgaXMgaWdub3JlZC4nKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh6SW5kZXggPCAwIHx8IHpJbmRleCA+PSB0aGlzLnBhcmVudC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIFV0aWwud2FybignVW5leHBlY3RlZCB2YWx1ZSAnICtcbiAgICAgICAgICAgICAgICB6SW5kZXggK1xuICAgICAgICAgICAgICAgICcgZm9yIHpJbmRleCBwcm9wZXJ0eS4gekluZGV4IGlzIGp1c3QgaW5kZXggb2YgYSBub2RlIGluIGNoaWxkcmVuIG9mIGl0cyBwYXJlbnQuIEV4cGVjdGVkIHZhbHVlIGlzIGZyb20gMCB0byAnICtcbiAgICAgICAgICAgICAgICAodGhpcy5wYXJlbnQuY2hpbGRyZW4ubGVuZ3RoIC0gMSkgK1xuICAgICAgICAgICAgICAgICcuJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoekluZGV4LCAwLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuX3NldENoaWxkcmVuSW5kaWNlcygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0QWJzb2x1dGVPcGFjaXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUoQUJTT0xVVEVfT1BBQ0lUWSwgdGhpcy5fZ2V0QWJzb2x1dGVPcGFjaXR5KTtcbiAgICB9XG4gICAgX2dldEFic29sdXRlT3BhY2l0eSgpIHtcbiAgICAgICAgbGV0IGFic09wYWNpdHkgPSB0aGlzLm9wYWNpdHkoKTtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKTtcbiAgICAgICAgaWYgKHBhcmVudCAmJiAhcGFyZW50Ll9pc1VuZGVyQ2FjaGUpIHtcbiAgICAgICAgICAgIGFic09wYWNpdHkgKj0gcGFyZW50LmdldEFic29sdXRlT3BhY2l0eSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhYnNPcGFjaXR5O1xuICAgIH1cbiAgICBtb3ZlVG8obmV3Q29udGFpbmVyKSB7XG4gICAgICAgIGlmICh0aGlzLmdldFBhcmVudCgpICE9PSBuZXdDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbW92ZSgpO1xuICAgICAgICAgICAgbmV3Q29udGFpbmVyLmFkZCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdG9PYmplY3QoKSB7XG4gICAgICAgIGxldCBhdHRycyA9IHRoaXMuZ2V0QXR0cnMoKSwga2V5LCB2YWwsIGdldHRlciwgZGVmYXVsdFZhbHVlLCBub25QbGFpbk9iamVjdDtcbiAgICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICAgICAgYXR0cnM6IHt9LFxuICAgICAgICAgICAgY2xhc3NOYW1lOiB0aGlzLmdldENsYXNzTmFtZSgpLFxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGtleSBpbiBhdHRycykge1xuICAgICAgICAgICAgdmFsID0gYXR0cnNba2V5XTtcbiAgICAgICAgICAgIG5vblBsYWluT2JqZWN0ID1cbiAgICAgICAgICAgICAgICBVdGlsLmlzT2JqZWN0KHZhbCkgJiYgIVV0aWwuX2lzUGxhaW5PYmplY3QodmFsKSAmJiAhVXRpbC5faXNBcnJheSh2YWwpO1xuICAgICAgICAgICAgaWYgKG5vblBsYWluT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZXR0ZXIgPSB0eXBlb2YgdGhpc1trZXldID09PSAnZnVuY3Rpb24nICYmIHRoaXNba2V5XTtcbiAgICAgICAgICAgIGRlbGV0ZSBhdHRyc1trZXldO1xuICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gZ2V0dGVyID8gZ2V0dGVyLmNhbGwodGhpcykgOiBudWxsO1xuICAgICAgICAgICAgYXR0cnNba2V5XSA9IHZhbDtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWUgIT09IHZhbCkge1xuICAgICAgICAgICAgICAgIG9iai5hdHRyc1trZXldID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBVdGlsLl9wcmVwYXJlVG9TdHJpbmdpZnkob2JqKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy50b09iamVjdCgpKTtcbiAgICB9XG4gICAgZ2V0UGFyZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQ7XG4gICAgfVxuICAgIGZpbmRBbmNlc3RvcnMoc2VsZWN0b3IsIGluY2x1ZGVTZWxmLCBzdG9wTm9kZSkge1xuICAgICAgICBjb25zdCByZXMgPSBbXTtcbiAgICAgICAgaWYgKGluY2x1ZGVTZWxmICYmIHRoaXMuX2lzTWF0Y2goc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICByZXMucHVzaCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgYW5jZXN0b3IgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKGFuY2VzdG9yKSB7XG4gICAgICAgICAgICBpZiAoYW5jZXN0b3IgPT09IHN0b3BOb2RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhbmNlc3Rvci5faXNNYXRjaChzZWxlY3RvcikpIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaChhbmNlc3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBpc0FuY2VzdG9yT2Yobm9kZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZpbmRBbmNlc3RvcihzZWxlY3RvciwgaW5jbHVkZVNlbGYsIHN0b3BOb2RlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmRBbmNlc3RvcnMoc2VsZWN0b3IsIGluY2x1ZGVTZWxmLCBzdG9wTm9kZSlbMF07XG4gICAgfVxuICAgIF9pc01hdGNoKHNlbGVjdG9yKSB7XG4gICAgICAgIGlmICghc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0b3IodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNlbGVjdG9yQXJyID0gc2VsZWN0b3IucmVwbGFjZSgvIC9nLCAnJykuc3BsaXQoJywnKSwgbGVuID0gc2VsZWN0b3JBcnIubGVuZ3RoLCBuLCBzZWw7XG4gICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgc2VsID0gc2VsZWN0b3JBcnJbbl07XG4gICAgICAgICAgICBpZiAoIVV0aWwuaXNWYWxpZFNlbGVjdG9yKHNlbCkpIHtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oJ1NlbGVjdG9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIHNlbCArXG4gICAgICAgICAgICAgICAgICAgICdcIiBpcyBpbnZhbGlkLiBBbGxvd2VkIHNlbGVjdG9ycyBleGFtcGxlcyBhcmUgXCIjZm9vXCIsIFwiLmJhclwiIG9yIFwiR3JvdXBcIi4nKTtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oJ0lmIHlvdSBoYXZlIGEgY3VzdG9tIHNoYXBlIHdpdGggc3VjaCBjbGFzc05hbWUsIHBsZWFzZSBjaGFuZ2UgaXQgdG8gc3RhcnQgd2l0aCB1cHBlciBsZXR0ZXIgbGlrZSBcIlRyaWFuZ2xlXCIuJyk7XG4gICAgICAgICAgICAgICAgVXRpbC53YXJuKCdLb252YSBpcyBhd2Vzb21lLCByaWdodD8nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWwuY2hhckF0KDApID09PSAnIycpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pZCgpID09PSBzZWwuc2xpY2UoMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2VsLmNoYXJBdCgwKSA9PT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTmFtZShzZWwuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY2xhc3NOYW1lID09PSBzZWwgfHwgdGhpcy5ub2RlVHlwZSA9PT0gc2VsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBnZXRMYXllcigpIHtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKTtcbiAgICAgICAgcmV0dXJuIHBhcmVudCA/IHBhcmVudC5nZXRMYXllcigpIDogbnVsbDtcbiAgICB9XG4gICAgZ2V0U3RhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShTVEFHRSwgdGhpcy5fZ2V0U3RhZ2UpO1xuICAgIH1cbiAgICBfZ2V0U3RhZ2UoKSB7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCk7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuZ2V0U3RhZ2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpcmUoZXZlbnRUeXBlLCBldnQgPSB7fSwgYnViYmxlKSB7XG4gICAgICAgIGV2dC50YXJnZXQgPSBldnQudGFyZ2V0IHx8IHRoaXM7XG4gICAgICAgIGlmIChidWJibGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpcmVBbmRCdWJibGUoZXZlbnRUeXBlLCBldnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudFR5cGUsIGV2dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkge1xuICAgICAgICBpZiAodG9wKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShBQlNPTFVURV9UUkFOU0ZPUk0sIHRoaXMuX2dldEFic29sdXRlVHJhbnNmb3JtKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKSB7XG4gICAgICAgIGxldCBhdDtcbiAgICAgICAgaWYgKHRvcCkge1xuICAgICAgICAgICAgYXQgPSBuZXcgVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICB0aGlzLl9lYWNoQW5jZXN0b3JSZXZlcnNlKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNmb3Jtc0VuYWJsZWQgPSBub2RlLnRyYW5zZm9ybXNFbmFibGVkKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zZm9ybXNFbmFibGVkID09PSAnYWxsJykge1xuICAgICAgICAgICAgICAgICAgICBhdC5tdWx0aXBseShub2RlLmdldFRyYW5zZm9ybSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHJhbnNmb3Jtc0VuYWJsZWQgPT09ICdwb3NpdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgYXQudHJhbnNsYXRlKG5vZGUueCgpIC0gbm9kZS5vZmZzZXRYKCksIG5vZGUueSgpIC0gbm9kZS5vZmZzZXRZKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHRvcCk7XG4gICAgICAgICAgICByZXR1cm4gYXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdCA9IHRoaXMuX2NhY2hlLmdldChBQlNPTFVURV9UUkFOU0ZPUk0pIHx8IG5ldyBUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmdldEFic29sdXRlVHJhbnNmb3JtKCkuY29weUludG8oYXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXQucmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZm9ybXNFbmFibGVkID0gdGhpcy50cmFuc2Zvcm1zRW5hYmxlZCgpO1xuICAgICAgICAgICAgaWYgKHRyYW5zZm9ybXNFbmFibGVkID09PSAnYWxsJykge1xuICAgICAgICAgICAgICAgIGF0Lm11bHRpcGx5KHRoaXMuZ2V0VHJhbnNmb3JtKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHJhbnNmb3Jtc0VuYWJsZWQgPT09ICdwb3NpdGlvbicpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB4ID0gdGhpcy5hdHRycy54IHx8IDA7XG4gICAgICAgICAgICAgICAgY29uc3QgeSA9IHRoaXMuYXR0cnMueSB8fCAwO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldFggPSB0aGlzLmF0dHJzLm9mZnNldFggfHwgMDtcbiAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXRZID0gdGhpcy5hdHRycy5vZmZzZXRZIHx8IDA7XG4gICAgICAgICAgICAgICAgYXQudHJhbnNsYXRlKHggLSBvZmZzZXRYLCB5IC0gb2Zmc2V0WSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhdC5kaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGF0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEFic29sdXRlU2NhbGUodG9wKSB7XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzO1xuICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgICBpZiAocGFyZW50Ll9pc1VuZGVyQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICB0b3AgPSBwYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQuZ2V0UGFyZW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gdGhpcy5nZXRBYnNvbHV0ZVRyYW5zZm9ybSh0b3ApO1xuICAgICAgICBjb25zdCBhdHRycyA9IHRyYW5zZm9ybS5kZWNvbXBvc2UoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IGF0dHJzLnNjYWxlWCxcbiAgICAgICAgICAgIHk6IGF0dHJzLnNjYWxlWSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0QWJzb2x1dGVSb3RhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWJzb2x1dGVUcmFuc2Zvcm0oKS5kZWNvbXBvc2UoKS5yb3RhdGlvbjtcbiAgICB9XG4gICAgZ2V0VHJhbnNmb3JtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUoVFJBTlNGT1JNLCB0aGlzLl9nZXRUcmFuc2Zvcm0pO1xuICAgIH1cbiAgICBfZ2V0VHJhbnNmb3JtKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCBtID0gdGhpcy5fY2FjaGUuZ2V0KFRSQU5TRk9STSkgfHwgbmV3IFRyYW5zZm9ybSgpO1xuICAgICAgICBtLnJlc2V0KCk7XG4gICAgICAgIGNvbnN0IHggPSB0aGlzLngoKSwgeSA9IHRoaXMueSgpLCByb3RhdGlvbiA9IEtvbnZhLmdldEFuZ2xlKHRoaXMucm90YXRpb24oKSksIHNjYWxlWCA9IChfYSA9IHRoaXMuYXR0cnMuc2NhbGVYKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAxLCBzY2FsZVkgPSAoX2IgPSB0aGlzLmF0dHJzLnNjYWxlWSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogMSwgc2tld1ggPSB0aGlzLmF0dHJzLnNrZXdYIHx8IDAsIHNrZXdZID0gdGhpcy5hdHRycy5za2V3WSB8fCAwLCBvZmZzZXRYID0gdGhpcy5hdHRycy5vZmZzZXRYIHx8IDAsIG9mZnNldFkgPSB0aGlzLmF0dHJzLm9mZnNldFkgfHwgMDtcbiAgICAgICAgaWYgKHggIT09IDAgfHwgeSAhPT0gMCkge1xuICAgICAgICAgICAgbS50cmFuc2xhdGUoeCwgeSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0aW9uICE9PSAwKSB7XG4gICAgICAgICAgICBtLnJvdGF0ZShyb3RhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNrZXdYICE9PSAwIHx8IHNrZXdZICE9PSAwKSB7XG4gICAgICAgICAgICBtLnNrZXcoc2tld1gsIHNrZXdZKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NhbGVYICE9PSAxIHx8IHNjYWxlWSAhPT0gMSkge1xuICAgICAgICAgICAgbS5zY2FsZShzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9mZnNldFggIT09IDAgfHwgb2Zmc2V0WSAhPT0gMCkge1xuICAgICAgICAgICAgbS50cmFuc2xhdGUoLTEgKiBvZmZzZXRYLCAtMSAqIG9mZnNldFkpO1xuICAgICAgICB9XG4gICAgICAgIG0uZGlydHkgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIG07XG4gICAgfVxuICAgIGNsb25lKG9iaikge1xuICAgICAgICBsZXQgYXR0cnMgPSBVdGlsLmNsb25lT2JqZWN0KHRoaXMuYXR0cnMpLCBrZXksIGFsbExpc3RlbmVycywgbGVuLCBuLCBsaXN0ZW5lcjtcbiAgICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICBhdHRyc1trZXldID0gb2JqW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKGF0dHJzKTtcbiAgICAgICAgZm9yIChrZXkgaW4gdGhpcy5ldmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgYWxsTGlzdGVuZXJzID0gdGhpcy5ldmVudExpc3RlbmVyc1trZXldO1xuICAgICAgICAgICAgbGVuID0gYWxsTGlzdGVuZXJzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyID0gYWxsTGlzdGVuZXJzW25dO1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lci5uYW1lLmluZGV4T2YoS09OVkEpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW5vZGUuZXZlbnRMaXN0ZW5lcnNba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5ldmVudExpc3RlbmVyc1trZXldID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbm9kZS5ldmVudExpc3RlbmVyc1trZXldLnB1c2gobGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG4gICAgX3RvS29udmFDYW52YXMoY29uZmlnKSB7XG4gICAgICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcbiAgICAgICAgY29uc3QgYm94ID0gdGhpcy5nZXRDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpLCB4ID0gY29uZmlnLnggIT09IHVuZGVmaW5lZCA/IGNvbmZpZy54IDogTWF0aC5mbG9vcihib3gueCksIHkgPSBjb25maWcueSAhPT0gdW5kZWZpbmVkID8gY29uZmlnLnkgOiBNYXRoLmZsb29yKGJveC55KSwgcGl4ZWxSYXRpbyA9IGNvbmZpZy5waXhlbFJhdGlvIHx8IDEsIGNhbnZhcyA9IG5ldyBTY2VuZUNhbnZhcyh7XG4gICAgICAgICAgICB3aWR0aDogY29uZmlnLndpZHRoIHx8IE1hdGguY2VpbChib3gud2lkdGgpIHx8IChzdGFnZSA/IHN0YWdlLndpZHRoKCkgOiAwKSxcbiAgICAgICAgICAgIGhlaWdodDogY29uZmlnLmhlaWdodCB8fFxuICAgICAgICAgICAgICAgIE1hdGguY2VpbChib3guaGVpZ2h0KSB8fFxuICAgICAgICAgICAgICAgIChzdGFnZSA/IHN0YWdlLmhlaWdodCgpIDogMCksXG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBwaXhlbFJhdGlvLFxuICAgICAgICB9KSwgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCk7XG4gICAgICAgIGNvbnN0IGJ1ZmZlckNhbnZhcyA9IG5ldyBTY2VuZUNhbnZhcyh7XG4gICAgICAgICAgICB3aWR0aDogY2FudmFzLndpZHRoIC8gY2FudmFzLnBpeGVsUmF0aW8gKyBNYXRoLmFicyh4KSxcbiAgICAgICAgICAgIGhlaWdodDogY2FudmFzLmhlaWdodCAvIGNhbnZhcy5waXhlbFJhdGlvICsgTWF0aC5hYnMoeSksXG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBjYW52YXMucGl4ZWxSYXRpbyxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjb25maWcuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGV4dC5fY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgaWYgKHggfHwgeSkge1xuICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoLTEgKiB4LCAtMSAqIHkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHJhd1NjZW5lKGNhbnZhcywgdW5kZWZpbmVkLCBidWZmZXJDYW52YXMpO1xuICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgcmV0dXJuIGNhbnZhcztcbiAgICB9XG4gICAgdG9DYW52YXMoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b0tvbnZhQ2FudmFzKGNvbmZpZykuX2NhbnZhcztcbiAgICB9XG4gICAgdG9EYXRhVVJMKGNvbmZpZykge1xuICAgICAgICBjb25maWcgPSBjb25maWcgfHwge307XG4gICAgICAgIGNvbnN0IG1pbWVUeXBlID0gY29uZmlnLm1pbWVUeXBlIHx8IG51bGwsIHF1YWxpdHkgPSBjb25maWcucXVhbGl0eSB8fCBudWxsO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLl90b0tvbnZhQ2FudmFzKGNvbmZpZykudG9EYXRhVVJMKG1pbWVUeXBlLCBxdWFsaXR5KTtcbiAgICAgICAgaWYgKGNvbmZpZy5jYWxsYmFjaykge1xuICAgICAgICAgICAgY29uZmlnLmNhbGxiYWNrKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gICAgdG9JbWFnZShjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjb25maWcgPT09IG51bGwgfHwgY29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWcuY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29uZmlnLmNhbGxiYWNrO1xuICAgICAgICAgICAgICAgIFV0aWwuX3VybFRvSW1hZ2UodGhpcy50b0RhdGFVUkwoY29uZmlnKSwgZnVuY3Rpb24gKGltZykge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGltZyk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrID09PSBudWxsIHx8IGNhbGxiYWNrID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjYWxsYmFjayhpbWcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdG9CbG9iKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IGNvbmZpZyA9PT0gbnVsbCB8fCBjb25maWcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZy5jYWxsYmFjaztcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb25maWcuY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgdGhpcy50b0NhbnZhcyhjb25maWcpLnRvQmxvYigoYmxvYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGJsb2IpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayA9PT0gbnVsbCB8fCBjYWxsYmFjayA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2FsbGJhY2soYmxvYik7XG4gICAgICAgICAgICAgICAgfSwgY29uZmlnID09PSBudWxsIHx8IGNvbmZpZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlnLm1pbWVUeXBlLCBjb25maWcgPT09IG51bGwgfHwgY29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWcucXVhbGl0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRTaXplKHNpemUpIHtcbiAgICAgICAgdGhpcy53aWR0aChzaXplLndpZHRoKTtcbiAgICAgICAgdGhpcy5oZWlnaHQoc2l6ZS5oZWlnaHQpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0U2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoKCksXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0KCksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldENsYXNzTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NOYW1lIHx8IHRoaXMubm9kZVR5cGU7XG4gICAgfVxuICAgIGdldFR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVUeXBlO1xuICAgIH1cbiAgICBnZXREcmFnRGlzdGFuY2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmF0dHJzLmRyYWdEaXN0YW5jZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5kcmFnRGlzdGFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXREcmFnRGlzdGFuY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBLb252YS5kcmFnRGlzdGFuY2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX29mZih0eXBlLCBuYW1lLCBjYWxsYmFjaykge1xuICAgICAgICBsZXQgZXZ0TGlzdGVuZXJzID0gdGhpcy5ldmVudExpc3RlbmVyc1t0eXBlXSwgaSwgZXZ0TmFtZSwgaGFuZGxlcjtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGV2dExpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZXZ0TmFtZSA9IGV2dExpc3RlbmVyc1tpXS5uYW1lO1xuICAgICAgICAgICAgaGFuZGxlciA9IGV2dExpc3RlbmVyc1tpXS5oYW5kbGVyO1xuICAgICAgICAgICAgaWYgKChldnROYW1lICE9PSAna29udmEnIHx8IG5hbWUgPT09ICdrb252YScpICYmXG4gICAgICAgICAgICAgICAgKCFuYW1lIHx8IGV2dE5hbWUgPT09IG5hbWUpICYmXG4gICAgICAgICAgICAgICAgKCFjYWxsYmFjayB8fCBjYWxsYmFjayA9PT0gaGFuZGxlcikpIHtcbiAgICAgICAgICAgICAgICBldnRMaXN0ZW5lcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGlmIChldnRMaXN0ZW5lcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmV2ZW50TGlzdGVuZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIF9maXJlQ2hhbmdlRXZlbnQoYXR0ciwgb2xkVmFsLCBuZXdWYWwpIHtcbiAgICAgICAgdGhpcy5fZmlyZShhdHRyICsgQ0hBTkdFLCB7XG4gICAgICAgICAgICBvbGRWYWw6IG9sZFZhbCxcbiAgICAgICAgICAgIG5ld1ZhbDogbmV3VmFsLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRkTmFtZShuYW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNOYW1lKG5hbWUpKSB7XG4gICAgICAgICAgICBjb25zdCBvbGROYW1lID0gdGhpcy5uYW1lKCk7XG4gICAgICAgICAgICBjb25zdCBuZXdOYW1lID0gb2xkTmFtZSA/IG9sZE5hbWUgKyAnICcgKyBuYW1lIDogbmFtZTtcbiAgICAgICAgICAgIHRoaXMubmFtZShuZXdOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaGFzTmFtZShuYW1lKSB7XG4gICAgICAgIGlmICghbmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZ1bGxOYW1lID0gdGhpcy5uYW1lKCk7XG4gICAgICAgIGlmICghZnVsbE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuYW1lcyA9IChmdWxsTmFtZSB8fCAnJykuc3BsaXQoL1xccy9nKTtcbiAgICAgICAgcmV0dXJuIG5hbWVzLmluZGV4T2YobmFtZSkgIT09IC0xO1xuICAgIH1cbiAgICByZW1vdmVOYW1lKG5hbWUpIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSAodGhpcy5uYW1lKCkgfHwgJycpLnNwbGl0KC9cXHMvZyk7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gbmFtZXMuaW5kZXhPZihuYW1lKTtcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgbmFtZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHRoaXMubmFtZShuYW1lcy5qb2luKCcgJykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRBdHRyKGF0dHIsIHZhbCkge1xuICAgICAgICBjb25zdCBmdW5jID0gdGhpc1tTRVQgKyBVdGlsLl9jYXBpdGFsaXplKGF0dHIpXTtcbiAgICAgICAgaWYgKFV0aWwuX2lzRnVuY3Rpb24oZnVuYykpIHtcbiAgICAgICAgICAgIGZ1bmMuY2FsbCh0aGlzLCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2V0QXR0cihhdHRyLCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBfcmVxdWVzdERyYXcoKSB7XG4gICAgICAgIGlmIChLb252YS5hdXRvRHJhd0VuYWJsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGRyYXdOb2RlID0gdGhpcy5nZXRMYXllcigpIHx8IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIGRyYXdOb2RlID09PSBudWxsIHx8IGRyYXdOb2RlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkcmF3Tm9kZS5iYXRjaERyYXcoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc2V0QXR0cihrZXksIHZhbCkge1xuICAgICAgICBjb25zdCBvbGRWYWwgPSB0aGlzLmF0dHJzW2tleV07XG4gICAgICAgIGlmIChvbGRWYWwgPT09IHZhbCAmJiAhVXRpbC5pc09iamVjdCh2YWwpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYXR0cnNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cnNba2V5XSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2hvdWxkRmlyZUNoYW5nZUV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZUV2ZW50KGtleSwgb2xkVmFsLCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlcXVlc3REcmF3KCk7XG4gICAgfVxuICAgIF9zZXRDb21wb25lbnRBdHRyKGtleSwgY29tcG9uZW50LCB2YWwpIHtcbiAgICAgICAgbGV0IG9sZFZhbDtcbiAgICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvbGRWYWwgPSB0aGlzLmF0dHJzW2tleV07XG4gICAgICAgICAgICBpZiAoIW9sZFZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXR0cnNba2V5XSA9IHRoaXMuZ2V0QXR0cihrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hdHRyc1trZXldW2NvbXBvbmVudF0gPSB2YWw7XG4gICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlRXZlbnQoa2V5LCBvbGRWYWwsIHZhbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZpcmVBbmRCdWJibGUoZXZlbnRUeXBlLCBldnQsIGNvbXBhcmVTaGFwZSkge1xuICAgICAgICBpZiAoZXZ0ICYmIHRoaXMubm9kZVR5cGUgPT09IFNIQVBFKSB7XG4gICAgICAgICAgICBldnQudGFyZ2V0ID0gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub25CdWJibGluZyA9IFtcbiAgICAgICAgICAgIE1PVVNFRU5URVIsXG4gICAgICAgICAgICBNT1VTRUxFQVZFLFxuICAgICAgICAgICAgUE9JTlRFUkVOVEVSLFxuICAgICAgICAgICAgUE9JTlRFUkxFQVZFLFxuICAgICAgICAgICAgVE9VQ0hFTlRFUixcbiAgICAgICAgICAgIFRPVUNITEVBVkUsXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHNob3VsZFN0b3AgPSBub25CdWJibGluZy5pbmRleE9mKGV2ZW50VHlwZSkgIT09IC0xICYmXG4gICAgICAgICAgICAoKGNvbXBhcmVTaGFwZSAmJlxuICAgICAgICAgICAgICAgICh0aGlzID09PSBjb21wYXJlU2hhcGUgfHxcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuaXNBbmNlc3Rvck9mICYmIHRoaXMuaXNBbmNlc3Rvck9mKGNvbXBhcmVTaGFwZSkpKSkgfHxcbiAgICAgICAgICAgICAgICAodGhpcy5ub2RlVHlwZSA9PT0gJ1N0YWdlJyAmJiAhY29tcGFyZVNoYXBlKSk7XG4gICAgICAgIGlmICghc2hvdWxkU3RvcCkge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudFR5cGUsIGV2dCk7XG4gICAgICAgICAgICBjb25zdCBzdG9wQnViYmxlID0gbm9uQnViYmxpbmcuaW5kZXhPZihldmVudFR5cGUpICE9PSAtMSAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVTaGFwZSAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVTaGFwZS5pc0FuY2VzdG9yT2YgJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlU2hhcGUuaXNBbmNlc3Rvck9mKHRoaXMpICYmXG4gICAgICAgICAgICAgICAgIWNvbXBhcmVTaGFwZS5pc0FuY2VzdG9yT2YodGhpcy5wYXJlbnQpO1xuICAgICAgICAgICAgaWYgKCgoZXZ0ICYmICFldnQuY2FuY2VsQnViYmxlKSB8fCAhZXZ0KSAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50ICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuaXNMaXN0ZW5pbmcoKSAmJlxuICAgICAgICAgICAgICAgICFzdG9wQnViYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBhcmVTaGFwZSAmJiBjb21wYXJlU2hhcGUucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVBbmRCdWJibGUuY2FsbCh0aGlzLnBhcmVudCwgZXZlbnRUeXBlLCBldnQsIGNvbXBhcmVTaGFwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXJlQW5kQnViYmxlLmNhbGwodGhpcy5wYXJlbnQsIGV2ZW50VHlwZSwgZXZ0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2dldFByb3RvTGlzdGVuZXJzKGV2ZW50VHlwZSkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgY29uc3QgYWxsTGlzdGVuZXJzID0gKF9hID0gdGhpcy5fY2FjaGUuZ2V0KEFMTF9MSVNURU5FUlMpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB7fTtcbiAgICAgICAgbGV0IGV2ZW50cyA9IGFsbExpc3RlbmVycyA9PT0gbnVsbCB8fCBhbGxMaXN0ZW5lcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFsbExpc3RlbmVyc1tldmVudFR5cGVdO1xuICAgICAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGV2ZW50cyA9IFtdO1xuICAgICAgICAgICAgbGV0IG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKTtcbiAgICAgICAgICAgIHdoaWxlIChvYmopIHtcbiAgICAgICAgICAgICAgICBjb25zdCBoaWVyYXJjaHlFdmVudHMgPSAoX2MgPSAoX2IgPSBvYmouZXZlbnRMaXN0ZW5lcnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYltldmVudFR5cGVdKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBbXTtcbiAgICAgICAgICAgICAgICBldmVudHMucHVzaCguLi5oaWVyYXJjaHlFdmVudHMpO1xuICAgICAgICAgICAgICAgIG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWxsTGlzdGVuZXJzW2V2ZW50VHlwZV0gPSBldmVudHM7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZS5zZXQoQUxMX0xJU1RFTkVSUywgYWxsTGlzdGVuZXJzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRzO1xuICAgIH1cbiAgICBfZmlyZShldmVudFR5cGUsIGV2dCkge1xuICAgICAgICBldnQgPSBldnQgfHwge307XG4gICAgICAgIGV2dC5jdXJyZW50VGFyZ2V0ID0gdGhpcztcbiAgICAgICAgZXZ0LnR5cGUgPSBldmVudFR5cGU7XG4gICAgICAgIGNvbnN0IHRvcExpc3RlbmVycyA9IHRoaXMuX2dldFByb3RvTGlzdGVuZXJzKGV2ZW50VHlwZSk7XG4gICAgICAgIGlmICh0b3BMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9wTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdG9wTGlzdGVuZXJzW2ldLmhhbmRsZXIuY2FsbCh0aGlzLCBldnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlbGZMaXN0ZW5lcnMgPSB0aGlzLmV2ZW50TGlzdGVuZXJzW2V2ZW50VHlwZV07XG4gICAgICAgIGlmIChzZWxmTGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGZMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzZWxmTGlzdGVuZXJzW2ldLmhhbmRsZXIuY2FsbCh0aGlzLCBldnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGRyYXcoKSB7XG4gICAgICAgIHRoaXMuZHJhd1NjZW5lKCk7XG4gICAgICAgIHRoaXMuZHJhd0hpdCgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZURyYWdFbGVtZW50KGV2dCkge1xuICAgICAgICBjb25zdCBwb2ludGVySWQgPSBldnQgPyBldnQucG9pbnRlcklkIDogdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgY29uc3QgYXAgPSB0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKTtcbiAgICAgICAgaWYgKCFzdGFnZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBvcyA9IHN0YWdlLl9nZXRQb2ludGVyQnlJZChwb2ludGVySWQpIHx8XG4gICAgICAgICAgICBzdGFnZS5fY2hhbmdlZFBvaW50ZXJQb3NpdGlvbnNbMF0gfHxcbiAgICAgICAgICAgIGFwO1xuICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLnNldCh0aGlzLl9pZCwge1xuICAgICAgICAgICAgbm9kZTogdGhpcyxcbiAgICAgICAgICAgIHN0YXJ0UG9pbnRlclBvczogcG9zLFxuICAgICAgICAgICAgb2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgeDogcG9zLnggLSBhcC54LFxuICAgICAgICAgICAgICAgIHk6IHBvcy55IC0gYXAueSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkcmFnU3RhdHVzOiAncmVhZHknLFxuICAgICAgICAgICAgcG9pbnRlcklkLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhcnREcmFnKGV2dCwgYnViYmxlRXZlbnQgPSB0cnVlKSB7XG4gICAgICAgIGlmICghREQuX2RyYWdFbGVtZW50cy5oYXModGhpcy5faWQpKSB7XG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVEcmFnRWxlbWVudChldnQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVsZW0gPSBERC5fZHJhZ0VsZW1lbnRzLmdldCh0aGlzLl9pZCk7XG4gICAgICAgIGVsZW0uZHJhZ1N0YXR1cyA9ICdkcmFnZ2luZyc7XG4gICAgICAgIHRoaXMuZmlyZSgnZHJhZ3N0YXJ0Jywge1xuICAgICAgICAgICAgdHlwZTogJ2RyYWdzdGFydCcsXG4gICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICBldnQ6IGV2dCAmJiBldnQuZXZ0LFxuICAgICAgICB9LCBidWJibGVFdmVudCk7XG4gICAgfVxuICAgIF9zZXREcmFnUG9zaXRpb24oZXZ0LCBlbGVtKSB7XG4gICAgICAgIGNvbnN0IHBvcyA9IHRoaXMuZ2V0U3RhZ2UoKS5fZ2V0UG9pbnRlckJ5SWQoZWxlbS5wb2ludGVySWQpO1xuICAgICAgICBpZiAoIXBvcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuZXdOb2RlUG9zID0ge1xuICAgICAgICAgICAgeDogcG9zLnggLSBlbGVtLm9mZnNldC54LFxuICAgICAgICAgICAgeTogcG9zLnkgLSBlbGVtLm9mZnNldC55LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYmYgPSB0aGlzLmRyYWdCb3VuZEZ1bmMoKTtcbiAgICAgICAgaWYgKGRiZiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBib3VuZGVkID0gZGJmLmNhbGwodGhpcywgbmV3Tm9kZVBvcywgZXZ0KTtcbiAgICAgICAgICAgIGlmICghYm91bmRlZCkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybignZHJhZ0JvdW5kRnVuYyBkaWQgbm90IHJldHVybiBhbnkgdmFsdWUuIFRoYXQgaXMgdW5leHBlY3RlZCBiZWhhdmlvci4gWW91IG11c3QgcmV0dXJuIG5ldyBhYnNvbHV0ZSBwb3NpdGlvbiBmcm9tIGRyYWdCb3VuZEZ1bmMuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdOb2RlUG9zID0gYm91bmRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2xhc3RQb3MgfHxcbiAgICAgICAgICAgIHRoaXMuX2xhc3RQb3MueCAhPT0gbmV3Tm9kZVBvcy54IHx8XG4gICAgICAgICAgICB0aGlzLl9sYXN0UG9zLnkgIT09IG5ld05vZGVQb3MueSkge1xuICAgICAgICAgICAgdGhpcy5zZXRBYnNvbHV0ZVBvc2l0aW9uKG5ld05vZGVQb3MpO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdERyYXcoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sYXN0UG9zID0gbmV3Tm9kZVBvcztcbiAgICB9XG4gICAgc3RvcERyYWcoZXZ0KSB7XG4gICAgICAgIGNvbnN0IGVsZW0gPSBERC5fZHJhZ0VsZW1lbnRzLmdldCh0aGlzLl9pZCk7XG4gICAgICAgIGlmIChlbGVtKSB7XG4gICAgICAgICAgICBlbGVtLmRyYWdTdGF0dXMgPSAnc3RvcHBlZCc7XG4gICAgICAgIH1cbiAgICAgICAgREQuX2VuZERyYWdCZWZvcmUoZXZ0KTtcbiAgICAgICAgREQuX2VuZERyYWdBZnRlcihldnQpO1xuICAgIH1cbiAgICBzZXREcmFnZ2FibGUoZHJhZ2dhYmxlKSB7XG4gICAgICAgIHRoaXMuX3NldEF0dHIoJ2RyYWdnYWJsZScsIGRyYWdnYWJsZSk7XG4gICAgICAgIHRoaXMuX2RyYWdDaGFuZ2UoKTtcbiAgICB9XG4gICAgaXNEcmFnZ2luZygpIHtcbiAgICAgICAgY29uc3QgZWxlbSA9IERELl9kcmFnRWxlbWVudHMuZ2V0KHRoaXMuX2lkKTtcbiAgICAgICAgcmV0dXJuIGVsZW0gPyBlbGVtLmRyYWdTdGF0dXMgPT09ICdkcmFnZ2luZycgOiBmYWxzZTtcbiAgICB9XG4gICAgX2xpc3RlbkRyYWcoKSB7XG4gICAgICAgIHRoaXMuX2RyYWdDbGVhbnVwKCk7XG4gICAgICAgIHRoaXMub24oJ21vdXNlZG93bi5rb252YSB0b3VjaHN0YXJ0LmtvbnZhJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgY29uc3Qgc2hvdWxkQ2hlY2tCdXR0b24gPSBldnQuZXZ0WydidXR0b24nXSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgY29uc3QgY2FuRHJhZyA9ICFzaG91bGRDaGVja0J1dHRvbiB8fCBLb252YS5kcmFnQnV0dG9ucy5pbmRleE9mKGV2dC5ldnRbJ2J1dHRvbiddKSA+PSAwO1xuICAgICAgICAgICAgaWYgKCFjYW5EcmFnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNEcmFnZ2luZygpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGhhc0RyYWdnaW5nQ2hpbGQgPSBmYWxzZTtcbiAgICAgICAgICAgIERELl9kcmFnRWxlbWVudHMuZm9yRWFjaCgoZWxlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQW5jZXN0b3JPZihlbGVtLm5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhc0RyYWdnaW5nQ2hpbGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFoYXNEcmFnZ2luZ0NoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlRHJhZ0VsZW1lbnQoZXZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9kcmFnQ2hhbmdlKCkge1xuICAgICAgICBpZiAodGhpcy5hdHRycy5kcmFnZ2FibGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbkRyYWcoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2RyYWdDbGVhbnVwKCk7XG4gICAgICAgICAgICBjb25zdCBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIGlmICghc3RhZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkcmFnRWxlbWVudCA9IERELl9kcmFnRWxlbWVudHMuZ2V0KHRoaXMuX2lkKTtcbiAgICAgICAgICAgIGNvbnN0IGlzRHJhZ2dpbmcgPSBkcmFnRWxlbWVudCAmJiBkcmFnRWxlbWVudC5kcmFnU3RhdHVzID09PSAnZHJhZ2dpbmcnO1xuICAgICAgICAgICAgY29uc3QgaXNSZWFkeSA9IGRyYWdFbGVtZW50ICYmIGRyYWdFbGVtZW50LmRyYWdTdGF0dXMgPT09ICdyZWFkeSc7XG4gICAgICAgICAgICBpZiAoaXNEcmFnZ2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcERyYWcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzUmVhZHkpIHtcbiAgICAgICAgICAgICAgICBERC5fZHJhZ0VsZW1lbnRzLmRlbGV0ZSh0aGlzLl9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2RyYWdDbGVhbnVwKCkge1xuICAgICAgICB0aGlzLm9mZignbW91c2Vkb3duLmtvbnZhJyk7XG4gICAgICAgIHRoaXMub2ZmKCd0b3VjaHN0YXJ0LmtvbnZhJyk7XG4gICAgfVxuICAgIGlzQ2xpZW50UmVjdE9uU2NyZWVuKG1hcmdpbiA9IHsgeDogMCwgeTogMCB9KSB7XG4gICAgICAgIGNvbnN0IHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpO1xuICAgICAgICBpZiAoIXN0YWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2NyZWVuUmVjdCA9IHtcbiAgICAgICAgICAgIHg6IC1tYXJnaW4ueCxcbiAgICAgICAgICAgIHk6IC1tYXJnaW4ueSxcbiAgICAgICAgICAgIHdpZHRoOiBzdGFnZS53aWR0aCgpICsgMiAqIG1hcmdpbi54LFxuICAgICAgICAgICAgaGVpZ2h0OiBzdGFnZS5oZWlnaHQoKSArIDIgKiBtYXJnaW4ueSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFV0aWwuaGF2ZUludGVyc2VjdGlvbihzY3JlZW5SZWN0LCB0aGlzLmdldENsaWVudFJlY3QoKSk7XG4gICAgfVxuICAgIHN0YXRpYyBjcmVhdGUoZGF0YSwgY29udGFpbmVyKSB7XG4gICAgICAgIGlmIChVdGlsLl9pc1N0cmluZyhkYXRhKSkge1xuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZU5vZGUoZGF0YSwgY29udGFpbmVyKTtcbiAgICB9XG4gICAgc3RhdGljIF9jcmVhdGVOb2RlKG9iaiwgY29udGFpbmVyKSB7XG4gICAgICAgIGxldCBjbGFzc05hbWUgPSBOb2RlLnByb3RvdHlwZS5nZXRDbGFzc05hbWUuY2FsbChvYmopLCBjaGlsZHJlbiA9IG9iai5jaGlsZHJlbiwgbm8sIGxlbiwgbjtcbiAgICAgICAgaWYgKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgb2JqLmF0dHJzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIUtvbnZhW2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgIFV0aWwud2FybignQ2FuIG5vdCBmaW5kIGEgbm9kZSB3aXRoIGNsYXNzIG5hbWUgXCInICtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgK1xuICAgICAgICAgICAgICAgICdcIi4gRmFsbGJhY2sgdG8gXCJTaGFwZVwiLicpO1xuICAgICAgICAgICAgY2xhc3NOYW1lID0gJ1NoYXBlJztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBDbGFzcyA9IEtvbnZhW2NsYXNzTmFtZV07XG4gICAgICAgIG5vID0gbmV3IENsYXNzKG9iai5hdHRycyk7XG4gICAgICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgICAgICAgbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgbm8uYWRkKE5vZGUuX2NyZWF0ZU5vZGUoY2hpbGRyZW5bbl0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm87XG4gICAgfVxufVxuTm9kZS5wcm90b3R5cGUubm9kZVR5cGUgPSAnTm9kZSc7XG5Ob2RlLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gW107XG5Ob2RlLnByb3RvdHlwZS5ldmVudExpc3RlbmVycyA9IHt9O1xuTm9kZS5wcm90b3R5cGUub24uY2FsbChOb2RlLnByb3RvdHlwZSwgVFJBTlNGT1JNX0NIQU5HRV9TVFIsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5fYmF0Y2hpbmdUcmFuc2Zvcm1DaGFuZ2UpIHtcbiAgICAgICAgdGhpcy5fbmVlZENsZWFyVHJhbnNmb3JtQ2FjaGUgPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2NsZWFyQ2FjaGUoVFJBTlNGT1JNKTtcbiAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfVFJBTlNGT1JNKTtcbn0pO1xuTm9kZS5wcm90b3R5cGUub24uY2FsbChOb2RlLnByb3RvdHlwZSwgJ3Zpc2libGVDaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKFZJU0lCTEUpO1xufSk7XG5Ob2RlLnByb3RvdHlwZS5vbi5jYWxsKE5vZGUucHJvdG90eXBlLCAnbGlzdGVuaW5nQ2hhbmdlLmtvbnZhJywgZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShMSVNURU5JTkcpO1xufSk7XG5Ob2RlLnByb3RvdHlwZS5vbi5jYWxsKE5vZGUucHJvdG90eXBlLCAnb3BhY2l0eUNoYW5nZS5rb252YScsIGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfT1BBQ0lUWSk7XG59KTtcbmNvbnN0IGFkZEdldHRlclNldHRlciA9IEZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICd6SW5kZXgnKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAnYWJzb2x1dGVQb3NpdGlvbicpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdwb3NpdGlvbicpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICd4JywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICd5JywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24nLCAnc291cmNlLW92ZXInLCBnZXRTdHJpbmdWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ29wYWNpdHknLCAxLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ25hbWUnLCAnJywgZ2V0U3RyaW5nVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdpZCcsICcnLCBnZXRTdHJpbmdWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ3JvdGF0aW9uJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKE5vZGUsICdzY2FsZScsIFsneCcsICd5J10pO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdzY2FsZVgnLCAxLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ3NjYWxlWScsIDEsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihOb2RlLCAnc2tldycsIFsneCcsICd5J10pO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdza2V3WCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAnc2tld1knLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoTm9kZSwgJ29mZnNldCcsIFsneCcsICd5J10pO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdvZmZzZXRYJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdvZmZzZXRZJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdkcmFnRGlzdGFuY2UnLCB1bmRlZmluZWQsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAnd2lkdGgnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2hlaWdodCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAnbGlzdGVuaW5nJywgdHJ1ZSwgZ2V0Qm9vbGVhblZhbGlkYXRvcigpKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAncHJldmVudERlZmF1bHQnLCB0cnVlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdmaWx0ZXJzJywgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsKSB7XG4gICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICByZXR1cm4gdmFsO1xufSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ3Zpc2libGUnLCB0cnVlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICd0cmFuc2Zvcm1zRW5hYmxlZCcsICdhbGwnLCBnZXRTdHJpbmdWYWxpZGF0b3IoKSk7XG5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ3NpemUnKTtcbmFkZEdldHRlclNldHRlcihOb2RlLCAnZHJhZ0JvdW5kRnVuYycpO1xuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdkcmFnZ2FibGUnLCBmYWxzZSwgZ2V0Qm9vbGVhblZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYmFja0NvbXBhdChOb2RlLCB7XG4gICAgcm90YXRlRGVnOiAncm90YXRlJyxcbiAgICBzZXRSb3RhdGlvbkRlZzogJ3NldFJvdGF0aW9uJyxcbiAgICBnZXRSb3RhdGlvbkRlZzogJ2dldFJvdGF0aW9uJyxcbn0pO1xuIiwiaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmNvbnN0IENhcHR1cmVzID0gbmV3IE1hcCgpO1xuY29uc3QgU1VQUE9SVF9QT0lOVEVSX0VWRU5UUyA9IEtvbnZhLl9nbG9iYWxbJ1BvaW50ZXJFdmVudCddICE9PSB1bmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FwdHVyZWRTaGFwZShwb2ludGVySWQpIHtcbiAgICByZXR1cm4gQ2FwdHVyZXMuZ2V0KHBvaW50ZXJJZCk7XG59XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXZlbnQoZXZ0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZ0LFxuICAgICAgICBwb2ludGVySWQ6IGV2dC5wb2ludGVySWQsXG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBoYXNQb2ludGVyQ2FwdHVyZShwb2ludGVySWQsIHNoYXBlKSB7XG4gICAgcmV0dXJuIENhcHR1cmVzLmdldChwb2ludGVySWQpID09PSBzaGFwZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXRQb2ludGVyQ2FwdHVyZShwb2ludGVySWQsIHNoYXBlKSB7XG4gICAgcmVsZWFzZUNhcHR1cmUocG9pbnRlcklkKTtcbiAgICBjb25zdCBzdGFnZSA9IHNoYXBlLmdldFN0YWdlKCk7XG4gICAgaWYgKCFzdGFnZSlcbiAgICAgICAgcmV0dXJuO1xuICAgIENhcHR1cmVzLnNldChwb2ludGVySWQsIHNoYXBlKTtcbiAgICBpZiAoU1VQUE9SVF9QT0lOVEVSX0VWRU5UUykge1xuICAgICAgICBzaGFwZS5fZmlyZSgnZ290cG9pbnRlcmNhcHR1cmUnLCBjcmVhdGVFdmVudChuZXcgUG9pbnRlckV2ZW50KCdnb3Rwb2ludGVyY2FwdHVyZScpKSk7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHJlbGVhc2VDYXB0dXJlKHBvaW50ZXJJZCwgdGFyZ2V0KSB7XG4gICAgY29uc3Qgc2hhcGUgPSBDYXB0dXJlcy5nZXQocG9pbnRlcklkKTtcbiAgICBpZiAoIXNoYXBlKVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3Qgc3RhZ2UgPSBzaGFwZS5nZXRTdGFnZSgpO1xuICAgIGlmIChzdGFnZSAmJiBzdGFnZS5jb250ZW50KSB7XG4gICAgfVxuICAgIENhcHR1cmVzLmRlbGV0ZShwb2ludGVySWQpO1xuICAgIGlmIChTVVBQT1JUX1BPSU5URVJfRVZFTlRTKSB7XG4gICAgICAgIHNoYXBlLl9maXJlKCdsb3N0cG9pbnRlcmNhcHR1cmUnLCBjcmVhdGVFdmVudChuZXcgUG9pbnRlckV2ZW50KCdsb3N0cG9pbnRlcmNhcHR1cmUnKSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBUcmFuc2Zvcm0sIFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciwgZ2V0TnVtYmVyT3JBdXRvVmFsaWRhdG9yLCBnZXRTdHJpbmdWYWxpZGF0b3IsIGdldEJvb2xlYW5WYWxpZGF0b3IsIGdldFN0cmluZ09yR3JhZGllbnRWYWxpZGF0b3IsIH0gZnJvbSBcIi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuL0dsb2JhbC5qc1wiO1xuaW1wb3J0ICogYXMgUG9pbnRlckV2ZW50cyBmcm9tIFwiLi9Qb2ludGVyRXZlbnRzLmpzXCI7XG5jb25zdCBIQVNfU0hBRE9XID0gJ2hhc1NoYWRvdyc7XG5jb25zdCBTSEFET1dfUkdCQSA9ICdzaGFkb3dSR0JBJztcbmNvbnN0IHBhdHRlcm5JbWFnZSA9ICdwYXR0ZXJuSW1hZ2UnO1xuY29uc3QgbGluZWFyR3JhZGllbnQgPSAnbGluZWFyR3JhZGllbnQnO1xuY29uc3QgcmFkaWFsR3JhZGllbnQgPSAncmFkaWFsR3JhZGllbnQnO1xubGV0IGR1bW15Q29udGV4dDtcbmZ1bmN0aW9uIGdldER1bW15Q29udGV4dCgpIHtcbiAgICBpZiAoZHVtbXlDb250ZXh0KSB7XG4gICAgICAgIHJldHVybiBkdW1teUNvbnRleHQ7XG4gICAgfVxuICAgIGR1bW15Q29udGV4dCA9IFV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLmdldENvbnRleHQoJzJkJyk7XG4gICAgcmV0dXJuIGR1bW15Q29udGV4dDtcbn1cbmV4cG9ydCBjb25zdCBzaGFwZXMgPSB7fTtcbmZ1bmN0aW9uIF9maWxsRnVuYyhjb250ZXh0KSB7XG4gICAgY29uc3QgZmlsbFJ1bGUgPSB0aGlzLmF0dHJzLmZpbGxSdWxlO1xuICAgIGlmIChmaWxsUnVsZSkge1xuICAgICAgICBjb250ZXh0LmZpbGwoZmlsbFJ1bGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29udGV4dC5maWxsKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gX3N0cm9rZUZ1bmMoY29udGV4dCkge1xuICAgIGNvbnRleHQuc3Ryb2tlKCk7XG59XG5mdW5jdGlvbiBfZmlsbEZ1bmNIaXQoY29udGV4dCkge1xuICAgIGNvbnN0IGZpbGxSdWxlID0gdGhpcy5hdHRycy5maWxsUnVsZTtcbiAgICBpZiAoZmlsbFJ1bGUpIHtcbiAgICAgICAgY29udGV4dC5maWxsKGZpbGxSdWxlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9zdHJva2VGdW5jSGl0KGNvbnRleHQpIHtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xufVxuZnVuY3Rpb24gX2NsZWFySGFzU2hhZG93Q2FjaGUoKSB7XG4gICAgdGhpcy5fY2xlYXJDYWNoZShIQVNfU0hBRE9XKTtcbn1cbmZ1bmN0aW9uIF9jbGVhckdldFNoYWRvd1JHQkFDYWNoZSgpIHtcbiAgICB0aGlzLl9jbGVhckNhY2hlKFNIQURPV19SR0JBKTtcbn1cbmZ1bmN0aW9uIF9jbGVhckZpbGxQYXR0ZXJuQ2FjaGUoKSB7XG4gICAgdGhpcy5fY2xlYXJDYWNoZShwYXR0ZXJuSW1hZ2UpO1xufVxuZnVuY3Rpb24gX2NsZWFyTGluZWFyR3JhZGllbnRDYWNoZSgpIHtcbiAgICB0aGlzLl9jbGVhckNhY2hlKGxpbmVhckdyYWRpZW50KTtcbn1cbmZ1bmN0aW9uIF9jbGVhclJhZGlhbEdyYWRpZW50Q2FjaGUoKSB7XG4gICAgdGhpcy5fY2xlYXJDYWNoZShyYWRpYWxHcmFkaWVudCk7XG59XG5leHBvcnQgY2xhc3MgU2hhcGUgZXh0ZW5kcyBOb2RlIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgc3VwZXIoY29uZmlnKTtcbiAgICAgICAgbGV0IGtleTtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGtleSA9IFV0aWwuZ2V0UmFuZG9tQ29sb3IoKTtcbiAgICAgICAgICAgIGlmIChrZXkgJiYgIShrZXkgaW4gc2hhcGVzKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sb3JLZXkgPSBrZXk7XG4gICAgICAgIHNoYXBlc1trZXldID0gdGhpcztcbiAgICB9XG4gICAgZ2V0Q29udGV4dCgpIHtcbiAgICAgICAgVXRpbC53YXJuKCdzaGFwZS5nZXRDb250ZXh0KCkgbWV0aG9kIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSBkbyBub3QgdXNlIGl0LicpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRMYXllcigpLmdldENvbnRleHQoKTtcbiAgICB9XG4gICAgZ2V0Q2FudmFzKCkge1xuICAgICAgICBVdGlsLndhcm4oJ3NoYXBlLmdldENhbnZhcygpIG1ldGhvZCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgZG8gbm90IHVzZSBpdC4nKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGF5ZXIoKS5nZXRDYW52YXMoKTtcbiAgICB9XG4gICAgZ2V0U2NlbmVGdW5jKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5zY2VuZUZ1bmMgfHwgdGhpc1snX3NjZW5lRnVuYyddO1xuICAgIH1cbiAgICBnZXRIaXRGdW5jKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5oaXRGdW5jIHx8IHRoaXNbJ19oaXRGdW5jJ107XG4gICAgfVxuICAgIGhhc1NoYWRvdygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKEhBU19TSEFET1csIHRoaXMuX2hhc1NoYWRvdyk7XG4gICAgfVxuICAgIF9oYXNTaGFkb3coKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5zaGFkb3dFbmFibGVkKCkgJiZcbiAgICAgICAgICAgIHRoaXMuc2hhZG93T3BhY2l0eSgpICE9PSAwICYmXG4gICAgICAgICAgICAhISh0aGlzLnNoYWRvd0NvbG9yKCkgfHxcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd0JsdXIoKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuc2hhZG93T2Zmc2V0WCgpIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3dPZmZzZXRZKCkpKTtcbiAgICB9XG4gICAgX2dldEZpbGxQYXR0ZXJuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUocGF0dGVybkltYWdlLCB0aGlzLl9fZ2V0RmlsbFBhdHRlcm4pO1xuICAgIH1cbiAgICBfX2dldEZpbGxQYXR0ZXJuKCkge1xuICAgICAgICBpZiAodGhpcy5maWxsUGF0dGVybkltYWdlKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGN0eCA9IGdldER1bW15Q29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcGF0dGVybiA9IGN0eC5jcmVhdGVQYXR0ZXJuKHRoaXMuZmlsbFBhdHRlcm5JbWFnZSgpLCB0aGlzLmZpbGxQYXR0ZXJuUmVwZWF0KCkgfHwgJ3JlcGVhdCcpO1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4gJiYgcGF0dGVybi5zZXRUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ciA9IG5ldyBUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgICAgICB0ci50cmFuc2xhdGUodGhpcy5maWxsUGF0dGVyblgoKSwgdGhpcy5maWxsUGF0dGVyblkoKSk7XG4gICAgICAgICAgICAgICAgdHIucm90YXRlKEtvbnZhLmdldEFuZ2xlKHRoaXMuZmlsbFBhdHRlcm5Sb3RhdGlvbigpKSk7XG4gICAgICAgICAgICAgICAgdHIuc2NhbGUodGhpcy5maWxsUGF0dGVyblNjYWxlWCgpLCB0aGlzLmZpbGxQYXR0ZXJuU2NhbGVZKCkpO1xuICAgICAgICAgICAgICAgIHRyLnRyYW5zbGF0ZSgtMSAqIHRoaXMuZmlsbFBhdHRlcm5PZmZzZXRYKCksIC0xICogdGhpcy5maWxsUGF0dGVybk9mZnNldFkoKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbSA9IHRyLmdldE1hdHJpeCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHR5cGVvZiBET01NYXRyaXggPT09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYTogbVswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGI6IG1bMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjOiBtWzJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZDogbVszXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGU6IG1bNF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmOiBtWzVdLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogbmV3IERPTU1hdHJpeChtKTtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuLnNldFRyYW5zZm9ybShtYXRyaXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2dldExpbmVhckdyYWRpZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUobGluZWFyR3JhZGllbnQsIHRoaXMuX19nZXRMaW5lYXJHcmFkaWVudCk7XG4gICAgfVxuICAgIF9fZ2V0TGluZWFyR3JhZGllbnQoKSB7XG4gICAgICAgIGNvbnN0IGNvbG9yU3RvcHMgPSB0aGlzLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHMoKTtcbiAgICAgICAgaWYgKGNvbG9yU3RvcHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGN0eCA9IGdldER1bW15Q29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnQoKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnQoKTtcbiAgICAgICAgICAgIGNvbnN0IGdyZCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudChzdGFydC54LCBzdGFydC55LCBlbmQueCwgZW5kLnkpO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBjb2xvclN0b3BzLmxlbmd0aDsgbiArPSAyKSB7XG4gICAgICAgICAgICAgICAgZ3JkLmFkZENvbG9yU3RvcChjb2xvclN0b3BzW25dLCBjb2xvclN0b3BzW24gKyAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZ3JkO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9nZXRSYWRpYWxHcmFkaWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKHJhZGlhbEdyYWRpZW50LCB0aGlzLl9fZ2V0UmFkaWFsR3JhZGllbnQpO1xuICAgIH1cbiAgICBfX2dldFJhZGlhbEdyYWRpZW50KCkge1xuICAgICAgICBjb25zdCBjb2xvclN0b3BzID0gdGhpcy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzKCk7XG4gICAgICAgIGlmIChjb2xvclN0b3BzKSB7XG4gICAgICAgICAgICBjb25zdCBjdHggPSBnZXREdW1teUNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50KCk7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSB0aGlzLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50KCk7XG4gICAgICAgICAgICBjb25zdCBncmQgPSBjdHguY3JlYXRlUmFkaWFsR3JhZGllbnQoc3RhcnQueCwgc3RhcnQueSwgdGhpcy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1cygpLCBlbmQueCwgZW5kLnksIHRoaXMuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzKCkpO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBjb2xvclN0b3BzLmxlbmd0aDsgbiArPSAyKSB7XG4gICAgICAgICAgICAgICAgZ3JkLmFkZENvbG9yU3RvcChjb2xvclN0b3BzW25dLCBjb2xvclN0b3BzW24gKyAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZ3JkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFNoYWRvd1JHQkEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShTSEFET1dfUkdCQSwgdGhpcy5fZ2V0U2hhZG93UkdCQSk7XG4gICAgfVxuICAgIF9nZXRTaGFkb3dSR0JBKCkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzU2hhZG93KCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZ2JhID0gVXRpbC5jb2xvclRvUkdCQSh0aGlzLnNoYWRvd0NvbG9yKCkpO1xuICAgICAgICBpZiAocmdiYSkge1xuICAgICAgICAgICAgcmV0dXJuICgncmdiYSgnICtcbiAgICAgICAgICAgICAgICByZ2JhLnIgK1xuICAgICAgICAgICAgICAgICcsJyArXG4gICAgICAgICAgICAgICAgcmdiYS5nICtcbiAgICAgICAgICAgICAgICAnLCcgK1xuICAgICAgICAgICAgICAgIHJnYmEuYiArXG4gICAgICAgICAgICAgICAgJywnICtcbiAgICAgICAgICAgICAgICByZ2JhLmEgKiAodGhpcy5zaGFkb3dPcGFjaXR5KCkgfHwgMSkgK1xuICAgICAgICAgICAgICAgICcpJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFzRmlsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGN1bGF0ZSgnaGFzRmlsbCcsIFtcbiAgICAgICAgICAgICdmaWxsRW5hYmxlZCcsXG4gICAgICAgICAgICAnZmlsbCcsXG4gICAgICAgICAgICAnZmlsbFBhdHRlcm5JbWFnZScsXG4gICAgICAgICAgICAnZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wcycsXG4gICAgICAgICAgICAnZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wcycsXG4gICAgICAgIF0sICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5maWxsRW5hYmxlZCgpICYmXG4gICAgICAgICAgICAgICAgISEodGhpcy5maWxsKCkgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsUGF0dGVybkltYWdlKCkgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKCkgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzKCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGhhc1N0cm9rZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGN1bGF0ZSgnaGFzU3Ryb2tlJywgW1xuICAgICAgICAgICAgJ3N0cm9rZUVuYWJsZWQnLFxuICAgICAgICAgICAgJ3N0cm9rZVdpZHRoJyxcbiAgICAgICAgICAgICdzdHJva2UnLFxuICAgICAgICAgICAgJ3N0cm9rZUxpbmVhckdyYWRpZW50Q29sb3JTdG9wcycsXG4gICAgICAgIF0sICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5zdHJva2VFbmFibGVkKCkgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnN0cm9rZVdpZHRoKCkgJiZcbiAgICAgICAgICAgICAgICAhISh0aGlzLnN0cm9rZSgpIHx8IHRoaXMuc3Ryb2tlTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGhhc0hpdFN0cm9rZSgpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLmhpdFN0cm9rZVdpZHRoKCk7XG4gICAgICAgIGlmICh3aWR0aCA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYXNTdHJva2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdHJva2VFbmFibGVkKCkgJiYgISF3aWR0aDtcbiAgICB9XG4gICAgaW50ZXJzZWN0cyhwb2ludCkge1xuICAgICAgICBjb25zdCBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgaWYgKCFzdGFnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJ1ZmZlckhpdENhbnZhcyA9IHN0YWdlLmJ1ZmZlckhpdENhbnZhcztcbiAgICAgICAgYnVmZmVySGl0Q2FudmFzLmdldENvbnRleHQoKS5jbGVhcigpO1xuICAgICAgICB0aGlzLmRyYXdIaXQoYnVmZmVySGl0Q2FudmFzLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICBjb25zdCBwID0gYnVmZmVySGl0Q2FudmFzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKE1hdGgucm91bmQocG9pbnQueCksIE1hdGgucm91bmQocG9pbnQueSksIDEsIDEpLmRhdGE7XG4gICAgICAgIHJldHVybiBwWzNdID4gMDtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgTm9kZS5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpO1xuICAgICAgICBkZWxldGUgc2hhcGVzW3RoaXMuY29sb3JLZXldO1xuICAgICAgICBkZWxldGUgdGhpcy5jb2xvcktleTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIF91c2VCdWZmZXJDYW52YXMoZm9yY2VGaWxsKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgcGVyZmVjdERyYXdFbmFibGVkID0gKF9hID0gdGhpcy5hdHRycy5wZXJmZWN0RHJhd0VuYWJsZWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRydWU7XG4gICAgICAgIGlmICghcGVyZmVjdERyYXdFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzRmlsbCA9IGZvcmNlRmlsbCB8fCB0aGlzLmhhc0ZpbGwoKTtcbiAgICAgICAgY29uc3QgaGFzU3Ryb2tlID0gdGhpcy5oYXNTdHJva2UoKTtcbiAgICAgICAgY29uc3QgaXNUcmFuc3BhcmVudCA9IHRoaXMuZ2V0QWJzb2x1dGVPcGFjaXR5KCkgIT09IDE7XG4gICAgICAgIGlmIChoYXNGaWxsICYmIGhhc1N0cm9rZSAmJiBpc1RyYW5zcGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNTaGFkb3cgPSB0aGlzLmhhc1NoYWRvdygpO1xuICAgICAgICBjb25zdCBzdHJva2VGb3JTaGFkb3cgPSB0aGlzLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWQoKTtcbiAgICAgICAgaWYgKGhhc0ZpbGwgJiYgaGFzU3Ryb2tlICYmIGhhc1NoYWRvdyAmJiBzdHJva2VGb3JTaGFkb3cpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgc2V0U3Ryb2tlSGl0RW5hYmxlZCh2YWwpIHtcbiAgICAgICAgVXRpbC53YXJuKCdzdHJva2VIaXRFbmFibGVkIHByb3BlcnR5IGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgaGl0U3Ryb2tlV2lkdGggaW5zdGVhZC4nKTtcbiAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgdGhpcy5oaXRTdHJva2VXaWR0aCgnYXV0bycpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oaXRTdHJva2VXaWR0aCgwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRTdHJva2VIaXRFbmFibGVkKCkge1xuICAgICAgICBpZiAodGhpcy5oaXRTdHJva2VXaWR0aCgpID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgY29uc3Qgc2l6ZSA9IHRoaXMuc2l6ZSgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogdGhpcy5fY2VudHJvaWQgPyAtc2l6ZS53aWR0aCAvIDIgOiAwLFxuICAgICAgICAgICAgeTogdGhpcy5fY2VudHJvaWQgPyAtc2l6ZS5oZWlnaHQgLyAyIDogMCxcbiAgICAgICAgICAgIHdpZHRoOiBzaXplLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBzaXplLmhlaWdodCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0Q2xpZW50UmVjdChjb25maWcgPSB7fSkge1xuICAgICAgICBsZXQgaGFzQ2FjaGVkUGFyZW50ID0gZmFsc2U7XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpO1xuICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgICBpZiAocGFyZW50LmlzQ2FjaGVkKCkpIHtcbiAgICAgICAgICAgICAgICBoYXNDYWNoZWRQYXJlbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LmdldFBhcmVudCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNraXBUcmFuc2Zvcm0gPSBjb25maWcuc2tpcFRyYW5zZm9ybTtcbiAgICAgICAgY29uc3QgcmVsYXRpdmVUbyA9IGNvbmZpZy5yZWxhdGl2ZVRvIHx8IChoYXNDYWNoZWRQYXJlbnQgJiYgdGhpcy5nZXRTdGFnZSgpKSB8fCB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGZpbGxSZWN0ID0gdGhpcy5nZXRTZWxmUmVjdCgpO1xuICAgICAgICBjb25zdCBhcHBseVN0cm9rZSA9ICFjb25maWcuc2tpcFN0cm9rZSAmJiB0aGlzLmhhc1N0cm9rZSgpO1xuICAgICAgICBjb25zdCBzdHJva2VXaWR0aCA9IChhcHBseVN0cm9rZSAmJiB0aGlzLnN0cm9rZVdpZHRoKCkpIHx8IDA7XG4gICAgICAgIGNvbnN0IGZpbGxBbmRTdHJva2VXaWR0aCA9IGZpbGxSZWN0LndpZHRoICsgc3Ryb2tlV2lkdGg7XG4gICAgICAgIGNvbnN0IGZpbGxBbmRTdHJva2VIZWlnaHQgPSBmaWxsUmVjdC5oZWlnaHQgKyBzdHJva2VXaWR0aDtcbiAgICAgICAgY29uc3QgYXBwbHlTaGFkb3cgPSAhY29uZmlnLnNraXBTaGFkb3cgJiYgdGhpcy5oYXNTaGFkb3coKTtcbiAgICAgICAgY29uc3Qgc2hhZG93T2Zmc2V0WCA9IGFwcGx5U2hhZG93ID8gdGhpcy5zaGFkb3dPZmZzZXRYKCkgOiAwO1xuICAgICAgICBjb25zdCBzaGFkb3dPZmZzZXRZID0gYXBwbHlTaGFkb3cgPyB0aGlzLnNoYWRvd09mZnNldFkoKSA6IDA7XG4gICAgICAgIGNvbnN0IHByZVdpZHRoID0gZmlsbEFuZFN0cm9rZVdpZHRoICsgTWF0aC5hYnMoc2hhZG93T2Zmc2V0WCk7XG4gICAgICAgIGNvbnN0IHByZUhlaWdodCA9IGZpbGxBbmRTdHJva2VIZWlnaHQgKyBNYXRoLmFicyhzaGFkb3dPZmZzZXRZKTtcbiAgICAgICAgY29uc3QgYmx1clJhZGl1cyA9IChhcHBseVNoYWRvdyAmJiB0aGlzLnNoYWRvd0JsdXIoKSkgfHwgMDtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBwcmVXaWR0aCArIGJsdXJSYWRpdXMgKiAyO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBwcmVIZWlnaHQgKyBibHVyUmFkaXVzICogMjtcbiAgICAgICAgY29uc3QgcmVjdCA9IHtcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgeDogLShzdHJva2VXaWR0aCAvIDIgKyBibHVyUmFkaXVzKSArXG4gICAgICAgICAgICAgICAgTWF0aC5taW4oc2hhZG93T2Zmc2V0WCwgMCkgK1xuICAgICAgICAgICAgICAgIGZpbGxSZWN0LngsXG4gICAgICAgICAgICB5OiAtKHN0cm9rZVdpZHRoIC8gMiArIGJsdXJSYWRpdXMpICtcbiAgICAgICAgICAgICAgICBNYXRoLm1pbihzaGFkb3dPZmZzZXRZLCAwKSArXG4gICAgICAgICAgICAgICAgZmlsbFJlY3QueSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFza2lwVHJhbnNmb3JtKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNmb3JtZWRSZWN0KHJlY3QsIHJlbGF0aXZlVG8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWN0O1xuICAgIH1cbiAgICBkcmF3U2NlbmUoY2FuLCB0b3AsIGJ1ZmZlckNhbnZhcykge1xuICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKTtcbiAgICAgICAgY29uc3QgY2FudmFzID0gY2FuIHx8IGxheWVyLmdldENhbnZhcygpLCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoKSwgY2FjaGVkQ2FudmFzID0gdGhpcy5fZ2V0Q2FudmFzQ2FjaGUoKSwgZHJhd0Z1bmMgPSB0aGlzLmdldFNjZW5lRnVuYygpLCBoYXNTaGFkb3cgPSB0aGlzLmhhc1NoYWRvdygpO1xuICAgICAgICBsZXQgc3RhZ2U7XG4gICAgICAgIGNvbnN0IHNraXBCdWZmZXIgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgY2FjaGluZ1NlbGYgPSB0b3AgPT09IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5pc1Zpc2libGUoKSAmJiAhY2FjaGluZ1NlbGYpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYWNoZWRDYW52YXMpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgY29uc3QgbSA9IHRoaXMuZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKS5nZXRNYXRyaXgoKTtcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKG1bMF0sIG1bMV0sIG1bMl0sIG1bM10sIG1bNF0sIG1bNV0pO1xuICAgICAgICAgICAgdGhpcy5fZHJhd0NhY2hlZFNjZW5lQ2FudmFzKGNvbnRleHQpO1xuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRyYXdGdW5jKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgaWYgKHRoaXMuX3VzZUJ1ZmZlckNhbnZhcygpICYmICFza2lwQnVmZmVyKSB7XG4gICAgICAgICAgICBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGJjID0gYnVmZmVyQ2FudmFzIHx8IHN0YWdlLmJ1ZmZlckNhbnZhcztcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlckNvbnRleHQgPSBiYy5nZXRDb250ZXh0KCk7XG4gICAgICAgICAgICBidWZmZXJDb250ZXh0LmNsZWFyKCk7XG4gICAgICAgICAgICBidWZmZXJDb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIGJ1ZmZlckNvbnRleHQuX2FwcGx5TGluZUpvaW4odGhpcyk7XG4gICAgICAgICAgICBidWZmZXJDb250ZXh0Ll9hcHBseU1pdGVyTGltaXQodGhpcyk7XG4gICAgICAgICAgICBjb25zdCBvID0gdGhpcy5nZXRBYnNvbHV0ZVRyYW5zZm9ybSh0b3ApLmdldE1hdHJpeCgpO1xuICAgICAgICAgICAgYnVmZmVyQ29udGV4dC50cmFuc2Zvcm0ob1swXSwgb1sxXSwgb1syXSwgb1szXSwgb1s0XSwgb1s1XSk7XG4gICAgICAgICAgICBkcmF3RnVuYy5jYWxsKHRoaXMsIGJ1ZmZlckNvbnRleHQsIHRoaXMpO1xuICAgICAgICAgICAgYnVmZmVyQ29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICBjb25zdCByYXRpbyA9IGJjLnBpeGVsUmF0aW87XG4gICAgICAgICAgICBpZiAoaGFzU2hhZG93KSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlTaGFkb3codGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0Ll9hcHBseU9wYWNpdHkodGhpcyk7XG4gICAgICAgICAgICBjb250ZXh0Ll9hcHBseUdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbih0aGlzKTtcbiAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGJjLl9jYW52YXMsIGJjLnggfHwgMCwgYmMueSB8fCAwLCBiYy53aWR0aCAvIHJhdGlvLCBiYy5oZWlnaHQgLyByYXRpbyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0Ll9hcHBseUxpbmVKb2luKHRoaXMpO1xuICAgICAgICAgICAgY29udGV4dC5fYXBwbHlNaXRlckxpbWl0KHRoaXMpO1xuICAgICAgICAgICAgaWYgKCFjYWNoaW5nU2VsZikge1xuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC50cmFuc2Zvcm0ob1swXSwgb1sxXSwgb1syXSwgb1szXSwgb1s0XSwgb1s1XSk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlPcGFjaXR5KHRoaXMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuX2FwcGx5R2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhc1NoYWRvdykge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuX2FwcGx5U2hhZG93KHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZHJhd0Z1bmMuY2FsbCh0aGlzLCBjb250ZXh0LCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRyYXdIaXQoY2FuLCB0b3AsIHNraXBEcmFnQ2hlY2sgPSBmYWxzZSkge1xuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkRHJhd0hpdCh0b3AsIHNraXBEcmFnQ2hlY2spKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSwgY2FudmFzID0gY2FuIHx8IGxheWVyLmhpdENhbnZhcywgY29udGV4dCA9IGNhbnZhcyAmJiBjYW52YXMuZ2V0Q29udGV4dCgpLCBkcmF3RnVuYyA9IHRoaXMuaGl0RnVuYygpIHx8IHRoaXMuc2NlbmVGdW5jKCksIGNhY2hlZENhbnZhcyA9IHRoaXMuX2dldENhbnZhc0NhY2hlKCksIGNhY2hlZEhpdENhbnZhcyA9IGNhY2hlZENhbnZhcyAmJiBjYWNoZWRDYW52YXMuaGl0O1xuICAgICAgICBpZiAoIXRoaXMuY29sb3JLZXkpIHtcbiAgICAgICAgICAgIFV0aWwud2FybignTG9va3MgbGlrZSB5b3VyIGNhbnZhcyBoYXMgYSBkZXN0cm95ZWQgc2hhcGUgaW4gaXQuIERvIG5vdCByZXVzZSBzaGFwZSBhZnRlciB5b3UgZGVzdHJveWVkIGl0LiBJZiB5b3Ugd2FudCB0byByZXVzZSBzaGFwZSB5b3Ugc2hvdWxkIGNhbGwgcmVtb3ZlKCkgaW5zdGVhZCBvZiBkZXN0cm95KCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FjaGVkSGl0Q2FudmFzKSB7XG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIGNvbnN0IG0gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zZm9ybShtWzBdLCBtWzFdLCBtWzJdLCBtWzNdLCBtWzRdLCBtWzVdKTtcbiAgICAgICAgICAgIHRoaXMuX2RyYXdDYWNoZWRIaXRDYW52YXMoY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZHJhd0Z1bmMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICBjb250ZXh0Ll9hcHBseUxpbmVKb2luKHRoaXMpO1xuICAgICAgICBjb250ZXh0Ll9hcHBseU1pdGVyTGltaXQodGhpcyk7XG4gICAgICAgIGNvbnN0IHNlbGZDYWNoZSA9IHRoaXMgPT09IHRvcDtcbiAgICAgICAgaWYgKCFzZWxmQ2FjaGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zZm9ybShvWzBdLCBvWzFdLCBvWzJdLCBvWzNdLCBvWzRdLCBvWzVdKTtcbiAgICAgICAgfVxuICAgICAgICBkcmF3RnVuYy5jYWxsKHRoaXMsIGNvbnRleHQsIHRoaXMpO1xuICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRyYXdIaXRGcm9tQ2FjaGUoYWxwaGFUaHJlc2hvbGQgPSAwKSB7XG4gICAgICAgIGNvbnN0IGNhY2hlZENhbnZhcyA9IHRoaXMuX2dldENhbnZhc0NhY2hlKCksIHNjZW5lQ2FudmFzID0gdGhpcy5fZ2V0Q2FjaGVkU2NlbmVDYW52YXMoKSwgaGl0Q2FudmFzID0gY2FjaGVkQ2FudmFzLmhpdCwgaGl0Q29udGV4dCA9IGhpdENhbnZhcy5nZXRDb250ZXh0KCksIGhpdFdpZHRoID0gaGl0Q2FudmFzLmdldFdpZHRoKCksIGhpdEhlaWdodCA9IGhpdENhbnZhcy5nZXRIZWlnaHQoKTtcbiAgICAgICAgaGl0Q29udGV4dC5jbGVhcigpO1xuICAgICAgICBoaXRDb250ZXh0LmRyYXdJbWFnZShzY2VuZUNhbnZhcy5fY2FudmFzLCAwLCAwLCBoaXRXaWR0aCwgaGl0SGVpZ2h0KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGhpdEltYWdlRGF0YSA9IGhpdENvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGhpdFdpZHRoLCBoaXRIZWlnaHQpO1xuICAgICAgICAgICAgY29uc3QgaGl0RGF0YSA9IGhpdEltYWdlRGF0YS5kYXRhO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gaGl0RGF0YS5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCByZ2JDb2xvcktleSA9IFV0aWwuX2hleFRvUmdiKHRoaXMuY29sb3JLZXkpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFscGhhID0gaGl0RGF0YVtpICsgM107XG4gICAgICAgICAgICAgICAgaWYgKGFscGhhID4gYWxwaGFUaHJlc2hvbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaGl0RGF0YVtpXSA9IHJnYkNvbG9yS2V5LnI7XG4gICAgICAgICAgICAgICAgICAgIGhpdERhdGFbaSArIDFdID0gcmdiQ29sb3JLZXkuZztcbiAgICAgICAgICAgICAgICAgICAgaGl0RGF0YVtpICsgMl0gPSByZ2JDb2xvcktleS5iO1xuICAgICAgICAgICAgICAgICAgICBoaXREYXRhW2kgKyAzXSA9IDI1NTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhpdERhdGFbaSArIDNdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoaXRDb250ZXh0LnB1dEltYWdlRGF0YShoaXRJbWFnZURhdGEsIDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBVdGlsLmVycm9yKCdVbmFibGUgdG8gZHJhdyBoaXQgZ3JhcGggZnJvbSBjYWNoZWQgc2NlbmUgY2FudmFzLiAnICsgZS5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaGFzUG9pbnRlckNhcHR1cmUocG9pbnRlcklkKSB7XG4gICAgICAgIHJldHVybiBQb2ludGVyRXZlbnRzLmhhc1BvaW50ZXJDYXB0dXJlKHBvaW50ZXJJZCwgdGhpcyk7XG4gICAgfVxuICAgIHNldFBvaW50ZXJDYXB0dXJlKHBvaW50ZXJJZCkge1xuICAgICAgICBQb2ludGVyRXZlbnRzLnNldFBvaW50ZXJDYXB0dXJlKHBvaW50ZXJJZCwgdGhpcyk7XG4gICAgfVxuICAgIHJlbGVhc2VDYXB0dXJlKHBvaW50ZXJJZCkge1xuICAgICAgICBQb2ludGVyRXZlbnRzLnJlbGVhc2VDYXB0dXJlKHBvaW50ZXJJZCwgdGhpcyk7XG4gICAgfVxufVxuU2hhcGUucHJvdG90eXBlLl9maWxsRnVuYyA9IF9maWxsRnVuYztcblNoYXBlLnByb3RvdHlwZS5fc3Ryb2tlRnVuYyA9IF9zdHJva2VGdW5jO1xuU2hhcGUucHJvdG90eXBlLl9maWxsRnVuY0hpdCA9IF9maWxsRnVuY0hpdDtcblNoYXBlLnByb3RvdHlwZS5fc3Ryb2tlRnVuY0hpdCA9IF9zdHJva2VGdW5jSGl0O1xuU2hhcGUucHJvdG90eXBlLl9jZW50cm9pZCA9IGZhbHNlO1xuU2hhcGUucHJvdG90eXBlLm5vZGVUeXBlID0gJ1NoYXBlJztcbl9yZWdpc3Rlck5vZGUoU2hhcGUpO1xuU2hhcGUucHJvdG90eXBlLmV2ZW50TGlzdGVuZXJzID0ge307XG5TaGFwZS5wcm90b3R5cGUub24uY2FsbChTaGFwZS5wcm90b3R5cGUsICdzaGFkb3dDb2xvckNoYW5nZS5rb252YSBzaGFkb3dCbHVyQ2hhbmdlLmtvbnZhIHNoYWRvd09mZnNldENoYW5nZS5rb252YSBzaGFkb3dPcGFjaXR5Q2hhbmdlLmtvbnZhIHNoYWRvd0VuYWJsZWRDaGFuZ2Uua29udmEnLCBfY2xlYXJIYXNTaGFkb3dDYWNoZSk7XG5TaGFwZS5wcm90b3R5cGUub24uY2FsbChTaGFwZS5wcm90b3R5cGUsICdzaGFkb3dDb2xvckNoYW5nZS5rb252YSBzaGFkb3dPcGFjaXR5Q2hhbmdlLmtvbnZhIHNoYWRvd0VuYWJsZWRDaGFuZ2Uua29udmEnLCBfY2xlYXJHZXRTaGFkb3dSR0JBQ2FjaGUpO1xuU2hhcGUucHJvdG90eXBlLm9uLmNhbGwoU2hhcGUucHJvdG90eXBlLCAnZmlsbFByaW9yaXR5Q2hhbmdlLmtvbnZhIGZpbGxQYXR0ZXJuSW1hZ2VDaGFuZ2Uua29udmEgZmlsbFBhdHRlcm5SZXBlYXRDaGFuZ2Uua29udmEgZmlsbFBhdHRlcm5TY2FsZVhDaGFuZ2Uua29udmEgZmlsbFBhdHRlcm5TY2FsZVlDaGFuZ2Uua29udmEgZmlsbFBhdHRlcm5PZmZzZXRYQ2hhbmdlLmtvbnZhIGZpbGxQYXR0ZXJuT2Zmc2V0WUNoYW5nZS5rb252YSBmaWxsUGF0dGVyblhDaGFuZ2Uua29udmEgZmlsbFBhdHRlcm5ZQ2hhbmdlLmtvbnZhIGZpbGxQYXR0ZXJuUm90YXRpb25DaGFuZ2Uua29udmEnLCBfY2xlYXJGaWxsUGF0dGVybkNhY2hlKTtcblNoYXBlLnByb3RvdHlwZS5vbi5jYWxsKFNoYXBlLnByb3RvdHlwZSwgJ2ZpbGxQcmlvcml0eUNoYW5nZS5rb252YSBmaWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzQ2hhbmdlLmtvbnZhIGZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYQ2hhbmdlLmtvbnZhIGZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZQ2hhbmdlLmtvbnZhIGZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WENoYW5nZS5rb252YSBmaWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFlDaGFuZ2Uua29udmEnLCBfY2xlYXJMaW5lYXJHcmFkaWVudENhY2hlKTtcblNoYXBlLnByb3RvdHlwZS5vbi5jYWxsKFNoYXBlLnByb3RvdHlwZSwgJ2ZpbGxQcmlvcml0eUNoYW5nZS5rb252YSBmaWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzQ2hhbmdlLmtvbnZhIGZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYQ2hhbmdlLmtvbnZhIGZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRZQ2hhbmdlLmtvbnZhIGZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WENoYW5nZS5rb252YSBmaWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFlDaGFuZ2Uua29udmEgZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNDaGFuZ2Uua29udmEgZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzQ2hhbmdlLmtvbnZhJywgX2NsZWFyUmFkaWFsR3JhZGllbnRDYWNoZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZScsIHVuZGVmaW5lZCwgZ2V0U3RyaW5nT3JHcmFkaWVudFZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc3Ryb2tlV2lkdGgnLCAyLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxBZnRlclN0cm9rZUVuYWJsZWQnLCBmYWxzZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2hpdFN0cm9rZVdpZHRoJywgJ2F1dG8nLCBnZXROdW1iZXJPckF1dG9WYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZUhpdEVuYWJsZWQnLCB0cnVlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdwZXJmZWN0RHJhd0VuYWJsZWQnLCB0cnVlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdzaGFkb3dGb3JTdHJva2VFbmFibGVkJywgdHJ1ZSwgZ2V0Qm9vbGVhblZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnbGluZUpvaW4nKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnbGluZUNhcCcpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdtaXRlckxpbWl0Jyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3NjZW5lRnVuYycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdoaXRGdW5jJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2Rhc2gnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZGFzaE9mZnNldCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc2hhZG93Q29sb3InLCB1bmRlZmluZWQsIGdldFN0cmluZ1ZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc2hhZG93Qmx1cicsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc2hhZG93T3BhY2l0eScsIDEsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihTaGFwZSwgJ3NoYWRvd09mZnNldCcsIFsneCcsICd5J10pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdzaGFkb3dPZmZzZXRYJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdzaGFkb3dPZmZzZXRZJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUGF0dGVybkltYWdlJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGwnLCB1bmRlZmluZWQsIGdldFN0cmluZ09yR3JhZGllbnRWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxQYXR0ZXJuWCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFBhdHRlcm5ZJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZUxpbmVhckdyYWRpZW50Q29sb3JTdG9wcycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1cycsIDApO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXMnLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wcycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUGF0dGVyblJlcGVhdCcsICdyZXBlYXQnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbEVuYWJsZWQnLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc3Ryb2tlRW5hYmxlZCcsIHRydWUpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdzaGFkb3dFbmFibGVkJywgdHJ1ZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2Rhc2hFbmFibGVkJywgdHJ1ZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZVNjYWxlRW5hYmxlZCcsIHRydWUpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUHJpb3JpdHknLCAnY29sb3InKTtcbkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxQYXR0ZXJuT2Zmc2V0JywgWyd4JywgJ3knXSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxQYXR0ZXJuT2Zmc2V0WCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFBhdHRlcm5PZmZzZXRZJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFBhdHRlcm5TY2FsZScsIFsneCcsICd5J10pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUGF0dGVyblNjYWxlWCcsIDEsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFBhdHRlcm5TY2FsZVknLCAxLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50JywgW1xuICAgICd4JyxcbiAgICAneScsXG5dKTtcbkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZUxpbmVhckdyYWRpZW50U3RhcnRQb2ludCcsIFtcbiAgICAneCcsXG4gICAgJ3knLFxuXSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYJywgMCk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ3N0cm9rZUxpbmVhckdyYWRpZW50U3RhcnRQb2ludFgnLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFknLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc3Ryb2tlTGluZWFyR3JhZGllbnRTdGFydFBvaW50WScsIDApO1xuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnQnLCBbXG4gICAgJ3gnLFxuICAgICd5Jyxcbl0pO1xuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKFNoYXBlLCAnc3Ryb2tlTGluZWFyR3JhZGllbnRFbmRQb2ludCcsIFtcbiAgICAneCcsXG4gICAgJ3knLFxuXSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WCcsIDApO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdzdHJva2VMaW5lYXJHcmFkaWVudEVuZFBvaW50WCcsIDApO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFknLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnc3Ryb2tlTGluZWFyR3JhZGllbnRFbmRQb2ludFknLCAwKTtcbkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnQnLCBbXG4gICAgJ3gnLFxuICAgICd5Jyxcbl0pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WCcsIDApO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WScsIDApO1xuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnQnLCBbXG4gICAgJ3gnLFxuICAgICd5Jyxcbl0pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFgnLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZJywgMCk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTaGFwZSwgJ2ZpbGxQYXR0ZXJuUm90YXRpb24nLCAwKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNoYXBlLCAnZmlsbFJ1bGUnLCB1bmRlZmluZWQsIGdldFN0cmluZ1ZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYmFja0NvbXBhdChTaGFwZSwge1xuICAgIGRhc2hBcnJheTogJ2Rhc2gnLFxuICAgIGdldERhc2hBcnJheTogJ2dldERhc2gnLFxuICAgIHNldERhc2hBcnJheTogJ2dldERhc2gnLFxuICAgIGRyYXdGdW5jOiAnc2NlbmVGdW5jJyxcbiAgICBnZXREcmF3RnVuYzogJ2dldFNjZW5lRnVuYycsXG4gICAgc2V0RHJhd0Z1bmM6ICdzZXRTY2VuZUZ1bmMnLFxuICAgIGRyYXdIaXRGdW5jOiAnaGl0RnVuYycsXG4gICAgZ2V0RHJhd0hpdEZ1bmM6ICdnZXRIaXRGdW5jJyxcbiAgICBzZXREcmF3SGl0RnVuYzogJ3NldEhpdEZ1bmMnLFxufSk7XG4iLCJpbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4vVXRpbC5qc1wiO1xuaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IENvbnRhaW5lciB9IGZyb20gXCIuL0NvbnRhaW5lci5qc1wiO1xuaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmltcG9ydCB7IFNjZW5lQ2FudmFzLCBIaXRDYW52YXMgfSBmcm9tIFwiLi9DYW52YXMuanNcIjtcbmltcG9ydCB7IEREIH0gZnJvbSBcIi4vRHJhZ0FuZERyb3AuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmltcG9ydCAqIGFzIFBvaW50ZXJFdmVudHMgZnJvbSBcIi4vUG9pbnRlckV2ZW50cy5qc1wiO1xuY29uc3QgU1RBR0UgPSAnU3RhZ2UnLCBTVFJJTkcgPSAnc3RyaW5nJywgUFggPSAncHgnLCBNT1VTRU9VVCA9ICdtb3VzZW91dCcsIE1PVVNFTEVBVkUgPSAnbW91c2VsZWF2ZScsIE1PVVNFT1ZFUiA9ICdtb3VzZW92ZXInLCBNT1VTRUVOVEVSID0gJ21vdXNlZW50ZXInLCBNT1VTRU1PVkUgPSAnbW91c2Vtb3ZlJywgTU9VU0VET1dOID0gJ21vdXNlZG93bicsIE1PVVNFVVAgPSAnbW91c2V1cCcsIFBPSU5URVJNT1ZFID0gJ3BvaW50ZXJtb3ZlJywgUE9JTlRFUkRPV04gPSAncG9pbnRlcmRvd24nLCBQT0lOVEVSVVAgPSAncG9pbnRlcnVwJywgUE9JTlRFUkNBTkNFTCA9ICdwb2ludGVyY2FuY2VsJywgTE9TVFBPSU5URVJDQVBUVVJFID0gJ2xvc3Rwb2ludGVyY2FwdHVyZScsIFBPSU5URVJPVVQgPSAncG9pbnRlcm91dCcsIFBPSU5URVJMRUFWRSA9ICdwb2ludGVybGVhdmUnLCBQT0lOVEVST1ZFUiA9ICdwb2ludGVyb3ZlcicsIFBPSU5URVJFTlRFUiA9ICdwb2ludGVyZW50ZXInLCBDT05URVhUTUVOVSA9ICdjb250ZXh0bWVudScsIFRPVUNIU1RBUlQgPSAndG91Y2hzdGFydCcsIFRPVUNIRU5EID0gJ3RvdWNoZW5kJywgVE9VQ0hNT1ZFID0gJ3RvdWNobW92ZScsIFRPVUNIQ0FOQ0VMID0gJ3RvdWNoY2FuY2VsJywgV0hFRUwgPSAnd2hlZWwnLCBNQVhfTEFZRVJTX05VTUJFUiA9IDUsIEVWRU5UUyA9IFtcbiAgICBbTU9VU0VFTlRFUiwgJ19wb2ludGVyZW50ZXInXSxcbiAgICBbTU9VU0VET1dOLCAnX3BvaW50ZXJkb3duJ10sXG4gICAgW01PVVNFTU9WRSwgJ19wb2ludGVybW92ZSddLFxuICAgIFtNT1VTRVVQLCAnX3BvaW50ZXJ1cCddLFxuICAgIFtNT1VTRUxFQVZFLCAnX3BvaW50ZXJsZWF2ZSddLFxuICAgIFtUT1VDSFNUQVJULCAnX3BvaW50ZXJkb3duJ10sXG4gICAgW1RPVUNITU9WRSwgJ19wb2ludGVybW92ZSddLFxuICAgIFtUT1VDSEVORCwgJ19wb2ludGVydXAnXSxcbiAgICBbVE9VQ0hDQU5DRUwsICdfcG9pbnRlcmNhbmNlbCddLFxuICAgIFtNT1VTRU9WRVIsICdfcG9pbnRlcm92ZXInXSxcbiAgICBbV0hFRUwsICdfd2hlZWwnXSxcbiAgICBbQ09OVEVYVE1FTlUsICdfY29udGV4dG1lbnUnXSxcbiAgICBbUE9JTlRFUkRPV04sICdfcG9pbnRlcmRvd24nXSxcbiAgICBbUE9JTlRFUk1PVkUsICdfcG9pbnRlcm1vdmUnXSxcbiAgICBbUE9JTlRFUlVQLCAnX3BvaW50ZXJ1cCddLFxuICAgIFtQT0lOVEVSQ0FOQ0VMLCAnX3BvaW50ZXJjYW5jZWwnXSxcbiAgICBbUE9JTlRFUkxFQVZFLCAnX3BvaW50ZXJsZWF2ZSddLFxuICAgIFtMT1NUUE9JTlRFUkNBUFRVUkUsICdfbG9zdHBvaW50ZXJjYXB0dXJlJ10sXG5dO1xuY29uc3QgRVZFTlRTX01BUCA9IHtcbiAgICBtb3VzZToge1xuICAgICAgICBbUE9JTlRFUk9VVF06IE1PVVNFT1VULFxuICAgICAgICBbUE9JTlRFUkxFQVZFXTogTU9VU0VMRUFWRSxcbiAgICAgICAgW1BPSU5URVJPVkVSXTogTU9VU0VPVkVSLFxuICAgICAgICBbUE9JTlRFUkVOVEVSXTogTU9VU0VFTlRFUixcbiAgICAgICAgW1BPSU5URVJNT1ZFXTogTU9VU0VNT1ZFLFxuICAgICAgICBbUE9JTlRFUkRPV05dOiBNT1VTRURPV04sXG4gICAgICAgIFtQT0lOVEVSVVBdOiBNT1VTRVVQLFxuICAgICAgICBbUE9JTlRFUkNBTkNFTF06ICdtb3VzZWNhbmNlbCcsXG4gICAgICAgIHBvaW50ZXJjbGljazogJ2NsaWNrJyxcbiAgICAgICAgcG9pbnRlcmRibGNsaWNrOiAnZGJsY2xpY2snLFxuICAgIH0sXG4gICAgdG91Y2g6IHtcbiAgICAgICAgW1BPSU5URVJPVVRdOiAndG91Y2hvdXQnLFxuICAgICAgICBbUE9JTlRFUkxFQVZFXTogJ3RvdWNobGVhdmUnLFxuICAgICAgICBbUE9JTlRFUk9WRVJdOiAndG91Y2hvdmVyJyxcbiAgICAgICAgW1BPSU5URVJFTlRFUl06ICd0b3VjaGVudGVyJyxcbiAgICAgICAgW1BPSU5URVJNT1ZFXTogVE9VQ0hNT1ZFLFxuICAgICAgICBbUE9JTlRFUkRPV05dOiBUT1VDSFNUQVJULFxuICAgICAgICBbUE9JTlRFUlVQXTogVE9VQ0hFTkQsXG4gICAgICAgIFtQT0lOVEVSQ0FOQ0VMXTogVE9VQ0hDQU5DRUwsXG4gICAgICAgIHBvaW50ZXJjbGljazogJ3RhcCcsXG4gICAgICAgIHBvaW50ZXJkYmxjbGljazogJ2RibHRhcCcsXG4gICAgfSxcbiAgICBwb2ludGVyOiB7XG4gICAgICAgIFtQT0lOVEVST1VUXTogUE9JTlRFUk9VVCxcbiAgICAgICAgW1BPSU5URVJMRUFWRV06IFBPSU5URVJMRUFWRSxcbiAgICAgICAgW1BPSU5URVJPVkVSXTogUE9JTlRFUk9WRVIsXG4gICAgICAgIFtQT0lOVEVSRU5URVJdOiBQT0lOVEVSRU5URVIsXG4gICAgICAgIFtQT0lOVEVSTU9WRV06IFBPSU5URVJNT1ZFLFxuICAgICAgICBbUE9JTlRFUkRPV05dOiBQT0lOVEVSRE9XTixcbiAgICAgICAgW1BPSU5URVJVUF06IFBPSU5URVJVUCxcbiAgICAgICAgW1BPSU5URVJDQU5DRUxdOiBQT0lOVEVSQ0FOQ0VMLFxuICAgICAgICBwb2ludGVyY2xpY2s6ICdwb2ludGVyY2xpY2snLFxuICAgICAgICBwb2ludGVyZGJsY2xpY2s6ICdwb2ludGVyZGJsY2xpY2snLFxuICAgIH0sXG59O1xuY29uc3QgZ2V0RXZlbnRUeXBlID0gKHR5cGUpID0+IHtcbiAgICBpZiAodHlwZS5pbmRleE9mKCdwb2ludGVyJykgPj0gMCkge1xuICAgICAgICByZXR1cm4gJ3BvaW50ZXInO1xuICAgIH1cbiAgICBpZiAodHlwZS5pbmRleE9mKCd0b3VjaCcpID49IDApIHtcbiAgICAgICAgcmV0dXJuICd0b3VjaCc7XG4gICAgfVxuICAgIHJldHVybiAnbW91c2UnO1xufTtcbmNvbnN0IGdldEV2ZW50c01hcCA9IChldmVudFR5cGUpID0+IHtcbiAgICBjb25zdCB0eXBlID0gZ2V0RXZlbnRUeXBlKGV2ZW50VHlwZSk7XG4gICAgaWYgKHR5cGUgPT09ICdwb2ludGVyJykge1xuICAgICAgICByZXR1cm4gS29udmEucG9pbnRlckV2ZW50c0VuYWJsZWQgJiYgRVZFTlRTX01BUC5wb2ludGVyO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gJ3RvdWNoJykge1xuICAgICAgICByZXR1cm4gRVZFTlRTX01BUC50b3VjaDtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdtb3VzZScpIHtcbiAgICAgICAgcmV0dXJuIEVWRU5UU19NQVAubW91c2U7XG4gICAgfVxufTtcbmZ1bmN0aW9uIGNoZWNrTm9DbGlwKGF0dHJzID0ge30pIHtcbiAgICBpZiAoYXR0cnMuY2xpcEZ1bmMgfHwgYXR0cnMuY2xpcFdpZHRoIHx8IGF0dHJzLmNsaXBIZWlnaHQpIHtcbiAgICAgICAgVXRpbC53YXJuKCdTdGFnZSBkb2VzIG5vdCBzdXBwb3J0IGNsaXBwaW5nLiBQbGVhc2UgdXNlIGNsaXAgZm9yIExheWVycyBvciBHcm91cHMuJyk7XG4gICAgfVxuICAgIHJldHVybiBhdHRycztcbn1cbmNvbnN0IE5PX1BPSU5URVJTX01FU1NBR0UgPSBgUG9pbnRlciBwb3NpdGlvbiBpcyBtaXNzaW5nIGFuZCBub3QgcmVnaXN0ZXJlZCBieSB0aGUgc3RhZ2UuIExvb2tzIGxpa2UgaXQgaXMgb3V0c2lkZSBvZiB0aGUgc3RhZ2UgY29udGFpbmVyLiBZb3UgY2FuIHNldCBpdCBtYW51YWxseSBmcm9tIGV2ZW50OiBzdGFnZS5zZXRQb2ludGVyc1Bvc2l0aW9ucyhldmVudCk7YDtcbmV4cG9ydCBjb25zdCBzdGFnZXMgPSBbXTtcbmV4cG9ydCBjbGFzcyBTdGFnZSBleHRlbmRzIENvbnRhaW5lciB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyKGNoZWNrTm9DbGlwKGNvbmZpZykpO1xuICAgICAgICB0aGlzLl9wb2ludGVyUG9zaXRpb25zID0gW107XG4gICAgICAgIHRoaXMuX2NoYW5nZWRQb2ludGVyUG9zaXRpb25zID0gW107XG4gICAgICAgIHRoaXMuX2J1aWxkRE9NKCk7XG4gICAgICAgIHRoaXMuX2JpbmRDb250ZW50RXZlbnRzKCk7XG4gICAgICAgIHN0YWdlcy5wdXNoKHRoaXMpO1xuICAgICAgICB0aGlzLm9uKCd3aWR0aENoYW5nZS5rb252YSBoZWlnaHRDaGFuZ2Uua29udmEnLCB0aGlzLl9yZXNpemVET00pO1xuICAgICAgICB0aGlzLm9uKCd2aXNpYmxlQ2hhbmdlLmtvbnZhJywgdGhpcy5fY2hlY2tWaXNpYmlsaXR5KTtcbiAgICAgICAgdGhpcy5vbignY2xpcFdpZHRoQ2hhbmdlLmtvbnZhIGNsaXBIZWlnaHRDaGFuZ2Uua29udmEgY2xpcEZ1bmNDaGFuZ2Uua29udmEnLCAoKSA9PiB7XG4gICAgICAgICAgICBjaGVja05vQ2xpcCh0aGlzLmF0dHJzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2NoZWNrVmlzaWJpbGl0eSgpO1xuICAgIH1cbiAgICBfdmFsaWRhdGVBZGQoY2hpbGQpIHtcbiAgICAgICAgY29uc3QgaXNMYXllciA9IGNoaWxkLmdldFR5cGUoKSA9PT0gJ0xheWVyJztcbiAgICAgICAgY29uc3QgaXNGYXN0TGF5ZXIgPSBjaGlsZC5nZXRUeXBlKCkgPT09ICdGYXN0TGF5ZXInO1xuICAgICAgICBjb25zdCB2YWxpZCA9IGlzTGF5ZXIgfHwgaXNGYXN0TGF5ZXI7XG4gICAgICAgIGlmICghdmFsaWQpIHtcbiAgICAgICAgICAgIFV0aWwudGhyb3coJ1lvdSBtYXkgb25seSBhZGQgbGF5ZXJzIHRvIHRoZSBzdGFnZS4nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2hlY2tWaXNpYmlsaXR5KCkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0eWxlID0gdGhpcy52aXNpYmxlKCkgPyAnJyA6ICdub25lJztcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLmRpc3BsYXkgPSBzdHlsZTtcbiAgICB9XG4gICAgc2V0Q29udGFpbmVyKGNvbnRhaW5lcikge1xuICAgICAgICBpZiAodHlwZW9mIGNvbnRhaW5lciA9PT0gU1RSSU5HKSB7XG4gICAgICAgICAgICBsZXQgaWQ7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLmNoYXJBdCgwKSA9PT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gY29udGFpbmVyLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2xhc3NOYW1lKVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuY2hhckF0KDApICE9PSAnIycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZCA9IGNvbnRhaW5lci5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAnQ2FuIG5vdCBmaW5kIGNvbnRhaW5lciBpbiBkb2N1bWVudCB3aXRoIGlkICcgKyBpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRBdHRyKCdjb250YWluZXInLCBjb250YWluZXIpO1xuICAgICAgICBpZiAodGhpcy5jb250ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNob3VsZERyYXdIaXQoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjbGVhcigpIHtcbiAgICAgICAgY29uc3QgbGF5ZXJzID0gdGhpcy5jaGlsZHJlbiwgbGVuID0gbGF5ZXJzLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgbGF5ZXJzW25dLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGNsb25lKG9iaikge1xuICAgICAgICBpZiAoIW9iaikge1xuICAgICAgICAgICAgb2JqID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb2JqLmNvbnRhaW5lciA9XG4gICAgICAgICAgICB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICByZXR1cm4gQ29udGFpbmVyLnByb3RvdHlwZS5jbG9uZS5jYWxsKHRoaXMsIG9iaik7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudDtcbiAgICAgICAgaWYgKGNvbnRlbnQgJiYgVXRpbC5faXNJbkRvY3VtZW50KGNvbnRlbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lcigpLnJlbW92ZUNoaWxkKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gc3RhZ2VzLmluZGV4T2YodGhpcyk7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICBzdGFnZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICBVdGlsLnJlbGVhc2VDYW52YXModGhpcy5idWZmZXJDYW52YXMuX2NhbnZhcywgdGhpcy5idWZmZXJIaXRDYW52YXMuX2NhbnZhcyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBnZXRQb2ludGVyUG9zaXRpb24oKSB7XG4gICAgICAgIGNvbnN0IHBvcyA9IHRoaXMuX3BvaW50ZXJQb3NpdGlvbnNbMF0gfHwgdGhpcy5fY2hhbmdlZFBvaW50ZXJQb3NpdGlvbnNbMF07XG4gICAgICAgIGlmICghcG9zKSB7XG4gICAgICAgICAgICBVdGlsLndhcm4oTk9fUE9JTlRFUlNfTUVTU0FHRSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogcG9zLngsXG4gICAgICAgICAgICB5OiBwb3MueSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2dldFBvaW50ZXJCeUlkKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb2ludGVyUG9zaXRpb25zLmZpbmQoKHApID0+IHAuaWQgPT09IGlkKTtcbiAgICB9XG4gICAgZ2V0UG9pbnRlcnNQb3NpdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb2ludGVyUG9zaXRpb25zO1xuICAgIH1cbiAgICBnZXRTdGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGdldENvbnRlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQ7XG4gICAgfVxuICAgIF90b0tvbnZhQ2FudmFzKGNvbmZpZykge1xuICAgICAgICBjb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuICAgICAgICBjb25maWcueCA9IGNvbmZpZy54IHx8IDA7XG4gICAgICAgIGNvbmZpZy55ID0gY29uZmlnLnkgfHwgMDtcbiAgICAgICAgY29uZmlnLndpZHRoID0gY29uZmlnLndpZHRoIHx8IHRoaXMud2lkdGgoKTtcbiAgICAgICAgY29uZmlnLmhlaWdodCA9IGNvbmZpZy5oZWlnaHQgfHwgdGhpcy5oZWlnaHQoKTtcbiAgICAgICAgY29uc3QgY2FudmFzID0gbmV3IFNjZW5lQ2FudmFzKHtcbiAgICAgICAgICAgIHdpZHRoOiBjb25maWcud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGNvbmZpZy5oZWlnaHQsXG4gICAgICAgICAgICBwaXhlbFJhdGlvOiBjb25maWcucGl4ZWxSYXRpbyB8fCAxLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgX2NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0O1xuICAgICAgICBjb25zdCBsYXllcnMgPSB0aGlzLmNoaWxkcmVuO1xuICAgICAgICBpZiAoY29uZmlnLnggfHwgY29uZmlnLnkpIHtcbiAgICAgICAgICAgIF9jb250ZXh0LnRyYW5zbGF0ZSgtMSAqIGNvbmZpZy54LCAtMSAqIGNvbmZpZy55KTtcbiAgICAgICAgfVxuICAgICAgICBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgICAgICAgIGlmICghbGF5ZXIuaXNWaXNpYmxlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBsYXllckNhbnZhcyA9IGxheWVyLl90b0tvbnZhQ2FudmFzKGNvbmZpZyk7XG4gICAgICAgICAgICBfY29udGV4dC5kcmF3SW1hZ2UobGF5ZXJDYW52YXMuX2NhbnZhcywgY29uZmlnLngsIGNvbmZpZy55LCBsYXllckNhbnZhcy5nZXRXaWR0aCgpIC8gbGF5ZXJDYW52YXMuZ2V0UGl4ZWxSYXRpbygpLCBsYXllckNhbnZhcy5nZXRIZWlnaHQoKSAvIGxheWVyQ2FudmFzLmdldFBpeGVsUmF0aW8oKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgIH1cbiAgICBnZXRJbnRlcnNlY3Rpb24ocG9zKSB7XG4gICAgICAgIGlmICghcG9zKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsYXllcnMgPSB0aGlzLmNoaWxkcmVuLCBsZW4gPSBsYXllcnMubGVuZ3RoLCBlbmQgPSBsZW4gLSAxO1xuICAgICAgICBmb3IgKGxldCBuID0gZW5kOyBuID49IDA7IG4tLSkge1xuICAgICAgICAgICAgY29uc3Qgc2hhcGUgPSBsYXllcnNbbl0uZ2V0SW50ZXJzZWN0aW9uKHBvcyk7XG4gICAgICAgICAgICBpZiAoc2hhcGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIF9yZXNpemVET00oKSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCgpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmhlaWdodCgpO1xuICAgICAgICBpZiAodGhpcy5jb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuc3R5bGUud2lkdGggPSB3aWR0aCArIFBYO1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFBYO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYnVmZmVyQ2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHRoaXMuYnVmZmVySGl0Q2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgobGF5ZXIpID0+IHtcbiAgICAgICAgICAgIGxheWVyLnNldFNpemUoeyB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgICAgICAgICAgbGF5ZXIuZHJhdygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRkKGxheWVyLCAuLi5yZXN0KSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZChhcmd1bWVudHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuYWRkKGxheWVyKTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gdGhpcy5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgIGlmIChsZW5ndGggPiBNQVhfTEFZRVJTX05VTUJFUikge1xuICAgICAgICAgICAgVXRpbC53YXJuKCdUaGUgc3RhZ2UgaGFzICcgK1xuICAgICAgICAgICAgICAgIGxlbmd0aCArXG4gICAgICAgICAgICAgICAgJyBsYXllcnMuIFJlY29tbWVuZGVkIG1heGltdW0gbnVtYmVyIG9mIGxheWVycyBpcyAzLTUuIEFkZGluZyBtb3JlIGxheWVycyBpbnRvIHRoZSBzdGFnZSBtYXkgZHJvcCB0aGUgcGVyZm9ybWFuY2UuIFJldGhpbmsgeW91ciB0cmVlIHN0cnVjdHVyZSwgeW91IGNhbiB1c2UgS29udmEuR3JvdXAuJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGF5ZXIuc2V0U2l6ZSh7IHdpZHRoOiB0aGlzLndpZHRoKCksIGhlaWdodDogdGhpcy5oZWlnaHQoKSB9KTtcbiAgICAgICAgbGF5ZXIuZHJhdygpO1xuICAgICAgICBpZiAoS29udmEuaXNCcm93c2VyKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuYXBwZW5kQ2hpbGQobGF5ZXIuY2FudmFzLl9jYW52YXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBnZXRQYXJlbnQoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBnZXRMYXllcigpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGhhc1BvaW50ZXJDYXB0dXJlKHBvaW50ZXJJZCkge1xuICAgICAgICByZXR1cm4gUG9pbnRlckV2ZW50cy5oYXNQb2ludGVyQ2FwdHVyZShwb2ludGVySWQsIHRoaXMpO1xuICAgIH1cbiAgICBzZXRQb2ludGVyQ2FwdHVyZShwb2ludGVySWQpIHtcbiAgICAgICAgUG9pbnRlckV2ZW50cy5zZXRQb2ludGVyQ2FwdHVyZShwb2ludGVySWQsIHRoaXMpO1xuICAgIH1cbiAgICByZWxlYXNlQ2FwdHVyZShwb2ludGVySWQpIHtcbiAgICAgICAgUG9pbnRlckV2ZW50cy5yZWxlYXNlQ2FwdHVyZShwb2ludGVySWQsIHRoaXMpO1xuICAgIH1cbiAgICBnZXRMYXllcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuO1xuICAgIH1cbiAgICBfYmluZENvbnRlbnRFdmVudHMoKSB7XG4gICAgICAgIGlmICghS29udmEuaXNCcm93c2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgRVZFTlRTLmZvckVhY2goKFtldmVudCwgbWV0aG9kTmFtZV0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29udGVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpc1ttZXRob2ROYW1lXShldnQpO1xuICAgICAgICAgICAgfSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9wb2ludGVyZW50ZXIoZXZ0KSB7XG4gICAgICAgIHRoaXMuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZ0KTtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gZ2V0RXZlbnRzTWFwKGV2dC50eXBlKTtcbiAgICAgICAgaWYgKGV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcmVudGVyLCB7XG4gICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfcG9pbnRlcm92ZXIoZXZ0KSB7XG4gICAgICAgIHRoaXMuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZ0KTtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gZ2V0RXZlbnRzTWFwKGV2dC50eXBlKTtcbiAgICAgICAgaWYgKGV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcm92ZXIsIHtcbiAgICAgICAgICAgICAgICBldnQ6IGV2dCxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9nZXRUYXJnZXRTaGFwZShldmVuVHlwZSkge1xuICAgICAgICBsZXQgc2hhcGUgPSB0aGlzW2V2ZW5UeXBlICsgJ3RhcmdldFNoYXBlJ107XG4gICAgICAgIGlmIChzaGFwZSAmJiAhc2hhcGUuZ2V0U3RhZ2UoKSkge1xuICAgICAgICAgICAgc2hhcGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGFwZTtcbiAgICB9XG4gICAgX3BvaW50ZXJsZWF2ZShldnQpIHtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gZ2V0RXZlbnRzTWFwKGV2dC50eXBlKTtcbiAgICAgICAgY29uc3QgZXZlbnRUeXBlID0gZ2V0RXZlbnRUeXBlKGV2dC50eXBlKTtcbiAgICAgICAgaWYgKCFldmVudHMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFBvaW50ZXJzUG9zaXRpb25zKGV2dCk7XG4gICAgICAgIGNvbnN0IHRhcmdldFNoYXBlID0gdGhpcy5fZ2V0VGFyZ2V0U2hhcGUoZXZlbnRUeXBlKTtcbiAgICAgICAgY29uc3QgZXZlbnRzRW5hYmxlZCA9ICEoS29udmEuaXNEcmFnZ2luZygpIHx8IEtvbnZhLmlzVHJhbnNmb3JtaW5nKCkpIHx8IEtvbnZhLmhpdE9uRHJhZ0VuYWJsZWQ7XG4gICAgICAgIGlmICh0YXJnZXRTaGFwZSAmJiBldmVudHNFbmFibGVkKSB7XG4gICAgICAgICAgICB0YXJnZXRTaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcm91dCwgeyBldnQ6IGV2dCB9KTtcbiAgICAgICAgICAgIHRhcmdldFNoYXBlLl9maXJlQW5kQnViYmxlKGV2ZW50cy5wb2ludGVybGVhdmUsIHsgZXZ0OiBldnQgfSk7XG4gICAgICAgICAgICB0aGlzLl9maXJlKGV2ZW50cy5wb2ludGVybGVhdmUsIHtcbiAgICAgICAgICAgICAgICBldnQ6IGV2dCxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAndGFyZ2V0U2hhcGUnXSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRzRW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcmxlYXZlLCB7XG4gICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX2ZpcmUoZXZlbnRzLnBvaW50ZXJvdXQsIHtcbiAgICAgICAgICAgICAgICBldnQ6IGV2dCxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9pbnRlclBvcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BvaW50ZXJQb3NpdGlvbnMgPSBbXTtcbiAgICB9XG4gICAgX3BvaW50ZXJkb3duKGV2dCkge1xuICAgICAgICBjb25zdCBldmVudHMgPSBnZXRFdmVudHNNYXAoZXZ0LnR5cGUpO1xuICAgICAgICBjb25zdCBldmVudFR5cGUgPSBnZXRFdmVudFR5cGUoZXZ0LnR5cGUpO1xuICAgICAgICBpZiAoIWV2ZW50cykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZ0KTtcbiAgICAgICAgbGV0IHRyaWdnZXJlZE9uU2hhcGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2hhbmdlZFBvaW50ZXJQb3NpdGlvbnMuZm9yRWFjaCgocG9zKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzaGFwZSA9IHRoaXMuZ2V0SW50ZXJzZWN0aW9uKHBvcyk7XG4gICAgICAgICAgICBERC5qdXN0RHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgS29udmFbJ18nICsgZXZlbnRUeXBlICsgJ0xpc3RlbkNsaWNrJ10gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKCFzaGFwZSB8fCAhc2hhcGUuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXNbZXZlbnRUeXBlICsgJ0NsaWNrU3RhcnRTaGFwZSddID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChLb252YS5jYXB0dXJlUG9pbnRlckV2ZW50c0VuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBzaGFwZS5zZXRQb2ludGVyQ2FwdHVyZShwb3MuaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAnQ2xpY2tTdGFydFNoYXBlJ10gPSBzaGFwZTtcbiAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKGV2ZW50cy5wb2ludGVyZG93biwge1xuICAgICAgICAgICAgICAgIGV2dDogZXZ0LFxuICAgICAgICAgICAgICAgIHBvaW50ZXJJZDogcG9zLmlkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0cmlnZ2VyZWRPblNoYXBlID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVG91Y2ggPSBldnQudHlwZS5pbmRleE9mKCd0b3VjaCcpID49IDA7XG4gICAgICAgICAgICBpZiAoc2hhcGUucHJldmVudERlZmF1bHQoKSAmJiBldnQuY2FuY2VsYWJsZSAmJiBpc1RvdWNoKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXRyaWdnZXJlZE9uU2hhcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpcmUoZXZlbnRzLnBvaW50ZXJkb3duLCB7XG4gICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgcG9pbnRlcklkOiB0aGlzLl9wb2ludGVyUG9zaXRpb25zWzBdLmlkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3BvaW50ZXJtb3ZlKGV2dCkge1xuICAgICAgICBjb25zdCBldmVudHMgPSBnZXRFdmVudHNNYXAoZXZ0LnR5cGUpO1xuICAgICAgICBjb25zdCBldmVudFR5cGUgPSBnZXRFdmVudFR5cGUoZXZ0LnR5cGUpO1xuICAgICAgICBpZiAoIWV2ZW50cykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzVG91Y2hQb2ludGVyID0gZXZ0LnR5cGUuaW5kZXhPZigndG91Y2gnKSA+PSAwIHx8XG4gICAgICAgICAgICBldnQucG9pbnRlclR5cGUgPT09ICd0b3VjaCc7XG4gICAgICAgIGlmIChLb252YS5pc0RyYWdnaW5nKCkgJiZcbiAgICAgICAgICAgIERELm5vZGUucHJldmVudERlZmF1bHQoKSAmJlxuICAgICAgICAgICAgZXZ0LmNhbmNlbGFibGUgJiZcbiAgICAgICAgICAgIGlzVG91Y2hQb2ludGVyKSB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFBvaW50ZXJzUG9zaXRpb25zKGV2dCk7XG4gICAgICAgIGNvbnN0IGV2ZW50c0VuYWJsZWQgPSAhKEtvbnZhLmlzRHJhZ2dpbmcoKSB8fCBLb252YS5pc1RyYW5zZm9ybWluZygpKSB8fCBLb252YS5oaXRPbkRyYWdFbmFibGVkO1xuICAgICAgICBpZiAoIWV2ZW50c0VuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcm9jZXNzZWRTaGFwZXNJZHMgPSB7fTtcbiAgICAgICAgbGV0IHRyaWdnZXJlZE9uU2hhcGUgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgdGFyZ2V0U2hhcGUgPSB0aGlzLl9nZXRUYXJnZXRTaGFwZShldmVudFR5cGUpO1xuICAgICAgICB0aGlzLl9jaGFuZ2VkUG9pbnRlclBvc2l0aW9ucy5mb3JFYWNoKChwb3MpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNoYXBlID0gKFBvaW50ZXJFdmVudHMuZ2V0Q2FwdHVyZWRTaGFwZShwb3MuaWQpIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnNlY3Rpb24ocG9zKSk7XG4gICAgICAgICAgICBjb25zdCBwb2ludGVySWQgPSBwb3MuaWQ7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsgZXZ0OiBldnQsIHBvaW50ZXJJZCB9O1xuICAgICAgICAgICAgY29uc3QgZGlmZmVyZW50VGFyZ2V0ID0gdGFyZ2V0U2hhcGUgIT09IHNoYXBlO1xuICAgICAgICAgICAgaWYgKGRpZmZlcmVudFRhcmdldCAmJiB0YXJnZXRTaGFwZSkge1xuICAgICAgICAgICAgICAgIHRhcmdldFNoYXBlLl9maXJlQW5kQnViYmxlKGV2ZW50cy5wb2ludGVyb3V0LCB7IC4uLmV2ZW50IH0sIHNoYXBlKTtcbiAgICAgICAgICAgICAgICB0YXJnZXRTaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcmxlYXZlLCB7IC4uLmV2ZW50IH0sIHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaGFwZSkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWRTaGFwZXNJZHNbc2hhcGUuX2lkXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZFNoYXBlc0lkc1tzaGFwZS5faWRdID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaGFwZSAmJiBzaGFwZS5pc0xpc3RlbmluZygpKSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkT25TaGFwZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGRpZmZlcmVudFRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcm92ZXIsIHsgLi4uZXZlbnQgfSwgdGFyZ2V0U2hhcGUpO1xuICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcmVudGVyLCB7IC4uLmV2ZW50IH0sIHRhcmdldFNoYXBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAndGFyZ2V0U2hhcGUnXSA9IHNoYXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcm1vdmUsIHsgLi4uZXZlbnQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0U2hhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcm92ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dDogZXZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbZXZlbnRUeXBlICsgJ3RhcmdldFNoYXBlJ10gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdHJpZ2dlcmVkT25TaGFwZSkge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcm1vdmUsIHtcbiAgICAgICAgICAgICAgICBldnQ6IGV2dCxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgICAgICBwb2ludGVySWQ6IHRoaXMuX2NoYW5nZWRQb2ludGVyUG9zaXRpb25zWzBdLmlkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3BvaW50ZXJ1cChldnQpIHtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gZ2V0RXZlbnRzTWFwKGV2dC50eXBlKTtcbiAgICAgICAgY29uc3QgZXZlbnRUeXBlID0gZ2V0RXZlbnRUeXBlKGV2dC50eXBlKTtcbiAgICAgICAgaWYgKCFldmVudHMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFBvaW50ZXJzUG9zaXRpb25zKGV2dCk7XG4gICAgICAgIGNvbnN0IGNsaWNrU3RhcnRTaGFwZSA9IHRoaXNbZXZlbnRUeXBlICsgJ0NsaWNrU3RhcnRTaGFwZSddO1xuICAgICAgICBjb25zdCBjbGlja0VuZFNoYXBlID0gdGhpc1tldmVudFR5cGUgKyAnQ2xpY2tFbmRTaGFwZSddO1xuICAgICAgICBjb25zdCBwcm9jZXNzZWRTaGFwZXNJZHMgPSB7fTtcbiAgICAgICAgbGV0IHNraXBQb2ludGVyVXBUcmlnZ2VyID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NoYW5nZWRQb2ludGVyUG9zaXRpb25zLmZvckVhY2goKHBvcykgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2hhcGUgPSAoUG9pbnRlckV2ZW50cy5nZXRDYXB0dXJlZFNoYXBlKHBvcy5pZCkgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmdldEludGVyc2VjdGlvbihwb3MpKTtcbiAgICAgICAgICAgIGlmIChzaGFwZSkge1xuICAgICAgICAgICAgICAgIHNoYXBlLnJlbGVhc2VDYXB0dXJlKHBvcy5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZFNoYXBlc0lkc1tzaGFwZS5faWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkU2hhcGVzSWRzW3NoYXBlLl9pZF0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcG9pbnRlcklkID0gcG9zLmlkO1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGV2dDogZXZ0LCBwb2ludGVySWQgfTtcbiAgICAgICAgICAgIGxldCBmaXJlRGJsQ2xpY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChLb252YVsnXycgKyBldmVudFR5cGUgKyAnSW5EYmxDbGlja1dpbmRvdyddKSB7XG4gICAgICAgICAgICAgICAgZmlyZURibENsaWNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpc1tldmVudFR5cGUgKyAnRGJsVGltZW91dCddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFERC5qdXN0RHJhZ2dlZCkge1xuICAgICAgICAgICAgICAgIEtvbnZhWydfJyArIGV2ZW50VHlwZSArICdJbkRibENsaWNrV2luZG93J10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzW2V2ZW50VHlwZSArICdEYmxUaW1lb3V0J10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAnRGJsVGltZW91dCddID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgS29udmFbJ18nICsgZXZlbnRUeXBlICsgJ0luRGJsQ2xpY2tXaW5kb3cnXSA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgS29udmEuZGJsQ2xpY2tXaW5kb3cpO1xuICAgICAgICAgICAgaWYgKHNoYXBlICYmIHNoYXBlLmlzTGlzdGVuaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBza2lwUG9pbnRlclVwVHJpZ2dlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAnQ2xpY2tFbmRTaGFwZSddID0gc2hhcGU7XG4gICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoZXZlbnRzLnBvaW50ZXJ1cCwgeyAuLi5ldmVudCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoS29udmFbJ18nICsgZXZlbnRUeXBlICsgJ0xpc3RlbkNsaWNrJ10gJiZcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tTdGFydFNoYXBlICYmXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrU3RhcnRTaGFwZSA9PT0gc2hhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoZXZlbnRzLnBvaW50ZXJjbGljaywgeyAuLi5ldmVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcmVEYmxDbGljayAmJiBjbGlja0VuZFNoYXBlICYmIGNsaWNrRW5kU2hhcGUgPT09IHNoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShldmVudHMucG9pbnRlcmRibGNsaWNrLCB7IC4uLmV2ZW50IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpc1tldmVudFR5cGUgKyAnQ2xpY2tFbmRTaGFwZSddID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoIXNraXBQb2ludGVyVXBUcmlnZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmUoZXZlbnRzLnBvaW50ZXJ1cCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcklkOiB0aGlzLl9jaGFuZ2VkUG9pbnRlclBvc2l0aW9uc1swXS5pZCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNraXBQb2ludGVyVXBUcmlnZ2VyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKEtvbnZhWydfJyArIGV2ZW50VHlwZSArICdMaXN0ZW5DbGljayddKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmUoZXZlbnRzLnBvaW50ZXJjbGljaywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcklkLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZpcmVEYmxDbGljaykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXJlKGV2ZW50cy5wb2ludGVyZGJsY2xpY2ssIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dDogZXZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFza2lwUG9pbnRlclVwVHJpZ2dlcikge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudHMucG9pbnRlcnVwLCB7XG4gICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgcG9pbnRlcklkOiB0aGlzLl9jaGFuZ2VkUG9pbnRlclBvc2l0aW9uc1swXS5pZCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIEtvbnZhWydfJyArIGV2ZW50VHlwZSArICdMaXN0ZW5DbGljayddID0gZmFsc2U7XG4gICAgICAgIGlmIChldnQuY2FuY2VsYWJsZSAmJiBldmVudFR5cGUgIT09ICd0b3VjaCcgJiYgZXZlbnRUeXBlICE9PSAncG9pbnRlcicpIHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9jb250ZXh0bWVudShldnQpIHtcbiAgICAgICAgdGhpcy5zZXRQb2ludGVyc1Bvc2l0aW9ucyhldnQpO1xuICAgICAgICBjb25zdCBzaGFwZSA9IHRoaXMuZ2V0SW50ZXJzZWN0aW9uKHRoaXMuZ2V0UG9pbnRlclBvc2l0aW9uKCkpO1xuICAgICAgICBpZiAoc2hhcGUgJiYgc2hhcGUuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoQ09OVEVYVE1FTlUsIHsgZXZ0OiBldnQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFWFRNRU5VLCB7XG4gICAgICAgICAgICAgICAgZXZ0OiBldnQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IHRoaXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfd2hlZWwoZXZ0KSB7XG4gICAgICAgIHRoaXMuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZ0KTtcbiAgICAgICAgY29uc3Qgc2hhcGUgPSB0aGlzLmdldEludGVyc2VjdGlvbih0aGlzLmdldFBvaW50ZXJQb3NpdGlvbigpKTtcbiAgICAgICAgaWYgKHNoYXBlICYmIHNoYXBlLmlzTGlzdGVuaW5nKCkpIHtcbiAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKFdIRUVMLCB7IGV2dDogZXZ0IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShXSEVFTCwge1xuICAgICAgICAgICAgICAgIGV2dDogZXZ0LFxuICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcyxcbiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3BvaW50ZXJjYW5jZWwoZXZ0KSB7XG4gICAgICAgIHRoaXMuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZ0KTtcbiAgICAgICAgY29uc3Qgc2hhcGUgPSBQb2ludGVyRXZlbnRzLmdldENhcHR1cmVkU2hhcGUoZXZ0LnBvaW50ZXJJZCkgfHxcbiAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJzZWN0aW9uKHRoaXMuZ2V0UG9pbnRlclBvc2l0aW9uKCkpO1xuICAgICAgICBpZiAoc2hhcGUpIHtcbiAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKFBPSU5URVJVUCwgUG9pbnRlckV2ZW50cy5jcmVhdGVFdmVudChldnQpKTtcbiAgICAgICAgfVxuICAgICAgICBQb2ludGVyRXZlbnRzLnJlbGVhc2VDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xuICAgIH1cbiAgICBfbG9zdHBvaW50ZXJjYXB0dXJlKGV2dCkge1xuICAgICAgICBQb2ludGVyRXZlbnRzLnJlbGVhc2VDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xuICAgIH1cbiAgICBzZXRQb2ludGVyc1Bvc2l0aW9ucyhldnQpIHtcbiAgICAgICAgY29uc3QgY29udGVudFBvc2l0aW9uID0gdGhpcy5fZ2V0Q29udGVudFBvc2l0aW9uKCk7XG4gICAgICAgIGxldCB4ID0gbnVsbCwgeSA9IG51bGw7XG4gICAgICAgIGV2dCA9IGV2dCA/IGV2dCA6IHdpbmRvdy5ldmVudDtcbiAgICAgICAgaWYgKGV2dC50b3VjaGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJQb3NpdGlvbnMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX2NoYW5nZWRQb2ludGVyUG9zaXRpb25zID0gW107XG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGV2dC50b3VjaGVzLCAodG91Y2gpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wb2ludGVyUG9zaXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogdG91Y2guaWRlbnRpZmllcixcbiAgICAgICAgICAgICAgICAgICAgeDogKHRvdWNoLmNsaWVudFggLSBjb250ZW50UG9zaXRpb24ubGVmdCkgLyBjb250ZW50UG9zaXRpb24uc2NhbGVYLFxuICAgICAgICAgICAgICAgICAgICB5OiAodG91Y2guY2xpZW50WSAtIGNvbnRlbnRQb3NpdGlvbi50b3ApIC8gY29udGVudFBvc2l0aW9uLnNjYWxlWSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChldnQuY2hhbmdlZFRvdWNoZXMgfHwgZXZ0LnRvdWNoZXMsICh0b3VjaCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZWRQb2ludGVyUG9zaXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogdG91Y2guaWRlbnRpZmllcixcbiAgICAgICAgICAgICAgICAgICAgeDogKHRvdWNoLmNsaWVudFggLSBjb250ZW50UG9zaXRpb24ubGVmdCkgLyBjb250ZW50UG9zaXRpb24uc2NhbGVYLFxuICAgICAgICAgICAgICAgICAgICB5OiAodG91Y2guY2xpZW50WSAtIGNvbnRlbnRQb3NpdGlvbi50b3ApIC8gY29udGVudFBvc2l0aW9uLnNjYWxlWSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgeCA9IChldnQuY2xpZW50WCAtIGNvbnRlbnRQb3NpdGlvbi5sZWZ0KSAvIGNvbnRlbnRQb3NpdGlvbi5zY2FsZVg7XG4gICAgICAgICAgICB5ID0gKGV2dC5jbGllbnRZIC0gY29udGVudFBvc2l0aW9uLnRvcCkgLyBjb250ZW50UG9zaXRpb24uc2NhbGVZO1xuICAgICAgICAgICAgdGhpcy5wb2ludGVyUG9zID0ge1xuICAgICAgICAgICAgICAgIHg6IHgsXG4gICAgICAgICAgICAgICAgeTogeSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLl9wb2ludGVyUG9zaXRpb25zID0gW3sgeCwgeSwgaWQ6IFV0aWwuX2dldEZpcnN0UG9pbnRlcklkKGV2dCkgfV07XG4gICAgICAgICAgICB0aGlzLl9jaGFuZ2VkUG9pbnRlclBvc2l0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICB7IHgsIHksIGlkOiBVdGlsLl9nZXRGaXJzdFBvaW50ZXJJZChldnQpIH0sXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zZXRQb2ludGVyUG9zaXRpb24oZXZ0KSB7XG4gICAgICAgIFV0aWwud2FybignTWV0aG9kIF9zZXRQb2ludGVyUG9zaXRpb24gaXMgZGVwcmVjYXRlZC4gVXNlIFwic3RhZ2Uuc2V0UG9pbnRlcnNQb3NpdGlvbnMoZXZlbnQpXCIgaW5zdGVhZC4nKTtcbiAgICAgICAgdGhpcy5zZXRQb2ludGVyc1Bvc2l0aW9ucyhldnQpO1xuICAgIH1cbiAgICBfZ2V0Q29udGVudFBvc2l0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGVudCB8fCAhdGhpcy5jb250ZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICAgICAgbGVmdDogMCxcbiAgICAgICAgICAgICAgICBzY2FsZVg6IDEsXG4gICAgICAgICAgICAgICAgc2NhbGVZOiAxLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jb250ZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG9wOiByZWN0LnRvcCxcbiAgICAgICAgICAgIGxlZnQ6IHJlY3QubGVmdCxcbiAgICAgICAgICAgIHNjYWxlWDogcmVjdC53aWR0aCAvIHRoaXMuY29udGVudC5jbGllbnRXaWR0aCB8fCAxLFxuICAgICAgICAgICAgc2NhbGVZOiByZWN0LmhlaWdodCAvIHRoaXMuY29udGVudC5jbGllbnRIZWlnaHQgfHwgMSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2J1aWxkRE9NKCkge1xuICAgICAgICB0aGlzLmJ1ZmZlckNhbnZhcyA9IG5ldyBTY2VuZUNhbnZhcyh7XG4gICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCgpLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCgpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idWZmZXJIaXRDYW52YXMgPSBuZXcgSGl0Q2FudmFzKHtcbiAgICAgICAgICAgIHBpeGVsUmF0aW86IDEsXG4gICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCgpLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCgpLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFLb252YS5pc0Jyb3dzZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcigpO1xuICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhyb3cgJ1N0YWdlIGhhcyBubyBjb250YWluZXIuIEEgY29udGFpbmVyIGlzIHJlcXVpcmVkLic7XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICB0aGlzLmNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLnVzZXJTZWxlY3QgPSAnbm9uZSc7XG4gICAgICAgIHRoaXMuY29udGVudC5jbGFzc05hbWUgPSAna29udmFqcy1jb250ZW50JztcbiAgICAgICAgdGhpcy5jb250ZW50LnNldEF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG4gICAgICAgIHRoaXMuX3Jlc2l6ZURPTSgpO1xuICAgIH1cbiAgICBjYWNoZSgpIHtcbiAgICAgICAgVXRpbC53YXJuKCdDYWNoZSBmdW5jdGlvbiBpcyBub3QgYWxsb3dlZCBmb3Igc3RhZ2UuIFlvdSBtYXkgdXNlIGNhY2hlIG9ubHkgZm9yIGxheWVycywgZ3JvdXBzIGFuZCBzaGFwZXMuJyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBjbGVhckNhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYmF0Y2hEcmF3KCkge1xuICAgICAgICB0aGlzLmdldENoaWxkcmVuKCkuZm9yRWFjaChmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgICAgICAgIGxheWVyLmJhdGNoRHJhdygpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuU3RhZ2UucHJvdG90eXBlLm5vZGVUeXBlID0gU1RBR0U7XG5fcmVnaXN0ZXJOb2RlKFN0YWdlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFN0YWdlLCAnY29udGFpbmVyJyk7XG5pZiAoS29udmEuaXNCcm93c2VyKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgc3RhZ2VzLmZvckVhY2goKHN0YWdlKSA9PiB7XG4gICAgICAgICAgICBzdGFnZS5iYXRjaERyYXcoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG4iLCJpbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4vVXRpbC5qc1wiO1xuaW1wb3J0IHsgQW5pbWF0aW9uIH0gZnJvbSBcIi4vQW5pbWF0aW9uLmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmNvbnN0IGJsYWNrbGlzdCA9IHtcbiAgICBub2RlOiAxLFxuICAgIGR1cmF0aW9uOiAxLFxuICAgIGVhc2luZzogMSxcbiAgICBvbkZpbmlzaDogMSxcbiAgICB5b3lvOiAxLFxufSwgUEFVU0VEID0gMSwgUExBWUlORyA9IDIsIFJFVkVSU0lORyA9IDMsIGNvbG9yQXR0cnMgPSBbJ2ZpbGwnLCAnc3Ryb2tlJywgJ3NoYWRvd0NvbG9yJ107XG5sZXQgaWRDb3VudGVyID0gMDtcbmNsYXNzIFR3ZWVuRW5naW5lIHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wLCBwcm9wRnVuYywgZnVuYywgYmVnaW4sIGZpbmlzaCwgZHVyYXRpb24sIHlveW8pIHtcbiAgICAgICAgdGhpcy5wcm9wID0gcHJvcDtcbiAgICAgICAgdGhpcy5wcm9wRnVuYyA9IHByb3BGdW5jO1xuICAgICAgICB0aGlzLmJlZ2luID0gYmVnaW47XG4gICAgICAgIHRoaXMuX3BvcyA9IGJlZ2luO1xuICAgICAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIHRoaXMuX2NoYW5nZSA9IDA7XG4gICAgICAgIHRoaXMucHJldlBvcyA9IDA7XG4gICAgICAgIHRoaXMueW95byA9IHlveW87XG4gICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICB0aGlzLl9wb3NpdGlvbiA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IDA7XG4gICAgICAgIHRoaXMuX2ZpbmlzaCA9IDA7XG4gICAgICAgIHRoaXMuZnVuYyA9IGZ1bmM7XG4gICAgICAgIHRoaXMuX2NoYW5nZSA9IGZpbmlzaCAtIHRoaXMuYmVnaW47XG4gICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICB9XG4gICAgZmlyZShzdHIpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlciA9IHRoaXNbc3RyXTtcbiAgICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgICAgIGhhbmRsZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRUaW1lKHQpIHtcbiAgICAgICAgaWYgKHQgPiB0aGlzLmR1cmF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy55b3lvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IHRoaXMuZHVyYXRpb247XG4gICAgICAgICAgICAgICAgdGhpcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHQgPCAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy55b3lvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90aW1lID0gdDtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0VGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWU7XG4gICAgfVxuICAgIHNldFBvc2l0aW9uKHApIHtcbiAgICAgICAgdGhpcy5wcmV2UG9zID0gdGhpcy5fcG9zO1xuICAgICAgICB0aGlzLnByb3BGdW5jKHApO1xuICAgICAgICB0aGlzLl9wb3MgPSBwO1xuICAgIH1cbiAgICBnZXRQb3NpdGlvbih0KSB7XG4gICAgICAgIGlmICh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHQgPSB0aGlzLl90aW1lO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmZ1bmModCwgdGhpcy5iZWdpbiwgdGhpcy5fY2hhbmdlLCB0aGlzLmR1cmF0aW9uKTtcbiAgICB9XG4gICAgcGxheSgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBMQVlJTkc7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IHRoaXMuZ2V0VGltZXIoKSAtIHRoaXMuX3RpbWU7XG4gICAgICAgIHRoaXMub25FbnRlckZyYW1lKCk7XG4gICAgICAgIHRoaXMuZmlyZSgnb25QbGF5Jyk7XG4gICAgfVxuICAgIHJldmVyc2UoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBSRVZFUlNJTkc7XG4gICAgICAgIHRoaXMuX3RpbWUgPSB0aGlzLmR1cmF0aW9uIC0gdGhpcy5fdGltZTtcbiAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gdGhpcy5nZXRUaW1lcigpIC0gdGhpcy5fdGltZTtcbiAgICAgICAgdGhpcy5vbkVudGVyRnJhbWUoKTtcbiAgICAgICAgdGhpcy5maXJlKCdvblJldmVyc2UnKTtcbiAgICB9XG4gICAgc2Vlayh0KSB7XG4gICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgdGhpcy5fdGltZSA9IHQ7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgIHRoaXMuZmlyZSgnb25TZWVrJyk7XG4gICAgfVxuICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnBhdXNlKCk7XG4gICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmZpcmUoJ29uUmVzZXQnKTtcbiAgICB9XG4gICAgZmluaXNoKCkge1xuICAgICAgICB0aGlzLnBhdXNlKCk7XG4gICAgICAgIHRoaXMuX3RpbWUgPSB0aGlzLmR1cmF0aW9uO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmZpcmUoJ29uRmluaXNoJyk7XG4gICAgfVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbih0aGlzLmdldFBvc2l0aW9uKHRoaXMuX3RpbWUpKTtcbiAgICAgICAgdGhpcy5maXJlKCdvblVwZGF0ZScpO1xuICAgIH1cbiAgICBvbkVudGVyRnJhbWUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmdldFRpbWVyKCkgLSB0aGlzLl9zdGFydFRpbWU7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBQTEFZSU5HKSB7XG4gICAgICAgICAgICB0aGlzLnNldFRpbWUodCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdGF0ZSA9PT0gUkVWRVJTSU5HKSB7XG4gICAgICAgICAgICB0aGlzLnNldFRpbWUodGhpcy5kdXJhdGlvbiAtIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHBhdXNlKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gUEFVU0VEO1xuICAgICAgICB0aGlzLmZpcmUoJ29uUGF1c2UnKTtcbiAgICB9XG4gICAgZ2V0VGltZXIoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHdlZW4ge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcywgbm9kZSA9IGNvbmZpZy5ub2RlLCBub2RlSWQgPSBub2RlLl9pZCwgZWFzaW5nID0gY29uZmlnLmVhc2luZyB8fCBFYXNpbmdzLkxpbmVhciwgeW95byA9ICEhY29uZmlnLnlveW87XG4gICAgICAgIGxldCBkdXJhdGlvbiwga2V5O1xuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZy5kdXJhdGlvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGR1cmF0aW9uID0gMC4zO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbmZpZy5kdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAwLjAwMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGR1cmF0aW9uID0gY29uZmlnLmR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIHRoaXMuX2lkID0gaWRDb3VudGVyKys7XG4gICAgICAgIGNvbnN0IGxheWVycyA9IG5vZGUuZ2V0TGF5ZXIoKSB8fFxuICAgICAgICAgICAgKG5vZGUgaW5zdGFuY2VvZiBLb252YVsnU3RhZ2UnXSA/IG5vZGUuZ2V0TGF5ZXJzKCkgOiBudWxsKTtcbiAgICAgICAgaWYgKCFsYXllcnMpIHtcbiAgICAgICAgICAgIFV0aWwuZXJyb3IoJ1R3ZWVuIGNvbnN0cnVjdG9yIGhhdmUgYG5vZGVgIHRoYXQgaXMgbm90IGluIGEgbGF5ZXIuIFBsZWFzZSBhZGQgbm9kZSBpbnRvIGxheWVyIGZpcnN0LicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5pbSA9IG5ldyBBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhhdC50d2Vlbi5vbkVudGVyRnJhbWUoKTtcbiAgICAgICAgfSwgbGF5ZXJzKTtcbiAgICAgICAgdGhpcy50d2VlbiA9IG5ldyBUd2VlbkVuZ2luZShrZXksIGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB0aGF0Ll90d2VlbkZ1bmMoaSk7XG4gICAgICAgIH0sIGVhc2luZywgMCwgMSwgZHVyYXRpb24gKiAxMDAwLCB5b3lvKTtcbiAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XG4gICAgICAgIGlmICghVHdlZW4uYXR0cnNbbm9kZUlkXSkge1xuICAgICAgICAgICAgVHdlZW4uYXR0cnNbbm9kZUlkXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghVHdlZW4uYXR0cnNbbm9kZUlkXVt0aGlzLl9pZF0pIHtcbiAgICAgICAgICAgIFR3ZWVuLmF0dHJzW25vZGVJZF1bdGhpcy5faWRdID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFUd2Vlbi50d2VlbnNbbm9kZUlkXSkge1xuICAgICAgICAgICAgVHdlZW4udHdlZW5zW25vZGVJZF0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGtleSBpbiBjb25maWcpIHtcbiAgICAgICAgICAgIGlmIChibGFja2xpc3Rba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkQXR0cihrZXksIGNvbmZpZ1trZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMub25GaW5pc2ggPSBjb25maWcub25GaW5pc2g7XG4gICAgICAgIHRoaXMub25SZXNldCA9IGNvbmZpZy5vblJlc2V0O1xuICAgICAgICB0aGlzLm9uVXBkYXRlID0gY29uZmlnLm9uVXBkYXRlO1xuICAgIH1cbiAgICBfYWRkQXR0cihrZXksIGVuZCkge1xuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5ub2RlLCBub2RlSWQgPSBub2RlLl9pZDtcbiAgICAgICAgbGV0IGRpZmYsIGxlbiwgdHJ1ZUVuZCwgdHJ1ZVN0YXJ0LCBlbmRSR0JBO1xuICAgICAgICBjb25zdCB0d2VlbklkID0gVHdlZW4udHdlZW5zW25vZGVJZF1ba2V5XTtcbiAgICAgICAgaWYgKHR3ZWVuSWQpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBUd2Vlbi5hdHRyc1tub2RlSWRdW3R3ZWVuSWRdW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHN0YXJ0ID0gbm9kZS5nZXRBdHRyKGtleSk7XG4gICAgICAgIGlmIChVdGlsLl9pc0FycmF5KGVuZCkpIHtcbiAgICAgICAgICAgIGRpZmYgPSBbXTtcbiAgICAgICAgICAgIGxlbiA9IE1hdGgubWF4KGVuZC5sZW5ndGgsIHN0YXJ0Lmxlbmd0aCk7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAncG9pbnRzJyAmJiBlbmQubGVuZ3RoICE9PSBzdGFydC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZW5kLmxlbmd0aCA+IHN0YXJ0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0cnVlU3RhcnQgPSBzdGFydDtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBVdGlsLl9wcmVwYXJlQXJyYXlGb3JUd2VlbihzdGFydCwgZW5kLCBub2RlLmNsb3NlZCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRydWVFbmQgPSBlbmQ7XG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IFV0aWwuX3ByZXBhcmVBcnJheUZvclR3ZWVuKGVuZCwgc3RhcnQsIG5vZGUuY2xvc2VkKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChrZXkuaW5kZXhPZignZmlsbCcpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobiAlIDIgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYucHVzaChlbmRbbl0gLSBzdGFydFtuXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFJHQkEgPSBVdGlsLmNvbG9yVG9SR0JBKHN0YXJ0W25dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZFJHQkEgPSBVdGlsLmNvbG9yVG9SR0JBKGVuZFtuXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydFtuXSA9IHN0YXJ0UkdCQTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcjogZW5kUkdCQS5yIC0gc3RhcnRSR0JBLnIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZzogZW5kUkdCQS5nIC0gc3RhcnRSR0JBLmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYjogZW5kUkdCQS5iIC0gc3RhcnRSR0JBLmIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYTogZW5kUkdCQS5hIC0gc3RhcnRSR0JBLmEsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGlmZi5wdXNoKGVuZFtuXSAtIHN0YXJ0W25dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sb3JBdHRycy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgICAgICBzdGFydCA9IFV0aWwuY29sb3JUb1JHQkEoc3RhcnQpO1xuICAgICAgICAgICAgZW5kUkdCQSA9IFV0aWwuY29sb3JUb1JHQkEoZW5kKTtcbiAgICAgICAgICAgIGRpZmYgPSB7XG4gICAgICAgICAgICAgICAgcjogZW5kUkdCQS5yIC0gc3RhcnQucixcbiAgICAgICAgICAgICAgICBnOiBlbmRSR0JBLmcgLSBzdGFydC5nLFxuICAgICAgICAgICAgICAgIGI6IGVuZFJHQkEuYiAtIHN0YXJ0LmIsXG4gICAgICAgICAgICAgICAgYTogZW5kUkdCQS5hIC0gc3RhcnQuYSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkaWZmID0gZW5kIC0gc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgVHdlZW4uYXR0cnNbbm9kZUlkXVt0aGlzLl9pZF1ba2V5XSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICAgIGRpZmY6IGRpZmYsXG4gICAgICAgICAgICBlbmQ6IGVuZCxcbiAgICAgICAgICAgIHRydWVFbmQ6IHRydWVFbmQsXG4gICAgICAgICAgICB0cnVlU3RhcnQ6IHRydWVTdGFydCxcbiAgICAgICAgfTtcbiAgICAgICAgVHdlZW4udHdlZW5zW25vZGVJZF1ba2V5XSA9IHRoaXMuX2lkO1xuICAgIH1cbiAgICBfdHdlZW5GdW5jKGkpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZSwgYXR0cnMgPSBUd2Vlbi5hdHRyc1tub2RlLl9pZF1bdGhpcy5faWRdO1xuICAgICAgICBsZXQga2V5LCBhdHRyLCBzdGFydCwgZGlmZiwgbmV3VmFsLCBuLCBsZW4sIGVuZDtcbiAgICAgICAgZm9yIChrZXkgaW4gYXR0cnMpIHtcbiAgICAgICAgICAgIGF0dHIgPSBhdHRyc1trZXldO1xuICAgICAgICAgICAgc3RhcnQgPSBhdHRyLnN0YXJ0O1xuICAgICAgICAgICAgZGlmZiA9IGF0dHIuZGlmZjtcbiAgICAgICAgICAgIGVuZCA9IGF0dHIuZW5kO1xuICAgICAgICAgICAgaWYgKFV0aWwuX2lzQXJyYXkoc3RhcnQpKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsID0gW107XG4gICAgICAgICAgICAgICAgbGVuID0gTWF0aC5tYXgoc3RhcnQubGVuZ3RoLCBlbmQubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5LmluZGV4T2YoJ2ZpbGwnKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuICUgMiA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbC5wdXNoKChzdGFydFtuXSB8fCAwKSArIGRpZmZbbl0gKiBpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbC5wdXNoKCdyZ2JhKCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKHN0YXJ0W25dLnIgKyBkaWZmW25dLnIgKiBpKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcsJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoc3RhcnRbbl0uZyArIGRpZmZbbl0uZyAqIGkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJywnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChzdGFydFtuXS5iICsgZGlmZltuXS5iICogaSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RhcnRbbl0uYSArIGRpZmZbbl0uYSAqIGkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWwucHVzaCgoc3RhcnRbbl0gfHwgMCkgKyBkaWZmW25dICogaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb2xvckF0dHJzLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWwgPVxuICAgICAgICAgICAgICAgICAgICAncmdiYSgnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoc3RhcnQuciArIGRpZmYuciAqIGkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcsJyArXG4gICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKHN0YXJ0LmcgKyBkaWZmLmcgKiBpKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChzdGFydC5iICsgZGlmZi5iICogaSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJywnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIChzdGFydC5hICsgZGlmZi5hICogaSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJyknO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsID0gc3RhcnQgKyBkaWZmICogaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cihrZXksIG5ld1ZhbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FkZExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy50d2Vlbi5vblBsYXkgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFuaW0uc3RhcnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50d2Vlbi5vblJldmVyc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFuaW0uc3RhcnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50d2Vlbi5vblBhdXNlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hbmltLnN0b3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50d2Vlbi5vbkZpbmlzaCA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLm5vZGU7XG4gICAgICAgICAgICBjb25zdCBhdHRycyA9IFR3ZWVuLmF0dHJzW25vZGUuX2lkXVt0aGlzLl9pZF07XG4gICAgICAgICAgICBpZiAoYXR0cnMucG9pbnRzICYmIGF0dHJzLnBvaW50cy50cnVlRW5kKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKCdwb2ludHMnLCBhdHRycy5wb2ludHMudHJ1ZUVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vbkZpbmlzaCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25GaW5pc2guY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50d2Vlbi5vblJlc2V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJzID0gVHdlZW4uYXR0cnNbbm9kZS5faWRdW3RoaXMuX2lkXTtcbiAgICAgICAgICAgIGlmIChhdHRycy5wb2ludHMgJiYgYXR0cnMucG9pbnRzLnRydWVTdGFydCkge1xuICAgICAgICAgICAgICAgIG5vZGUucG9pbnRzKGF0dHJzLnBvaW50cy50cnVlU3RhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub25SZXNldCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25SZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnR3ZWVuLm9uVXBkYXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMub25VcGRhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uVXBkYXRlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHBsYXkoKSB7XG4gICAgICAgIHRoaXMudHdlZW4ucGxheSgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmV2ZXJzZSgpIHtcbiAgICAgICAgdGhpcy50d2Vlbi5yZXZlcnNlKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy50d2Vlbi5yZXNldCgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgc2Vlayh0KSB7XG4gICAgICAgIHRoaXMudHdlZW4uc2Vlayh0ICogMTAwMCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBwYXVzZSgpIHtcbiAgICAgICAgdGhpcy50d2Vlbi5wYXVzZSgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZmluaXNoKCkge1xuICAgICAgICB0aGlzLnR3ZWVuLmZpbmlzaCgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgY29uc3Qgbm9kZUlkID0gdGhpcy5ub2RlLl9pZCwgdGhpc0lkID0gdGhpcy5faWQsIGF0dHJzID0gVHdlZW4udHdlZW5zW25vZGVJZF07XG4gICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgaWYgKHRoaXMuYW5pbSkge1xuICAgICAgICAgICAgdGhpcy5hbmltLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRycykge1xuICAgICAgICAgICAgZGVsZXRlIFR3ZWVuLnR3ZWVuc1tub2RlSWRdW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIFR3ZWVuLmF0dHJzW25vZGVJZF1bdGhpc0lkXTtcbiAgICAgICAgaWYgKFR3ZWVuLnR3ZWVuc1tub2RlSWRdKSB7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoVHdlZW4udHdlZW5zW25vZGVJZF0pLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBUd2Vlbi50d2VlbnNbbm9kZUlkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhUd2Vlbi5hdHRyc1tub2RlSWRdKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgVHdlZW4uYXR0cnNbbm9kZUlkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblR3ZWVuLmF0dHJzID0ge307XG5Ud2Vlbi50d2VlbnMgPSB7fTtcbk5vZGUucHJvdG90eXBlLnRvID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgIGNvbnN0IG9uRmluaXNoID0gcGFyYW1zLm9uRmluaXNoO1xuICAgIHBhcmFtcy5ub2RlID0gdGhpcztcbiAgICBwYXJhbXMub25GaW5pc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICBpZiAob25GaW5pc2gpIHtcbiAgICAgICAgICAgIG9uRmluaXNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHR3ZWVuID0gbmV3IFR3ZWVuKHBhcmFtcyk7XG4gICAgdHdlZW4ucGxheSgpO1xufTtcbmV4cG9ydCBjb25zdCBFYXNpbmdzID0ge1xuICAgIEJhY2tFYXNlSW4odCwgYiwgYywgZCkge1xuICAgICAgICBjb25zdCBzID0gMS43MDE1ODtcbiAgICAgICAgcmV0dXJuIGMgKiAodCAvPSBkKSAqIHQgKiAoKHMgKyAxKSAqIHQgLSBzKSArIGI7XG4gICAgfSxcbiAgICBCYWNrRWFzZU91dCh0LCBiLCBjLCBkKSB7XG4gICAgICAgIGNvbnN0IHMgPSAxLjcwMTU4O1xuICAgICAgICByZXR1cm4gYyAqICgodCA9IHQgLyBkIC0gMSkgKiB0ICogKChzICsgMSkgKiB0ICsgcykgKyAxKSArIGI7XG4gICAgfSxcbiAgICBCYWNrRWFzZUluT3V0KHQsIGIsIGMsIGQpIHtcbiAgICAgICAgbGV0IHMgPSAxLjcwMTU4O1xuICAgICAgICBpZiAoKHQgLz0gZCAvIDIpIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIChjIC8gMikgKiAodCAqIHQgKiAoKChzICo9IDEuNTI1KSArIDEpICogdCAtIHMpKSArIGI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChjIC8gMikgKiAoKHQgLT0gMikgKiB0ICogKCgocyAqPSAxLjUyNSkgKyAxKSAqIHQgKyBzKSArIDIpICsgYjtcbiAgICB9LFxuICAgIEVsYXN0aWNFYXNlSW4odCwgYiwgYywgZCwgYSwgcCkge1xuICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgIGlmICh0ID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKHQgLz0gZCkgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBiICsgYztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXApIHtcbiAgICAgICAgICAgIHAgPSBkICogMC4zO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYSB8fCBhIDwgTWF0aC5hYnMoYykpIHtcbiAgICAgICAgICAgIGEgPSBjO1xuICAgICAgICAgICAgcyA9IHAgLyA0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcyA9IChwIC8gKDIgKiBNYXRoLlBJKSkgKiBNYXRoLmFzaW4oYyAvIGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoLShhICpcbiAgICAgICAgICAgIE1hdGgucG93KDIsIDEwICogKHQgLT0gMSkpICpcbiAgICAgICAgICAgIE1hdGguc2luKCgodCAqIGQgLSBzKSAqICgyICogTWF0aC5QSSkpIC8gcCkpICsgYik7XG4gICAgfSxcbiAgICBFbGFzdGljRWFzZU91dCh0LCBiLCBjLCBkLCBhLCBwKSB7XG4gICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgaWYgKHQgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICB9XG4gICAgICAgIGlmICgodCAvPSBkKSA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGIgKyBjO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcCkge1xuICAgICAgICAgICAgcCA9IGQgKiAwLjM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFhIHx8IGEgPCBNYXRoLmFicyhjKSkge1xuICAgICAgICAgICAgYSA9IGM7XG4gICAgICAgICAgICBzID0gcCAvIDQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzID0gKHAgLyAoMiAqIE1hdGguUEkpKSAqIE1hdGguYXNpbihjIC8gYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChhICogTWF0aC5wb3coMiwgLTEwICogdCkgKiBNYXRoLnNpbigoKHQgKiBkIC0gcykgKiAoMiAqIE1hdGguUEkpKSAvIHApICtcbiAgICAgICAgICAgIGMgK1xuICAgICAgICAgICAgYik7XG4gICAgfSxcbiAgICBFbGFzdGljRWFzZUluT3V0KHQsIGIsIGMsIGQsIGEsIHApIHtcbiAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICBpZiAodCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh0IC89IGQgLyAyKSA9PT0gMikge1xuICAgICAgICAgICAgcmV0dXJuIGIgKyBjO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcCkge1xuICAgICAgICAgICAgcCA9IGQgKiAoMC4zICogMS41KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7XG4gICAgICAgICAgICBhID0gYztcbiAgICAgICAgICAgIHMgPSBwIC8gNDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHMgPSAocCAvICgyICogTWF0aC5QSSkpICogTWF0aC5hc2luKGMgLyBhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodCA8IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAoLTAuNSAqXG4gICAgICAgICAgICAgICAgKGEgKlxuICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdygyLCAxMCAqICh0IC09IDEpKSAqXG4gICAgICAgICAgICAgICAgICAgIE1hdGguc2luKCgodCAqIGQgLSBzKSAqICgyICogTWF0aC5QSSkpIC8gcCkpICtcbiAgICAgICAgICAgICAgICBiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGEgKlxuICAgICAgICAgICAgTWF0aC5wb3coMiwgLTEwICogKHQgLT0gMSkpICpcbiAgICAgICAgICAgIE1hdGguc2luKCgodCAqIGQgLSBzKSAqICgyICogTWF0aC5QSSkpIC8gcCkgKlxuICAgICAgICAgICAgMC41ICtcbiAgICAgICAgICAgIGMgK1xuICAgICAgICAgICAgYik7XG4gICAgfSxcbiAgICBCb3VuY2VFYXNlT3V0KHQsIGIsIGMsIGQpIHtcbiAgICAgICAgaWYgKCh0IC89IGQpIDwgMSAvIDIuNzUpIHtcbiAgICAgICAgICAgIHJldHVybiBjICogKDcuNTYyNSAqIHQgKiB0KSArIGI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodCA8IDIgLyAyLjc1KSB7XG4gICAgICAgICAgICByZXR1cm4gYyAqICg3LjU2MjUgKiAodCAtPSAxLjUgLyAyLjc1KSAqIHQgKyAwLjc1KSArIGI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodCA8IDIuNSAvIDIuNzUpIHtcbiAgICAgICAgICAgIHJldHVybiBjICogKDcuNTYyNSAqICh0IC09IDIuMjUgLyAyLjc1KSAqIHQgKyAwLjkzNzUpICsgYjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBjICogKDcuNTYyNSAqICh0IC09IDIuNjI1IC8gMi43NSkgKiB0ICsgMC45ODQzNzUpICsgYjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgQm91bmNlRWFzZUluKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgcmV0dXJuIGMgLSBFYXNpbmdzLkJvdW5jZUVhc2VPdXQoZCAtIHQsIDAsIGMsIGQpICsgYjtcbiAgICB9LFxuICAgIEJvdW5jZUVhc2VJbk91dCh0LCBiLCBjLCBkKSB7XG4gICAgICAgIGlmICh0IDwgZCAvIDIpIHtcbiAgICAgICAgICAgIHJldHVybiBFYXNpbmdzLkJvdW5jZUVhc2VJbih0ICogMiwgMCwgYywgZCkgKiAwLjUgKyBiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIEVhc2luZ3MuQm91bmNlRWFzZU91dCh0ICogMiAtIGQsIDAsIGMsIGQpICogMC41ICsgYyAqIDAuNSArIGI7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIEVhc2VJbih0LCBiLCBjLCBkKSB7XG4gICAgICAgIHJldHVybiBjICogKHQgLz0gZCkgKiB0ICsgYjtcbiAgICB9LFxuICAgIEVhc2VPdXQodCwgYiwgYywgZCkge1xuICAgICAgICByZXR1cm4gLWMgKiAodCAvPSBkKSAqICh0IC0gMikgKyBiO1xuICAgIH0sXG4gICAgRWFzZUluT3V0KHQsIGIsIGMsIGQpIHtcbiAgICAgICAgaWYgKCh0IC89IGQgLyAyKSA8IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAoYyAvIDIpICogdCAqIHQgKyBiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoLWMgLyAyKSAqICgtLXQgKiAodCAtIDIpIC0gMSkgKyBiO1xuICAgIH0sXG4gICAgU3Ryb25nRWFzZUluKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgcmV0dXJuIGMgKiAodCAvPSBkKSAqIHQgKiB0ICogdCAqIHQgKyBiO1xuICAgIH0sXG4gICAgU3Ryb25nRWFzZU91dCh0LCBiLCBjLCBkKSB7XG4gICAgICAgIHJldHVybiBjICogKCh0ID0gdCAvIGQgLSAxKSAqIHQgKiB0ICogdCAqIHQgKyAxKSArIGI7XG4gICAgfSxcbiAgICBTdHJvbmdFYXNlSW5PdXQodCwgYiwgYywgZCkge1xuICAgICAgICBpZiAoKHQgLz0gZCAvIDIpIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIChjIC8gMikgKiB0ICogdCAqIHQgKiB0ICogdCArIGI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChjIC8gMikgKiAoKHQgLT0gMikgKiB0ICogdCAqIHQgKiB0ICsgMikgKyBiO1xuICAgIH0sXG4gICAgTGluZWFyKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgcmV0dXJuIChjICogdCkgLyBkICsgYjtcbiAgICB9LFxufTtcbiIsImltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4vR2xvYmFsLmpzXCI7XG5jb25zdCBOT0RFX0VSUk9SID0gYEtvbnZhLmpzIHVuc3VwcG9ydGVkIGVudmlyb25tZW50LlxuXG5Mb29rcyBsaWtlIHlvdSBhcmUgdHJ5aW5nIHRvIHVzZSBLb252YS5qcyBpbiBOb2RlLmpzIGVudmlyb25tZW50LiBiZWNhdXNlIFwiZG9jdW1lbnRcIiBvYmplY3QgaXMgdW5kZWZpbmVkLlxuXG5UbyB1c2UgS29udmEuanMgaW4gTm9kZS5qcyBlbnZpcm9ubWVudCwgeW91IG5lZWQgdG8gdXNlIHRoZSBcImNhbnZhcy1iYWNrZW5kXCIgb3IgXCJza2lhLWJhY2tlbmRcIiBtb2R1bGUuXG5cbmJhc2g6IG5wbSBpbnN0YWxsIGNhbnZhc1xuanM6IGltcG9ydCBcImtvbnZhL2NhbnZhcy1iYWNrZW5kXCI7XG5cbm9yXG5cbmJhc2g6IG5wbSBpbnN0YWxsIHNraWEtY2FudmFzXG5qczogaW1wb3J0IFwia29udmEvc2tpYS1iYWNrZW5kXCI7XG5gO1xuY29uc3QgZW5zdXJlQnJvd3NlciA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9ERV9FUlJPUik7XG4gICAgfVxufTtcbmV4cG9ydCBjbGFzcyBUcmFuc2Zvcm0ge1xuICAgIGNvbnN0cnVjdG9yKG0gPSBbMSwgMCwgMCwgMSwgMCwgMF0pIHtcbiAgICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm0gPSAobSAmJiBtLnNsaWNlKCkpIHx8IFsxLCAwLCAwLCAxLCAwLCAwXTtcbiAgICB9XG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMubVswXSA9IDE7XG4gICAgICAgIHRoaXMubVsxXSA9IDA7XG4gICAgICAgIHRoaXMubVsyXSA9IDA7XG4gICAgICAgIHRoaXMubVszXSA9IDE7XG4gICAgICAgIHRoaXMubVs0XSA9IDA7XG4gICAgICAgIHRoaXMubVs1XSA9IDA7XG4gICAgfVxuICAgIGNvcHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNmb3JtKHRoaXMubSk7XG4gICAgfVxuICAgIGNvcHlJbnRvKHRyKSB7XG4gICAgICAgIHRyLm1bMF0gPSB0aGlzLm1bMF07XG4gICAgICAgIHRyLm1bMV0gPSB0aGlzLm1bMV07XG4gICAgICAgIHRyLm1bMl0gPSB0aGlzLm1bMl07XG4gICAgICAgIHRyLm1bM10gPSB0aGlzLm1bM107XG4gICAgICAgIHRyLm1bNF0gPSB0aGlzLm1bNF07XG4gICAgICAgIHRyLm1bNV0gPSB0aGlzLm1bNV07XG4gICAgfVxuICAgIHBvaW50KHBvaW50KSB7XG4gICAgICAgIGNvbnN0IG0gPSB0aGlzLm07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBtWzBdICogcG9pbnQueCArIG1bMl0gKiBwb2ludC55ICsgbVs0XSxcbiAgICAgICAgICAgIHk6IG1bMV0gKiBwb2ludC54ICsgbVszXSAqIHBvaW50LnkgKyBtWzVdLFxuICAgICAgICB9O1xuICAgIH1cbiAgICB0cmFuc2xhdGUoeCwgeSkge1xuICAgICAgICB0aGlzLm1bNF0gKz0gdGhpcy5tWzBdICogeCArIHRoaXMubVsyXSAqIHk7XG4gICAgICAgIHRoaXMubVs1XSArPSB0aGlzLm1bMV0gKiB4ICsgdGhpcy5tWzNdICogeTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNjYWxlKHN4LCBzeSkge1xuICAgICAgICB0aGlzLm1bMF0gKj0gc3g7XG4gICAgICAgIHRoaXMubVsxXSAqPSBzeDtcbiAgICAgICAgdGhpcy5tWzJdICo9IHN5O1xuICAgICAgICB0aGlzLm1bM10gKj0gc3k7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByb3RhdGUocmFkKSB7XG4gICAgICAgIGNvbnN0IGMgPSBNYXRoLmNvcyhyYWQpO1xuICAgICAgICBjb25zdCBzID0gTWF0aC5zaW4ocmFkKTtcbiAgICAgICAgY29uc3QgbTExID0gdGhpcy5tWzBdICogYyArIHRoaXMubVsyXSAqIHM7XG4gICAgICAgIGNvbnN0IG0xMiA9IHRoaXMubVsxXSAqIGMgKyB0aGlzLm1bM10gKiBzO1xuICAgICAgICBjb25zdCBtMjEgPSB0aGlzLm1bMF0gKiAtcyArIHRoaXMubVsyXSAqIGM7XG4gICAgICAgIGNvbnN0IG0yMiA9IHRoaXMubVsxXSAqIC1zICsgdGhpcy5tWzNdICogYztcbiAgICAgICAgdGhpcy5tWzBdID0gbTExO1xuICAgICAgICB0aGlzLm1bMV0gPSBtMTI7XG4gICAgICAgIHRoaXMubVsyXSA9IG0yMTtcbiAgICAgICAgdGhpcy5tWzNdID0gbTIyO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0VHJhbnNsYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB0aGlzLm1bNF0sXG4gICAgICAgICAgICB5OiB0aGlzLm1bNV0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIHNrZXcoc3gsIHN5KSB7XG4gICAgICAgIGNvbnN0IG0xMSA9IHRoaXMubVswXSArIHRoaXMubVsyXSAqIHN5O1xuICAgICAgICBjb25zdCBtMTIgPSB0aGlzLm1bMV0gKyB0aGlzLm1bM10gKiBzeTtcbiAgICAgICAgY29uc3QgbTIxID0gdGhpcy5tWzJdICsgdGhpcy5tWzBdICogc3g7XG4gICAgICAgIGNvbnN0IG0yMiA9IHRoaXMubVszXSArIHRoaXMubVsxXSAqIHN4O1xuICAgICAgICB0aGlzLm1bMF0gPSBtMTE7XG4gICAgICAgIHRoaXMubVsxXSA9IG0xMjtcbiAgICAgICAgdGhpcy5tWzJdID0gbTIxO1xuICAgICAgICB0aGlzLm1bM10gPSBtMjI7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBtdWx0aXBseShtYXRyaXgpIHtcbiAgICAgICAgY29uc3QgbTExID0gdGhpcy5tWzBdICogbWF0cml4Lm1bMF0gKyB0aGlzLm1bMl0gKiBtYXRyaXgubVsxXTtcbiAgICAgICAgY29uc3QgbTEyID0gdGhpcy5tWzFdICogbWF0cml4Lm1bMF0gKyB0aGlzLm1bM10gKiBtYXRyaXgubVsxXTtcbiAgICAgICAgY29uc3QgbTIxID0gdGhpcy5tWzBdICogbWF0cml4Lm1bMl0gKyB0aGlzLm1bMl0gKiBtYXRyaXgubVszXTtcbiAgICAgICAgY29uc3QgbTIyID0gdGhpcy5tWzFdICogbWF0cml4Lm1bMl0gKyB0aGlzLm1bM10gKiBtYXRyaXgubVszXTtcbiAgICAgICAgY29uc3QgZHggPSB0aGlzLm1bMF0gKiBtYXRyaXgubVs0XSArIHRoaXMubVsyXSAqIG1hdHJpeC5tWzVdICsgdGhpcy5tWzRdO1xuICAgICAgICBjb25zdCBkeSA9IHRoaXMubVsxXSAqIG1hdHJpeC5tWzRdICsgdGhpcy5tWzNdICogbWF0cml4Lm1bNV0gKyB0aGlzLm1bNV07XG4gICAgICAgIHRoaXMubVswXSA9IG0xMTtcbiAgICAgICAgdGhpcy5tWzFdID0gbTEyO1xuICAgICAgICB0aGlzLm1bMl0gPSBtMjE7XG4gICAgICAgIHRoaXMubVszXSA9IG0yMjtcbiAgICAgICAgdGhpcy5tWzRdID0gZHg7XG4gICAgICAgIHRoaXMubVs1XSA9IGR5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaW52ZXJ0KCkge1xuICAgICAgICBjb25zdCBkID0gMSAvICh0aGlzLm1bMF0gKiB0aGlzLm1bM10gLSB0aGlzLm1bMV0gKiB0aGlzLm1bMl0pO1xuICAgICAgICBjb25zdCBtMCA9IHRoaXMubVszXSAqIGQ7XG4gICAgICAgIGNvbnN0IG0xID0gLXRoaXMubVsxXSAqIGQ7XG4gICAgICAgIGNvbnN0IG0yID0gLXRoaXMubVsyXSAqIGQ7XG4gICAgICAgIGNvbnN0IG0zID0gdGhpcy5tWzBdICogZDtcbiAgICAgICAgY29uc3QgbTQgPSBkICogKHRoaXMubVsyXSAqIHRoaXMubVs1XSAtIHRoaXMubVszXSAqIHRoaXMubVs0XSk7XG4gICAgICAgIGNvbnN0IG01ID0gZCAqICh0aGlzLm1bMV0gKiB0aGlzLm1bNF0gLSB0aGlzLm1bMF0gKiB0aGlzLm1bNV0pO1xuICAgICAgICB0aGlzLm1bMF0gPSBtMDtcbiAgICAgICAgdGhpcy5tWzFdID0gbTE7XG4gICAgICAgIHRoaXMubVsyXSA9IG0yO1xuICAgICAgICB0aGlzLm1bM10gPSBtMztcbiAgICAgICAgdGhpcy5tWzRdID0gbTQ7XG4gICAgICAgIHRoaXMubVs1XSA9IG01O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0TWF0cml4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tO1xuICAgIH1cbiAgICBkZWNvbXBvc2UoKSB7XG4gICAgICAgIGNvbnN0IGEgPSB0aGlzLm1bMF07XG4gICAgICAgIGNvbnN0IGIgPSB0aGlzLm1bMV07XG4gICAgICAgIGNvbnN0IGMgPSB0aGlzLm1bMl07XG4gICAgICAgIGNvbnN0IGQgPSB0aGlzLm1bM107XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLm1bNF07XG4gICAgICAgIGNvbnN0IGYgPSB0aGlzLm1bNV07XG4gICAgICAgIGNvbnN0IGRlbHRhID0gYSAqIGQgLSBiICogYztcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgeDogZSxcbiAgICAgICAgICAgIHk6IGYsXG4gICAgICAgICAgICByb3RhdGlvbjogMCxcbiAgICAgICAgICAgIHNjYWxlWDogMCxcbiAgICAgICAgICAgIHNjYWxlWTogMCxcbiAgICAgICAgICAgIHNrZXdYOiAwLFxuICAgICAgICAgICAgc2tld1k6IDAsXG4gICAgICAgIH07XG4gICAgICAgIGlmIChhICE9IDAgfHwgYiAhPSAwKSB7XG4gICAgICAgICAgICBjb25zdCByID0gTWF0aC5zcXJ0KGEgKiBhICsgYiAqIGIpO1xuICAgICAgICAgICAgcmVzdWx0LnJvdGF0aW9uID0gYiA+IDAgPyBNYXRoLmFjb3MoYSAvIHIpIDogLU1hdGguYWNvcyhhIC8gcik7XG4gICAgICAgICAgICByZXN1bHQuc2NhbGVYID0gcjtcbiAgICAgICAgICAgIHJlc3VsdC5zY2FsZVkgPSBkZWx0YSAvIHI7XG4gICAgICAgICAgICByZXN1bHQuc2tld1ggPSAoYSAqIGMgKyBiICogZCkgLyBkZWx0YTtcbiAgICAgICAgICAgIHJlc3VsdC5za2V3WSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyAhPSAwIHx8IGQgIT0gMCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IE1hdGguc3FydChjICogYyArIGQgKiBkKTtcbiAgICAgICAgICAgIHJlc3VsdC5yb3RhdGlvbiA9XG4gICAgICAgICAgICAgICAgTWF0aC5QSSAvIDIgLSAoZCA+IDAgPyBNYXRoLmFjb3MoLWMgLyBzKSA6IC1NYXRoLmFjb3MoYyAvIHMpKTtcbiAgICAgICAgICAgIHJlc3VsdC5zY2FsZVggPSBkZWx0YSAvIHM7XG4gICAgICAgICAgICByZXN1bHQuc2NhbGVZID0gcztcbiAgICAgICAgICAgIHJlc3VsdC5za2V3WCA9IDA7XG4gICAgICAgICAgICByZXN1bHQuc2tld1kgPSAoYSAqIGMgKyBiICogZCkgLyBkZWx0YTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQucm90YXRpb24gPSBVdGlsLl9nZXRSb3RhdGlvbihyZXN1bHQucm90YXRpb24pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbmNvbnN0IE9CSkVDVF9BUlJBWSA9ICdbb2JqZWN0IEFycmF5XScsIE9CSkVDVF9OVU1CRVIgPSAnW29iamVjdCBOdW1iZXJdJywgT0JKRUNUX1NUUklORyA9ICdbb2JqZWN0IFN0cmluZ10nLCBPQkpFQ1RfQk9PTEVBTiA9ICdbb2JqZWN0IEJvb2xlYW5dJywgUElfT1ZFUl9ERUcxODAgPSBNYXRoLlBJIC8gMTgwLCBERUcxODBfT1ZFUl9QSSA9IDE4MCAvIE1hdGguUEksIEhBU0ggPSAnIycsIEVNUFRZX1NUUklORyA9ICcnLCBaRVJPID0gJzAnLCBLT05WQV9XQVJOSU5HID0gJ0tvbnZhIHdhcm5pbmc6ICcsIEtPTlZBX0VSUk9SID0gJ0tvbnZhIGVycm9yOiAnLCBSR0JfUEFSRU4gPSAncmdiKCcsIENPTE9SUyA9IHtcbiAgICBhbGljZWJsdWU6IFsyNDAsIDI0OCwgMjU1XSxcbiAgICBhbnRpcXVld2hpdGU6IFsyNTAsIDIzNSwgMjE1XSxcbiAgICBhcXVhOiBbMCwgMjU1LCAyNTVdLFxuICAgIGFxdWFtYXJpbmU6IFsxMjcsIDI1NSwgMjEyXSxcbiAgICBhenVyZTogWzI0MCwgMjU1LCAyNTVdLFxuICAgIGJlaWdlOiBbMjQ1LCAyNDUsIDIyMF0sXG4gICAgYmlzcXVlOiBbMjU1LCAyMjgsIDE5Nl0sXG4gICAgYmxhY2s6IFswLCAwLCAwXSxcbiAgICBibGFuY2hlZGFsbW9uZDogWzI1NSwgMjM1LCAyMDVdLFxuICAgIGJsdWU6IFswLCAwLCAyNTVdLFxuICAgIGJsdWV2aW9sZXQ6IFsxMzgsIDQzLCAyMjZdLFxuICAgIGJyb3duOiBbMTY1LCA0MiwgNDJdLFxuICAgIGJ1cmx5d29vZDogWzIyMiwgMTg0LCAxMzVdLFxuICAgIGNhZGV0Ymx1ZTogWzk1LCAxNTgsIDE2MF0sXG4gICAgY2hhcnRyZXVzZTogWzEyNywgMjU1LCAwXSxcbiAgICBjaG9jb2xhdGU6IFsyMTAsIDEwNSwgMzBdLFxuICAgIGNvcmFsOiBbMjU1LCAxMjcsIDgwXSxcbiAgICBjb3JuZmxvd2VyYmx1ZTogWzEwMCwgMTQ5LCAyMzddLFxuICAgIGNvcm5zaWxrOiBbMjU1LCAyNDgsIDIyMF0sXG4gICAgY3JpbXNvbjogWzIyMCwgMjAsIDYwXSxcbiAgICBjeWFuOiBbMCwgMjU1LCAyNTVdLFxuICAgIGRhcmtibHVlOiBbMCwgMCwgMTM5XSxcbiAgICBkYXJrY3lhbjogWzAsIDEzOSwgMTM5XSxcbiAgICBkYXJrZ29sZGVucm9kOiBbMTg0LCAxMzIsIDExXSxcbiAgICBkYXJrZ3JheTogWzE2OSwgMTY5LCAxNjldLFxuICAgIGRhcmtncmVlbjogWzAsIDEwMCwgMF0sXG4gICAgZGFya2dyZXk6IFsxNjksIDE2OSwgMTY5XSxcbiAgICBkYXJra2hha2k6IFsxODksIDE4MywgMTA3XSxcbiAgICBkYXJrbWFnZW50YTogWzEzOSwgMCwgMTM5XSxcbiAgICBkYXJrb2xpdmVncmVlbjogWzg1LCAxMDcsIDQ3XSxcbiAgICBkYXJrb3JhbmdlOiBbMjU1LCAxNDAsIDBdLFxuICAgIGRhcmtvcmNoaWQ6IFsxNTMsIDUwLCAyMDRdLFxuICAgIGRhcmtyZWQ6IFsxMzksIDAsIDBdLFxuICAgIGRhcmtzYWxtb246IFsyMzMsIDE1MCwgMTIyXSxcbiAgICBkYXJrc2VhZ3JlZW46IFsxNDMsIDE4OCwgMTQzXSxcbiAgICBkYXJrc2xhdGVibHVlOiBbNzIsIDYxLCAxMzldLFxuICAgIGRhcmtzbGF0ZWdyYXk6IFs0NywgNzksIDc5XSxcbiAgICBkYXJrc2xhdGVncmV5OiBbNDcsIDc5LCA3OV0sXG4gICAgZGFya3R1cnF1b2lzZTogWzAsIDIwNiwgMjA5XSxcbiAgICBkYXJrdmlvbGV0OiBbMTQ4LCAwLCAyMTFdLFxuICAgIGRlZXBwaW5rOiBbMjU1LCAyMCwgMTQ3XSxcbiAgICBkZWVwc2t5Ymx1ZTogWzAsIDE5MSwgMjU1XSxcbiAgICBkaW1ncmF5OiBbMTA1LCAxMDUsIDEwNV0sXG4gICAgZGltZ3JleTogWzEwNSwgMTA1LCAxMDVdLFxuICAgIGRvZGdlcmJsdWU6IFszMCwgMTQ0LCAyNTVdLFxuICAgIGZpcmVicmljazogWzE3OCwgMzQsIDM0XSxcbiAgICBmbG9yYWx3aGl0ZTogWzI1NSwgMjU1LCAyNDBdLFxuICAgIGZvcmVzdGdyZWVuOiBbMzQsIDEzOSwgMzRdLFxuICAgIGZ1Y2hzaWE6IFsyNTUsIDAsIDI1NV0sXG4gICAgZ2FpbnNib3JvOiBbMjIwLCAyMjAsIDIyMF0sXG4gICAgZ2hvc3R3aGl0ZTogWzI0OCwgMjQ4LCAyNTVdLFxuICAgIGdvbGQ6IFsyNTUsIDIxNSwgMF0sXG4gICAgZ29sZGVucm9kOiBbMjE4LCAxNjUsIDMyXSxcbiAgICBncmF5OiBbMTI4LCAxMjgsIDEyOF0sXG4gICAgZ3JlZW46IFswLCAxMjgsIDBdLFxuICAgIGdyZWVueWVsbG93OiBbMTczLCAyNTUsIDQ3XSxcbiAgICBncmV5OiBbMTI4LCAxMjgsIDEyOF0sXG4gICAgaG9uZXlkZXc6IFsyNDAsIDI1NSwgMjQwXSxcbiAgICBob3RwaW5rOiBbMjU1LCAxMDUsIDE4MF0sXG4gICAgaW5kaWFucmVkOiBbMjA1LCA5MiwgOTJdLFxuICAgIGluZGlnbzogWzc1LCAwLCAxMzBdLFxuICAgIGl2b3J5OiBbMjU1LCAyNTUsIDI0MF0sXG4gICAga2hha2k6IFsyNDAsIDIzMCwgMTQwXSxcbiAgICBsYXZlbmRlcjogWzIzMCwgMjMwLCAyNTBdLFxuICAgIGxhdmVuZGVyYmx1c2g6IFsyNTUsIDI0MCwgMjQ1XSxcbiAgICBsYXduZ3JlZW46IFsxMjQsIDI1MiwgMF0sXG4gICAgbGVtb25jaGlmZm9uOiBbMjU1LCAyNTAsIDIwNV0sXG4gICAgbGlnaHRibHVlOiBbMTczLCAyMTYsIDIzMF0sXG4gICAgbGlnaHRjb3JhbDogWzI0MCwgMTI4LCAxMjhdLFxuICAgIGxpZ2h0Y3lhbjogWzIyNCwgMjU1LCAyNTVdLFxuICAgIGxpZ2h0Z29sZGVucm9keWVsbG93OiBbMjUwLCAyNTAsIDIxMF0sXG4gICAgbGlnaHRncmF5OiBbMjExLCAyMTEsIDIxMV0sXG4gICAgbGlnaHRncmVlbjogWzE0NCwgMjM4LCAxNDRdLFxuICAgIGxpZ2h0Z3JleTogWzIxMSwgMjExLCAyMTFdLFxuICAgIGxpZ2h0cGluazogWzI1NSwgMTgyLCAxOTNdLFxuICAgIGxpZ2h0c2FsbW9uOiBbMjU1LCAxNjAsIDEyMl0sXG4gICAgbGlnaHRzZWFncmVlbjogWzMyLCAxNzgsIDE3MF0sXG4gICAgbGlnaHRza3libHVlOiBbMTM1LCAyMDYsIDI1MF0sXG4gICAgbGlnaHRzbGF0ZWdyYXk6IFsxMTksIDEzNiwgMTUzXSxcbiAgICBsaWdodHNsYXRlZ3JleTogWzExOSwgMTM2LCAxNTNdLFxuICAgIGxpZ2h0c3RlZWxibHVlOiBbMTc2LCAxOTYsIDIyMl0sXG4gICAgbGlnaHR5ZWxsb3c6IFsyNTUsIDI1NSwgMjI0XSxcbiAgICBsaW1lOiBbMCwgMjU1LCAwXSxcbiAgICBsaW1lZ3JlZW46IFs1MCwgMjA1LCA1MF0sXG4gICAgbGluZW46IFsyNTAsIDI0MCwgMjMwXSxcbiAgICBtYWdlbnRhOiBbMjU1LCAwLCAyNTVdLFxuICAgIG1hcm9vbjogWzEyOCwgMCwgMF0sXG4gICAgbWVkaXVtYXF1YW1hcmluZTogWzEwMiwgMjA1LCAxNzBdLFxuICAgIG1lZGl1bWJsdWU6IFswLCAwLCAyMDVdLFxuICAgIG1lZGl1bW9yY2hpZDogWzE4NiwgODUsIDIxMV0sXG4gICAgbWVkaXVtcHVycGxlOiBbMTQ3LCAxMTIsIDIxOV0sXG4gICAgbWVkaXVtc2VhZ3JlZW46IFs2MCwgMTc5LCAxMTNdLFxuICAgIG1lZGl1bXNsYXRlYmx1ZTogWzEyMywgMTA0LCAyMzhdLFxuICAgIG1lZGl1bXNwcmluZ2dyZWVuOiBbMCwgMjUwLCAxNTRdLFxuICAgIG1lZGl1bXR1cnF1b2lzZTogWzcyLCAyMDksIDIwNF0sXG4gICAgbWVkaXVtdmlvbGV0cmVkOiBbMTk5LCAyMSwgMTMzXSxcbiAgICBtaWRuaWdodGJsdWU6IFsyNSwgMjUsIDExMl0sXG4gICAgbWludGNyZWFtOiBbMjQ1LCAyNTUsIDI1MF0sXG4gICAgbWlzdHlyb3NlOiBbMjU1LCAyMjgsIDIyNV0sXG4gICAgbW9jY2FzaW46IFsyNTUsIDIyOCwgMTgxXSxcbiAgICBuYXZham93aGl0ZTogWzI1NSwgMjIyLCAxNzNdLFxuICAgIG5hdnk6IFswLCAwLCAxMjhdLFxuICAgIG9sZGxhY2U6IFsyNTMsIDI0NSwgMjMwXSxcbiAgICBvbGl2ZTogWzEyOCwgMTI4LCAwXSxcbiAgICBvbGl2ZWRyYWI6IFsxMDcsIDE0MiwgMzVdLFxuICAgIG9yYW5nZTogWzI1NSwgMTY1LCAwXSxcbiAgICBvcmFuZ2VyZWQ6IFsyNTUsIDY5LCAwXSxcbiAgICBvcmNoaWQ6IFsyMTgsIDExMiwgMjE0XSxcbiAgICBwYWxlZ29sZGVucm9kOiBbMjM4LCAyMzIsIDE3MF0sXG4gICAgcGFsZWdyZWVuOiBbMTUyLCAyNTEsIDE1Ml0sXG4gICAgcGFsZXR1cnF1b2lzZTogWzE3NSwgMjM4LCAyMzhdLFxuICAgIHBhbGV2aW9sZXRyZWQ6IFsyMTksIDExMiwgMTQ3XSxcbiAgICBwYXBheWF3aGlwOiBbMjU1LCAyMzksIDIxM10sXG4gICAgcGVhY2hwdWZmOiBbMjU1LCAyMTgsIDE4NV0sXG4gICAgcGVydTogWzIwNSwgMTMzLCA2M10sXG4gICAgcGluazogWzI1NSwgMTkyLCAyMDNdLFxuICAgIHBsdW06IFsyMjEsIDE2MCwgMjAzXSxcbiAgICBwb3dkZXJibHVlOiBbMTc2LCAyMjQsIDIzMF0sXG4gICAgcHVycGxlOiBbMTI4LCAwLCAxMjhdLFxuICAgIHJlYmVjY2FwdXJwbGU6IFsxMDIsIDUxLCAxNTNdLFxuICAgIHJlZDogWzI1NSwgMCwgMF0sXG4gICAgcm9zeWJyb3duOiBbMTg4LCAxNDMsIDE0M10sXG4gICAgcm95YWxibHVlOiBbNjUsIDEwNSwgMjI1XSxcbiAgICBzYWRkbGVicm93bjogWzEzOSwgNjksIDE5XSxcbiAgICBzYWxtb246IFsyNTAsIDEyOCwgMTE0XSxcbiAgICBzYW5keWJyb3duOiBbMjQ0LCAxNjQsIDk2XSxcbiAgICBzZWFncmVlbjogWzQ2LCAxMzksIDg3XSxcbiAgICBzZWFzaGVsbDogWzI1NSwgMjQ1LCAyMzhdLFxuICAgIHNpZW5uYTogWzE2MCwgODIsIDQ1XSxcbiAgICBzaWx2ZXI6IFsxOTIsIDE5MiwgMTkyXSxcbiAgICBza3libHVlOiBbMTM1LCAyMDYsIDIzNV0sXG4gICAgc2xhdGVibHVlOiBbMTA2LCA5MCwgMjA1XSxcbiAgICBzbGF0ZWdyYXk6IFsxMTksIDEyOCwgMTQ0XSxcbiAgICBzbGF0ZWdyZXk6IFsxMTksIDEyOCwgMTQ0XSxcbiAgICBzbm93OiBbMjU1LCAyNTUsIDI1MF0sXG4gICAgc3ByaW5nZ3JlZW46IFswLCAyNTUsIDEyN10sXG4gICAgc3RlZWxibHVlOiBbNzAsIDEzMCwgMTgwXSxcbiAgICB0YW46IFsyMTAsIDE4MCwgMTQwXSxcbiAgICB0ZWFsOiBbMCwgMTI4LCAxMjhdLFxuICAgIHRoaXN0bGU6IFsyMTYsIDE5MSwgMjE2XSxcbiAgICB0cmFuc3BhcmVudDogWzI1NSwgMjU1LCAyNTUsIDBdLFxuICAgIHRvbWF0bzogWzI1NSwgOTksIDcxXSxcbiAgICB0dXJxdW9pc2U6IFs2NCwgMjI0LCAyMDhdLFxuICAgIHZpb2xldDogWzIzOCwgMTMwLCAyMzhdLFxuICAgIHdoZWF0OiBbMjQ1LCAyMjIsIDE3OV0sXG4gICAgd2hpdGU6IFsyNTUsIDI1NSwgMjU1XSxcbiAgICB3aGl0ZXNtb2tlOiBbMjQ1LCAyNDUsIDI0NV0sXG4gICAgeWVsbG93OiBbMjU1LCAyNTUsIDBdLFxuICAgIHllbGxvd2dyZWVuOiBbMTU0LCAyMDUsIDVdLFxufSwgUkdCX1JFR0VYID0gL3JnYlxcKChcXGR7MSwzfSksKFxcZHsxLDN9KSwoXFxkezEsM30pXFwpLztcbmxldCBhbmltUXVldWUgPSBbXTtcbmNvbnN0IHJlcSA9ICh0eXBlb2YgcmVxdWVzdEFuaW1hdGlvbkZyYW1lICE9PSAndW5kZWZpbmVkJyAmJiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHx8XG4gICAgZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgc2V0VGltZW91dChmLCA2MCk7XG4gICAgfTtcbmV4cG9ydCBjb25zdCBVdGlsID0ge1xuICAgIF9pc0VsZW1lbnQob2JqKSB7XG4gICAgICAgIHJldHVybiAhIShvYmogJiYgb2JqLm5vZGVUeXBlID09IDEpO1xuICAgIH0sXG4gICAgX2lzRnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIHJldHVybiAhIShvYmogJiYgb2JqLmNvbnN0cnVjdG9yICYmIG9iai5jYWxsICYmIG9iai5hcHBseSk7XG4gICAgfSxcbiAgICBfaXNQbGFpbk9iamVjdChvYmopIHtcbiAgICAgICAgcmV0dXJuICEhb2JqICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0O1xuICAgIH0sXG4gICAgX2lzQXJyYXkob2JqKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gT0JKRUNUX0FSUkFZO1xuICAgIH0sXG4gICAgX2lzTnVtYmVyKG9iaikge1xuICAgICAgICByZXR1cm4gKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopID09PSBPQkpFQ1RfTlVNQkVSICYmXG4gICAgICAgICAgICAhaXNOYU4ob2JqKSAmJlxuICAgICAgICAgICAgaXNGaW5pdGUob2JqKSk7XG4gICAgfSxcbiAgICBfaXNTdHJpbmcob2JqKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gT0JKRUNUX1NUUklORztcbiAgICB9LFxuICAgIF9pc0Jvb2xlYW4ob2JqKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gT0JKRUNUX0JPT0xFQU47XG4gICAgfSxcbiAgICBpc09iamVjdCh2YWwpIHtcbiAgICAgICAgcmV0dXJuIHZhbCBpbnN0YW5jZW9mIE9iamVjdDtcbiAgICB9LFxuICAgIGlzVmFsaWRTZWxlY3RvcihzZWxlY3Rvcikge1xuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpcnN0Q2hhciA9IHNlbGVjdG9yWzBdO1xuICAgICAgICByZXR1cm4gKGZpcnN0Q2hhciA9PT0gJyMnIHx8XG4gICAgICAgICAgICBmaXJzdENoYXIgPT09ICcuJyB8fFxuICAgICAgICAgICAgZmlyc3RDaGFyID09PSBmaXJzdENoYXIudG9VcHBlckNhc2UoKSk7XG4gICAgfSxcbiAgICBfc2lnbihudW1iZXIpIHtcbiAgICAgICAgaWYgKG51bWJlciA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG51bWJlciA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByZXF1ZXN0QW5pbUZyYW1lKGNhbGxiYWNrKSB7XG4gICAgICAgIGFuaW1RdWV1ZS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgaWYgKGFuaW1RdWV1ZS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJlcShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcXVldWUgPSBhbmltUXVldWU7XG4gICAgICAgICAgICAgICAgYW5pbVF1ZXVlID0gW107XG4gICAgICAgICAgICAgICAgcXVldWUuZm9yRWFjaChmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjcmVhdGVDYW52YXNFbGVtZW50KCkge1xuICAgICAgICBlbnN1cmVCcm93c2VyKCk7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY2FudmFzLnN0eWxlID0gY2FudmFzLnN0eWxlIHx8IHt9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgcmV0dXJuIGNhbnZhcztcbiAgICB9LFxuICAgIGNyZWF0ZUltYWdlRWxlbWVudCgpIHtcbiAgICAgICAgZW5zdXJlQnJvd3NlcigpO1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgfSxcbiAgICBfaXNJbkRvY3VtZW50KGVsKSB7XG4gICAgICAgIHdoaWxlICgoZWwgPSBlbC5wYXJlbnROb2RlKSkge1xuICAgICAgICAgICAgaWYgKGVsID09IGRvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG4gICAgX3VybFRvSW1hZ2UodXJsLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBpbWFnZU9iaiA9IFV0aWwuY3JlYXRlSW1hZ2VFbGVtZW50KCk7XG4gICAgICAgIGltYWdlT2JqLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGltYWdlT2JqKTtcbiAgICAgICAgfTtcbiAgICAgICAgaW1hZ2VPYmouc3JjID0gdXJsO1xuICAgIH0sXG4gICAgX3JnYlRvSGV4KHIsIGcsIGIpIHtcbiAgICAgICAgcmV0dXJuICgoMSA8PCAyNCkgKyAociA8PCAxNikgKyAoZyA8PCA4KSArIGIpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcbiAgICB9LFxuICAgIF9oZXhUb1JnYihoZXgpIHtcbiAgICAgICAgaGV4ID0gaGV4LnJlcGxhY2UoSEFTSCwgRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgY29uc3QgYmlnaW50ID0gcGFyc2VJbnQoaGV4LCAxNik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByOiAoYmlnaW50ID4+IDE2KSAmIDI1NSxcbiAgICAgICAgICAgIGc6IChiaWdpbnQgPj4gOCkgJiAyNTUsXG4gICAgICAgICAgICBiOiBiaWdpbnQgJiAyNTUsXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZXRSYW5kb21Db2xvcigpIHtcbiAgICAgICAgbGV0IHJhbmRDb2xvciA9ICgoTWF0aC5yYW5kb20oKSAqIDB4ZmZmZmZmKSA8PCAwKS50b1N0cmluZygxNik7XG4gICAgICAgIHdoaWxlIChyYW5kQ29sb3IubGVuZ3RoIDwgNikge1xuICAgICAgICAgICAgcmFuZENvbG9yID0gWkVSTyArIHJhbmRDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSEFTSCArIHJhbmRDb2xvcjtcbiAgICB9LFxuICAgIGdldFJHQihjb2xvcikge1xuICAgICAgICBsZXQgcmdiO1xuICAgICAgICBpZiAoY29sb3IgaW4gQ09MT1JTKSB7XG4gICAgICAgICAgICByZ2IgPSBDT0xPUlNbY29sb3JdO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiByZ2JbMF0sXG4gICAgICAgICAgICAgICAgZzogcmdiWzFdLFxuICAgICAgICAgICAgICAgIGI6IHJnYlsyXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sb3JbMF0gPT09IEhBU0gpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZXhUb1JnYihjb2xvci5zdWJzdHJpbmcoMSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbG9yLnN1YnN0cigwLCA0KSA9PT0gUkdCX1BBUkVOKSB7XG4gICAgICAgICAgICByZ2IgPSBSR0JfUkVHRVguZXhlYyhjb2xvci5yZXBsYWNlKC8gL2csICcnKSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHI6IHBhcnNlSW50KHJnYlsxXSwgMTApLFxuICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50KHJnYlsyXSwgMTApLFxuICAgICAgICAgICAgICAgIGI6IHBhcnNlSW50KHJnYlszXSwgMTApLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcjogMCxcbiAgICAgICAgICAgICAgICBnOiAwLFxuICAgICAgICAgICAgICAgIGI6IDAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb2xvclRvUkdCQShzdHIpIHtcbiAgICAgICAgc3RyID0gc3RyIHx8ICdibGFjayc7XG4gICAgICAgIHJldHVybiAoVXRpbC5fbmFtZWRDb2xvclRvUkJBKHN0cikgfHxcbiAgICAgICAgICAgIFV0aWwuX2hleDNDb2xvclRvUkdCQShzdHIpIHx8XG4gICAgICAgICAgICBVdGlsLl9oZXg0Q29sb3JUb1JHQkEoc3RyKSB8fFxuICAgICAgICAgICAgVXRpbC5faGV4NkNvbG9yVG9SR0JBKHN0cikgfHxcbiAgICAgICAgICAgIFV0aWwuX2hleDhDb2xvclRvUkdCQShzdHIpIHx8XG4gICAgICAgICAgICBVdGlsLl9yZ2JDb2xvclRvUkdCQShzdHIpIHx8XG4gICAgICAgICAgICBVdGlsLl9yZ2JhQ29sb3JUb1JHQkEoc3RyKSB8fFxuICAgICAgICAgICAgVXRpbC5faHNsQ29sb3JUb1JHQkEoc3RyKSk7XG4gICAgfSxcbiAgICBfbmFtZWRDb2xvclRvUkJBKHN0cikge1xuICAgICAgICBjb25zdCBjID0gQ09MT1JTW3N0ci50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgaWYgKCFjKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcjogY1swXSxcbiAgICAgICAgICAgIGc6IGNbMV0sXG4gICAgICAgICAgICBiOiBjWzJdLFxuICAgICAgICAgICAgYTogMSxcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIF9yZ2JDb2xvclRvUkdCQShzdHIpIHtcbiAgICAgICAgaWYgKHN0ci5pbmRleE9mKCdyZ2IoJykgPT09IDApIHtcbiAgICAgICAgICAgIHN0ciA9IHN0ci5tYXRjaCgvcmdiXFwoKFteKV0rKVxcKS8pWzFdO1xuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBzdHIuc3BsaXQoLyAqLCAqLykubWFwKE51bWJlcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHI6IHBhcnRzWzBdLFxuICAgICAgICAgICAgICAgIGc6IHBhcnRzWzFdLFxuICAgICAgICAgICAgICAgIGI6IHBhcnRzWzJdLFxuICAgICAgICAgICAgICAgIGE6IDEsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfcmdiYUNvbG9yVG9SR0JBKHN0cikge1xuICAgICAgICBpZiAoc3RyLmluZGV4T2YoJ3JnYmEoJykgPT09IDApIHtcbiAgICAgICAgICAgIHN0ciA9IHN0ci5tYXRjaCgvcmdiYVxcKChbXildKylcXCkvKVsxXTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gc3RyLnNwbGl0KC8gKiwgKi8pLm1hcCgobiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobi5zbGljZSgtMSkgPT09ICclJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggPT09IDMgPyBwYXJzZUludChuKSAvIDEwMCA6IChwYXJzZUludChuKSAvIDEwMCkgKiAyNTU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcjogcGFydHNbMF0sXG4gICAgICAgICAgICAgICAgZzogcGFydHNbMV0sXG4gICAgICAgICAgICAgICAgYjogcGFydHNbMl0sXG4gICAgICAgICAgICAgICAgYTogcGFydHNbM10sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfaGV4OENvbG9yVG9SR0JBKHN0cikge1xuICAgICAgICBpZiAoc3RyWzBdID09PSAnIycgJiYgc3RyLmxlbmd0aCA9PT0gOSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludChzdHIuc2xpY2UoMSwgMyksIDE2KSxcbiAgICAgICAgICAgICAgICBnOiBwYXJzZUludChzdHIuc2xpY2UoMywgNSksIDE2KSxcbiAgICAgICAgICAgICAgICBiOiBwYXJzZUludChzdHIuc2xpY2UoNSwgNyksIDE2KSxcbiAgICAgICAgICAgICAgICBhOiBwYXJzZUludChzdHIuc2xpY2UoNywgOSksIDE2KSAvIDB4ZmYsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfaGV4NkNvbG9yVG9SR0JBKHN0cikge1xuICAgICAgICBpZiAoc3RyWzBdID09PSAnIycgJiYgc3RyLmxlbmd0aCA9PT0gNykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludChzdHIuc2xpY2UoMSwgMyksIDE2KSxcbiAgICAgICAgICAgICAgICBnOiBwYXJzZUludChzdHIuc2xpY2UoMywgNSksIDE2KSxcbiAgICAgICAgICAgICAgICBiOiBwYXJzZUludChzdHIuc2xpY2UoNSwgNyksIDE2KSxcbiAgICAgICAgICAgICAgICBhOiAxLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX2hleDRDb2xvclRvUkdCQShzdHIpIHtcbiAgICAgICAgaWYgKHN0clswXSA9PT0gJyMnICYmIHN0ci5sZW5ndGggPT09IDUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcjogcGFyc2VJbnQoc3RyWzFdICsgc3RyWzFdLCAxNiksXG4gICAgICAgICAgICAgICAgZzogcGFyc2VJbnQoc3RyWzJdICsgc3RyWzJdLCAxNiksXG4gICAgICAgICAgICAgICAgYjogcGFyc2VJbnQoc3RyWzNdICsgc3RyWzNdLCAxNiksXG4gICAgICAgICAgICAgICAgYTogcGFyc2VJbnQoc3RyWzRdICsgc3RyWzRdLCAxNikgLyAweGZmLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX2hleDNDb2xvclRvUkdCQShzdHIpIHtcbiAgICAgICAgaWYgKHN0clswXSA9PT0gJyMnICYmIHN0ci5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcjogcGFyc2VJbnQoc3RyWzFdICsgc3RyWzFdLCAxNiksXG4gICAgICAgICAgICAgICAgZzogcGFyc2VJbnQoc3RyWzJdICsgc3RyWzJdLCAxNiksXG4gICAgICAgICAgICAgICAgYjogcGFyc2VJbnQoc3RyWzNdICsgc3RyWzNdLCAxNiksXG4gICAgICAgICAgICAgICAgYTogMSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9oc2xDb2xvclRvUkdCQShzdHIpIHtcbiAgICAgICAgaWYgKC9oc2xcXCgoXFxkKyksXFxzKihbXFxkLl0rKSUsXFxzKihbXFxkLl0rKSVcXCkvZy50ZXN0KHN0cikpIHtcbiAgICAgICAgICAgIGNvbnN0IFtfLCAuLi5oc2xdID0gL2hzbFxcKChcXGQrKSxcXHMqKFtcXGQuXSspJSxcXHMqKFtcXGQuXSspJVxcKS9nLmV4ZWMoc3RyKTtcbiAgICAgICAgICAgIGNvbnN0IGggPSBOdW1iZXIoaHNsWzBdKSAvIDM2MDtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBOdW1iZXIoaHNsWzFdKSAvIDEwMDtcbiAgICAgICAgICAgIGNvbnN0IGwgPSBOdW1iZXIoaHNsWzJdKSAvIDEwMDtcbiAgICAgICAgICAgIGxldCB0MjtcbiAgICAgICAgICAgIGxldCB0MztcbiAgICAgICAgICAgIGxldCB2YWw7XG4gICAgICAgICAgICBpZiAocyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZhbCA9IGwgKiAyNTU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcjogTWF0aC5yb3VuZCh2YWwpLFxuICAgICAgICAgICAgICAgICAgICBnOiBNYXRoLnJvdW5kKHZhbCksXG4gICAgICAgICAgICAgICAgICAgIGI6IE1hdGgucm91bmQodmFsKSxcbiAgICAgICAgICAgICAgICAgICAgYTogMSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGwgPCAwLjUpIHtcbiAgICAgICAgICAgICAgICB0MiA9IGwgKiAoMSArIHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdDIgPSBsICsgcyAtIGwgKiBzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdDEgPSAyICogbCAtIHQyO1xuICAgICAgICAgICAgY29uc3QgcmdiID0gWzAsIDAsIDBdO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0MyA9IGggKyAoMSAvIDMpICogLShpIC0gMSk7XG4gICAgICAgICAgICAgICAgaWYgKHQzIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICB0MysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodDMgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHQzLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICg2ICogdDMgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHQxICsgKHQyIC0gdDEpICogNiAqIHQzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgyICogdDMgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHQyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgzICogdDMgPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHQxICsgKHQyIC0gdDEpICogKDIgLyAzIC0gdDMpICogNjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHQxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZ2JbaV0gPSB2YWwgKiAyNTU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHI6IE1hdGgucm91bmQocmdiWzBdKSxcbiAgICAgICAgICAgICAgICBnOiBNYXRoLnJvdW5kKHJnYlsxXSksXG4gICAgICAgICAgICAgICAgYjogTWF0aC5yb3VuZChyZ2JbMl0pLFxuICAgICAgICAgICAgICAgIGE6IDEsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBoYXZlSW50ZXJzZWN0aW9uKHIxLCByMikge1xuICAgICAgICByZXR1cm4gIShyMi54ID4gcjEueCArIHIxLndpZHRoIHx8XG4gICAgICAgICAgICByMi54ICsgcjIud2lkdGggPCByMS54IHx8XG4gICAgICAgICAgICByMi55ID4gcjEueSArIHIxLmhlaWdodCB8fFxuICAgICAgICAgICAgcjIueSArIHIyLmhlaWdodCA8IHIxLnkpO1xuICAgIH0sXG4gICAgY2xvbmVPYmplY3Qob2JqKSB7XG4gICAgICAgIGNvbnN0IHJldE9iaiA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1BsYWluT2JqZWN0KG9ialtrZXldKSkge1xuICAgICAgICAgICAgICAgIHJldE9ialtrZXldID0gdGhpcy5jbG9uZU9iamVjdChvYmpba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9pc0FycmF5KG9ialtrZXldKSkge1xuICAgICAgICAgICAgICAgIHJldE9ialtrZXldID0gdGhpcy5jbG9uZUFycmF5KG9ialtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldE9ialtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldE9iajtcbiAgICB9LFxuICAgIGNsb25lQXJyYXkoYXJyKSB7XG4gICAgICAgIHJldHVybiBhcnIuc2xpY2UoMCk7XG4gICAgfSxcbiAgICBkZWdUb1JhZChkZWcpIHtcbiAgICAgICAgcmV0dXJuIGRlZyAqIFBJX09WRVJfREVHMTgwO1xuICAgIH0sXG4gICAgcmFkVG9EZWcocmFkKSB7XG4gICAgICAgIHJldHVybiByYWQgKiBERUcxODBfT1ZFUl9QSTtcbiAgICB9LFxuICAgIF9kZWdUb1JhZChkZWcpIHtcbiAgICAgICAgVXRpbC53YXJuKCdVdGlsLl9kZWdUb1JhZCBpcyByZW1vdmVkLiBQbGVhc2UgdXNlIHB1YmxpYyBVdGlsLmRlZ1RvUmFkIGluc3RlYWQuJyk7XG4gICAgICAgIHJldHVybiBVdGlsLmRlZ1RvUmFkKGRlZyk7XG4gICAgfSxcbiAgICBfcmFkVG9EZWcocmFkKSB7XG4gICAgICAgIFV0aWwud2FybignVXRpbC5fcmFkVG9EZWcgaXMgcmVtb3ZlZC4gUGxlYXNlIHVzZSBwdWJsaWMgVXRpbC5yYWRUb0RlZyBpbnN0ZWFkLicpO1xuICAgICAgICByZXR1cm4gVXRpbC5yYWRUb0RlZyhyYWQpO1xuICAgIH0sXG4gICAgX2dldFJvdGF0aW9uKHJhZGlhbnMpIHtcbiAgICAgICAgcmV0dXJuIEtvbnZhLmFuZ2xlRGVnID8gVXRpbC5yYWRUb0RlZyhyYWRpYW5zKSA6IHJhZGlhbnM7XG4gICAgfSxcbiAgICBfY2FwaXRhbGl6ZShzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcbiAgICB9LFxuICAgIHRocm93KHN0cikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoS09OVkFfRVJST1IgKyBzdHIpO1xuICAgIH0sXG4gICAgZXJyb3Ioc3RyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoS09OVkFfRVJST1IgKyBzdHIpO1xuICAgIH0sXG4gICAgd2FybihzdHIpIHtcbiAgICAgICAgaWYgKCFLb252YS5zaG93V2FybmluZ3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLndhcm4oS09OVkFfV0FSTklORyArIHN0cik7XG4gICAgfSxcbiAgICBlYWNoKG9iaiwgZnVuYykge1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgIGZ1bmMoa2V5LCBvYmpba2V5XSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9pblJhbmdlKHZhbCwgbGVmdCwgcmlnaHQpIHtcbiAgICAgICAgcmV0dXJuIGxlZnQgPD0gdmFsICYmIHZhbCA8IHJpZ2h0O1xuICAgIH0sXG4gICAgX2dldFByb2plY3Rpb25Ub1NlZ21lbnQoeDEsIHkxLCB4MiwgeTIsIHgzLCB5Mykge1xuICAgICAgICBsZXQgeCwgeSwgZGlzdDtcbiAgICAgICAgY29uc3QgcGQyID0gKHgxIC0geDIpICogKHgxIC0geDIpICsgKHkxIC0geTIpICogKHkxIC0geTIpO1xuICAgICAgICBpZiAocGQyID09IDApIHtcbiAgICAgICAgICAgIHggPSB4MTtcbiAgICAgICAgICAgIHkgPSB5MTtcbiAgICAgICAgICAgIGRpc3QgPSAoeDMgLSB4MikgKiAoeDMgLSB4MikgKyAoeTMgLSB5MikgKiAoeTMgLSB5Mik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB1ID0gKCh4MyAtIHgxKSAqICh4MiAtIHgxKSArICh5MyAtIHkxKSAqICh5MiAtIHkxKSkgLyBwZDI7XG4gICAgICAgICAgICBpZiAodSA8IDApIHtcbiAgICAgICAgICAgICAgICB4ID0geDE7XG4gICAgICAgICAgICAgICAgeSA9IHkxO1xuICAgICAgICAgICAgICAgIGRpc3QgPSAoeDEgLSB4MykgKiAoeDEgLSB4MykgKyAoeTEgLSB5MykgKiAoeTEgLSB5Myk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh1ID4gMS4wKSB7XG4gICAgICAgICAgICAgICAgeCA9IHgyO1xuICAgICAgICAgICAgICAgIHkgPSB5MjtcbiAgICAgICAgICAgICAgICBkaXN0ID0gKHgyIC0geDMpICogKHgyIC0geDMpICsgKHkyIC0geTMpICogKHkyIC0geTMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgeCA9IHgxICsgdSAqICh4MiAtIHgxKTtcbiAgICAgICAgICAgICAgICB5ID0geTEgKyB1ICogKHkyIC0geTEpO1xuICAgICAgICAgICAgICAgIGRpc3QgPSAoeCAtIHgzKSAqICh4IC0geDMpICsgKHkgLSB5MykgKiAoeSAtIHkzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3gsIHksIGRpc3RdO1xuICAgIH0sXG4gICAgX2dldFByb2plY3Rpb25Ub0xpbmUocHQsIGxpbmUsIGlzQ2xvc2VkKSB7XG4gICAgICAgIGNvbnN0IHBjID0gVXRpbC5jbG9uZU9iamVjdChwdCk7XG4gICAgICAgIGxldCBkaXN0ID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgICAgbGluZS5mb3JFYWNoKGZ1bmN0aW9uIChwMSwgaSkge1xuICAgICAgICAgICAgaWYgKCFpc0Nsb3NlZCAmJiBpID09PSBsaW5lLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwMiA9IGxpbmVbKGkgKyAxKSAlIGxpbmUubGVuZ3RoXTtcbiAgICAgICAgICAgIGNvbnN0IHByb2ogPSBVdGlsLl9nZXRQcm9qZWN0aW9uVG9TZWdtZW50KHAxLngsIHAxLnksIHAyLngsIHAyLnksIHB0LngsIHB0LnkpO1xuICAgICAgICAgICAgY29uc3QgcHggPSBwcm9qWzBdLCBweSA9IHByb2pbMV0sIHBkaXN0ID0gcHJvalsyXTtcbiAgICAgICAgICAgIGlmIChwZGlzdCA8IGRpc3QpIHtcbiAgICAgICAgICAgICAgICBwYy54ID0gcHg7XG4gICAgICAgICAgICAgICAgcGMueSA9IHB5O1xuICAgICAgICAgICAgICAgIGRpc3QgPSBwZGlzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwYztcbiAgICB9LFxuICAgIF9wcmVwYXJlQXJyYXlGb3JUd2VlbihzdGFydEFycmF5LCBlbmRBcnJheSwgaXNDbG9zZWQpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBbXSwgZW5kID0gW107XG4gICAgICAgIGlmIChzdGFydEFycmF5Lmxlbmd0aCA+IGVuZEFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgdGVtcCA9IGVuZEFycmF5O1xuICAgICAgICAgICAgZW5kQXJyYXkgPSBzdGFydEFycmF5O1xuICAgICAgICAgICAgc3RhcnRBcnJheSA9IHRlbXA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBzdGFydEFycmF5Lmxlbmd0aDsgbiArPSAyKSB7XG4gICAgICAgICAgICBzdGFydC5wdXNoKHtcbiAgICAgICAgICAgICAgICB4OiBzdGFydEFycmF5W25dLFxuICAgICAgICAgICAgICAgIHk6IHN0YXJ0QXJyYXlbbiArIDFdLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlbmRBcnJheS5sZW5ndGg7IG4gKz0gMikge1xuICAgICAgICAgICAgZW5kLnB1c2goe1xuICAgICAgICAgICAgICAgIHg6IGVuZEFycmF5W25dLFxuICAgICAgICAgICAgICAgIHk6IGVuZEFycmF5W24gKyAxXSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1N0YXJ0ID0gW107XG4gICAgICAgIGVuZC5mb3JFYWNoKGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgY29uc3QgcHIgPSBVdGlsLl9nZXRQcm9qZWN0aW9uVG9MaW5lKHBvaW50LCBzdGFydCwgaXNDbG9zZWQpO1xuICAgICAgICAgICAgbmV3U3RhcnQucHVzaChwci54KTtcbiAgICAgICAgICAgIG5ld1N0YXJ0LnB1c2gocHIueSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3U3RhcnQ7XG4gICAgfSxcbiAgICBfcHJlcGFyZVRvU3RyaW5naWZ5KG9iaikge1xuICAgICAgICBsZXQgZGVzYztcbiAgICAgICAgb2JqLnZpc2l0ZWRCeUNpcmN1bGFyUmVmZXJlbmNlUmVtb3ZhbCA9IHRydWU7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICAgICAgaWYgKCEob2JqLmhhc093blByb3BlcnR5KGtleSkgJiYgb2JqW2tleV0gJiYgdHlwZW9mIG9ialtrZXldID09ICdvYmplY3QnKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpO1xuICAgICAgICAgICAgaWYgKG9ialtrZXldLnZpc2l0ZWRCeUNpcmN1bGFyUmVmZXJlbmNlUmVtb3ZhbCB8fFxuICAgICAgICAgICAgICAgIFV0aWwuX2lzRWxlbWVudChvYmpba2V5XSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVzYy5jb25maWd1cmFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9ialtrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoVXRpbC5fcHJlcGFyZVRvU3RyaW5naWZ5KG9ialtrZXldKSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChkZXNjLmNvbmZpZ3VyYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgb2JqW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIG9iai52aXNpdGVkQnlDaXJjdWxhclJlZmVyZW5jZVJlbW92YWw7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcbiAgICBfYXNzaWduKHRhcmdldCwgc291cmNlKSB7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH0sXG4gICAgX2dldEZpcnN0UG9pbnRlcklkKGV2dCkge1xuICAgICAgICBpZiAoIWV2dC50b3VjaGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gZXZ0LnBvaW50ZXJJZCB8fCA5OTk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZXZ0LmNoYW5nZWRUb3VjaGVzWzBdLmlkZW50aWZpZXI7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlbGVhc2VDYW52YXMoLi4uY2FudmFzZXMpIHtcbiAgICAgICAgaWYgKCFLb252YS5yZWxlYXNlQ2FudmFzT25EZXN0cm95KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjYW52YXNlcy5mb3JFYWNoKChjKSA9PiB7XG4gICAgICAgICAgICBjLndpZHRoID0gMDtcbiAgICAgICAgICAgIGMuaGVpZ2h0ID0gMDtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBkcmF3Um91bmRlZFJlY3RQYXRoKGNvbnRleHQsIHdpZHRoLCBoZWlnaHQsIGNvcm5lclJhZGl1cykge1xuICAgICAgICBsZXQgeE9yaWdpbiA9IHdpZHRoIDwgMCA/IHdpZHRoIDogMDtcbiAgICAgICAgbGV0IHlPcmlnaW4gPSBoZWlnaHQgPCAwID8gaGVpZ2h0IDogMDtcbiAgICAgICAgd2lkdGggPSBNYXRoLmFicyh3aWR0aCk7XG4gICAgICAgIGhlaWdodCA9IE1hdGguYWJzKGhlaWdodCk7XG4gICAgICAgIGxldCB0b3BMZWZ0ID0gMDtcbiAgICAgICAgbGV0IHRvcFJpZ2h0ID0gMDtcbiAgICAgICAgbGV0IGJvdHRvbUxlZnQgPSAwO1xuICAgICAgICBsZXQgYm90dG9tUmlnaHQgPSAwO1xuICAgICAgICBpZiAodHlwZW9mIGNvcm5lclJhZGl1cyA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRvcExlZnQgPVxuICAgICAgICAgICAgICAgIHRvcFJpZ2h0ID1cbiAgICAgICAgICAgICAgICAgICAgYm90dG9tTGVmdCA9XG4gICAgICAgICAgICAgICAgICAgICAgICBib3R0b21SaWdodCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oY29ybmVyUmFkaXVzLCB3aWR0aCAvIDIsIGhlaWdodCAvIDIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdG9wTGVmdCA9IE1hdGgubWluKGNvcm5lclJhZGl1c1swXSB8fCAwLCB3aWR0aCAvIDIsIGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgdG9wUmlnaHQgPSBNYXRoLm1pbihjb3JuZXJSYWRpdXNbMV0gfHwgMCwgd2lkdGggLyAyLCBoZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIGJvdHRvbVJpZ2h0ID0gTWF0aC5taW4oY29ybmVyUmFkaXVzWzJdIHx8IDAsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICBib3R0b21MZWZ0ID0gTWF0aC5taW4oY29ybmVyUmFkaXVzWzNdIHx8IDAsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5tb3ZlVG8oeE9yaWdpbiArIHRvcExlZnQsIHlPcmlnaW4pO1xuICAgICAgICBjb250ZXh0LmxpbmVUbyh4T3JpZ2luICsgd2lkdGggLSB0b3BSaWdodCwgeU9yaWdpbik7XG4gICAgICAgIGNvbnRleHQuYXJjKHhPcmlnaW4gKyB3aWR0aCAtIHRvcFJpZ2h0LCB5T3JpZ2luICsgdG9wUmlnaHQsIHRvcFJpZ2h0LCAoTWF0aC5QSSAqIDMpIC8gMiwgMCwgZmFsc2UpO1xuICAgICAgICBjb250ZXh0LmxpbmVUbyh4T3JpZ2luICsgd2lkdGgsIHlPcmlnaW4gKyBoZWlnaHQgLSBib3R0b21SaWdodCk7XG4gICAgICAgIGNvbnRleHQuYXJjKHhPcmlnaW4gKyB3aWR0aCAtIGJvdHRvbVJpZ2h0LCB5T3JpZ2luICsgaGVpZ2h0IC0gYm90dG9tUmlnaHQsIGJvdHRvbVJpZ2h0LCAwLCBNYXRoLlBJIC8gMiwgZmFsc2UpO1xuICAgICAgICBjb250ZXh0LmxpbmVUbyh4T3JpZ2luICsgYm90dG9tTGVmdCwgeU9yaWdpbiArIGhlaWdodCk7XG4gICAgICAgIGNvbnRleHQuYXJjKHhPcmlnaW4gKyBib3R0b21MZWZ0LCB5T3JpZ2luICsgaGVpZ2h0IC0gYm90dG9tTGVmdCwgYm90dG9tTGVmdCwgTWF0aC5QSSAvIDIsIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgY29udGV4dC5saW5lVG8oeE9yaWdpbiwgeU9yaWdpbiArIHRvcExlZnQpO1xuICAgICAgICBjb250ZXh0LmFyYyh4T3JpZ2luICsgdG9wTGVmdCwgeU9yaWdpbiArIHRvcExlZnQsIHRvcExlZnQsIE1hdGguUEksIChNYXRoLlBJICogMykgLyAyLCBmYWxzZSk7XG4gICAgfSxcbiAgICBkcmF3Um91bmRlZFBvbHlnb25QYXRoKGNvbnRleHQsIHBvaW50cywgc2lkZXMsIHJhZGl1cywgY29ybmVyUmFkaXVzKSB7XG4gICAgICAgIHJhZGl1cyA9IE1hdGguYWJzKHJhZGl1cyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2lkZXM7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcHJldiA9IHBvaW50c1soaSAtIDEgKyBzaWRlcykgJSBzaWRlc107XG4gICAgICAgICAgICBjb25zdCBjdXJyID0gcG9pbnRzW2ldO1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IHBvaW50c1soaSArIDEpICUgc2lkZXNdO1xuICAgICAgICAgICAgY29uc3QgdmVjMSA9IHsgeDogY3Vyci54IC0gcHJldi54LCB5OiBjdXJyLnkgLSBwcmV2LnkgfTtcbiAgICAgICAgICAgIGNvbnN0IHZlYzIgPSB7IHg6IG5leHQueCAtIGN1cnIueCwgeTogbmV4dC55IC0gY3Vyci55IH07XG4gICAgICAgICAgICBjb25zdCBsZW4xID0gTWF0aC5oeXBvdCh2ZWMxLngsIHZlYzEueSk7XG4gICAgICAgICAgICBjb25zdCBsZW4yID0gTWF0aC5oeXBvdCh2ZWMyLngsIHZlYzIueSk7XG4gICAgICAgICAgICBsZXQgY3VyckNvcm5lclJhZGl1cztcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29ybmVyUmFkaXVzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIGN1cnJDb3JuZXJSYWRpdXMgPSBjb3JuZXJSYWRpdXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdXJyQ29ybmVyUmFkaXVzID0gaSA8IGNvcm5lclJhZGl1cy5sZW5ndGggPyBjb3JuZXJSYWRpdXNbaV0gOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbWF4Q29ybmVyUmFkaXVzID0gcmFkaXVzICogTWF0aC5jb3MoTWF0aC5QSSAvIHNpZGVzKTtcbiAgICAgICAgICAgIGN1cnJDb3JuZXJSYWRpdXMgPVxuICAgICAgICAgICAgICAgIG1heENvcm5lclJhZGl1cyAqIE1hdGgubWluKDEsIChjdXJyQ29ybmVyUmFkaXVzIC8gcmFkaXVzKSAqIDIpO1xuICAgICAgICAgICAgY29uc3Qgbm9ybWFsVmVjMSA9IHsgeDogdmVjMS54IC8gbGVuMSwgeTogdmVjMS55IC8gbGVuMSB9O1xuICAgICAgICAgICAgY29uc3Qgbm9ybWFsVmVjMiA9IHsgeDogdmVjMi54IC8gbGVuMiwgeTogdmVjMi55IC8gbGVuMiB9O1xuICAgICAgICAgICAgY29uc3QgcDEgPSB7XG4gICAgICAgICAgICAgICAgeDogY3Vyci54IC0gbm9ybWFsVmVjMS54ICogY3VyckNvcm5lclJhZGl1cyxcbiAgICAgICAgICAgICAgICB5OiBjdXJyLnkgLSBub3JtYWxWZWMxLnkgKiBjdXJyQ29ybmVyUmFkaXVzLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IHAyID0ge1xuICAgICAgICAgICAgICAgIHg6IGN1cnIueCArIG5vcm1hbFZlYzIueCAqIGN1cnJDb3JuZXJSYWRpdXMsXG4gICAgICAgICAgICAgICAgeTogY3Vyci55ICsgbm9ybWFsVmVjMi55ICogY3VyckNvcm5lclJhZGl1cyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHAxLngsIHAxLnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8ocDEueCwgcDEueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LmFyY1RvKGN1cnIueCwgY3Vyci55LCBwMi54LCBwMi55LCBjdXJyQ29ybmVyUmFkaXVzKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuIiwiaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi9VdGlsLmpzXCI7XG5mdW5jdGlvbiBfZm9ybWF0VmFsdWUodmFsKSB7XG4gICAgaWYgKFV0aWwuX2lzU3RyaW5nKHZhbCkpIHtcbiAgICAgICAgcmV0dXJuICdcIicgKyB2YWwgKyAnXCInO1xuICAgIH1cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IE51bWJlcl0nKSB7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIGlmIChVdGlsLl9pc0Jvb2xlYW4odmFsKSkge1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCk7XG59XG5leHBvcnQgZnVuY3Rpb24gUkdCQ29tcG9uZW50KHZhbCkge1xuICAgIGlmICh2YWwgPiAyNTUpIHtcbiAgICAgICAgcmV0dXJuIDI1NTtcbiAgICB9XG4gICAgZWxzZSBpZiAodmFsIDwgMCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgucm91bmQodmFsKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhbHBoYUNvbXBvbmVudCh2YWwpIHtcbiAgICBpZiAodmFsID4gMSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgZWxzZSBpZiAodmFsIDwgMC4wMDAxKSB7XG4gICAgICAgIHJldHVybiAwLjAwMDE7XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0TnVtYmVyVmFsaWRhdG9yKCkge1xuICAgIGlmIChLb252YS5pc1VubWluaWZpZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWwsIGF0dHIpIHtcbiAgICAgICAgICAgIGlmICghVXRpbC5faXNOdW1iZXIodmFsKSkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybihfZm9ybWF0VmFsdWUodmFsKSArXG4gICAgICAgICAgICAgICAgICAgICcgaXMgYSBub3QgdmFsaWQgdmFsdWUgZm9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGF0dHIgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgYXR0cmlidXRlLiBUaGUgdmFsdWUgc2hvdWxkIGJlIGEgbnVtYmVyLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0TnVtYmVyT3JBcnJheU9mTnVtYmVyc1ZhbGlkYXRvcihub09mRWxlbWVudHMpIHtcbiAgICBpZiAoS29udmEuaXNVbm1pbmlmaWVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodmFsLCBhdHRyKSB7XG4gICAgICAgICAgICBsZXQgaXNOdW1iZXIgPSBVdGlsLl9pc051bWJlcih2YWwpO1xuICAgICAgICAgICAgbGV0IGlzVmFsaWRBcnJheSA9IFV0aWwuX2lzQXJyYXkodmFsKSAmJiB2YWwubGVuZ3RoID09IG5vT2ZFbGVtZW50cztcbiAgICAgICAgICAgIGlmICghaXNOdW1iZXIgJiYgIWlzVmFsaWRBcnJheSkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybihfZm9ybWF0VmFsdWUodmFsKSArXG4gICAgICAgICAgICAgICAgICAgICcgaXMgYSBub3QgdmFsaWQgdmFsdWUgZm9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGF0dHIgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgYXR0cmlidXRlLiBUaGUgdmFsdWUgc2hvdWxkIGJlIGEgbnVtYmVyIG9yIEFycmF5PG51bWJlcj4oJyArXG4gICAgICAgICAgICAgICAgICAgIG5vT2ZFbGVtZW50cyArXG4gICAgICAgICAgICAgICAgICAgICcpJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXROdW1iZXJPckF1dG9WYWxpZGF0b3IoKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgY29uc3QgaXNOdW1iZXIgPSBVdGlsLl9pc051bWJlcih2YWwpO1xuICAgICAgICAgICAgY29uc3QgaXNBdXRvID0gdmFsID09PSAnYXV0byc7XG4gICAgICAgICAgICBpZiAoIShpc051bWJlciB8fCBpc0F1dG8pKSB7XG4gICAgICAgICAgICAgICAgVXRpbC53YXJuKF9mb3JtYXRWYWx1ZSh2YWwpICtcbiAgICAgICAgICAgICAgICAgICAgJyBpcyBhIG5vdCB2YWxpZCB2YWx1ZSBmb3IgXCInICtcbiAgICAgICAgICAgICAgICAgICAgYXR0ciArXG4gICAgICAgICAgICAgICAgICAgICdcIiBhdHRyaWJ1dGUuIFRoZSB2YWx1ZSBzaG91bGQgYmUgYSBudW1iZXIgb3IgXCJhdXRvXCIuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJpbmdWYWxpZGF0b3IoKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKCFVdGlsLl9pc1N0cmluZyh2YWwpKSB7XG4gICAgICAgICAgICAgICAgVXRpbC53YXJuKF9mb3JtYXRWYWx1ZSh2YWwpICtcbiAgICAgICAgICAgICAgICAgICAgJyBpcyBhIG5vdCB2YWxpZCB2YWx1ZSBmb3IgXCInICtcbiAgICAgICAgICAgICAgICAgICAgYXR0ciArXG4gICAgICAgICAgICAgICAgICAgICdcIiBhdHRyaWJ1dGUuIFRoZSB2YWx1ZSBzaG91bGQgYmUgYSBzdHJpbmcuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJpbmdPckdyYWRpZW50VmFsaWRhdG9yKCkge1xuICAgIGlmIChLb252YS5pc1VubWluaWZpZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWwsIGF0dHIpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzU3RyaW5nID0gVXRpbC5faXNTdHJpbmcodmFsKTtcbiAgICAgICAgICAgIGNvbnN0IGlzR3JhZGllbnQgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQ2FudmFzR3JhZGllbnRdJyB8fFxuICAgICAgICAgICAgICAgICh2YWwgJiYgdmFsWydhZGRDb2xvclN0b3AnXSk7XG4gICAgICAgICAgICBpZiAoIShpc1N0cmluZyB8fCBpc0dyYWRpZW50KSkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybihfZm9ybWF0VmFsdWUodmFsKSArXG4gICAgICAgICAgICAgICAgICAgICcgaXMgYSBub3QgdmFsaWQgdmFsdWUgZm9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGF0dHIgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgYXR0cmlidXRlLiBUaGUgdmFsdWUgc2hvdWxkIGJlIGEgc3RyaW5nIG9yIGEgbmF0aXZlIGdyYWRpZW50LicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RnVuY3Rpb25WYWxpZGF0b3IoKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKCFVdGlsLl9pc0Z1bmN0aW9uKHZhbCkpIHtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oX2Zvcm1hdFZhbHVlKHZhbCkgK1xuICAgICAgICAgICAgICAgICAgICAnIGlzIGEgbm90IHZhbGlkIHZhbHVlIGZvciBcIicgK1xuICAgICAgICAgICAgICAgICAgICBhdHRyICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIGF0dHJpYnV0ZS4gVGhlIHZhbHVlIHNob3VsZCBiZSBhIGZ1bmN0aW9uLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0TnVtYmVyQXJyYXlWYWxpZGF0b3IoKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgY29uc3QgVHlwZWRBcnJheSA9IEludDhBcnJheSA/IE9iamVjdC5nZXRQcm90b3R5cGVPZihJbnQ4QXJyYXkpIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChUeXBlZEFycmF5ICYmIHZhbCBpbnN0YW5jZW9mIFR5cGVkQXJyYXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFVdGlsLl9pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oX2Zvcm1hdFZhbHVlKHZhbCkgK1xuICAgICAgICAgICAgICAgICAgICAnIGlzIGEgbm90IHZhbGlkIHZhbHVlIGZvciBcIicgK1xuICAgICAgICAgICAgICAgICAgICBhdHRyICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIGF0dHJpYnV0ZS4gVGhlIHZhbHVlIHNob3VsZCBiZSBhIGFycmF5IG9mIG51bWJlcnMuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWwuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIVV0aWwuX2lzTnVtYmVyKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBVdGlsLndhcm4oJ1wiJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ciArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1wiIGF0dHJpYnV0ZSBoYXMgbm9uIG51bWVyaWMgZWxlbWVudCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLiBNYWtlIHN1cmUgdGhhdCBhbGwgZWxlbWVudHMgYXJlIG51bWJlcnMuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIH07XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEJvb2xlYW5WYWxpZGF0b3IoKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgY29uc3QgaXNCb29sID0gdmFsID09PSB0cnVlIHx8IHZhbCA9PT0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIWlzQm9vbCkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybihfZm9ybWF0VmFsdWUodmFsKSArXG4gICAgICAgICAgICAgICAgICAgICcgaXMgYSBub3QgdmFsaWQgdmFsdWUgZm9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGF0dHIgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgYXR0cmlidXRlLiBUaGUgdmFsdWUgc2hvdWxkIGJlIGEgYm9vbGVhbi4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIH07XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbXBvbmVudFZhbGlkYXRvcihjb21wb25lbnRzKSB7XG4gICAgaWYgKEtvbnZhLmlzVW5taW5pZmllZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIVV0aWwuaXNPYmplY3QodmFsKSkge1xuICAgICAgICAgICAgICAgIFV0aWwud2FybihfZm9ybWF0VmFsdWUodmFsKSArXG4gICAgICAgICAgICAgICAgICAgICcgaXMgYSBub3QgdmFsaWQgdmFsdWUgZm9yIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGF0dHIgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgYXR0cmlidXRlLiBUaGUgdmFsdWUgc2hvdWxkIGJlIGFuIG9iamVjdCB3aXRoIHByb3BlcnRpZXMgJyArXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBLb252YSBhcyBHbG9iYWwgfSBmcm9tIFwiLi9HbG9iYWwuanNcIjtcbmltcG9ydCB7IFV0aWwsIFRyYW5zZm9ybSB9IGZyb20gXCIuL1V0aWwuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tIFwiLi9Db250YWluZXIuanNcIjtcbmltcG9ydCB7IFN0YWdlLCBzdGFnZXMgfSBmcm9tIFwiLi9TdGFnZS5qc1wiO1xuaW1wb3J0IHsgTGF5ZXIgfSBmcm9tIFwiLi9MYXllci5qc1wiO1xuaW1wb3J0IHsgRmFzdExheWVyIH0gZnJvbSBcIi4vRmFzdExheWVyLmpzXCI7XG5pbXBvcnQgeyBHcm91cCB9IGZyb20gXCIuL0dyb3VwLmpzXCI7XG5pbXBvcnQgeyBERCB9IGZyb20gXCIuL0RyYWdBbmREcm9wLmpzXCI7XG5pbXBvcnQgeyBTaGFwZSwgc2hhcGVzIH0gZnJvbSBcIi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IEFuaW1hdGlvbiB9IGZyb20gXCIuL0FuaW1hdGlvbi5qc1wiO1xuaW1wb3J0IHsgVHdlZW4sIEVhc2luZ3MgfSBmcm9tIFwiLi9Ud2Vlbi5qc1wiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCIuL0NvbnRleHQuanNcIjtcbmltcG9ydCB7IENhbnZhcyB9IGZyb20gXCIuL0NhbnZhcy5qc1wiO1xuZXhwb3J0IGNvbnN0IEtvbnZhID0gVXRpbC5fYXNzaWduKEdsb2JhbCwge1xuICAgIFV0aWwsXG4gICAgVHJhbnNmb3JtLFxuICAgIE5vZGUsXG4gICAgQ29udGFpbmVyLFxuICAgIFN0YWdlLFxuICAgIHN0YWdlcyxcbiAgICBMYXllcixcbiAgICBGYXN0TGF5ZXIsXG4gICAgR3JvdXAsXG4gICAgREQsXG4gICAgU2hhcGUsXG4gICAgc2hhcGVzLFxuICAgIEFuaW1hdGlvbixcbiAgICBUd2VlbixcbiAgICBFYXNpbmdzLFxuICAgIENvbnRleHQsXG4gICAgQ2FudmFzLFxufSk7XG5leHBvcnQgZGVmYXVsdCBLb252YTtcbiIsImltcG9ydCB7IEtvbnZhIGFzIENvcmUgfSBmcm9tIFwiLi9fQ29yZUludGVybmFscy5qc1wiO1xuaW1wb3J0IHsgQXJjIH0gZnJvbSBcIi4vc2hhcGVzL0FyYy5qc1wiO1xuaW1wb3J0IHsgQXJyb3cgfSBmcm9tIFwiLi9zaGFwZXMvQXJyb3cuanNcIjtcbmltcG9ydCB7IENpcmNsZSB9IGZyb20gXCIuL3NoYXBlcy9DaXJjbGUuanNcIjtcbmltcG9ydCB7IEVsbGlwc2UgfSBmcm9tIFwiLi9zaGFwZXMvRWxsaXBzZS5qc1wiO1xuaW1wb3J0IHsgSW1hZ2UgfSBmcm9tIFwiLi9zaGFwZXMvSW1hZ2UuanNcIjtcbmltcG9ydCB7IExhYmVsLCBUYWcgfSBmcm9tIFwiLi9zaGFwZXMvTGFiZWwuanNcIjtcbmltcG9ydCB7IExpbmUgfSBmcm9tIFwiLi9zaGFwZXMvTGluZS5qc1wiO1xuaW1wb3J0IHsgUGF0aCB9IGZyb20gXCIuL3NoYXBlcy9QYXRoLmpzXCI7XG5pbXBvcnQgeyBSZWN0IH0gZnJvbSBcIi4vc2hhcGVzL1JlY3QuanNcIjtcbmltcG9ydCB7IFJlZ3VsYXJQb2x5Z29uIH0gZnJvbSBcIi4vc2hhcGVzL1JlZ3VsYXJQb2x5Z29uLmpzXCI7XG5pbXBvcnQgeyBSaW5nIH0gZnJvbSBcIi4vc2hhcGVzL1JpbmcuanNcIjtcbmltcG9ydCB7IFNwcml0ZSB9IGZyb20gXCIuL3NoYXBlcy9TcHJpdGUuanNcIjtcbmltcG9ydCB7IFN0YXIgfSBmcm9tIFwiLi9zaGFwZXMvU3Rhci5qc1wiO1xuaW1wb3J0IHsgVGV4dCB9IGZyb20gXCIuL3NoYXBlcy9UZXh0LmpzXCI7XG5pbXBvcnQgeyBUZXh0UGF0aCB9IGZyb20gXCIuL3NoYXBlcy9UZXh0UGF0aC5qc1wiO1xuaW1wb3J0IHsgVHJhbnNmb3JtZXIgfSBmcm9tIFwiLi9zaGFwZXMvVHJhbnNmb3JtZXIuanNcIjtcbmltcG9ydCB7IFdlZGdlIH0gZnJvbSBcIi4vc2hhcGVzL1dlZGdlLmpzXCI7XG5pbXBvcnQgeyBCbHVyIH0gZnJvbSBcIi4vZmlsdGVycy9CbHVyLmpzXCI7XG5pbXBvcnQgeyBCcmlnaHRlbiB9IGZyb20gXCIuL2ZpbHRlcnMvQnJpZ2h0ZW4uanNcIjtcbmltcG9ydCB7IEJyaWdodG5lc3MgfSBmcm9tIFwiLi9maWx0ZXJzL0JyaWdodG5lc3MuanNcIjtcbmltcG9ydCB7IENvbnRyYXN0IH0gZnJvbSBcIi4vZmlsdGVycy9Db250cmFzdC5qc1wiO1xuaW1wb3J0IHsgRW1ib3NzIH0gZnJvbSBcIi4vZmlsdGVycy9FbWJvc3MuanNcIjtcbmltcG9ydCB7IEVuaGFuY2UgfSBmcm9tIFwiLi9maWx0ZXJzL0VuaGFuY2UuanNcIjtcbmltcG9ydCB7IEdyYXlzY2FsZSB9IGZyb20gXCIuL2ZpbHRlcnMvR3JheXNjYWxlLmpzXCI7XG5pbXBvcnQgeyBIU0wgfSBmcm9tIFwiLi9maWx0ZXJzL0hTTC5qc1wiO1xuaW1wb3J0IHsgSFNWIH0gZnJvbSBcIi4vZmlsdGVycy9IU1YuanNcIjtcbmltcG9ydCB7IEludmVydCB9IGZyb20gXCIuL2ZpbHRlcnMvSW52ZXJ0LmpzXCI7XG5pbXBvcnQgeyBLYWxlaWRvc2NvcGUgfSBmcm9tIFwiLi9maWx0ZXJzL0thbGVpZG9zY29wZS5qc1wiO1xuaW1wb3J0IHsgTWFzayB9IGZyb20gXCIuL2ZpbHRlcnMvTWFzay5qc1wiO1xuaW1wb3J0IHsgTm9pc2UgfSBmcm9tIFwiLi9maWx0ZXJzL05vaXNlLmpzXCI7XG5pbXBvcnQgeyBQaXhlbGF0ZSB9IGZyb20gXCIuL2ZpbHRlcnMvUGl4ZWxhdGUuanNcIjtcbmltcG9ydCB7IFBvc3Rlcml6ZSB9IGZyb20gXCIuL2ZpbHRlcnMvUG9zdGVyaXplLmpzXCI7XG5pbXBvcnQgeyBSR0IgfSBmcm9tIFwiLi9maWx0ZXJzL1JHQi5qc1wiO1xuaW1wb3J0IHsgUkdCQSB9IGZyb20gXCIuL2ZpbHRlcnMvUkdCQS5qc1wiO1xuaW1wb3J0IHsgU2VwaWEgfSBmcm9tIFwiLi9maWx0ZXJzL1NlcGlhLmpzXCI7XG5pbXBvcnQgeyBTb2xhcml6ZSB9IGZyb20gXCIuL2ZpbHRlcnMvU29sYXJpemUuanNcIjtcbmltcG9ydCB7IFRocmVzaG9sZCB9IGZyb20gXCIuL2ZpbHRlcnMvVGhyZXNob2xkLmpzXCI7XG5leHBvcnQgY29uc3QgS29udmEgPSBDb3JlLlV0aWwuX2Fzc2lnbihDb3JlLCB7XG4gICAgQXJjLFxuICAgIEFycm93LFxuICAgIENpcmNsZSxcbiAgICBFbGxpcHNlLFxuICAgIEltYWdlLFxuICAgIExhYmVsLFxuICAgIFRhZyxcbiAgICBMaW5lLFxuICAgIFBhdGgsXG4gICAgUmVjdCxcbiAgICBSZWd1bGFyUG9seWdvbixcbiAgICBSaW5nLFxuICAgIFNwcml0ZSxcbiAgICBTdGFyLFxuICAgIFRleHQsXG4gICAgVGV4dFBhdGgsXG4gICAgVHJhbnNmb3JtZXIsXG4gICAgV2VkZ2UsXG4gICAgRmlsdGVyczoge1xuICAgICAgICBCbHVyLFxuICAgICAgICBCcmlnaHRuZXNzLFxuICAgICAgICBCcmlnaHRlbixcbiAgICAgICAgQ29udHJhc3QsXG4gICAgICAgIEVtYm9zcyxcbiAgICAgICAgRW5oYW5jZSxcbiAgICAgICAgR3JheXNjYWxlLFxuICAgICAgICBIU0wsXG4gICAgICAgIEhTVixcbiAgICAgICAgSW52ZXJ0LFxuICAgICAgICBLYWxlaWRvc2NvcGUsXG4gICAgICAgIE1hc2ssXG4gICAgICAgIE5vaXNlLFxuICAgICAgICBQaXhlbGF0ZSxcbiAgICAgICAgUG9zdGVyaXplLFxuICAgICAgICBSR0IsXG4gICAgICAgIFJHQkEsXG4gICAgICAgIFNlcGlhLFxuICAgICAgICBTb2xhcml6ZSxcbiAgICAgICAgVGhyZXNob2xkLFxuICAgIH0sXG59KTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuZnVuY3Rpb24gQmx1clN0YWNrKCkge1xuICAgIHRoaXMuciA9IDA7XG4gICAgdGhpcy5nID0gMDtcbiAgICB0aGlzLmIgPSAwO1xuICAgIHRoaXMuYSA9IDA7XG4gICAgdGhpcy5uZXh0ID0gbnVsbDtcbn1cbmNvbnN0IG11bF90YWJsZSA9IFtcbiAgICA1MTIsIDUxMiwgNDU2LCA1MTIsIDMyOCwgNDU2LCAzMzUsIDUxMiwgNDA1LCAzMjgsIDI3MSwgNDU2LCAzODgsIDMzNSwgMjkyLFxuICAgIDUxMiwgNDU0LCA0MDUsIDM2NCwgMzI4LCAyOTgsIDI3MSwgNDk2LCA0NTYsIDQyMCwgMzg4LCAzNjAsIDMzNSwgMzEyLCAyOTIsXG4gICAgMjczLCA1MTIsIDQ4MiwgNDU0LCA0MjgsIDQwNSwgMzgzLCAzNjQsIDM0NSwgMzI4LCAzMTIsIDI5OCwgMjg0LCAyNzEsIDI1OSxcbiAgICA0OTYsIDQ3NSwgNDU2LCA0MzcsIDQyMCwgNDA0LCAzODgsIDM3NCwgMzYwLCAzNDcsIDMzNSwgMzIzLCAzMTIsIDMwMiwgMjkyLFxuICAgIDI4MiwgMjczLCAyNjUsIDUxMiwgNDk3LCA0ODIsIDQ2OCwgNDU0LCA0NDEsIDQyOCwgNDE3LCA0MDUsIDM5NCwgMzgzLCAzNzMsXG4gICAgMzY0LCAzNTQsIDM0NSwgMzM3LCAzMjgsIDMyMCwgMzEyLCAzMDUsIDI5OCwgMjkxLCAyODQsIDI3OCwgMjcxLCAyNjUsIDI1OSxcbiAgICA1MDcsIDQ5NiwgNDg1LCA0NzUsIDQ2NSwgNDU2LCA0NDYsIDQzNywgNDI4LCA0MjAsIDQxMiwgNDA0LCAzOTYsIDM4OCwgMzgxLFxuICAgIDM3NCwgMzY3LCAzNjAsIDM1NCwgMzQ3LCAzNDEsIDMzNSwgMzI5LCAzMjMsIDMxOCwgMzEyLCAzMDcsIDMwMiwgMjk3LCAyOTIsXG4gICAgMjg3LCAyODIsIDI3OCwgMjczLCAyNjksIDI2NSwgMjYxLCA1MTIsIDUwNSwgNDk3LCA0ODksIDQ4MiwgNDc1LCA0NjgsIDQ2MSxcbiAgICA0NTQsIDQ0NywgNDQxLCA0MzUsIDQyOCwgNDIyLCA0MTcsIDQxMSwgNDA1LCAzOTksIDM5NCwgMzg5LCAzODMsIDM3OCwgMzczLFxuICAgIDM2OCwgMzY0LCAzNTksIDM1NCwgMzUwLCAzNDUsIDM0MSwgMzM3LCAzMzIsIDMyOCwgMzI0LCAzMjAsIDMxNiwgMzEyLCAzMDksXG4gICAgMzA1LCAzMDEsIDI5OCwgMjk0LCAyOTEsIDI4NywgMjg0LCAyODEsIDI3OCwgMjc0LCAyNzEsIDI2OCwgMjY1LCAyNjIsIDI1OSxcbiAgICAyNTcsIDUwNywgNTAxLCA0OTYsIDQ5MSwgNDg1LCA0ODAsIDQ3NSwgNDcwLCA0NjUsIDQ2MCwgNDU2LCA0NTEsIDQ0NiwgNDQyLFxuICAgIDQzNywgNDMzLCA0MjgsIDQyNCwgNDIwLCA0MTYsIDQxMiwgNDA4LCA0MDQsIDQwMCwgMzk2LCAzOTIsIDM4OCwgMzg1LCAzODEsXG4gICAgMzc3LCAzNzQsIDM3MCwgMzY3LCAzNjMsIDM2MCwgMzU3LCAzNTQsIDM1MCwgMzQ3LCAzNDQsIDM0MSwgMzM4LCAzMzUsIDMzMixcbiAgICAzMjksIDMyNiwgMzIzLCAzMjAsIDMxOCwgMzE1LCAzMTIsIDMxMCwgMzA3LCAzMDQsIDMwMiwgMjk5LCAyOTcsIDI5NCwgMjkyLFxuICAgIDI4OSwgMjg3LCAyODUsIDI4MiwgMjgwLCAyNzgsIDI3NSwgMjczLCAyNzEsIDI2OSwgMjY3LCAyNjUsIDI2MywgMjYxLCAyNTksXG5dO1xuY29uc3Qgc2hnX3RhYmxlID0gW1xuICAgIDksIDExLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxNiwgMTcsIDE3LCAxNywgMTcsIDE3LFxuICAgIDE3LCAxNywgMTgsIDE4LCAxOCwgMTgsIDE4LCAxOCwgMTgsIDE4LCAxOCwgMTksIDE5LCAxOSwgMTksIDE5LCAxOSwgMTksIDE5LFxuICAgIDE5LCAxOSwgMTksIDE5LCAxOSwgMTksIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLFxuICAgIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLFxuICAgIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLFxuICAgIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLFxuICAgIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLFxuICAgIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLFxuICAgIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLFxuICAgIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuICAgIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuICAgIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuICAgIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuICAgIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuXTtcbmZ1bmN0aW9uIGZpbHRlckdhdXNzQmx1clJHQkEoaW1hZ2VEYXRhLCByYWRpdXMpIHtcbiAgICBjb25zdCBwaXhlbHMgPSBpbWFnZURhdGEuZGF0YSwgd2lkdGggPSBpbWFnZURhdGEud2lkdGgsIGhlaWdodCA9IGltYWdlRGF0YS5oZWlnaHQ7XG4gICAgbGV0IHAsIHlpLCB5dywgcl9zdW0sIGdfc3VtLCBiX3N1bSwgYV9zdW0sIHJfb3V0X3N1bSwgZ19vdXRfc3VtLCBiX291dF9zdW0sIGFfb3V0X3N1bSwgcl9pbl9zdW0sIGdfaW5fc3VtLCBiX2luX3N1bSwgYV9pbl9zdW0sIHByLCBwZywgcGIsIHBhLCByYnM7XG4gICAgY29uc3QgZGl2ID0gcmFkaXVzICsgcmFkaXVzICsgMSwgd2lkdGhNaW51czEgPSB3aWR0aCAtIDEsIGhlaWdodE1pbnVzMSA9IGhlaWdodCAtIDEsIHJhZGl1c1BsdXMxID0gcmFkaXVzICsgMSwgc3VtRmFjdG9yID0gKHJhZGl1c1BsdXMxICogKHJhZGl1c1BsdXMxICsgMSkpIC8gMiwgc3RhY2tTdGFydCA9IG5ldyBCbHVyU3RhY2soKSwgbXVsX3N1bSA9IG11bF90YWJsZVtyYWRpdXNdLCBzaGdfc3VtID0gc2hnX3RhYmxlW3JhZGl1c107XG4gICAgbGV0IHN0YWNrRW5kID0gbnVsbCwgc3RhY2sgPSBzdGFja1N0YXJ0LCBzdGFja0luID0gbnVsbCwgc3RhY2tPdXQgPSBudWxsO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZGl2OyBpKyspIHtcbiAgICAgICAgc3RhY2sgPSBzdGFjay5uZXh0ID0gbmV3IEJsdXJTdGFjaygpO1xuICAgICAgICBpZiAoaSA9PT0gcmFkaXVzUGx1czEpIHtcbiAgICAgICAgICAgIHN0YWNrRW5kID0gc3RhY2s7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhY2submV4dCA9IHN0YWNrU3RhcnQ7XG4gICAgeXcgPSB5aSA9IDA7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgICAgICByX2luX3N1bSA9XG4gICAgICAgICAgICBnX2luX3N1bSA9XG4gICAgICAgICAgICAgICAgYl9pbl9zdW0gPVxuICAgICAgICAgICAgICAgICAgICBhX2luX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICByX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ19zdW0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMDtcbiAgICAgICAgcl9vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAocHIgPSBwaXhlbHNbeWldKTtcbiAgICAgICAgZ19vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAocGcgPSBwaXhlbHNbeWkgKyAxXSk7XG4gICAgICAgIGJfb3V0X3N1bSA9IHJhZGl1c1BsdXMxICogKHBiID0gcGl4ZWxzW3lpICsgMl0pO1xuICAgICAgICBhX291dF9zdW0gPSByYWRpdXNQbHVzMSAqIChwYSA9IHBpeGVsc1t5aSArIDNdKTtcbiAgICAgICAgcl9zdW0gKz0gc3VtRmFjdG9yICogcHI7XG4gICAgICAgIGdfc3VtICs9IHN1bUZhY3RvciAqIHBnO1xuICAgICAgICBiX3N1bSArPSBzdW1GYWN0b3IgKiBwYjtcbiAgICAgICAgYV9zdW0gKz0gc3VtRmFjdG9yICogcGE7XG4gICAgICAgIHN0YWNrID0gc3RhY2tTdGFydDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpdXNQbHVzMTsgaSsrKSB7XG4gICAgICAgICAgICBzdGFjay5yID0gcHI7XG4gICAgICAgICAgICBzdGFjay5nID0gcGc7XG4gICAgICAgICAgICBzdGFjay5iID0gcGI7XG4gICAgICAgICAgICBzdGFjay5hID0gcGE7XG4gICAgICAgICAgICBzdGFjayA9IHN0YWNrLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCByYWRpdXNQbHVzMTsgaSsrKSB7XG4gICAgICAgICAgICBwID0geWkgKyAoKHdpZHRoTWludXMxIDwgaSA/IHdpZHRoTWludXMxIDogaSkgPDwgMik7XG4gICAgICAgICAgICByX3N1bSArPSAoc3RhY2suciA9IHByID0gcGl4ZWxzW3BdKSAqIChyYnMgPSByYWRpdXNQbHVzMSAtIGkpO1xuICAgICAgICAgICAgZ19zdW0gKz0gKHN0YWNrLmcgPSBwZyA9IHBpeGVsc1twICsgMV0pICogcmJzO1xuICAgICAgICAgICAgYl9zdW0gKz0gKHN0YWNrLmIgPSBwYiA9IHBpeGVsc1twICsgMl0pICogcmJzO1xuICAgICAgICAgICAgYV9zdW0gKz0gKHN0YWNrLmEgPSBwYSA9IHBpeGVsc1twICsgM10pICogcmJzO1xuICAgICAgICAgICAgcl9pbl9zdW0gKz0gcHI7XG4gICAgICAgICAgICBnX2luX3N1bSArPSBwZztcbiAgICAgICAgICAgIGJfaW5fc3VtICs9IHBiO1xuICAgICAgICAgICAgYV9pbl9zdW0gKz0gcGE7XG4gICAgICAgICAgICBzdGFjayA9IHN0YWNrLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgc3RhY2tJbiA9IHN0YWNrU3RhcnQ7XG4gICAgICAgIHN0YWNrT3V0ID0gc3RhY2tFbmQ7XG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgICAgICAgcGl4ZWxzW3lpICsgM10gPSBwYSA9IChhX3N1bSAqIG11bF9zdW0pID4+IHNoZ19zdW07XG4gICAgICAgICAgICBpZiAocGEgIT09IDApIHtcbiAgICAgICAgICAgICAgICBwYSA9IDI1NSAvIHBhO1xuICAgICAgICAgICAgICAgIHBpeGVsc1t5aV0gPSAoKHJfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bSkgKiBwYTtcbiAgICAgICAgICAgICAgICBwaXhlbHNbeWkgKyAxXSA9ICgoZ19zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtKSAqIHBhO1xuICAgICAgICAgICAgICAgIHBpeGVsc1t5aSArIDJdID0gKChiX3N1bSAqIG11bF9zdW0pID4+IHNoZ19zdW0pICogcGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwaXhlbHNbeWldID0gcGl4ZWxzW3lpICsgMV0gPSBwaXhlbHNbeWkgKyAyXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByX3N1bSAtPSByX291dF9zdW07XG4gICAgICAgICAgICBnX3N1bSAtPSBnX291dF9zdW07XG4gICAgICAgICAgICBiX3N1bSAtPSBiX291dF9zdW07XG4gICAgICAgICAgICBhX3N1bSAtPSBhX291dF9zdW07XG4gICAgICAgICAgICByX291dF9zdW0gLT0gc3RhY2tJbi5yO1xuICAgICAgICAgICAgZ19vdXRfc3VtIC09IHN0YWNrSW4uZztcbiAgICAgICAgICAgIGJfb3V0X3N1bSAtPSBzdGFja0luLmI7XG4gICAgICAgICAgICBhX291dF9zdW0gLT0gc3RhY2tJbi5hO1xuICAgICAgICAgICAgcCA9ICh5dyArICgocCA9IHggKyByYWRpdXMgKyAxKSA8IHdpZHRoTWludXMxID8gcCA6IHdpZHRoTWludXMxKSkgPDwgMjtcbiAgICAgICAgICAgIHJfaW5fc3VtICs9IHN0YWNrSW4uciA9IHBpeGVsc1twXTtcbiAgICAgICAgICAgIGdfaW5fc3VtICs9IHN0YWNrSW4uZyA9IHBpeGVsc1twICsgMV07XG4gICAgICAgICAgICBiX2luX3N1bSArPSBzdGFja0luLmIgPSBwaXhlbHNbcCArIDJdO1xuICAgICAgICAgICAgYV9pbl9zdW0gKz0gc3RhY2tJbi5hID0gcGl4ZWxzW3AgKyAzXTtcbiAgICAgICAgICAgIHJfc3VtICs9IHJfaW5fc3VtO1xuICAgICAgICAgICAgZ19zdW0gKz0gZ19pbl9zdW07XG4gICAgICAgICAgICBiX3N1bSArPSBiX2luX3N1bTtcbiAgICAgICAgICAgIGFfc3VtICs9IGFfaW5fc3VtO1xuICAgICAgICAgICAgc3RhY2tJbiA9IHN0YWNrSW4ubmV4dDtcbiAgICAgICAgICAgIHJfb3V0X3N1bSArPSBwciA9IHN0YWNrT3V0LnI7XG4gICAgICAgICAgICBnX291dF9zdW0gKz0gcGcgPSBzdGFja091dC5nO1xuICAgICAgICAgICAgYl9vdXRfc3VtICs9IHBiID0gc3RhY2tPdXQuYjtcbiAgICAgICAgICAgIGFfb3V0X3N1bSArPSBwYSA9IHN0YWNrT3V0LmE7XG4gICAgICAgICAgICByX2luX3N1bSAtPSBwcjtcbiAgICAgICAgICAgIGdfaW5fc3VtIC09IHBnO1xuICAgICAgICAgICAgYl9pbl9zdW0gLT0gcGI7XG4gICAgICAgICAgICBhX2luX3N1bSAtPSBwYTtcbiAgICAgICAgICAgIHN0YWNrT3V0ID0gc3RhY2tPdXQubmV4dDtcbiAgICAgICAgICAgIHlpICs9IDQ7XG4gICAgICAgIH1cbiAgICAgICAgeXcgKz0gd2lkdGg7XG4gICAgfVxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgICBnX2luX3N1bSA9XG4gICAgICAgICAgICBiX2luX3N1bSA9XG4gICAgICAgICAgICAgICAgYV9pbl9zdW0gPVxuICAgICAgICAgICAgICAgICAgICByX2luX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBnX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYl9zdW0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByX3N1bSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMDtcbiAgICAgICAgeWkgPSB4IDw8IDI7XG4gICAgICAgIHJfb3V0X3N1bSA9IHJhZGl1c1BsdXMxICogKHByID0gcGl4ZWxzW3lpXSk7XG4gICAgICAgIGdfb3V0X3N1bSA9IHJhZGl1c1BsdXMxICogKHBnID0gcGl4ZWxzW3lpICsgMV0pO1xuICAgICAgICBiX291dF9zdW0gPSByYWRpdXNQbHVzMSAqIChwYiA9IHBpeGVsc1t5aSArIDJdKTtcbiAgICAgICAgYV9vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAocGEgPSBwaXhlbHNbeWkgKyAzXSk7XG4gICAgICAgIHJfc3VtICs9IHN1bUZhY3RvciAqIHByO1xuICAgICAgICBnX3N1bSArPSBzdW1GYWN0b3IgKiBwZztcbiAgICAgICAgYl9zdW0gKz0gc3VtRmFjdG9yICogcGI7XG4gICAgICAgIGFfc3VtICs9IHN1bUZhY3RvciAqIHBhO1xuICAgICAgICBzdGFjayA9IHN0YWNrU3RhcnQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFkaXVzUGx1czE7IGkrKykge1xuICAgICAgICAgICAgc3RhY2suciA9IHByO1xuICAgICAgICAgICAgc3RhY2suZyA9IHBnO1xuICAgICAgICAgICAgc3RhY2suYiA9IHBiO1xuICAgICAgICAgICAgc3RhY2suYSA9IHBhO1xuICAgICAgICAgICAgc3RhY2sgPSBzdGFjay5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGxldCB5cCA9IHdpZHRoO1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSByYWRpdXM7IGkrKykge1xuICAgICAgICAgICAgeWkgPSAoeXAgKyB4KSA8PCAyO1xuICAgICAgICAgICAgcl9zdW0gKz0gKHN0YWNrLnIgPSBwciA9IHBpeGVsc1t5aV0pICogKHJicyA9IHJhZGl1c1BsdXMxIC0gaSk7XG4gICAgICAgICAgICBnX3N1bSArPSAoc3RhY2suZyA9IHBnID0gcGl4ZWxzW3lpICsgMV0pICogcmJzO1xuICAgICAgICAgICAgYl9zdW0gKz0gKHN0YWNrLmIgPSBwYiA9IHBpeGVsc1t5aSArIDJdKSAqIHJicztcbiAgICAgICAgICAgIGFfc3VtICs9IChzdGFjay5hID0gcGEgPSBwaXhlbHNbeWkgKyAzXSkgKiByYnM7XG4gICAgICAgICAgICByX2luX3N1bSArPSBwcjtcbiAgICAgICAgICAgIGdfaW5fc3VtICs9IHBnO1xuICAgICAgICAgICAgYl9pbl9zdW0gKz0gcGI7XG4gICAgICAgICAgICBhX2luX3N1bSArPSBwYTtcbiAgICAgICAgICAgIHN0YWNrID0gc3RhY2submV4dDtcbiAgICAgICAgICAgIGlmIChpIDwgaGVpZ2h0TWludXMxKSB7XG4gICAgICAgICAgICAgICAgeXAgKz0gd2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgeWkgPSB4O1xuICAgICAgICBzdGFja0luID0gc3RhY2tTdGFydDtcbiAgICAgICAgc3RhY2tPdXQgPSBzdGFja0VuZDtcbiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgcCA9IHlpIDw8IDI7XG4gICAgICAgICAgICBwaXhlbHNbcCArIDNdID0gcGEgPSAoYV9zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtO1xuICAgICAgICAgICAgaWYgKHBhID4gMCkge1xuICAgICAgICAgICAgICAgIHBhID0gMjU1IC8gcGE7XG4gICAgICAgICAgICAgICAgcGl4ZWxzW3BdID0gKChyX3N1bSAqIG11bF9zdW0pID4+IHNoZ19zdW0pICogcGE7XG4gICAgICAgICAgICAgICAgcGl4ZWxzW3AgKyAxXSA9ICgoZ19zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtKSAqIHBhO1xuICAgICAgICAgICAgICAgIHBpeGVsc1twICsgMl0gPSAoKGJfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bSkgKiBwYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBpeGVsc1twXSA9IHBpeGVsc1twICsgMV0gPSBwaXhlbHNbcCArIDJdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJfc3VtIC09IHJfb3V0X3N1bTtcbiAgICAgICAgICAgIGdfc3VtIC09IGdfb3V0X3N1bTtcbiAgICAgICAgICAgIGJfc3VtIC09IGJfb3V0X3N1bTtcbiAgICAgICAgICAgIGFfc3VtIC09IGFfb3V0X3N1bTtcbiAgICAgICAgICAgIHJfb3V0X3N1bSAtPSBzdGFja0luLnI7XG4gICAgICAgICAgICBnX291dF9zdW0gLT0gc3RhY2tJbi5nO1xuICAgICAgICAgICAgYl9vdXRfc3VtIC09IHN0YWNrSW4uYjtcbiAgICAgICAgICAgIGFfb3V0X3N1bSAtPSBzdGFja0luLmE7XG4gICAgICAgICAgICBwID1cbiAgICAgICAgICAgICAgICAoeCArXG4gICAgICAgICAgICAgICAgICAgICgocCA9IHkgKyByYWRpdXNQbHVzMSkgPCBoZWlnaHRNaW51czEgPyBwIDogaGVpZ2h0TWludXMxKSAqIHdpZHRoKSA8PFxuICAgICAgICAgICAgICAgICAgICAyO1xuICAgICAgICAgICAgcl9zdW0gKz0gcl9pbl9zdW0gKz0gc3RhY2tJbi5yID0gcGl4ZWxzW3BdO1xuICAgICAgICAgICAgZ19zdW0gKz0gZ19pbl9zdW0gKz0gc3RhY2tJbi5nID0gcGl4ZWxzW3AgKyAxXTtcbiAgICAgICAgICAgIGJfc3VtICs9IGJfaW5fc3VtICs9IHN0YWNrSW4uYiA9IHBpeGVsc1twICsgMl07XG4gICAgICAgICAgICBhX3N1bSArPSBhX2luX3N1bSArPSBzdGFja0luLmEgPSBwaXhlbHNbcCArIDNdO1xuICAgICAgICAgICAgc3RhY2tJbiA9IHN0YWNrSW4ubmV4dDtcbiAgICAgICAgICAgIHJfb3V0X3N1bSArPSBwciA9IHN0YWNrT3V0LnI7XG4gICAgICAgICAgICBnX291dF9zdW0gKz0gcGcgPSBzdGFja091dC5nO1xuICAgICAgICAgICAgYl9vdXRfc3VtICs9IHBiID0gc3RhY2tPdXQuYjtcbiAgICAgICAgICAgIGFfb3V0X3N1bSArPSBwYSA9IHN0YWNrT3V0LmE7XG4gICAgICAgICAgICByX2luX3N1bSAtPSBwcjtcbiAgICAgICAgICAgIGdfaW5fc3VtIC09IHBnO1xuICAgICAgICAgICAgYl9pbl9zdW0gLT0gcGI7XG4gICAgICAgICAgICBhX2luX3N1bSAtPSBwYTtcbiAgICAgICAgICAgIHN0YWNrT3V0ID0gc3RhY2tPdXQubmV4dDtcbiAgICAgICAgICAgIHlpICs9IHdpZHRoO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IEJsdXIgPSBmdW5jdGlvbiBCbHVyKGltYWdlRGF0YSkge1xuICAgIGNvbnN0IHJhZGl1cyA9IE1hdGgucm91bmQodGhpcy5ibHVyUmFkaXVzKCkpO1xuICAgIGlmIChyYWRpdXMgPiAwKSB7XG4gICAgICAgIGZpbHRlckdhdXNzQmx1clJHQkEoaW1hZ2VEYXRhLCByYWRpdXMpO1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnYmx1clJhZGl1cycsIDAsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuZXhwb3J0IGNvbnN0IEJyaWdodGVuID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgIGNvbnN0IGJyaWdodG5lc3MgPSB0aGlzLmJyaWdodG5lc3MoKSAqIDI1NSwgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBsZW4gPSBkYXRhLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XG4gICAgICAgIGRhdGFbaV0gKz0gYnJpZ2h0bmVzcztcbiAgICAgICAgZGF0YVtpICsgMV0gKz0gYnJpZ2h0bmVzcztcbiAgICAgICAgZGF0YVtpICsgMl0gKz0gYnJpZ2h0bmVzcztcbiAgICB9XG59O1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2JyaWdodG5lc3MnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJleHBvcnQgY29uc3QgQnJpZ2h0bmVzcyA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICBjb25zdCBicmlnaHRuZXNzID0gdGhpcy5icmlnaHRuZXNzKCksIGRhdGEgPSBpbWFnZURhdGEuZGF0YSwgbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgICAgICBkYXRhW2ldID0gTWF0aC5taW4oMjU1LCBkYXRhW2ldICogYnJpZ2h0bmVzcyk7XG4gICAgICAgIGRhdGFbaSArIDFdID0gTWF0aC5taW4oMjU1LCBkYXRhW2kgKyAxXSAqIGJyaWdodG5lc3MpO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IE1hdGgubWluKDI1NSwgZGF0YVtpICsgMl0gKiBicmlnaHRuZXNzKTtcbiAgICB9XG59O1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5leHBvcnQgY29uc3QgQ29udHJhc3QgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgYWRqdXN0ID0gTWF0aC5wb3coKHRoaXMuY29udHJhc3QoKSArIDEwMCkgLyAxMDAsIDIpO1xuICAgIGNvbnN0IGRhdGEgPSBpbWFnZURhdGEuZGF0YSwgblBpeGVscyA9IGRhdGEubGVuZ3RoO1xuICAgIGxldCByZWQgPSAxNTAsIGdyZWVuID0gMTUwLCBibHVlID0gMTUwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgblBpeGVsczsgaSArPSA0KSB7XG4gICAgICAgIHJlZCA9IGRhdGFbaV07XG4gICAgICAgIGdyZWVuID0gZGF0YVtpICsgMV07XG4gICAgICAgIGJsdWUgPSBkYXRhW2kgKyAyXTtcbiAgICAgICAgcmVkIC89IDI1NTtcbiAgICAgICAgcmVkIC09IDAuNTtcbiAgICAgICAgcmVkICo9IGFkanVzdDtcbiAgICAgICAgcmVkICs9IDAuNTtcbiAgICAgICAgcmVkICo9IDI1NTtcbiAgICAgICAgZ3JlZW4gLz0gMjU1O1xuICAgICAgICBncmVlbiAtPSAwLjU7XG4gICAgICAgIGdyZWVuICo9IGFkanVzdDtcbiAgICAgICAgZ3JlZW4gKz0gMC41O1xuICAgICAgICBncmVlbiAqPSAyNTU7XG4gICAgICAgIGJsdWUgLz0gMjU1O1xuICAgICAgICBibHVlIC09IDAuNTtcbiAgICAgICAgYmx1ZSAqPSBhZGp1c3Q7XG4gICAgICAgIGJsdWUgKz0gMC41O1xuICAgICAgICBibHVlICo9IDI1NTtcbiAgICAgICAgcmVkID0gcmVkIDwgMCA/IDAgOiByZWQgPiAyNTUgPyAyNTUgOiByZWQ7XG4gICAgICAgIGdyZWVuID0gZ3JlZW4gPCAwID8gMCA6IGdyZWVuID4gMjU1ID8gMjU1IDogZ3JlZW47XG4gICAgICAgIGJsdWUgPSBibHVlIDwgMCA/IDAgOiBibHVlID4gMjU1ID8gMjU1IDogYmx1ZTtcbiAgICAgICAgZGF0YVtpXSA9IHJlZDtcbiAgICAgICAgZGF0YVtpICsgMV0gPSBncmVlbjtcbiAgICAgICAgZGF0YVtpICsgMl0gPSBibHVlO1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnY29udHJhc3QnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmV4cG9ydCBjb25zdCBFbWJvc3MgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaCwgX2o7XG4gICAgY29uc3QgZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuICAgIGNvbnN0IHcgPSBpbWFnZURhdGEud2lkdGg7XG4gICAgY29uc3QgaCA9IGltYWdlRGF0YS5oZWlnaHQ7XG4gICAgY29uc3Qgc3RyZW5ndGgwMSA9IE1hdGgubWluKDEsIE1hdGgubWF4KDAsIChfYiA9IChfYSA9IHRoaXMuZW1ib3NzU3RyZW5ndGgpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKHRoaXMpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAwLjUpKTtcbiAgICBjb25zdCB3aGl0ZUxldmVsMDEgPSBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCAoX2QgPSAoX2MgPSB0aGlzLmVtYm9zc1doaXRlTGV2ZWwpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKHRoaXMpKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiAwLjUpKTtcbiAgICBjb25zdCBkaXJlY3Rpb25NYXAgPSB7XG4gICAgICAgICd0b3AtbGVmdCc6IDMxNSxcbiAgICAgICAgdG9wOiAyNzAsXG4gICAgICAgICd0b3AtcmlnaHQnOiAyMjUsXG4gICAgICAgIHJpZ2h0OiAxODAsXG4gICAgICAgICdib3R0b20tcmlnaHQnOiAxMzUsXG4gICAgICAgIGJvdHRvbTogOTAsXG4gICAgICAgICdib3R0b20tbGVmdCc6IDQ1LFxuICAgICAgICBsZWZ0OiAwLFxuICAgIH07XG4gICAgY29uc3QgZGlyZWN0aW9uRGVnID0gKF9nID0gZGlyZWN0aW9uTWFwWyhfZiA9IChfZSA9IHRoaXMuZW1ib3NzRGlyZWN0aW9uKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UuY2FsbCh0aGlzKSkgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDogJ3RvcC1sZWZ0J10pICE9PSBudWxsICYmIF9nICE9PSB2b2lkIDAgPyBfZyA6IDMxNTtcbiAgICBjb25zdCBibGVuZCA9ICEhKChfaiA9IChfaCA9IHRoaXMuZW1ib3NzQmxlbmQpID09PSBudWxsIHx8IF9oID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaC5jYWxsKHRoaXMpKSAhPT0gbnVsbCAmJiBfaiAhPT0gdm9pZCAwID8gX2ogOiBmYWxzZSk7XG4gICAgY29uc3Qgc3RyZW5ndGggPSBzdHJlbmd0aDAxICogMTA7XG4gICAgY29uc3QgYmlhcyA9IHdoaXRlTGV2ZWwwMSAqIDI1NTtcbiAgICBjb25zdCBkaXJSYWQgPSAoZGlyZWN0aW9uRGVnICogTWF0aC5QSSkgLyAxODA7XG4gICAgY29uc3QgY3ggPSBNYXRoLmNvcyhkaXJSYWQpO1xuICAgIGNvbnN0IGN5ID0gTWF0aC5zaW4oZGlyUmFkKTtcbiAgICBjb25zdCBTQ0FMRSA9ICgxMjggLyAxMDIwKSAqIHN0cmVuZ3RoO1xuICAgIGNvbnN0IHNyYyA9IG5ldyBVaW50OENsYW1wZWRBcnJheShkYXRhKTtcbiAgICBjb25zdCBsdW0gPSBuZXcgRmxvYXQzMkFycmF5KHcgKiBoKTtcbiAgICBmb3IgKGxldCBwID0gMCwgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSA0LCBwKyspIHtcbiAgICAgICAgbHVtW3BdID0gMC4yMTI2ICogc3JjW2ldICsgMC43MTUyICogc3JjW2kgKyAxXSArIDAuMDcyMiAqIHNyY1tpICsgMl07XG4gICAgfVxuICAgIGNvbnN0IEd4ID0gWy0xLCAwLCAxLCAtMiwgMCwgMiwgLTEsIDAsIDFdO1xuICAgIGNvbnN0IEd5ID0gWy0xLCAtMiwgLTEsIDAsIDAsIDAsIDEsIDIsIDFdO1xuICAgIGNvbnN0IE9GRiA9IFstdyAtIDEsIC13LCAtdyArIDEsIC0xLCAwLCAxLCB3IC0gMSwgdywgdyArIDFdO1xuICAgIGNvbnN0IGNsYW1wOCA9ICh2KSA9PiAodiA8IDAgPyAwIDogdiA+IDI1NSA/IDI1NSA6IHYpO1xuICAgIGZvciAobGV0IHkgPSAxOyB5IDwgaCAtIDE7IHkrKykge1xuICAgICAgICBmb3IgKGxldCB4ID0gMTsgeCA8IHcgLSAxOyB4KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSB5ICogdyArIHg7XG4gICAgICAgICAgICBsZXQgc3ggPSAwLCBzeSA9IDA7XG4gICAgICAgICAgICBzeCArPSBsdW1bcCArIE9GRlswXV0gKiBHeFswXTtcbiAgICAgICAgICAgIHN5ICs9IGx1bVtwICsgT0ZGWzBdXSAqIEd5WzBdO1xuICAgICAgICAgICAgc3ggKz0gbHVtW3AgKyBPRkZbMV1dICogR3hbMV07XG4gICAgICAgICAgICBzeSArPSBsdW1bcCArIE9GRlsxXV0gKiBHeVsxXTtcbiAgICAgICAgICAgIHN4ICs9IGx1bVtwICsgT0ZGWzJdXSAqIEd4WzJdO1xuICAgICAgICAgICAgc3kgKz0gbHVtW3AgKyBPRkZbMl1dICogR3lbMl07XG4gICAgICAgICAgICBzeCArPSBsdW1bcCArIE9GRlszXV0gKiBHeFszXTtcbiAgICAgICAgICAgIHN5ICs9IGx1bVtwICsgT0ZGWzNdXSAqIEd5WzNdO1xuICAgICAgICAgICAgc3ggKz0gbHVtW3AgKyBPRkZbNV1dICogR3hbNV07XG4gICAgICAgICAgICBzeSArPSBsdW1bcCArIE9GRls1XV0gKiBHeVs1XTtcbiAgICAgICAgICAgIHN4ICs9IGx1bVtwICsgT0ZGWzZdXSAqIEd4WzZdO1xuICAgICAgICAgICAgc3kgKz0gbHVtW3AgKyBPRkZbNl1dICogR3lbNl07XG4gICAgICAgICAgICBzeCArPSBsdW1bcCArIE9GRls3XV0gKiBHeFs3XTtcbiAgICAgICAgICAgIHN5ICs9IGx1bVtwICsgT0ZGWzddXSAqIEd5WzddO1xuICAgICAgICAgICAgc3ggKz0gbHVtW3AgKyBPRkZbOF1dICogR3hbOF07XG4gICAgICAgICAgICBzeSArPSBsdW1bcCArIE9GRls4XV0gKiBHeVs4XTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBjeCAqIHN4ICsgY3kgKiBzeTtcbiAgICAgICAgICAgIGNvbnN0IG91dEdyYXkgPSBjbGFtcDgoYmlhcyArIHIgKiBTQ0FMRSk7XG4gICAgICAgICAgICBjb25zdCBvID0gcCAqIDQ7XG4gICAgICAgICAgICBpZiAoYmxlbmQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWx0YSA9IG91dEdyYXkgLSBiaWFzO1xuICAgICAgICAgICAgICAgIGRhdGFbb10gPSBjbGFtcDgoc3JjW29dICsgZGVsdGEpO1xuICAgICAgICAgICAgICAgIGRhdGFbbyArIDFdID0gY2xhbXA4KHNyY1tvICsgMV0gKyBkZWx0YSk7XG4gICAgICAgICAgICAgICAgZGF0YVtvICsgMl0gPSBjbGFtcDgoc3JjW28gKyAyXSArIGRlbHRhKTtcbiAgICAgICAgICAgICAgICBkYXRhW28gKyAzXSA9IHNyY1tvICsgM107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkYXRhW29dID0gZGF0YVtvICsgMV0gPSBkYXRhW28gKyAyXSA9IG91dEdyYXk7XG4gICAgICAgICAgICAgICAgZGF0YVtvICsgM10gPSBzcmNbbyArIDNdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgdzsgeCsrKSB7XG4gICAgICAgIGxldCBvVG9wID0geCAqIDQsIG9Cb3QgPSAoKGggLSAxKSAqIHcgKyB4KSAqIDQ7XG4gICAgICAgIGRhdGFbb1RvcF0gPSBzcmNbb1RvcF07XG4gICAgICAgIGRhdGFbb1RvcCArIDFdID0gc3JjW29Ub3AgKyAxXTtcbiAgICAgICAgZGF0YVtvVG9wICsgMl0gPSBzcmNbb1RvcCArIDJdO1xuICAgICAgICBkYXRhW29Ub3AgKyAzXSA9IHNyY1tvVG9wICsgM107XG4gICAgICAgIGRhdGFbb0JvdF0gPSBzcmNbb0JvdF07XG4gICAgICAgIGRhdGFbb0JvdCArIDFdID0gc3JjW29Cb3QgKyAxXTtcbiAgICAgICAgZGF0YVtvQm90ICsgMl0gPSBzcmNbb0JvdCArIDJdO1xuICAgICAgICBkYXRhW29Cb3QgKyAzXSA9IHNyY1tvQm90ICsgM107XG4gICAgfVxuICAgIGZvciAobGV0IHkgPSAxOyB5IDwgaCAtIDE7IHkrKykge1xuICAgICAgICBsZXQgb0wgPSB5ICogdyAqIDQsIG9SID0gKHkgKiB3ICsgKHcgLSAxKSkgKiA0O1xuICAgICAgICBkYXRhW29MXSA9IHNyY1tvTF07XG4gICAgICAgIGRhdGFbb0wgKyAxXSA9IHNyY1tvTCArIDFdO1xuICAgICAgICBkYXRhW29MICsgMl0gPSBzcmNbb0wgKyAyXTtcbiAgICAgICAgZGF0YVtvTCArIDNdID0gc3JjW29MICsgM107XG4gICAgICAgIGRhdGFbb1JdID0gc3JjW29SXTtcbiAgICAgICAgZGF0YVtvUiArIDFdID0gc3JjW29SICsgMV07XG4gICAgICAgIGRhdGFbb1IgKyAyXSA9IHNyY1tvUiArIDJdO1xuICAgICAgICBkYXRhW29SICsgM10gPSBzcmNbb1IgKyAzXTtcbiAgICB9XG4gICAgcmV0dXJuIGltYWdlRGF0YTtcbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnZW1ib3NzU3RyZW5ndGgnLCAwLjUsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdlbWJvc3NXaGl0ZUxldmVsJywgMC41LCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnZW1ib3NzRGlyZWN0aW9uJywgJ3RvcC1sZWZ0JywgdW5kZWZpbmVkLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdlbWJvc3NCbGVuZCcsIGZhbHNlLCB1bmRlZmluZWQsIEZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5mdW5jdGlvbiByZW1hcChmcm9tVmFsdWUsIGZyb21NaW4sIGZyb21NYXgsIHRvTWluLCB0b01heCkge1xuICAgIGNvbnN0IGZyb21SYW5nZSA9IGZyb21NYXggLSBmcm9tTWluLCB0b1JhbmdlID0gdG9NYXggLSB0b01pbjtcbiAgICBpZiAoZnJvbVJhbmdlID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0b01pbiArIHRvUmFuZ2UgLyAyO1xuICAgIH1cbiAgICBpZiAodG9SYW5nZSA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdG9NaW47XG4gICAgfVxuICAgIGxldCB0b1ZhbHVlID0gKGZyb21WYWx1ZSAtIGZyb21NaW4pIC8gZnJvbVJhbmdlO1xuICAgIHRvVmFsdWUgPSB0b1JhbmdlICogdG9WYWx1ZSArIHRvTWluO1xuICAgIHJldHVybiB0b1ZhbHVlO1xufVxuZXhwb3J0IGNvbnN0IEVuaGFuY2UgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBuU3ViUGl4ZWxzID0gZGF0YS5sZW5ndGg7XG4gICAgbGV0IHJNaW4gPSBkYXRhWzBdLCByTWF4ID0gck1pbiwgciwgZ01pbiA9IGRhdGFbMV0sIGdNYXggPSBnTWluLCBnLCBiTWluID0gZGF0YVsyXSwgYk1heCA9IGJNaW4sIGI7XG4gICAgY29uc3QgZW5oYW5jZUFtb3VudCA9IHRoaXMuZW5oYW5jZSgpO1xuICAgIGlmIChlbmhhbmNlQW1vdW50ID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuU3ViUGl4ZWxzOyBpICs9IDQpIHtcbiAgICAgICAgciA9IGRhdGFbaSArIDBdO1xuICAgICAgICBpZiAociA8IHJNaW4pIHtcbiAgICAgICAgICAgIHJNaW4gPSByO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHIgPiByTWF4KSB7XG4gICAgICAgICAgICByTWF4ID0gcjtcbiAgICAgICAgfVxuICAgICAgICBnID0gZGF0YVtpICsgMV07XG4gICAgICAgIGlmIChnIDwgZ01pbikge1xuICAgICAgICAgICAgZ01pbiA9IGc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZyA+IGdNYXgpIHtcbiAgICAgICAgICAgIGdNYXggPSBnO1xuICAgICAgICB9XG4gICAgICAgIGIgPSBkYXRhW2kgKyAyXTtcbiAgICAgICAgaWYgKGIgPCBiTWluKSB7XG4gICAgICAgICAgICBiTWluID0gYjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChiID4gYk1heCkge1xuICAgICAgICAgICAgYk1heCA9IGI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJNYXggPT09IHJNaW4pIHtcbiAgICAgICAgck1heCA9IDI1NTtcbiAgICAgICAgck1pbiA9IDA7XG4gICAgfVxuICAgIGlmIChnTWF4ID09PSBnTWluKSB7XG4gICAgICAgIGdNYXggPSAyNTU7XG4gICAgICAgIGdNaW4gPSAwO1xuICAgIH1cbiAgICBpZiAoYk1heCA9PT0gYk1pbikge1xuICAgICAgICBiTWF4ID0gMjU1O1xuICAgICAgICBiTWluID0gMDtcbiAgICB9XG4gICAgbGV0IHJHb2FsTWF4LCByR29hbE1pbiwgZ0dvYWxNYXgsIGdHb2FsTWluLCBiR29hbE1heCwgYkdvYWxNaW47XG4gICAgaWYgKGVuaGFuY2VBbW91bnQgPiAwKSB7XG4gICAgICAgIHJHb2FsTWF4ID0gck1heCArIGVuaGFuY2VBbW91bnQgKiAoMjU1IC0gck1heCk7XG4gICAgICAgIHJHb2FsTWluID0gck1pbiAtIGVuaGFuY2VBbW91bnQgKiAock1pbiAtIDApO1xuICAgICAgICBnR29hbE1heCA9IGdNYXggKyBlbmhhbmNlQW1vdW50ICogKDI1NSAtIGdNYXgpO1xuICAgICAgICBnR29hbE1pbiA9IGdNaW4gLSBlbmhhbmNlQW1vdW50ICogKGdNaW4gLSAwKTtcbiAgICAgICAgYkdvYWxNYXggPSBiTWF4ICsgZW5oYW5jZUFtb3VudCAqICgyNTUgLSBiTWF4KTtcbiAgICAgICAgYkdvYWxNaW4gPSBiTWluIC0gZW5oYW5jZUFtb3VudCAqIChiTWluIC0gMCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCByTWlkID0gKHJNYXggKyByTWluKSAqIDAuNTtcbiAgICAgICAgckdvYWxNYXggPSByTWF4ICsgZW5oYW5jZUFtb3VudCAqIChyTWF4IC0gck1pZCk7XG4gICAgICAgIHJHb2FsTWluID0gck1pbiArIGVuaGFuY2VBbW91bnQgKiAock1pbiAtIHJNaWQpO1xuICAgICAgICBjb25zdCBnTWlkID0gKGdNYXggKyBnTWluKSAqIDAuNTtcbiAgICAgICAgZ0dvYWxNYXggPSBnTWF4ICsgZW5oYW5jZUFtb3VudCAqIChnTWF4IC0gZ01pZCk7XG4gICAgICAgIGdHb2FsTWluID0gZ01pbiArIGVuaGFuY2VBbW91bnQgKiAoZ01pbiAtIGdNaWQpO1xuICAgICAgICBjb25zdCBiTWlkID0gKGJNYXggKyBiTWluKSAqIDAuNTtcbiAgICAgICAgYkdvYWxNYXggPSBiTWF4ICsgZW5oYW5jZUFtb3VudCAqIChiTWF4IC0gYk1pZCk7XG4gICAgICAgIGJHb2FsTWluID0gYk1pbiArIGVuaGFuY2VBbW91bnQgKiAoYk1pbiAtIGJNaWQpO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5TdWJQaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICBkYXRhW2kgKyAwXSA9IHJlbWFwKGRhdGFbaSArIDBdLCByTWluLCByTWF4LCByR29hbE1pbiwgckdvYWxNYXgpO1xuICAgICAgICBkYXRhW2kgKyAxXSA9IHJlbWFwKGRhdGFbaSArIDFdLCBnTWluLCBnTWF4LCBnR29hbE1pbiwgZ0dvYWxNYXgpO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IHJlbWFwKGRhdGFbaSArIDJdLCBiTWluLCBiTWF4LCBiR29hbE1pbiwgYkdvYWxNYXgpO1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnZW5oYW5jZScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbiIsImV4cG9ydCBjb25zdCBHcmF5c2NhbGUgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBsZW4gPSBkYXRhLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XG4gICAgICAgIGNvbnN0IGJyaWdodG5lc3MgPSAwLjM0ICogZGF0YVtpXSArIDAuNSAqIGRhdGFbaSArIDFdICsgMC4xNiAqIGRhdGFbaSArIDJdO1xuICAgICAgICBkYXRhW2ldID0gYnJpZ2h0bmVzcztcbiAgICAgICAgZGF0YVtpICsgMV0gPSBicmlnaHRuZXNzO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IGJyaWdodG5lc3M7XG4gICAgfVxufTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2h1ZScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdzYXR1cmF0aW9uJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCksIEZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2x1bWluYW5jZScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbmV4cG9ydCBjb25zdCBIU0wgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBuUGl4ZWxzID0gZGF0YS5sZW5ndGgsIHYgPSAxLCBzID0gTWF0aC5wb3coMiwgdGhpcy5zYXR1cmF0aW9uKCkpLCBoID0gTWF0aC5hYnModGhpcy5odWUoKSArIDM2MCkgJSAzNjAsIGwgPSB0aGlzLmx1bWluYW5jZSgpICogMTI3O1xuICAgIGNvbnN0IHZzdSA9IHYgKiBzICogTWF0aC5jb3MoKGggKiBNYXRoLlBJKSAvIDE4MCksIHZzdyA9IHYgKiBzICogTWF0aC5zaW4oKGggKiBNYXRoLlBJKSAvIDE4MCk7XG4gICAgY29uc3QgcnIgPSAwLjI5OSAqIHYgKyAwLjcwMSAqIHZzdSArIDAuMTY3ICogdnN3LCByZyA9IDAuNTg3ICogdiAtIDAuNTg3ICogdnN1ICsgMC4zMyAqIHZzdywgcmIgPSAwLjExNCAqIHYgLSAwLjExNCAqIHZzdSAtIDAuNDk3ICogdnN3O1xuICAgIGNvbnN0IGdyID0gMC4yOTkgKiB2IC0gMC4yOTkgKiB2c3UgLSAwLjMyOCAqIHZzdywgZ2cgPSAwLjU4NyAqIHYgKyAwLjQxMyAqIHZzdSArIDAuMDM1ICogdnN3LCBnYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1ICsgMC4yOTMgKiB2c3c7XG4gICAgY29uc3QgYnIgPSAwLjI5OSAqIHYgLSAwLjMgKiB2c3UgKyAxLjI1ICogdnN3LCBiZyA9IDAuNTg3ICogdiAtIDAuNTg2ICogdnN1IC0gMS4wNSAqIHZzdywgYmIgPSAwLjExNCAqIHYgKyAwLjg4NiAqIHZzdSAtIDAuMiAqIHZzdztcbiAgICBsZXQgciwgZywgYiwgYTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICByID0gZGF0YVtpICsgMF07XG4gICAgICAgIGcgPSBkYXRhW2kgKyAxXTtcbiAgICAgICAgYiA9IGRhdGFbaSArIDJdO1xuICAgICAgICBhID0gZGF0YVtpICsgM107XG4gICAgICAgIGRhdGFbaSArIDBdID0gcnIgKiByICsgcmcgKiBnICsgcmIgKiBiICsgbDtcbiAgICAgICAgZGF0YVtpICsgMV0gPSBnciAqIHIgKyBnZyAqIGcgKyBnYiAqIGIgKyBsO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IGJyICogciArIGJnICogZyArIGJiICogYiArIGw7XG4gICAgICAgIGRhdGFbaSArIDNdID0gYTtcbiAgICB9XG59O1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5leHBvcnQgY29uc3QgSFNWID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSBpbWFnZURhdGEuZGF0YSwgblBpeGVscyA9IGRhdGEubGVuZ3RoLCB2ID0gTWF0aC5wb3coMiwgdGhpcy52YWx1ZSgpKSwgcyA9IE1hdGgucG93KDIsIHRoaXMuc2F0dXJhdGlvbigpKSwgaCA9IE1hdGguYWJzKHRoaXMuaHVlKCkgKyAzNjApICUgMzYwO1xuICAgIGNvbnN0IHZzdSA9IHYgKiBzICogTWF0aC5jb3MoKGggKiBNYXRoLlBJKSAvIDE4MCksIHZzdyA9IHYgKiBzICogTWF0aC5zaW4oKGggKiBNYXRoLlBJKSAvIDE4MCk7XG4gICAgY29uc3QgcnIgPSAwLjI5OSAqIHYgKyAwLjcwMSAqIHZzdSArIDAuMTY3ICogdnN3LCByZyA9IDAuNTg3ICogdiAtIDAuNTg3ICogdnN1ICsgMC4zMyAqIHZzdywgcmIgPSAwLjExNCAqIHYgLSAwLjExNCAqIHZzdSAtIDAuNDk3ICogdnN3O1xuICAgIGNvbnN0IGdyID0gMC4yOTkgKiB2IC0gMC4yOTkgKiB2c3UgLSAwLjMyOCAqIHZzdywgZ2cgPSAwLjU4NyAqIHYgKyAwLjQxMyAqIHZzdSArIDAuMDM1ICogdnN3LCBnYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1ICsgMC4yOTMgKiB2c3c7XG4gICAgY29uc3QgYnIgPSAwLjI5OSAqIHYgLSAwLjMgKiB2c3UgKyAxLjI1ICogdnN3LCBiZyA9IDAuNTg3ICogdiAtIDAuNTg2ICogdnN1IC0gMS4wNSAqIHZzdywgYmIgPSAwLjExNCAqIHYgKyAwLjg4NiAqIHZzdSAtIDAuMiAqIHZzdztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICBjb25zdCByID0gZGF0YVtpICsgMF07XG4gICAgICAgIGNvbnN0IGcgPSBkYXRhW2kgKyAxXTtcbiAgICAgICAgY29uc3QgYiA9IGRhdGFbaSArIDJdO1xuICAgICAgICBjb25zdCBhID0gZGF0YVtpICsgM107XG4gICAgICAgIGRhdGFbaSArIDBdID0gcnIgKiByICsgcmcgKiBnICsgcmIgKiBiO1xuICAgICAgICBkYXRhW2kgKyAxXSA9IGdyICogciArIGdnICogZyArIGdiICogYjtcbiAgICAgICAgZGF0YVtpICsgMl0gPSBiciAqIHIgKyBiZyAqIGcgKyBiYiAqIGI7XG4gICAgICAgIGRhdGFbaSArIDNdID0gYTtcbiAgICB9XG59O1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2h1ZScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpLCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdzYXR1cmF0aW9uJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCksIEZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ3ZhbHVlJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCksIEZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuIiwiZXhwb3J0IGNvbnN0IEludmVydCA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICBjb25zdCBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsIGxlbiA9IGRhdGEubGVuZ3RoO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgZGF0YVtpXSA9IDI1NSAtIGRhdGFbaV07XG4gICAgICAgIGRhdGFbaSArIDFdID0gMjU1IC0gZGF0YVtpICsgMV07XG4gICAgICAgIGRhdGFbaSArIDJdID0gMjU1IC0gZGF0YVtpICsgMl07XG4gICAgfVxufTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4uL1V0aWwuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5jb25zdCBUb1BvbGFyID0gZnVuY3Rpb24gKHNyYywgZHN0LCBvcHQpIHtcbiAgICBjb25zdCBzcmNQaXhlbHMgPSBzcmMuZGF0YSwgZHN0UGl4ZWxzID0gZHN0LmRhdGEsIHhTaXplID0gc3JjLndpZHRoLCB5U2l6ZSA9IHNyYy5oZWlnaHQsIHhNaWQgPSBvcHQucG9sYXJDZW50ZXJYIHx8IHhTaXplIC8gMiwgeU1pZCA9IG9wdC5wb2xhckNlbnRlclkgfHwgeVNpemUgLyAyO1xuICAgIGxldCByTWF4ID0gTWF0aC5zcXJ0KHhNaWQgKiB4TWlkICsgeU1pZCAqIHlNaWQpO1xuICAgIGxldCB4ID0geFNpemUgLSB4TWlkO1xuICAgIGxldCB5ID0geVNpemUgLSB5TWlkO1xuICAgIGNvbnN0IHJhZCA9IE1hdGguc3FydCh4ICogeCArIHkgKiB5KTtcbiAgICByTWF4ID0gcmFkID4gck1heCA/IHJhZCA6IHJNYXg7XG4gICAgY29uc3QgclNpemUgPSB5U2l6ZSwgdFNpemUgPSB4U2l6ZTtcbiAgICBjb25zdCBjb252ZXJzaW9uID0gKCgzNjAgLyB0U2l6ZSkgKiBNYXRoLlBJKSAvIDE4MDtcbiAgICBmb3IgKGxldCB0aGV0YSA9IDA7IHRoZXRhIDwgdFNpemU7IHRoZXRhICs9IDEpIHtcbiAgICAgICAgY29uc3Qgc2luID0gTWF0aC5zaW4odGhldGEgKiBjb252ZXJzaW9uKTtcbiAgICAgICAgY29uc3QgY29zID0gTWF0aC5jb3ModGhldGEgKiBjb252ZXJzaW9uKTtcbiAgICAgICAgZm9yIChsZXQgcmFkaXVzID0gMDsgcmFkaXVzIDwgclNpemU7IHJhZGl1cyArPSAxKSB7XG4gICAgICAgICAgICB4ID0gTWF0aC5mbG9vcih4TWlkICsgKChyTWF4ICogcmFkaXVzKSAvIHJTaXplKSAqIGNvcyk7XG4gICAgICAgICAgICB5ID0gTWF0aC5mbG9vcih5TWlkICsgKChyTWF4ICogcmFkaXVzKSAvIHJTaXplKSAqIHNpbik7XG4gICAgICAgICAgICBsZXQgaSA9ICh5ICogeFNpemUgKyB4KSAqIDQ7XG4gICAgICAgICAgICBjb25zdCByID0gc3JjUGl4ZWxzW2kgKyAwXTtcbiAgICAgICAgICAgIGNvbnN0IGcgPSBzcmNQaXhlbHNbaSArIDFdO1xuICAgICAgICAgICAgY29uc3QgYiA9IHNyY1BpeGVsc1tpICsgMl07XG4gICAgICAgICAgICBjb25zdCBhID0gc3JjUGl4ZWxzW2kgKyAzXTtcbiAgICAgICAgICAgIGkgPSAodGhldGEgKyByYWRpdXMgKiB4U2l6ZSkgKiA0O1xuICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAwXSA9IHI7XG4gICAgICAgICAgICBkc3RQaXhlbHNbaSArIDFdID0gZztcbiAgICAgICAgICAgIGRzdFBpeGVsc1tpICsgMl0gPSBiO1xuICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAzXSA9IGE7XG4gICAgICAgIH1cbiAgICB9XG59O1xuY29uc3QgRnJvbVBvbGFyID0gZnVuY3Rpb24gKHNyYywgZHN0LCBvcHQpIHtcbiAgICBjb25zdCBzcmNQaXhlbHMgPSBzcmMuZGF0YSwgZHN0UGl4ZWxzID0gZHN0LmRhdGEsIHhTaXplID0gc3JjLndpZHRoLCB5U2l6ZSA9IHNyYy5oZWlnaHQsIHhNaWQgPSBvcHQucG9sYXJDZW50ZXJYIHx8IHhTaXplIC8gMiwgeU1pZCA9IG9wdC5wb2xhckNlbnRlclkgfHwgeVNpemUgLyAyO1xuICAgIGxldCByTWF4ID0gTWF0aC5zcXJ0KHhNaWQgKiB4TWlkICsgeU1pZCAqIHlNaWQpO1xuICAgIGxldCB4ID0geFNpemUgLSB4TWlkO1xuICAgIGxldCB5ID0geVNpemUgLSB5TWlkO1xuICAgIGNvbnN0IHJhZCA9IE1hdGguc3FydCh4ICogeCArIHkgKiB5KTtcbiAgICByTWF4ID0gcmFkID4gck1heCA/IHJhZCA6IHJNYXg7XG4gICAgY29uc3QgclNpemUgPSB5U2l6ZSwgdFNpemUgPSB4U2l6ZSwgcGhhc2VTaGlmdCA9IG9wdC5wb2xhclJvdGF0aW9uIHx8IDA7XG4gICAgbGV0IHgxLCB5MTtcbiAgICBmb3IgKHggPSAwOyB4IDwgeFNpemU7IHggKz0gMSkge1xuICAgICAgICBmb3IgKHkgPSAwOyB5IDwgeVNpemU7IHkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgZHggPSB4IC0geE1pZDtcbiAgICAgICAgICAgIGNvbnN0IGR5ID0geSAtIHlNaWQ7XG4gICAgICAgICAgICBjb25zdCByYWRpdXMgPSAoTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KSAqIHJTaXplKSAvIHJNYXg7XG4gICAgICAgICAgICBsZXQgdGhldGEgPSAoKE1hdGguYXRhbjIoZHksIGR4KSAqIDE4MCkgLyBNYXRoLlBJICsgMzYwICsgcGhhc2VTaGlmdCkgJSAzNjA7XG4gICAgICAgICAgICB0aGV0YSA9ICh0aGV0YSAqIHRTaXplKSAvIDM2MDtcbiAgICAgICAgICAgIHgxID0gTWF0aC5mbG9vcih0aGV0YSk7XG4gICAgICAgICAgICB5MSA9IE1hdGguZmxvb3IocmFkaXVzKTtcbiAgICAgICAgICAgIGxldCBpID0gKHkxICogeFNpemUgKyB4MSkgKiA0O1xuICAgICAgICAgICAgY29uc3QgciA9IHNyY1BpeGVsc1tpICsgMF07XG4gICAgICAgICAgICBjb25zdCBnID0gc3JjUGl4ZWxzW2kgKyAxXTtcbiAgICAgICAgICAgIGNvbnN0IGIgPSBzcmNQaXhlbHNbaSArIDJdO1xuICAgICAgICAgICAgY29uc3QgYSA9IHNyY1BpeGVsc1tpICsgM107XG4gICAgICAgICAgICBpID0gKHkgKiB4U2l6ZSArIHgpICogNDtcbiAgICAgICAgICAgIGRzdFBpeGVsc1tpICsgMF0gPSByO1xuICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAxXSA9IGc7XG4gICAgICAgICAgICBkc3RQaXhlbHNbaSArIDJdID0gYjtcbiAgICAgICAgICAgIGRzdFBpeGVsc1tpICsgM10gPSBhO1xuICAgICAgICB9XG4gICAgfVxufTtcbmV4cG9ydCBjb25zdCBLYWxlaWRvc2NvcGUgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgeFNpemUgPSBpbWFnZURhdGEud2lkdGgsIHlTaXplID0gaW1hZ2VEYXRhLmhlaWdodDtcbiAgICBsZXQgeCwgeSwgeG9mZiwgaSwgciwgZywgYiwgYSwgc3JjUG9zLCBkc3RQb3M7XG4gICAgbGV0IHBvd2VyID0gTWF0aC5yb3VuZCh0aGlzLmthbGVpZG9zY29wZVBvd2VyKCkpO1xuICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5yb3VuZCh0aGlzLmthbGVpZG9zY29wZUFuZ2xlKCkpO1xuICAgIGNvbnN0IG9mZnNldCA9IE1hdGguZmxvb3IoKHhTaXplICogKGFuZ2xlICUgMzYwKSkgLyAzNjApO1xuICAgIGlmIChwb3dlciA8IDEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB0ZW1wQ2FudmFzID0gVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG4gICAgdGVtcENhbnZhcy53aWR0aCA9IHhTaXplO1xuICAgIHRlbXBDYW52YXMuaGVpZ2h0ID0geVNpemU7XG4gICAgY29uc3Qgc2NyYXRjaERhdGEgPSB0ZW1wQ2FudmFzXG4gICAgICAgIC5nZXRDb250ZXh0KCcyZCcpXG4gICAgICAgIC5nZXRJbWFnZURhdGEoMCwgMCwgeFNpemUsIHlTaXplKTtcbiAgICBVdGlsLnJlbGVhc2VDYW52YXModGVtcENhbnZhcyk7XG4gICAgVG9Qb2xhcihpbWFnZURhdGEsIHNjcmF0Y2hEYXRhLCB7XG4gICAgICAgIHBvbGFyQ2VudGVyWDogeFNpemUgLyAyLFxuICAgICAgICBwb2xhckNlbnRlclk6IHlTaXplIC8gMixcbiAgICB9KTtcbiAgICBsZXQgbWluU2VjdGlvblNpemUgPSB4U2l6ZSAvIE1hdGgucG93KDIsIHBvd2VyKTtcbiAgICB3aGlsZSAobWluU2VjdGlvblNpemUgPD0gOCkge1xuICAgICAgICBtaW5TZWN0aW9uU2l6ZSA9IG1pblNlY3Rpb25TaXplICogMjtcbiAgICAgICAgcG93ZXIgLT0gMTtcbiAgICB9XG4gICAgbWluU2VjdGlvblNpemUgPSBNYXRoLmNlaWwobWluU2VjdGlvblNpemUpO1xuICAgIGxldCBzZWN0aW9uU2l6ZSA9IG1pblNlY3Rpb25TaXplO1xuICAgIGxldCB4U3RhcnQgPSAwLCB4RW5kID0gc2VjdGlvblNpemUsIHhEZWx0YSA9IDE7XG4gICAgaWYgKG9mZnNldCArIG1pblNlY3Rpb25TaXplID4geFNpemUpIHtcbiAgICAgICAgeFN0YXJ0ID0gc2VjdGlvblNpemU7XG4gICAgICAgIHhFbmQgPSAwO1xuICAgICAgICB4RGVsdGEgPSAtMTtcbiAgICB9XG4gICAgZm9yICh5ID0gMDsgeSA8IHlTaXplOyB5ICs9IDEpIHtcbiAgICAgICAgZm9yICh4ID0geFN0YXJ0OyB4ICE9PSB4RW5kOyB4ICs9IHhEZWx0YSkge1xuICAgICAgICAgICAgeG9mZiA9IE1hdGgucm91bmQoeCArIG9mZnNldCkgJSB4U2l6ZTtcbiAgICAgICAgICAgIHNyY1BvcyA9ICh4U2l6ZSAqIHkgKyB4b2ZmKSAqIDQ7XG4gICAgICAgICAgICByID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAwXTtcbiAgICAgICAgICAgIGcgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDFdO1xuICAgICAgICAgICAgYiA9IHNjcmF0Y2hEYXRhLmRhdGFbc3JjUG9zICsgMl07XG4gICAgICAgICAgICBhID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAzXTtcbiAgICAgICAgICAgIGRzdFBvcyA9ICh4U2l6ZSAqIHkgKyB4KSAqIDQ7XG4gICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDBdID0gcjtcbiAgICAgICAgICAgIHNjcmF0Y2hEYXRhLmRhdGFbZHN0UG9zICsgMV0gPSBnO1xuICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAyXSA9IGI7XG4gICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDNdID0gYTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHkgPSAwOyB5IDwgeVNpemU7IHkgKz0gMSkge1xuICAgICAgICBzZWN0aW9uU2l6ZSA9IE1hdGguZmxvb3IobWluU2VjdGlvblNpemUpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcG93ZXI7IGkgKz0gMSkge1xuICAgICAgICAgICAgZm9yICh4ID0gMDsgeCA8IHNlY3Rpb25TaXplICsgMTsgeCArPSAxKSB7XG4gICAgICAgICAgICAgICAgc3JjUG9zID0gKHhTaXplICogeSArIHgpICogNDtcbiAgICAgICAgICAgICAgICByID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAwXTtcbiAgICAgICAgICAgICAgICBnID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAxXTtcbiAgICAgICAgICAgICAgICBiID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAyXTtcbiAgICAgICAgICAgICAgICBhID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAzXTtcbiAgICAgICAgICAgICAgICBkc3RQb3MgPSAoeFNpemUgKiB5ICsgc2VjdGlvblNpemUgKiAyIC0geCAtIDEpICogNDtcbiAgICAgICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDBdID0gcjtcbiAgICAgICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDFdID0gZztcbiAgICAgICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDJdID0gYjtcbiAgICAgICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDNdID0gYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlY3Rpb25TaXplICo9IDI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgRnJvbVBvbGFyKHNjcmF0Y2hEYXRhLCBpbWFnZURhdGEsIHsgcG9sYXJSb3RhdGlvbjogMCB9KTtcbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAna2FsZWlkb3Njb3BlUG93ZXInLCAyLCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAna2FsZWlkb3Njb3BlQW5nbGUnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmZ1bmN0aW9uIHBpeGVsQXQoaWRhdGEsIHgsIHkpIHtcbiAgICBsZXQgaWR4ID0gKHkgKiBpZGF0YS53aWR0aCArIHgpICogNDtcbiAgICBjb25zdCBkID0gW107XG4gICAgZC5wdXNoKGlkYXRhLmRhdGFbaWR4KytdLCBpZGF0YS5kYXRhW2lkeCsrXSwgaWRhdGEuZGF0YVtpZHgrK10sIGlkYXRhLmRhdGFbaWR4KytdKTtcbiAgICByZXR1cm4gZDtcbn1cbmZ1bmN0aW9uIHJnYkRpc3RhbmNlKHAxLCBwMikge1xuICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3cocDFbMF0gLSBwMlswXSwgMikgK1xuICAgICAgICBNYXRoLnBvdyhwMVsxXSAtIHAyWzFdLCAyKSArXG4gICAgICAgIE1hdGgucG93KHAxWzJdIC0gcDJbMl0sIDIpKTtcbn1cbmZ1bmN0aW9uIHJnYk1lYW4ocFRhYikge1xuICAgIGNvbnN0IG0gPSBbMCwgMCwgMF07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVGFiLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG1bMF0gKz0gcFRhYltpXVswXTtcbiAgICAgICAgbVsxXSArPSBwVGFiW2ldWzFdO1xuICAgICAgICBtWzJdICs9IHBUYWJbaV1bMl07XG4gICAgfVxuICAgIG1bMF0gLz0gcFRhYi5sZW5ndGg7XG4gICAgbVsxXSAvPSBwVGFiLmxlbmd0aDtcbiAgICBtWzJdIC89IHBUYWIubGVuZ3RoO1xuICAgIHJldHVybiBtO1xufVxuZnVuY3Rpb24gYmFja2dyb3VuZE1hc2soaWRhdGEsIHRocmVzaG9sZCkge1xuICAgIGNvbnN0IHJnYnZfbm8gPSBwaXhlbEF0KGlkYXRhLCAwLCAwKTtcbiAgICBjb25zdCByZ2J2X25lID0gcGl4ZWxBdChpZGF0YSwgaWRhdGEud2lkdGggLSAxLCAwKTtcbiAgICBjb25zdCByZ2J2X3NvID0gcGl4ZWxBdChpZGF0YSwgMCwgaWRhdGEuaGVpZ2h0IC0gMSk7XG4gICAgY29uc3Qgcmdidl9zZSA9IHBpeGVsQXQoaWRhdGEsIGlkYXRhLndpZHRoIC0gMSwgaWRhdGEuaGVpZ2h0IC0gMSk7XG4gICAgY29uc3QgdGhyZXMgPSB0aHJlc2hvbGQgfHwgMTA7XG4gICAgaWYgKHJnYkRpc3RhbmNlKHJnYnZfbm8sIHJnYnZfbmUpIDwgdGhyZXMgJiZcbiAgICAgICAgcmdiRGlzdGFuY2Uocmdidl9uZSwgcmdidl9zZSkgPCB0aHJlcyAmJlxuICAgICAgICByZ2JEaXN0YW5jZShyZ2J2X3NlLCByZ2J2X3NvKSA8IHRocmVzICYmXG4gICAgICAgIHJnYkRpc3RhbmNlKHJnYnZfc28sIHJnYnZfbm8pIDwgdGhyZXMpIHtcbiAgICAgICAgY29uc3QgbWVhbiA9IHJnYk1lYW4oW3JnYnZfbmUsIHJnYnZfbm8sIHJnYnZfc2UsIHJnYnZfc29dKTtcbiAgICAgICAgY29uc3QgbWFzayA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkYXRhLndpZHRoICogaWRhdGEuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGQgPSByZ2JEaXN0YW5jZShtZWFuLCBbXG4gICAgICAgICAgICAgICAgaWRhdGEuZGF0YVtpICogNF0sXG4gICAgICAgICAgICAgICAgaWRhdGEuZGF0YVtpICogNCArIDFdLFxuICAgICAgICAgICAgICAgIGlkYXRhLmRhdGFbaSAqIDQgKyAyXSxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgbWFza1tpXSA9IGQgPCB0aHJlcyA/IDAgOiAyNTU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hc2s7XG4gICAgfVxufVxuZnVuY3Rpb24gYXBwbHlNYXNrKGlkYXRhLCBtYXNrKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZGF0YS53aWR0aCAqIGlkYXRhLmhlaWdodDsgaSsrKSB7XG4gICAgICAgIGlkYXRhLmRhdGFbNCAqIGkgKyAzXSA9IG1hc2tbaV07XG4gICAgfVxufVxuZnVuY3Rpb24gZXJvZGVNYXNrKG1hc2ssIHN3LCBzaCkge1xuICAgIGNvbnN0IHdlaWdodHMgPSBbMSwgMSwgMSwgMSwgMCwgMSwgMSwgMSwgMV07XG4gICAgY29uc3Qgc2lkZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KHdlaWdodHMubGVuZ3RoKSk7XG4gICAgY29uc3QgaGFsZlNpZGUgPSBNYXRoLmZsb29yKHNpZGUgLyAyKTtcbiAgICBjb25zdCBtYXNrUmVzdWx0ID0gW107XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaDsgeSsrKSB7XG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc3c7IHgrKykge1xuICAgICAgICAgICAgY29uc3Qgc28gPSB5ICogc3cgKyB4O1xuICAgICAgICAgICAgbGV0IGEgPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgY3kgPSAwOyBjeSA8IHNpZGU7IGN5KyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjeCA9IDA7IGN4IDwgc2lkZTsgY3grKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3kgPSB5ICsgY3kgLSBoYWxmU2lkZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2N4ID0geCArIGN4IC0gaGFsZlNpZGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3kgPj0gMCAmJiBzY3kgPCBzaCAmJiBzY3ggPj0gMCAmJiBzY3ggPCBzdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3JjT2ZmID0gc2N5ICogc3cgKyBzY3g7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3dCA9IHdlaWdodHNbY3kgKiBzaWRlICsgY3hdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYSArPSBtYXNrW3NyY09mZl0gKiB3dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tSZXN1bHRbc29dID0gYSA9PT0gMjU1ICogOCA/IDI1NSA6IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hc2tSZXN1bHQ7XG59XG5mdW5jdGlvbiBkaWxhdGVNYXNrKG1hc2ssIHN3LCBzaCkge1xuICAgIGNvbnN0IHdlaWdodHMgPSBbMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07XG4gICAgY29uc3Qgc2lkZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KHdlaWdodHMubGVuZ3RoKSk7XG4gICAgY29uc3QgaGFsZlNpZGUgPSBNYXRoLmZsb29yKHNpZGUgLyAyKTtcbiAgICBjb25zdCBtYXNrUmVzdWx0ID0gW107XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaDsgeSsrKSB7XG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc3c7IHgrKykge1xuICAgICAgICAgICAgY29uc3Qgc28gPSB5ICogc3cgKyB4O1xuICAgICAgICAgICAgbGV0IGEgPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgY3kgPSAwOyBjeSA8IHNpZGU7IGN5KyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjeCA9IDA7IGN4IDwgc2lkZTsgY3grKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3kgPSB5ICsgY3kgLSBoYWxmU2lkZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2N4ID0geCArIGN4IC0gaGFsZlNpZGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3kgPj0gMCAmJiBzY3kgPCBzaCAmJiBzY3ggPj0gMCAmJiBzY3ggPCBzdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3JjT2ZmID0gc2N5ICogc3cgKyBzY3g7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3dCA9IHdlaWdodHNbY3kgKiBzaWRlICsgY3hdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYSArPSBtYXNrW3NyY09mZl0gKiB3dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tSZXN1bHRbc29dID0gYSA+PSAyNTUgKiA0ID8gMjU1IDogMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWFza1Jlc3VsdDtcbn1cbmZ1bmN0aW9uIHNtb290aEVkZ2VNYXNrKG1hc2ssIHN3LCBzaCkge1xuICAgIGNvbnN0IHdlaWdodHMgPSBbXG4gICAgICAgIDEgLyA5LFxuICAgICAgICAxIC8gOSxcbiAgICAgICAgMSAvIDksXG4gICAgICAgIDEgLyA5LFxuICAgICAgICAxIC8gOSxcbiAgICAgICAgMSAvIDksXG4gICAgICAgIDEgLyA5LFxuICAgICAgICAxIC8gOSxcbiAgICAgICAgMSAvIDksXG4gICAgXTtcbiAgICBjb25zdCBzaWRlID0gTWF0aC5yb3VuZChNYXRoLnNxcnQod2VpZ2h0cy5sZW5ndGgpKTtcbiAgICBjb25zdCBoYWxmU2lkZSA9IE1hdGguZmxvb3Ioc2lkZSAvIDIpO1xuICAgIGNvbnN0IG1hc2tSZXN1bHQgPSBbXTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNoOyB5KyspIHtcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzdzsgeCsrKSB7XG4gICAgICAgICAgICBjb25zdCBzbyA9IHkgKiBzdyArIHg7XG4gICAgICAgICAgICBsZXQgYSA9IDA7XG4gICAgICAgICAgICBmb3IgKGxldCBjeSA9IDA7IGN5IDwgc2lkZTsgY3krKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGN4ID0gMDsgY3ggPCBzaWRlOyBjeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjeSA9IHkgKyBjeSAtIGhhbGZTaWRlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3ggPSB4ICsgY3ggLSBoYWxmU2lkZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjeSA+PSAwICYmIHNjeSA8IHNoICYmIHNjeCA+PSAwICYmIHNjeCA8IHN3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcmNPZmYgPSBzY3kgKiBzdyArIHNjeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHd0ID0gd2VpZ2h0c1tjeSAqIHNpZGUgKyBjeF07XG4gICAgICAgICAgICAgICAgICAgICAgICBhICs9IG1hc2tbc3JjT2ZmXSAqIHd0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFza1Jlc3VsdFtzb10gPSBhO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXNrUmVzdWx0O1xufVxuZXhwb3J0IGNvbnN0IE1hc2sgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgdGhyZXNob2xkID0gdGhpcy50aHJlc2hvbGQoKTtcbiAgICBsZXQgbWFzayA9IGJhY2tncm91bmRNYXNrKGltYWdlRGF0YSwgdGhyZXNob2xkKTtcbiAgICBpZiAobWFzaykge1xuICAgICAgICBtYXNrID0gZXJvZGVNYXNrKG1hc2ssIGltYWdlRGF0YS53aWR0aCwgaW1hZ2VEYXRhLmhlaWdodCk7XG4gICAgICAgIG1hc2sgPSBkaWxhdGVNYXNrKG1hc2ssIGltYWdlRGF0YS53aWR0aCwgaW1hZ2VEYXRhLmhlaWdodCk7XG4gICAgICAgIG1hc2sgPSBzbW9vdGhFZGdlTWFzayhtYXNrLCBpbWFnZURhdGEud2lkdGgsIGltYWdlRGF0YS5oZWlnaHQpO1xuICAgICAgICBhcHBseU1hc2soaW1hZ2VEYXRhLCBtYXNrKTtcbiAgICB9XG4gICAgcmV0dXJuIGltYWdlRGF0YTtcbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAndGhyZXNob2xkJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCksIEZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5leHBvcnQgY29uc3QgTm9pc2UgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgYW1vdW50ID0gdGhpcy5ub2lzZSgpICogMjU1LCBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsIG5QaXhlbHMgPSBkYXRhLmxlbmd0aCwgaGFsZiA9IGFtb3VudCAvIDI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuUGl4ZWxzOyBpICs9IDQpIHtcbiAgICAgICAgZGF0YVtpICsgMF0gKz0gaGFsZiAtIDIgKiBoYWxmICogTWF0aC5yYW5kb20oKTtcbiAgICAgICAgZGF0YVtpICsgMV0gKz0gaGFsZiAtIDIgKiBoYWxmICogTWF0aC5yYW5kb20oKTtcbiAgICAgICAgZGF0YVtpICsgMl0gKz0gaGFsZiAtIDIgKiBoYWxmICogTWF0aC5yYW5kb20oKTtcbiAgICB9XG59O1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ25vaXNlJywgMC4yLCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi4vVXRpbC5qc1wiO1xuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuLi9Ob2RlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuZXhwb3J0IGNvbnN0IFBpeGVsYXRlID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgIGxldCBwaXhlbFNpemUgPSBNYXRoLmNlaWwodGhpcy5waXhlbFNpemUoKSksIHdpZHRoID0gaW1hZ2VEYXRhLndpZHRoLCBoZWlnaHQgPSBpbWFnZURhdGEuaGVpZ2h0LCBuQmluc1ggPSBNYXRoLmNlaWwod2lkdGggLyBwaXhlbFNpemUpLCBuQmluc1kgPSBNYXRoLmNlaWwoaGVpZ2h0IC8gcGl4ZWxTaXplKSwgZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuICAgIGlmIChwaXhlbFNpemUgPD0gMCkge1xuICAgICAgICBVdGlsLmVycm9yKCdwaXhlbFNpemUgdmFsdWUgY2FuIG5vdCBiZSA8PSAwJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChsZXQgeEJpbiA9IDA7IHhCaW4gPCBuQmluc1g7IHhCaW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCB5QmluID0gMDsgeUJpbiA8IG5CaW5zWTsgeUJpbiArPSAxKSB7XG4gICAgICAgICAgICBsZXQgcmVkID0gMDtcbiAgICAgICAgICAgIGxldCBncmVlbiA9IDA7XG4gICAgICAgICAgICBsZXQgYmx1ZSA9IDA7XG4gICAgICAgICAgICBsZXQgYWxwaGEgPSAwO1xuICAgICAgICAgICAgY29uc3QgeEJpblN0YXJ0ID0geEJpbiAqIHBpeGVsU2l6ZTtcbiAgICAgICAgICAgIGNvbnN0IHhCaW5FbmQgPSB4QmluU3RhcnQgKyBwaXhlbFNpemU7XG4gICAgICAgICAgICBjb25zdCB5QmluU3RhcnQgPSB5QmluICogcGl4ZWxTaXplO1xuICAgICAgICAgICAgY29uc3QgeUJpbkVuZCA9IHlCaW5TdGFydCArIHBpeGVsU2l6ZTtcbiAgICAgICAgICAgIGxldCBwaXhlbHNJbkJpbiA9IDA7XG4gICAgICAgICAgICBmb3IgKGxldCB4ID0geEJpblN0YXJ0OyB4IDwgeEJpbkVuZDsgeCArPSAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKHggPj0gd2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAobGV0IHkgPSB5QmluU3RhcnQ7IHkgPCB5QmluRW5kOyB5ICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHkgPj0gaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gKHdpZHRoICogeSArIHgpICogNDtcbiAgICAgICAgICAgICAgICAgICAgcmVkICs9IGRhdGFbaSArIDBdO1xuICAgICAgICAgICAgICAgICAgICBncmVlbiArPSBkYXRhW2kgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgYmx1ZSArPSBkYXRhW2kgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgYWxwaGEgKz0gZGF0YVtpICsgM107XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc0luQmluICs9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVkID0gcmVkIC8gcGl4ZWxzSW5CaW47XG4gICAgICAgICAgICBncmVlbiA9IGdyZWVuIC8gcGl4ZWxzSW5CaW47XG4gICAgICAgICAgICBibHVlID0gYmx1ZSAvIHBpeGVsc0luQmluO1xuICAgICAgICAgICAgYWxwaGEgPSBhbHBoYSAvIHBpeGVsc0luQmluO1xuICAgICAgICAgICAgZm9yIChsZXQgeCA9IHhCaW5TdGFydDsgeCA8IHhCaW5FbmQ7IHggKz0gMSkge1xuICAgICAgICAgICAgICAgIGlmICh4ID49IHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGxldCB5ID0geUJpblN0YXJ0OyB5IDwgeUJpbkVuZDsgeSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh5ID49IGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9ICh3aWR0aCAqIHkgKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbaSArIDBdID0gcmVkO1xuICAgICAgICAgICAgICAgICAgICBkYXRhW2kgKyAxXSA9IGdyZWVuO1xuICAgICAgICAgICAgICAgICAgICBkYXRhW2kgKyAyXSA9IGJsdWU7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbaSArIDNdID0gYWxwaGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdwaXhlbFNpemUnLCA4LCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmV4cG9ydCBjb25zdCBQb3N0ZXJpemUgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgbGV2ZWxzID0gTWF0aC5yb3VuZCh0aGlzLmxldmVscygpICogMjU0KSArIDEsIGRhdGEgPSBpbWFnZURhdGEuZGF0YSwgbGVuID0gZGF0YS5sZW5ndGgsIHNjYWxlID0gMjU1IC8gbGV2ZWxzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgZGF0YVtpXSA9IE1hdGguZmxvb3IoZGF0YVtpXSAvIHNjYWxlKSAqIHNjYWxlO1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnbGV2ZWxzJywgMC41LCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgUkdCQ29tcG9uZW50IH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmV4cG9ydCBjb25zdCBSR0IgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBuUGl4ZWxzID0gZGF0YS5sZW5ndGgsIHJlZCA9IHRoaXMucmVkKCksIGdyZWVuID0gdGhpcy5ncmVlbigpLCBibHVlID0gdGhpcy5ibHVlKCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuUGl4ZWxzOyBpICs9IDQpIHtcbiAgICAgICAgY29uc3QgYnJpZ2h0bmVzcyA9ICgwLjM0ICogZGF0YVtpXSArIDAuNSAqIGRhdGFbaSArIDFdICsgMC4xNiAqIGRhdGFbaSArIDJdKSAvIDI1NTtcbiAgICAgICAgZGF0YVtpXSA9IGJyaWdodG5lc3MgKiByZWQ7XG4gICAgICAgIGRhdGFbaSArIDFdID0gYnJpZ2h0bmVzcyAqIGdyZWVuO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IGJyaWdodG5lc3MgKiBibHVlO1xuICAgICAgICBkYXRhW2kgKyAzXSA9IGRhdGFbaSArIDNdO1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAncmVkJywgMCwgZnVuY3Rpb24gKHZhbCkge1xuICAgIHRoaXMuX2ZpbHRlclVwVG9EYXRlID0gZmFsc2U7XG4gICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICByZXR1cm4gMjU1O1xuICAgIH1cbiAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQodmFsKTtcbiAgICB9XG59KTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdncmVlbicsIDAsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgIGlmICh2YWwgPiAyNTUpIHtcbiAgICAgICAgcmV0dXJuIDI1NTtcbiAgICB9XG4gICAgZWxzZSBpZiAodmFsIDwgMCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCk7XG4gICAgfVxufSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAnYmx1ZScsIDAsIFJHQkNvbXBvbmVudCwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgUkdCQ29tcG9uZW50IH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmV4cG9ydCBjb25zdCBSR0JBID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSBpbWFnZURhdGEuZGF0YSwgblBpeGVscyA9IGRhdGEubGVuZ3RoLCByZWQgPSB0aGlzLnJlZCgpLCBncmVlbiA9IHRoaXMuZ3JlZW4oKSwgYmx1ZSA9IHRoaXMuYmx1ZSgpLCBhbHBoYSA9IHRoaXMuYWxwaGEoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICBjb25zdCBpYSA9IDEgLSBhbHBoYTtcbiAgICAgICAgZGF0YVtpXSA9IHJlZCAqIGFscGhhICsgZGF0YVtpXSAqIGlhO1xuICAgICAgICBkYXRhW2kgKyAxXSA9IGdyZWVuICogYWxwaGEgKyBkYXRhW2kgKyAxXSAqIGlhO1xuICAgICAgICBkYXRhW2kgKyAyXSA9IGJsdWUgKiBhbHBoYSArIGRhdGFbaSArIDJdICogaWE7XG4gICAgfVxufTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdyZWQnLCAwLCBmdW5jdGlvbiAodmFsKSB7XG4gICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICBpZiAodmFsID4gMjU1KSB7XG4gICAgICAgIHJldHVybiAyNTU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbCA8IDApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWwpO1xuICAgIH1cbn0pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTm9kZSwgJ2dyZWVuJywgMCwgZnVuY3Rpb24gKHZhbCkge1xuICAgIHRoaXMuX2ZpbHRlclVwVG9EYXRlID0gZmFsc2U7XG4gICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICByZXR1cm4gMjU1O1xuICAgIH1cbiAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQodmFsKTtcbiAgICB9XG59KTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdibHVlJywgMCwgUkdCQ29tcG9uZW50LCBGYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKE5vZGUsICdhbHBoYScsIDEsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgIGlmICh2YWwgPiAxKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG59KTtcbiIsImV4cG9ydCBjb25zdCBTZXBpYSA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICBjb25zdCBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsIG5QaXhlbHMgPSBkYXRhLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICBjb25zdCByID0gZGF0YVtpICsgMF07XG4gICAgICAgIGNvbnN0IGcgPSBkYXRhW2kgKyAxXTtcbiAgICAgICAgY29uc3QgYiA9IGRhdGFbaSArIDJdO1xuICAgICAgICBkYXRhW2kgKyAwXSA9IE1hdGgubWluKDI1NSwgciAqIDAuMzkzICsgZyAqIDAuNzY5ICsgYiAqIDAuMTg5KTtcbiAgICAgICAgZGF0YVtpICsgMV0gPSBNYXRoLm1pbigyNTUsIHIgKiAwLjM0OSArIGcgKiAwLjY4NiArIGIgKiAwLjE2OCk7XG4gICAgICAgIGRhdGFbaSArIDJdID0gTWF0aC5taW4oMjU1LCByICogMC4yNzIgKyBnICogMC41MzQgKyBiICogMC4xMzEpO1xuICAgIH1cbn07XG4iLCJleHBvcnQgY29uc3QgU29sYXJpemUgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgY29uc3QgdGhyZXNob2xkID0gMTI4O1xuICAgIGNvbnN0IGQgPSBpbWFnZURhdGEuZGF0YTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGQubGVuZ3RoOyBpICs9IDQpIHtcbiAgICAgICAgY29uc3QgciA9IGRbaV0sIGcgPSBkW2kgKyAxXSwgYiA9IGRbaSArIDJdO1xuICAgICAgICBjb25zdCBMID0gMC4yMTI2ICogciArIDAuNzE1MiAqIGcgKyAwLjA3MjIgKiBiO1xuICAgICAgICBpZiAoTCA+PSB0aHJlc2hvbGQpIHtcbiAgICAgICAgICAgIGRbaV0gPSAyNTUgLSByO1xuICAgICAgICAgICAgZFtpICsgMV0gPSAyNTUgLSBnO1xuICAgICAgICAgICAgZFtpICsgMl0gPSAyNTUgLSBiO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbWFnZURhdGE7XG59O1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL05vZGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5leHBvcnQgY29uc3QgVGhyZXNob2xkID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgIGNvbnN0IGxldmVsID0gdGhpcy50aHJlc2hvbGQoKSAqIDI1NSwgZGF0YSA9IGltYWdlRGF0YS5kYXRhLCBsZW4gPSBkYXRhLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGRhdGFbaV0gPSBkYXRhW2ldIDwgbGV2ZWwgPyAwIDogMjU1O1xuICAgIH1cbn07XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihOb2RlLCAndGhyZXNob2xkJywgMC41LCBnZXROdW1iZXJWYWxpZGF0b3IoKSwgRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4iLCJpbXBvcnQgeyBLb252YSB9IGZyb20gXCIuL19GdWxsSW50ZXJuYWxzLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBLb252YTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yLCBnZXRCb29sZWFuVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5leHBvcnQgY2xhc3MgQXJjIGV4dGVuZHMgU2hhcGUge1xuICAgIF9zY2VuZUZ1bmMoY29udGV4dCkge1xuICAgICAgICBjb25zdCBhbmdsZSA9IEtvbnZhLmdldEFuZ2xlKHRoaXMuYW5nbGUoKSksIGNsb2Nrd2lzZSA9IHRoaXMuY2xvY2t3aXNlKCk7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMub3V0ZXJSYWRpdXMoKSwgMCwgYW5nbGUsIGNsb2Nrd2lzZSk7XG4gICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMuaW5uZXJSYWRpdXMoKSwgYW5nbGUsIDAsICFjbG9ja3dpc2UpO1xuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGVyUmFkaXVzKCkgKiAyO1xuICAgIH1cbiAgICBnZXRIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGVyUmFkaXVzKCkgKiAyO1xuICAgIH1cbiAgICBzZXRXaWR0aCh3aWR0aCkge1xuICAgICAgICB0aGlzLm91dGVyUmFkaXVzKHdpZHRoIC8gMik7XG4gICAgfVxuICAgIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5vdXRlclJhZGl1cyhoZWlnaHQgLyAyKTtcbiAgICB9XG4gICAgZ2V0U2VsZlJlY3QoKSB7XG4gICAgICAgIGNvbnN0IGlubmVyUmFkaXVzID0gdGhpcy5pbm5lclJhZGl1cygpO1xuICAgICAgICBjb25zdCBvdXRlclJhZGl1cyA9IHRoaXMub3V0ZXJSYWRpdXMoKTtcbiAgICAgICAgY29uc3QgY2xvY2t3aXNlID0gdGhpcy5jbG9ja3dpc2UoKTtcbiAgICAgICAgY29uc3QgYW5nbGUgPSBLb252YS5nZXRBbmdsZShjbG9ja3dpc2UgPyAzNjAgLSB0aGlzLmFuZ2xlKCkgOiB0aGlzLmFuZ2xlKCkpO1xuICAgICAgICBjb25zdCBib3VuZExlZnRSYXRpbyA9IE1hdGguY29zKE1hdGgubWluKGFuZ2xlLCBNYXRoLlBJKSk7XG4gICAgICAgIGNvbnN0IGJvdW5kUmlnaHRSYXRpbyA9IDE7XG4gICAgICAgIGNvbnN0IGJvdW5kVG9wUmF0aW8gPSBNYXRoLnNpbihNYXRoLm1pbihNYXRoLm1heChNYXRoLlBJLCBhbmdsZSksICgzICogTWF0aC5QSSkgLyAyKSk7XG4gICAgICAgIGNvbnN0IGJvdW5kQm90dG9tUmF0aW8gPSBNYXRoLnNpbihNYXRoLm1pbihhbmdsZSwgTWF0aC5QSSAvIDIpKTtcbiAgICAgICAgY29uc3QgYm91bmRMZWZ0ID0gYm91bmRMZWZ0UmF0aW8gKiAoYm91bmRMZWZ0UmF0aW8gPiAwID8gaW5uZXJSYWRpdXMgOiBvdXRlclJhZGl1cyk7XG4gICAgICAgIGNvbnN0IGJvdW5kUmlnaHQgPSBib3VuZFJpZ2h0UmF0aW8gKiAoYm91bmRSaWdodFJhdGlvID4gMCA/IG91dGVyUmFkaXVzIDogaW5uZXJSYWRpdXMpO1xuICAgICAgICBjb25zdCBib3VuZFRvcCA9IGJvdW5kVG9wUmF0aW8gKiAoYm91bmRUb3BSYXRpbyA+IDAgPyBpbm5lclJhZGl1cyA6IG91dGVyUmFkaXVzKTtcbiAgICAgICAgY29uc3QgYm91bmRCb3R0b20gPSBib3VuZEJvdHRvbVJhdGlvICogKGJvdW5kQm90dG9tUmF0aW8gPiAwID8gb3V0ZXJSYWRpdXMgOiBpbm5lclJhZGl1cyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBib3VuZExlZnQsXG4gICAgICAgICAgICB5OiBjbG9ja3dpc2UgPyAtMSAqIGJvdW5kQm90dG9tIDogYm91bmRUb3AsXG4gICAgICAgICAgICB3aWR0aDogYm91bmRSaWdodCAtIGJvdW5kTGVmdCxcbiAgICAgICAgICAgIGhlaWdodDogYm91bmRCb3R0b20gLSBib3VuZFRvcCxcbiAgICAgICAgfTtcbiAgICB9XG59XG5BcmMucHJvdG90eXBlLl9jZW50cm9pZCA9IHRydWU7XG5BcmMucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdBcmMnO1xuQXJjLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gW1xuICAgICdpbm5lclJhZGl1cycsXG4gICAgJ291dGVyUmFkaXVzJyxcbiAgICAnYW5nbGUnLFxuICAgICdjbG9ja3dpc2UnLFxuXTtcbl9yZWdpc3Rlck5vZGUoQXJjKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEFyYywgJ2lubmVyUmFkaXVzJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoQXJjLCAnb3V0ZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihBcmMsICdhbmdsZScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEFyYywgJ2Nsb2Nrd2lzZScsIGZhbHNlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBMaW5lIH0gZnJvbSBcIi4vTGluZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBQYXRoIH0gZnJvbSBcIi4vUGF0aC5qc1wiO1xuZXhwb3J0IGNsYXNzIEFycm93IGV4dGVuZHMgTGluZSB7XG4gICAgX3NjZW5lRnVuYyhjdHgpIHtcbiAgICAgICAgc3VwZXIuX3NjZW5lRnVuYyhjdHgpO1xuICAgICAgICBjb25zdCBQSTIgPSBNYXRoLlBJICogMjtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gdGhpcy5wb2ludHMoKTtcbiAgICAgICAgbGV0IHRwID0gcG9pbnRzO1xuICAgICAgICBjb25zdCBmcm9tVGVuc2lvbiA9IHRoaXMudGVuc2lvbigpICE9PSAwICYmIHBvaW50cy5sZW5ndGggPiA0O1xuICAgICAgICBpZiAoZnJvbVRlbnNpb24pIHtcbiAgICAgICAgICAgIHRwID0gdGhpcy5nZXRUZW5zaW9uUG9pbnRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGVuZ3RoID0gdGhpcy5wb2ludGVyTGVuZ3RoKCk7XG4gICAgICAgIGNvbnN0IG4gPSBwb2ludHMubGVuZ3RoO1xuICAgICAgICBsZXQgZHgsIGR5O1xuICAgICAgICBpZiAoZnJvbVRlbnNpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGxwID0gW1xuICAgICAgICAgICAgICAgIHRwW3RwLmxlbmd0aCAtIDRdLFxuICAgICAgICAgICAgICAgIHRwW3RwLmxlbmd0aCAtIDNdLFxuICAgICAgICAgICAgICAgIHRwW3RwLmxlbmd0aCAtIDJdLFxuICAgICAgICAgICAgICAgIHRwW3RwLmxlbmd0aCAtIDFdLFxuICAgICAgICAgICAgICAgIHBvaW50c1tuIC0gMl0sXG4gICAgICAgICAgICAgICAgcG9pbnRzW24gLSAxXSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBjb25zdCBsYXN0TGVuZ3RoID0gUGF0aC5jYWxjTGVuZ3RoKHRwW3RwLmxlbmd0aCAtIDRdLCB0cFt0cC5sZW5ndGggLSAzXSwgJ0MnLCBscCk7XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IFBhdGguZ2V0UG9pbnRPblF1YWRyYXRpY0JlemllcihNYXRoLm1pbigxLCAxIC0gbGVuZ3RoIC8gbGFzdExlbmd0aCksIGxwWzBdLCBscFsxXSwgbHBbMl0sIGxwWzNdLCBscFs0XSwgbHBbNV0pO1xuICAgICAgICAgICAgZHggPSBwb2ludHNbbiAtIDJdIC0gcHJldmlvdXMueDtcbiAgICAgICAgICAgIGR5ID0gcG9pbnRzW24gLSAxXSAtIHByZXZpb3VzLnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkeCA9IHBvaW50c1tuIC0gMl0gLSBwb2ludHNbbiAtIDRdO1xuICAgICAgICAgICAgZHkgPSBwb2ludHNbbiAtIDFdIC0gcG9pbnRzW24gLSAzXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByYWRpYW5zID0gKE1hdGguYXRhbjIoZHksIGR4KSArIFBJMikgJSBQSTI7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb2ludGVyV2lkdGgoKTtcbiAgICAgICAgaWYgKHRoaXMucG9pbnRlckF0RW5kaW5nKCkpIHtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHgudHJhbnNsYXRlKHBvaW50c1tuIC0gMl0sIHBvaW50c1tuIC0gMV0pO1xuICAgICAgICAgICAgY3R4LnJvdGF0ZShyYWRpYW5zKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgMCk7XG4gICAgICAgICAgICBjdHgubGluZVRvKC1sZW5ndGgsIHdpZHRoIC8gMik7XG4gICAgICAgICAgICBjdHgubGluZVRvKC1sZW5ndGgsIC13aWR0aCAvIDIpO1xuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIHRoaXMuX19maWxsU3Ryb2tlKGN0eCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9pbnRlckF0QmVnaW5uaW5nKCkpIHtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHgudHJhbnNsYXRlKHBvaW50c1swXSwgcG9pbnRzWzFdKTtcbiAgICAgICAgICAgIGlmIChmcm9tVGVuc2lvbikge1xuICAgICAgICAgICAgICAgIGR4ID0gKHRwWzBdICsgdHBbMl0pIC8gMiAtIHBvaW50c1swXTtcbiAgICAgICAgICAgICAgICBkeSA9ICh0cFsxXSArIHRwWzNdKSAvIDIgLSBwb2ludHNbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkeCA9IHBvaW50c1syXSAtIHBvaW50c1swXTtcbiAgICAgICAgICAgICAgICBkeSA9IHBvaW50c1szXSAtIHBvaW50c1sxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5yb3RhdGUoKE1hdGguYXRhbjIoLWR5LCAtZHgpICsgUEkyKSAlIFBJMik7XG4gICAgICAgICAgICBjdHgubW92ZVRvKDAsIDApO1xuICAgICAgICAgICAgY3R4LmxpbmVUbygtbGVuZ3RoLCB3aWR0aCAvIDIpO1xuICAgICAgICAgICAgY3R4LmxpbmVUbygtbGVuZ3RoLCAtd2lkdGggLyAyKTtcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB0aGlzLl9fZmlsbFN0cm9rZShjdHgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9fZmlsbFN0cm9rZShjdHgpIHtcbiAgICAgICAgY29uc3QgaXNEYXNoRW5hYmxlZCA9IHRoaXMuZGFzaEVuYWJsZWQoKTtcbiAgICAgICAgaWYgKGlzRGFzaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cnMuZGFzaEVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGN0eC5zZXRMaW5lRGFzaChbXSk7XG4gICAgICAgIH1cbiAgICAgICAgY3R4LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgaWYgKGlzRGFzaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cnMuZGFzaEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFNlbGZSZWN0KCkge1xuICAgICAgICBjb25zdCBsaW5lUmVjdCA9IHN1cGVyLmdldFNlbGZSZWN0KCk7XG4gICAgICAgIGNvbnN0IG9mZnNldCA9IHRoaXMucG9pbnRlcldpZHRoKCkgLyAyO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogbGluZVJlY3QueCxcbiAgICAgICAgICAgIHk6IGxpbmVSZWN0LnkgLSBvZmZzZXQsXG4gICAgICAgICAgICB3aWR0aDogbGluZVJlY3Qud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGxpbmVSZWN0LmhlaWdodCArIG9mZnNldCAqIDIsXG4gICAgICAgIH07XG4gICAgfVxufVxuQXJyb3cucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdBcnJvdyc7XG5fcmVnaXN0ZXJOb2RlKEFycm93KTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEFycm93LCAncG9pbnRlckxlbmd0aCcsIDEwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihBcnJvdywgJ3BvaW50ZXJXaWR0aCcsIDEwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihBcnJvdywgJ3BvaW50ZXJBdEJlZ2lubmluZycsIGZhbHNlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEFycm93LCAncG9pbnRlckF0RW5kaW5nJywgdHJ1ZSk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmV4cG9ydCBjbGFzcyBDaXJjbGUgZXh0ZW5kcyBTaGFwZSB7XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMuYXR0cnMucmFkaXVzIHx8IDAsIDAsIE1hdGguUEkgKiAyLCBmYWxzZSk7XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgIH1cbiAgICBnZXRXaWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFkaXVzKCkgKiAyO1xuICAgIH1cbiAgICBnZXRIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGl1cygpICogMjtcbiAgICB9XG4gICAgc2V0V2lkdGgod2lkdGgpIHtcbiAgICAgICAgaWYgKHRoaXMucmFkaXVzKCkgIT09IHdpZHRoIC8gMikge1xuICAgICAgICAgICAgdGhpcy5yYWRpdXMod2lkdGggLyAyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRIZWlnaHQoaGVpZ2h0KSB7XG4gICAgICAgIGlmICh0aGlzLnJhZGl1cygpICE9PSBoZWlnaHQgLyAyKSB7XG4gICAgICAgICAgICB0aGlzLnJhZGl1cyhoZWlnaHQgLyAyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbkNpcmNsZS5wcm90b3R5cGUuX2NlbnRyb2lkID0gdHJ1ZTtcbkNpcmNsZS5wcm90b3R5cGUuY2xhc3NOYW1lID0gJ0NpcmNsZSc7XG5DaXJjbGUucHJvdG90eXBlLl9hdHRyc0FmZmVjdGluZ1NpemUgPSBbJ3JhZGl1cyddO1xuX3JlZ2lzdGVyTm9kZShDaXJjbGUpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoQ2lyY2xlLCAncmFkaXVzJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9TaGFwZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5leHBvcnQgY2xhc3MgRWxsaXBzZSBleHRlbmRzIFNoYXBlIHtcbiAgICBfc2NlbmVGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcnggPSB0aGlzLnJhZGl1c1goKSwgcnkgPSB0aGlzLnJhZGl1c1koKTtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgIGlmIChyeCAhPT0gcnkpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2NhbGUoMSwgcnkgLyByeCk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgcngsIDAsIE1hdGguUEkgKiAyLCBmYWxzZSk7XG4gICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGl1c1goKSAqIDI7XG4gICAgfVxuICAgIGdldEhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFkaXVzWSgpICogMjtcbiAgICB9XG4gICAgc2V0V2lkdGgod2lkdGgpIHtcbiAgICAgICAgdGhpcy5yYWRpdXNYKHdpZHRoIC8gMik7XG4gICAgfVxuICAgIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5yYWRpdXNZKGhlaWdodCAvIDIpO1xuICAgIH1cbn1cbkVsbGlwc2UucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdFbGxpcHNlJztcbkVsbGlwc2UucHJvdG90eXBlLl9jZW50cm9pZCA9IHRydWU7XG5FbGxpcHNlLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gWydyYWRpdXNYJywgJ3JhZGl1c1knXTtcbl9yZWdpc3Rlck5vZGUoRWxsaXBzZSk7XG5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoRWxsaXBzZSwgJ3JhZGl1cycsIFsneCcsICd5J10pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoRWxsaXBzZSwgJ3JhZGl1c1gnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihFbGxpcHNlLCAncmFkaXVzWScsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbiIsImltcG9ydCB7IFV0aWwgfSBmcm9tIFwiLi4vVXRpbC5qc1wiO1xuaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9TaGFwZS5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmltcG9ydCB7IGdldE51bWJlck9yQXJyYXlPZk51bWJlcnNWYWxpZGF0b3IsIGdldE51bWJlclZhbGlkYXRvciwgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuZXhwb3J0IGNsYXNzIEltYWdlIGV4dGVuZHMgU2hhcGUge1xuICAgIGNvbnN0cnVjdG9yKGF0dHJzKSB7XG4gICAgICAgIHN1cGVyKGF0dHJzKTtcbiAgICAgICAgdGhpcy5fbG9hZExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdERyYXcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbignaW1hZ2VDaGFuZ2Uua29udmEnLCAocHJvcHMpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUltYWdlTG9hZChwcm9wcy5vbGRWYWwpO1xuICAgICAgICAgICAgdGhpcy5fc2V0SW1hZ2VMb2FkKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zZXRJbWFnZUxvYWQoKTtcbiAgICB9XG4gICAgX3NldEltYWdlTG9hZCgpIHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLmltYWdlKCk7XG4gICAgICAgIGlmIChpbWFnZSAmJiBpbWFnZS5jb21wbGV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbWFnZSAmJiBpbWFnZS5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGltYWdlICYmIGltYWdlWydhZGRFdmVudExpc3RlbmVyJ10pIHtcbiAgICAgICAgICAgIGltYWdlWydhZGRFdmVudExpc3RlbmVyJ10oJ2xvYWQnLCB0aGlzLl9sb2FkTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9yZW1vdmVJbWFnZUxvYWQoaW1hZ2UpIHtcbiAgICAgICAgaWYgKGltYWdlICYmIGltYWdlWydyZW1vdmVFdmVudExpc3RlbmVyJ10pIHtcbiAgICAgICAgICAgIGltYWdlWydyZW1vdmVFdmVudExpc3RlbmVyJ10oJ2xvYWQnLCB0aGlzLl9sb2FkTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZUltYWdlTG9hZCh0aGlzLmltYWdlKCkpO1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBfdXNlQnVmZmVyQ2FudmFzKCkge1xuICAgICAgICBjb25zdCBoYXNDb3JuZXJSYWRpdXMgPSAhIXRoaXMuY29ybmVyUmFkaXVzKCk7XG4gICAgICAgIGNvbnN0IGhhc1NoYWRvdyA9IHRoaXMuaGFzU2hhZG93KCk7XG4gICAgICAgIGlmIChoYXNDb3JuZXJSYWRpdXMgJiYgaGFzU2hhZG93KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIuX3VzZUJ1ZmZlckNhbnZhcyh0cnVlKTtcbiAgICB9XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5nZXRXaWR0aCgpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpO1xuICAgICAgICBjb25zdCBjb3JuZXJSYWRpdXMgPSB0aGlzLmNvcm5lclJhZGl1cygpO1xuICAgICAgICBjb25zdCBpbWFnZSA9IHRoaXMuYXR0cnMuaW1hZ2U7XG4gICAgICAgIGxldCBwYXJhbXM7XG4gICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgY29uc3QgY3JvcFdpZHRoID0gdGhpcy5hdHRycy5jcm9wV2lkdGg7XG4gICAgICAgICAgICBjb25zdCBjcm9wSGVpZ2h0ID0gdGhpcy5hdHRycy5jcm9wSGVpZ2h0O1xuICAgICAgICAgICAgaWYgKGNyb3BXaWR0aCAmJiBjcm9wSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gW1xuICAgICAgICAgICAgICAgICAgICBpbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcm9wWCgpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyb3BZKCksXG4gICAgICAgICAgICAgICAgICAgIGNyb3BXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgY3JvcEhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gW2ltYWdlLCAwLCAwLCB3aWR0aCwgaGVpZ2h0XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oYXNGaWxsKCkgfHwgdGhpcy5oYXNTdHJva2UoKSB8fCBjb3JuZXJSYWRpdXMpIHtcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb3JuZXJSYWRpdXNcbiAgICAgICAgICAgICAgICA/IFV0aWwuZHJhd1JvdW5kZWRSZWN0UGF0aChjb250ZXh0LCB3aWR0aCwgaGVpZ2h0LCBjb3JuZXJSYWRpdXMpXG4gICAgICAgICAgICAgICAgOiBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGltYWdlKSB7XG4gICAgICAgICAgICBpZiAoY29ybmVyUmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5jbGlwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZS5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9oaXRGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLndpZHRoKCksIGhlaWdodCA9IHRoaXMuaGVpZ2h0KCksIGNvcm5lclJhZGl1cyA9IHRoaXMuY29ybmVyUmFkaXVzKCk7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGlmICghY29ybmVyUmFkaXVzKSB7XG4gICAgICAgICAgICBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBVdGlsLmRyYXdSb3VuZGVkUmVjdFBhdGgoY29udGV4dCwgd2lkdGgsIGhlaWdodCwgY29ybmVyUmFkaXVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLmF0dHJzLndpZHRoKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2IgPSB0aGlzLmltYWdlKCkpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi53aWR0aDtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gKF9hID0gdGhpcy5hdHRycy5oZWlnaHQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYiA9IHRoaXMuaW1hZ2UoKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmhlaWdodDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21VUkwodXJsLCBjYWxsYmFjaywgb25FcnJvciA9IG51bGwpIHtcbiAgICAgICAgY29uc3QgaW1nID0gVXRpbC5jcmVhdGVJbWFnZUVsZW1lbnQoKTtcbiAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlKHtcbiAgICAgICAgICAgICAgICBpbWFnZTogaW1nLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYWxsYmFjayhpbWFnZSk7XG4gICAgICAgIH07XG4gICAgICAgIGltZy5vbmVycm9yID0gb25FcnJvcjtcbiAgICAgICAgaW1nLmNyb3NzT3JpZ2luID0gJ0Fub255bW91cyc7XG4gICAgICAgIGltZy5zcmMgPSB1cmw7XG4gICAgfVxufVxuSW1hZ2UucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdJbWFnZSc7XG5fcmVnaXN0ZXJOb2RlKEltYWdlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEltYWdlLCAnY29ybmVyUmFkaXVzJywgMCwgZ2V0TnVtYmVyT3JBcnJheU9mTnVtYmVyc1ZhbGlkYXRvcig0KSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihJbWFnZSwgJ2ltYWdlJyk7XG5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoSW1hZ2UsICdjcm9wJywgWyd4JywgJ3knLCAnd2lkdGgnLCAnaGVpZ2h0J10pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoSW1hZ2UsICdjcm9wWCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEltYWdlLCAnY3JvcFknLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihJbWFnZSwgJ2Nyb3BXaWR0aCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEltYWdlLCAnY3JvcEhlaWdodCcsIDAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IEdyb3VwIH0gZnJvbSBcIi4uL0dyb3VwLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJPckFycmF5T2ZOdW1iZXJzVmFsaWRhdG9yLCBnZXROdW1iZXJWYWxpZGF0b3IsIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5jb25zdCBBVFRSX0NIQU5HRV9MSVNUID0gW1xuICAgICdmb250RmFtaWx5JyxcbiAgICAnZm9udFNpemUnLFxuICAgICdmb250U3R5bGUnLFxuICAgICdwYWRkaW5nJyxcbiAgICAnbGluZUhlaWdodCcsXG4gICAgJ3RleHQnLFxuICAgICd3aWR0aCcsXG4gICAgJ2hlaWdodCcsXG4gICAgJ3BvaW50ZXJEaXJlY3Rpb24nLFxuICAgICdwb2ludGVyV2lkdGgnLFxuICAgICdwb2ludGVySGVpZ2h0Jyxcbl0sIENIQU5HRV9LT05WQSA9ICdDaGFuZ2Uua29udmEnLCBOT05FID0gJ25vbmUnLCBVUCA9ICd1cCcsIFJJR0hUID0gJ3JpZ2h0JywgRE9XTiA9ICdkb3duJywgTEVGVCA9ICdsZWZ0JywgYXR0ckNoYW5nZUxpc3RMZW4gPSBBVFRSX0NIQU5HRV9MSVNULmxlbmd0aDtcbmV4cG9ydCBjbGFzcyBMYWJlbCBleHRlbmRzIEdyb3VwIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgc3VwZXIoY29uZmlnKTtcbiAgICAgICAgdGhpcy5vbignYWRkLmtvbnZhJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXJzKGV2dC5jaGlsZCk7XG4gICAgICAgICAgICB0aGlzLl9zeW5jKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kKCdUZXh0JylbMF07XG4gICAgfVxuICAgIGdldFRhZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCgnVGFnJylbMF07XG4gICAgfVxuICAgIF9hZGRMaXN0ZW5lcnModGV4dCkge1xuICAgICAgICBsZXQgdGhhdCA9IHRoaXMsIG47XG4gICAgICAgIGNvbnN0IGZ1bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGF0Ll9zeW5jKCk7XG4gICAgICAgIH07XG4gICAgICAgIGZvciAobiA9IDA7IG4gPCBhdHRyQ2hhbmdlTGlzdExlbjsgbisrKSB7XG4gICAgICAgICAgICB0ZXh0Lm9uKEFUVFJfQ0hBTkdFX0xJU1Rbbl0gKyBDSEFOR0VfS09OVkEsIGZ1bmMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUZXh0KCkud2lkdGgoKTtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUZXh0KCkuaGVpZ2h0KCk7XG4gICAgfVxuICAgIF9zeW5jKCkge1xuICAgICAgICBsZXQgdGV4dCA9IHRoaXMuZ2V0VGV4dCgpLCB0YWcgPSB0aGlzLmdldFRhZygpLCB3aWR0aCwgaGVpZ2h0LCBwb2ludGVyRGlyZWN0aW9uLCBwb2ludGVyV2lkdGgsIHgsIHksIHBvaW50ZXJIZWlnaHQ7XG4gICAgICAgIGlmICh0ZXh0ICYmIHRhZykge1xuICAgICAgICAgICAgd2lkdGggPSB0ZXh0LndpZHRoKCk7XG4gICAgICAgICAgICBoZWlnaHQgPSB0ZXh0LmhlaWdodCgpO1xuICAgICAgICAgICAgcG9pbnRlckRpcmVjdGlvbiA9IHRhZy5wb2ludGVyRGlyZWN0aW9uKCk7XG4gICAgICAgICAgICBwb2ludGVyV2lkdGggPSB0YWcucG9pbnRlcldpZHRoKCk7XG4gICAgICAgICAgICBwb2ludGVySGVpZ2h0ID0gdGFnLnBvaW50ZXJIZWlnaHQoKTtcbiAgICAgICAgICAgIHggPSAwO1xuICAgICAgICAgICAgeSA9IDA7XG4gICAgICAgICAgICBzd2l0Y2ggKHBvaW50ZXJEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjYXNlIFVQOlxuICAgICAgICAgICAgICAgICAgICB4ID0gd2lkdGggLyAyO1xuICAgICAgICAgICAgICAgICAgICB5ID0gLTEgKiBwb2ludGVySGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFJJR0hUOlxuICAgICAgICAgICAgICAgICAgICB4ID0gd2lkdGggKyBwb2ludGVyV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHkgPSBoZWlnaHQgLyAyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIERPV046XG4gICAgICAgICAgICAgICAgICAgIHggPSB3aWR0aCAvIDI7XG4gICAgICAgICAgICAgICAgICAgIHkgPSBoZWlnaHQgKyBwb2ludGVySGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIExFRlQ6XG4gICAgICAgICAgICAgICAgICAgIHggPSAtMSAqIHBvaW50ZXJXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgeSA9IGhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFnLnNldEF0dHJzKHtcbiAgICAgICAgICAgICAgICB4OiAtMSAqIHgsXG4gICAgICAgICAgICAgICAgeTogLTEgKiB5LFxuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGV4dC5zZXRBdHRycyh7XG4gICAgICAgICAgICAgICAgeDogLTEgKiB4LFxuICAgICAgICAgICAgICAgIHk6IC0xICogeSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuTGFiZWwucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdMYWJlbCc7XG5fcmVnaXN0ZXJOb2RlKExhYmVsKTtcbmV4cG9ydCBjbGFzcyBUYWcgZXh0ZW5kcyBTaGFwZSB7XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCgpLCBoZWlnaHQgPSB0aGlzLmhlaWdodCgpLCBwb2ludGVyRGlyZWN0aW9uID0gdGhpcy5wb2ludGVyRGlyZWN0aW9uKCksIHBvaW50ZXJXaWR0aCA9IHRoaXMucG9pbnRlcldpZHRoKCksIHBvaW50ZXJIZWlnaHQgPSB0aGlzLnBvaW50ZXJIZWlnaHQoKSwgY29ybmVyUmFkaXVzID0gdGhpcy5jb3JuZXJSYWRpdXMoKTtcbiAgICAgICAgbGV0IHRvcExlZnQgPSAwO1xuICAgICAgICBsZXQgdG9wUmlnaHQgPSAwO1xuICAgICAgICBsZXQgYm90dG9tTGVmdCA9IDA7XG4gICAgICAgIGxldCBib3R0b21SaWdodCA9IDA7XG4gICAgICAgIGlmICh0eXBlb2YgY29ybmVyUmFkaXVzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdG9wTGVmdCA9XG4gICAgICAgICAgICAgICAgdG9wUmlnaHQgPVxuICAgICAgICAgICAgICAgICAgICBib3R0b21MZWZ0ID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbVJpZ2h0ID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihjb3JuZXJSYWRpdXMsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0b3BMZWZ0ID0gTWF0aC5taW4oY29ybmVyUmFkaXVzWzBdIHx8IDAsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICB0b3BSaWdodCA9IE1hdGgubWluKGNvcm5lclJhZGl1c1sxXSB8fCAwLCB3aWR0aCAvIDIsIGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgYm90dG9tUmlnaHQgPSBNYXRoLm1pbihjb3JuZXJSYWRpdXNbMl0gfHwgMCwgd2lkdGggLyAyLCBoZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIGJvdHRvbUxlZnQgPSBNYXRoLm1pbihjb3JuZXJSYWRpdXNbM10gfHwgMCwgd2lkdGggLyAyLCBoZWlnaHQgLyAyKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICBjb250ZXh0Lm1vdmVUbyh0b3BMZWZ0LCAwKTtcbiAgICAgICAgaWYgKHBvaW50ZXJEaXJlY3Rpb24gPT09IFVQKSB7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbygod2lkdGggLSBwb2ludGVyV2lkdGgpIC8gMiwgMCk7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCAvIDIsIC0xICogcG9pbnRlckhlaWdodCk7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbygod2lkdGggKyBwb2ludGVyV2lkdGgpIC8gMiwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGggLSB0b3BSaWdodCwgMCk7XG4gICAgICAgIGNvbnRleHQuYXJjKHdpZHRoIC0gdG9wUmlnaHQsIHRvcFJpZ2h0LCB0b3BSaWdodCwgKE1hdGguUEkgKiAzKSAvIDIsIDAsIGZhbHNlKTtcbiAgICAgICAgaWYgKHBvaW50ZXJEaXJlY3Rpb24gPT09IFJJR0hUKSB7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCwgKGhlaWdodCAtIHBvaW50ZXJIZWlnaHQpIC8gMik7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCArIHBvaW50ZXJXaWR0aCwgaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCwgKGhlaWdodCArIHBvaW50ZXJIZWlnaHQpIC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGgsIGhlaWdodCAtIGJvdHRvbVJpZ2h0KTtcbiAgICAgICAgY29udGV4dC5hcmMod2lkdGggLSBib3R0b21SaWdodCwgaGVpZ2h0IC0gYm90dG9tUmlnaHQsIGJvdHRvbVJpZ2h0LCAwLCBNYXRoLlBJIC8gMiwgZmFsc2UpO1xuICAgICAgICBpZiAocG9pbnRlckRpcmVjdGlvbiA9PT0gRE9XTikge1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oKHdpZHRoICsgcG9pbnRlcldpZHRoKSAvIDIsIGhlaWdodCk7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCAvIDIsIGhlaWdodCArIHBvaW50ZXJIZWlnaHQpO1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oKHdpZHRoIC0gcG9pbnRlcldpZHRoKSAvIDIsIGhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5saW5lVG8oYm90dG9tTGVmdCwgaGVpZ2h0KTtcbiAgICAgICAgY29udGV4dC5hcmMoYm90dG9tTGVmdCwgaGVpZ2h0IC0gYm90dG9tTGVmdCwgYm90dG9tTGVmdCwgTWF0aC5QSSAvIDIsIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgaWYgKHBvaW50ZXJEaXJlY3Rpb24gPT09IExFRlQpIHtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKDAsIChoZWlnaHQgKyBwb2ludGVySGVpZ2h0KSAvIDIpO1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oLTEgKiBwb2ludGVyV2lkdGgsIGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oMCwgKGhlaWdodCAtIHBvaW50ZXJIZWlnaHQpIC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5saW5lVG8oMCwgdG9wTGVmdCk7XG4gICAgICAgIGNvbnRleHQuYXJjKHRvcExlZnQsIHRvcExlZnQsIHRvcExlZnQsIE1hdGguUEksIChNYXRoLlBJICogMykgLyAyLCBmYWxzZSk7XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgbGV0IHggPSAwLCB5ID0gMCwgcG9pbnRlcldpZHRoID0gdGhpcy5wb2ludGVyV2lkdGgoKSwgcG9pbnRlckhlaWdodCA9IHRoaXMucG9pbnRlckhlaWdodCgpLCBkaXJlY3Rpb24gPSB0aGlzLnBvaW50ZXJEaXJlY3Rpb24oKSwgd2lkdGggPSB0aGlzLndpZHRoKCksIGhlaWdodCA9IHRoaXMuaGVpZ2h0KCk7XG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09IFVQKSB7XG4gICAgICAgICAgICB5IC09IHBvaW50ZXJIZWlnaHQ7XG4gICAgICAgICAgICBoZWlnaHQgKz0gcG9pbnRlckhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaXJlY3Rpb24gPT09IERPV04pIHtcbiAgICAgICAgICAgIGhlaWdodCArPSBwb2ludGVySGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gTEVGVCkge1xuICAgICAgICAgICAgeCAtPSBwb2ludGVyV2lkdGggKiAxLjU7XG4gICAgICAgICAgICB3aWR0aCArPSBwb2ludGVyV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlyZWN0aW9uID09PSBSSUdIVCkge1xuICAgICAgICAgICAgd2lkdGggKz0gcG9pbnRlcldpZHRoICogMS41O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgeTogeSxcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICB9O1xuICAgIH1cbn1cblRhZy5wcm90b3R5cGUuY2xhc3NOYW1lID0gJ1RhZyc7XG5fcmVnaXN0ZXJOb2RlKFRhZyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUYWcsICdwb2ludGVyRGlyZWN0aW9uJywgTk9ORSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUYWcsICdwb2ludGVyV2lkdGgnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUYWcsICdwb2ludGVySGVpZ2h0JywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGFnLCAnY29ybmVyUmFkaXVzJywgMCwgZ2V0TnVtYmVyT3JBcnJheU9mTnVtYmVyc1ZhbGlkYXRvcig0KSk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9TaGFwZS5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyQXJyYXlWYWxpZGF0b3IsIGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5mdW5jdGlvbiBnZXRDb250cm9sUG9pbnRzKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHQpIHtcbiAgICBjb25zdCBkMDEgPSBNYXRoLnNxcnQoTWF0aC5wb3coeDEgLSB4MCwgMikgKyBNYXRoLnBvdyh5MSAtIHkwLCAyKSksIGQxMiA9IE1hdGguc3FydChNYXRoLnBvdyh4MiAtIHgxLCAyKSArIE1hdGgucG93KHkyIC0geTEsIDIpKSwgZmEgPSAodCAqIGQwMSkgLyAoZDAxICsgZDEyKSwgZmIgPSAodCAqIGQxMikgLyAoZDAxICsgZDEyKSwgcDF4ID0geDEgLSBmYSAqICh4MiAtIHgwKSwgcDF5ID0geTEgLSBmYSAqICh5MiAtIHkwKSwgcDJ4ID0geDEgKyBmYiAqICh4MiAtIHgwKSwgcDJ5ID0geTEgKyBmYiAqICh5MiAtIHkwKTtcbiAgICByZXR1cm4gW3AxeCwgcDF5LCBwMngsIHAyeV07XG59XG5mdW5jdGlvbiBleHBhbmRQb2ludHMocCwgdGVuc2lvbikge1xuICAgIGNvbnN0IGxlbiA9IHAubGVuZ3RoLCBhbGxQb2ludHMgPSBbXTtcbiAgICBmb3IgKGxldCBuID0gMjsgbiA8IGxlbiAtIDI7IG4gKz0gMikge1xuICAgICAgICBjb25zdCBjcCA9IGdldENvbnRyb2xQb2ludHMocFtuIC0gMl0sIHBbbiAtIDFdLCBwW25dLCBwW24gKyAxXSwgcFtuICsgMl0sIHBbbiArIDNdLCB0ZW5zaW9uKTtcbiAgICAgICAgaWYgKGlzTmFOKGNwWzBdKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgYWxsUG9pbnRzLnB1c2goY3BbMF0pO1xuICAgICAgICBhbGxQb2ludHMucHVzaChjcFsxXSk7XG4gICAgICAgIGFsbFBvaW50cy5wdXNoKHBbbl0pO1xuICAgICAgICBhbGxQb2ludHMucHVzaChwW24gKyAxXSk7XG4gICAgICAgIGFsbFBvaW50cy5wdXNoKGNwWzJdKTtcbiAgICAgICAgYWxsUG9pbnRzLnB1c2goY3BbM10pO1xuICAgIH1cbiAgICByZXR1cm4gYWxsUG9pbnRzO1xufVxuZXhwb3J0IGNsYXNzIExpbmUgZXh0ZW5kcyBTaGFwZSB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyKGNvbmZpZyk7XG4gICAgICAgIHRoaXMub24oJ3BvaW50c0NoYW5nZS5rb252YSB0ZW5zaW9uQ2hhbmdlLmtvbnZhIGNsb3NlZENoYW5nZS5rb252YSBiZXppZXJDaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKCd0ZW5zaW9uUG9pbnRzJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfc2NlbmVGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gdGhpcy5wb2ludHMoKSwgbGVuZ3RoID0gcG9pbnRzLmxlbmd0aCwgdGVuc2lvbiA9IHRoaXMudGVuc2lvbigpLCBjbG9zZWQgPSB0aGlzLmNsb3NlZCgpLCBiZXppZXIgPSB0aGlzLmJlemllcigpO1xuICAgICAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuID0gMDtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgY29udGV4dC5tb3ZlVG8ocG9pbnRzWzBdLCBwb2ludHNbMV0pO1xuICAgICAgICBpZiAodGVuc2lvbiAhPT0gMCAmJiBsZW5ndGggPiA0KSB7XG4gICAgICAgICAgICBjb25zdCB0cCA9IHRoaXMuZ2V0VGVuc2lvblBvaW50cygpO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gdHAubGVuZ3RoO1xuICAgICAgICAgICAgbiA9IGNsb3NlZCA/IDAgOiA0O1xuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8odHBbMF0sIHRwWzFdLCB0cFsyXSwgdHBbM10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKG4gPCBsZW4gLSAyKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8odHBbbGVuIC0gMl0sIHRwW2xlbiAtIDFdLCBwb2ludHNbbGVuZ3RoIC0gMl0sIHBvaW50c1tsZW5ndGggLSAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYmV6aWVyKSB7XG4gICAgICAgICAgICBuID0gMjtcbiAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKHBvaW50c1tuKytdLCBwb2ludHNbbisrXSwgcG9pbnRzW24rK10sIHBvaW50c1tuKytdLCBwb2ludHNbbisrXSwgcG9pbnRzW24rK10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChuID0gMjsgbiA8IGxlbmd0aDsgbiArPSAyKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8ocG9pbnRzW25dLCBwb2ludHNbbiArIDFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xvc2VkKSB7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFRlbnNpb25Qb2ludHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZSgndGVuc2lvblBvaW50cycsIHRoaXMuX2dldFRlbnNpb25Qb2ludHMpO1xuICAgIH1cbiAgICBfZ2V0VGVuc2lvblBvaW50cygpIHtcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRUZW5zaW9uUG9pbnRzQ2xvc2VkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwYW5kUG9pbnRzKHRoaXMucG9pbnRzKCksIHRoaXMudGVuc2lvbigpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfZ2V0VGVuc2lvblBvaW50c0Nsb3NlZCgpIHtcbiAgICAgICAgY29uc3QgcCA9IHRoaXMucG9pbnRzKCksIGxlbiA9IHAubGVuZ3RoLCB0ZW5zaW9uID0gdGhpcy50ZW5zaW9uKCksIGZpcnN0Q29udHJvbFBvaW50cyA9IGdldENvbnRyb2xQb2ludHMocFtsZW4gLSAyXSwgcFtsZW4gLSAxXSwgcFswXSwgcFsxXSwgcFsyXSwgcFszXSwgdGVuc2lvbiksIGxhc3RDb250cm9sUG9pbnRzID0gZ2V0Q29udHJvbFBvaW50cyhwW2xlbiAtIDRdLCBwW2xlbiAtIDNdLCBwW2xlbiAtIDJdLCBwW2xlbiAtIDFdLCBwWzBdLCBwWzFdLCB0ZW5zaW9uKSwgbWlkZGxlID0gZXhwYW5kUG9pbnRzKHAsIHRlbnNpb24pLCB0cCA9IFtmaXJzdENvbnRyb2xQb2ludHNbMl0sIGZpcnN0Q29udHJvbFBvaW50c1szXV1cbiAgICAgICAgICAgIC5jb25jYXQobWlkZGxlKVxuICAgICAgICAgICAgLmNvbmNhdChbXG4gICAgICAgICAgICBsYXN0Q29udHJvbFBvaW50c1swXSxcbiAgICAgICAgICAgIGxhc3RDb250cm9sUG9pbnRzWzFdLFxuICAgICAgICAgICAgcFtsZW4gLSAyXSxcbiAgICAgICAgICAgIHBbbGVuIC0gMV0sXG4gICAgICAgICAgICBsYXN0Q29udHJvbFBvaW50c1syXSxcbiAgICAgICAgICAgIGxhc3RDb250cm9sUG9pbnRzWzNdLFxuICAgICAgICAgICAgZmlyc3RDb250cm9sUG9pbnRzWzBdLFxuICAgICAgICAgICAgZmlyc3RDb250cm9sUG9pbnRzWzFdLFxuICAgICAgICAgICAgcFswXSxcbiAgICAgICAgICAgIHBbMV0sXG4gICAgICAgIF0pO1xuICAgICAgICByZXR1cm4gdHA7XG4gICAgfVxuICAgIGdldFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTZWxmUmVjdCgpLndpZHRoO1xuICAgIH1cbiAgICBnZXRIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNlbGZSZWN0KCkuaGVpZ2h0O1xuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgbGV0IHBvaW50cyA9IHRoaXMucG9pbnRzKCk7XG4gICAgICAgIGlmIChwb2ludHMubGVuZ3RoIDwgNCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB4OiBwb2ludHNbMF0gfHwgMCxcbiAgICAgICAgICAgICAgICB5OiBwb2ludHNbMV0gfHwgMCxcbiAgICAgICAgICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRlbnNpb24oKSAhPT0gMCkge1xuICAgICAgICAgICAgcG9pbnRzID0gW1xuICAgICAgICAgICAgICAgIHBvaW50c1swXSxcbiAgICAgICAgICAgICAgICBwb2ludHNbMV0sXG4gICAgICAgICAgICAgICAgLi4udGhpcy5fZ2V0VGVuc2lvblBvaW50cygpLFxuICAgICAgICAgICAgICAgIHBvaW50c1twb2ludHMubGVuZ3RoIC0gMl0sXG4gICAgICAgICAgICAgICAgcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXSxcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb2ludHMgPSB0aGlzLnBvaW50cygpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBtaW5YID0gcG9pbnRzWzBdO1xuICAgICAgICBsZXQgbWF4WCA9IHBvaW50c1swXTtcbiAgICAgICAgbGV0IG1pblkgPSBwb2ludHNbMV07XG4gICAgICAgIGxldCBtYXhZID0gcG9pbnRzWzFdO1xuICAgICAgICBsZXQgeCwgeTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICB4ID0gcG9pbnRzW2kgKiAyXTtcbiAgICAgICAgICAgIHkgPSBwb2ludHNbaSAqIDIgKyAxXTtcbiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCB4KTtcbiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCB4KTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB5KTtcbiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCB5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogbWluWCxcbiAgICAgICAgICAgIHk6IG1pblksXG4gICAgICAgICAgICB3aWR0aDogbWF4WCAtIG1pblgsXG4gICAgICAgICAgICBoZWlnaHQ6IG1heFkgLSBtaW5ZLFxuICAgICAgICB9O1xuICAgIH1cbn1cbkxpbmUucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdMaW5lJztcbkxpbmUucHJvdG90eXBlLl9hdHRyc0FmZmVjdGluZ1NpemUgPSBbJ3BvaW50cycsICdiZXppZXInLCAndGVuc2lvbiddO1xuX3JlZ2lzdGVyTm9kZShMaW5lKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKExpbmUsICdjbG9zZWQnLCBmYWxzZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihMaW5lLCAnYmV6aWVyJywgZmFsc2UpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoTGluZSwgJ3RlbnNpb24nLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihMaW5lLCAncG9pbnRzJywgW10sIGdldE51bWJlckFycmF5VmFsaWRhdG9yKCkpO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IGdldEN1YmljQXJjTGVuZ3RoLCBnZXRRdWFkcmF0aWNBcmNMZW5ndGgsIHQybGVuZ3RoLCB9IGZyb20gXCIuLi9CZXppZXJGdW5jdGlvbnMuanNcIjtcbmV4cG9ydCBjbGFzcyBQYXRoIGV4dGVuZHMgU2hhcGUge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgICAgICBzdXBlcihjb25maWcpO1xuICAgICAgICB0aGlzLmRhdGFBcnJheSA9IFtdO1xuICAgICAgICB0aGlzLnBhdGhMZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9yZWFkRGF0YUF0dHJpYnV0ZSgpO1xuICAgICAgICB0aGlzLm9uKCdkYXRhQ2hhbmdlLmtvbnZhJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fcmVhZERhdGFBdHRyaWJ1dGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9yZWFkRGF0YUF0dHJpYnV0ZSgpIHtcbiAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSBQYXRoLnBhcnNlUGF0aERhdGEodGhpcy5kYXRhKCkpO1xuICAgICAgICB0aGlzLnBhdGhMZW5ndGggPSBQYXRoLmdldFBhdGhMZW5ndGgodGhpcy5kYXRhQXJyYXkpO1xuICAgIH1cbiAgICBfc2NlbmVGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgY2EgPSB0aGlzLmRhdGFBcnJheTtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgbGV0IGlzQ2xvc2VkID0gZmFsc2U7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgY2EubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBjYVtuXS5jb21tYW5kO1xuICAgICAgICAgICAgY29uc3QgcCA9IGNhW25dLnBvaW50cztcbiAgICAgICAgICAgIHN3aXRjaCAoYykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ0wnOlxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwWzBdLCBwWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTSc6XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHBbMF0sIHBbMV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdDJzpcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKHBbMF0sIHBbMV0sIHBbMl0sIHBbM10sIHBbNF0sIHBbNV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdRJzpcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKHBbMF0sIHBbMV0sIHBbMl0sIHBbM10pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3ggPSBwWzBdLCBjeSA9IHBbMV0sIHJ4ID0gcFsyXSwgcnkgPSBwWzNdLCB0aGV0YSA9IHBbNF0sIGRUaGV0YSA9IHBbNV0sIHBzaSA9IHBbNl0sIGZzID0gcFs3XTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHJ4ID4gcnkgPyByeCA6IHJ5O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY2FsZVggPSByeCA+IHJ5ID8gMSA6IHJ4IC8gcnk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjYWxlWSA9IHJ4ID4gcnkgPyByeSAvIHJ4IDogMTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoY3gsIGN5KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yb3RhdGUocHNpKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZShzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHIsIHRoZXRhLCB0aGV0YSArIGRUaGV0YSwgMSAtIGZzKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZSgxIC8gc2NhbGVYLCAxIC8gc2NhbGVZKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yb3RhdGUoLXBzaSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKC1jeCwgLWN5KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAneic6XG4gICAgICAgICAgICAgICAgICAgIGlzQ2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0Nsb3NlZCAmJiAhdGhpcy5oYXNGaWxsKCkpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgbGV0IHBvaW50cyA9IFtdO1xuICAgICAgICB0aGlzLmRhdGFBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5jb21tYW5kID09PSAnQScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IGRhdGEucG9pbnRzWzRdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRUaGV0YSA9IGRhdGEucG9pbnRzWzVdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IGRhdGEucG9pbnRzWzRdICsgZFRoZXRhO1xuICAgICAgICAgICAgICAgIGxldCBpbmMgPSBNYXRoLlBJIC8gMTgwLjA7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHN0YXJ0IC0gZW5kKSA8IGluYykge1xuICAgICAgICAgICAgICAgICAgICBpbmMgPSBNYXRoLmFicyhzdGFydCAtIGVuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkVGhldGEgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgPSBzdGFydCAtIGluYzsgdCA+IGVuZDsgdCAtPSBpbmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50ID0gUGF0aC5nZXRQb2ludE9uRWxsaXB0aWNhbEFyYyhkYXRhLnBvaW50c1swXSwgZGF0YS5wb2ludHNbMV0sIGRhdGEucG9pbnRzWzJdLCBkYXRhLnBvaW50c1szXSwgdCwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChwb2ludC54LCBwb2ludC55KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IHN0YXJ0ICsgaW5jOyB0IDwgZW5kOyB0ICs9IGluYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9pbnQgPSBQYXRoLmdldFBvaW50T25FbGxpcHRpY2FsQXJjKGRhdGEucG9pbnRzWzBdLCBkYXRhLnBvaW50c1sxXSwgZGF0YS5wb2ludHNbMl0sIGRhdGEucG9pbnRzWzNdLCB0LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKHBvaW50LngsIHBvaW50LnkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5jb21tYW5kID09PSAnQycpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gMC4wOyB0IDw9IDE7IHQgKz0gMC4wMSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwb2ludCA9IFBhdGguZ2V0UG9pbnRPbkN1YmljQmV6aWVyKHQsIGRhdGEuc3RhcnQueCwgZGF0YS5zdGFydC55LCBkYXRhLnBvaW50c1swXSwgZGF0YS5wb2ludHNbMV0sIGRhdGEucG9pbnRzWzJdLCBkYXRhLnBvaW50c1szXSwgZGF0YS5wb2ludHNbNF0sIGRhdGEucG9pbnRzWzVdKTtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2gocG9pbnQueCwgcG9pbnQueSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9pbnRzID0gcG9pbnRzLmNvbmNhdChkYXRhLnBvaW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgbWluWCA9IHBvaW50c1swXTtcbiAgICAgICAgbGV0IG1heFggPSBwb2ludHNbMF07XG4gICAgICAgIGxldCBtaW5ZID0gcG9pbnRzWzFdO1xuICAgICAgICBsZXQgbWF4WSA9IHBvaW50c1sxXTtcbiAgICAgICAgbGV0IHgsIHk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aCAvIDI7IGkrKykge1xuICAgICAgICAgICAgeCA9IHBvaW50c1tpICogMl07XG4gICAgICAgICAgICB5ID0gcG9pbnRzW2kgKiAyICsgMV07XG4gICAgICAgICAgICBpZiAoIWlzTmFOKHgpKSB7XG4gICAgICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIHgpO1xuICAgICAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCB4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNOYU4oeSkpIHtcbiAgICAgICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgeSk7XG4gICAgICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBtaW5YLFxuICAgICAgICAgICAgeTogbWluWSxcbiAgICAgICAgICAgIHdpZHRoOiBtYXhYIC0gbWluWCxcbiAgICAgICAgICAgIGhlaWdodDogbWF4WSAtIG1pblksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldExlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aExlbmd0aDtcbiAgICB9XG4gICAgZ2V0UG9pbnRBdExlbmd0aChsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFBhdGguZ2V0UG9pbnRBdExlbmd0aE9mRGF0YUFycmF5KGxlbmd0aCwgdGhpcy5kYXRhQXJyYXkpO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0TGluZUxlbmd0aCh4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KCh4MiAtIHgxKSAqICh4MiAtIHgxKSArICh5MiAtIHkxKSAqICh5MiAtIHkxKSk7XG4gICAgfVxuICAgIHN0YXRpYyBnZXRQYXRoTGVuZ3RoKGRhdGFBcnJheSkge1xuICAgICAgICBsZXQgcGF0aExlbmd0aCA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YUFycmF5Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBwYXRoTGVuZ3RoICs9IGRhdGFBcnJheVtpXS5wYXRoTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRoTGVuZ3RoO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0UG9pbnRBdExlbmd0aE9mRGF0YUFycmF5KGxlbmd0aCwgZGF0YUFycmF5KSB7XG4gICAgICAgIGxldCBwb2ludHMsIGkgPSAwLCBpaSA9IGRhdGFBcnJheS5sZW5ndGg7XG4gICAgICAgIGlmICghaWkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChpIDwgaWkgJiYgbGVuZ3RoID4gZGF0YUFycmF5W2ldLnBhdGhMZW5ndGgpIHtcbiAgICAgICAgICAgIGxlbmd0aCAtPSBkYXRhQXJyYXlbaV0ucGF0aExlbmd0aDtcbiAgICAgICAgICAgICsraTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaSA9PT0gaWkpIHtcbiAgICAgICAgICAgIHBvaW50cyA9IGRhdGFBcnJheVtpIC0gMV0ucG9pbnRzLnNsaWNlKC0yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogcG9pbnRzWzBdLFxuICAgICAgICAgICAgICAgIHk6IHBvaW50c1sxXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aCA8IDAuMDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNtZCA9IGRhdGFBcnJheVtpXS5jb21tYW5kO1xuICAgICAgICAgICAgaWYgKGNtZCA9PT0gJ00nKSB7XG4gICAgICAgICAgICAgICAgcG9pbnRzID0gZGF0YUFycmF5W2ldLnBvaW50cy5zbGljZSgwLCAyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB4OiBwb2ludHNbMF0sXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvaW50c1sxXSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgeDogZGF0YUFycmF5W2ldLnN0YXJ0LngsXG4gICAgICAgICAgICAgICAgICAgIHk6IGRhdGFBcnJheVtpXS5zdGFydC55LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3AgPSBkYXRhQXJyYXlbaV07XG4gICAgICAgIGNvbnN0IHAgPSBjcC5wb2ludHM7XG4gICAgICAgIHN3aXRjaCAoY3AuY29tbWFuZCkge1xuICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFBhdGguZ2V0UG9pbnRPbkxpbmUobGVuZ3RoLCBjcC5zdGFydC54LCBjcC5zdGFydC55LCBwWzBdLCBwWzFdKTtcbiAgICAgICAgICAgIGNhc2UgJ0MnOlxuICAgICAgICAgICAgICAgIHJldHVybiBQYXRoLmdldFBvaW50T25DdWJpY0Jlemllcih0Mmxlbmd0aChsZW5ndGgsIFBhdGguZ2V0UGF0aExlbmd0aChkYXRhQXJyYXkpLCAoaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q3ViaWNBcmNMZW5ndGgoW2NwLnN0YXJ0LngsIHBbMF0sIHBbMl0sIHBbNF1dLCBbY3Auc3RhcnQueSwgcFsxXSwgcFszXSwgcFs1XV0sIGkpO1xuICAgICAgICAgICAgICAgIH0pLCBjcC5zdGFydC54LCBjcC5zdGFydC55LCBwWzBdLCBwWzFdLCBwWzJdLCBwWzNdLCBwWzRdLCBwWzVdKTtcbiAgICAgICAgICAgIGNhc2UgJ1EnOlxuICAgICAgICAgICAgICAgIHJldHVybiBQYXRoLmdldFBvaW50T25RdWFkcmF0aWNCZXppZXIodDJsZW5ndGgobGVuZ3RoLCBQYXRoLmdldFBhdGhMZW5ndGgoZGF0YUFycmF5KSwgKGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFF1YWRyYXRpY0FyY0xlbmd0aChbY3Auc3RhcnQueCwgcFswXSwgcFsyXV0sIFtjcC5zdGFydC55LCBwWzFdLCBwWzNdXSwgaSk7XG4gICAgICAgICAgICAgICAgfSksIGNwLnN0YXJ0LngsIGNwLnN0YXJ0LnksIHBbMF0sIHBbMV0sIHBbMl0sIHBbM10pO1xuICAgICAgICAgICAgY2FzZSAnQSc6XG4gICAgICAgICAgICAgICAgY29uc3QgY3ggPSBwWzBdLCBjeSA9IHBbMV0sIHJ4ID0gcFsyXSwgcnkgPSBwWzNdLCBkVGhldGEgPSBwWzVdLCBwc2kgPSBwWzZdO1xuICAgICAgICAgICAgICAgIGxldCB0aGV0YSA9IHBbNF07XG4gICAgICAgICAgICAgICAgdGhldGEgKz0gKGRUaGV0YSAqIGxlbmd0aCkgLyBjcC5wYXRoTGVuZ3RoO1xuICAgICAgICAgICAgICAgIHJldHVybiBQYXRoLmdldFBvaW50T25FbGxpcHRpY2FsQXJjKGN4LCBjeSwgcngsIHJ5LCB0aGV0YSwgcHNpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIGdldFBvaW50T25MaW5lKGRpc3QsIFAxeCwgUDF5LCBQMngsIFAyeSwgZnJvbVgsIGZyb21ZKSB7XG4gICAgICAgIGZyb21YID0gZnJvbVggIT09IG51bGwgJiYgZnJvbVggIT09IHZvaWQgMCA/IGZyb21YIDogUDF4O1xuICAgICAgICBmcm9tWSA9IGZyb21ZICE9PSBudWxsICYmIGZyb21ZICE9PSB2b2lkIDAgPyBmcm9tWSA6IFAxeTtcbiAgICAgICAgY29uc3QgbGVuID0gdGhpcy5nZXRMaW5lTGVuZ3RoKFAxeCwgUDF5LCBQMngsIFAyeSk7XG4gICAgICAgIGlmIChsZW4gPCAxZS0xMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgeDogUDF4LCB5OiBQMXkgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUDJ4ID09PSBQMXgpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHg6IGZyb21YLCB5OiBmcm9tWSArIChQMnkgPiBQMXkgPyBkaXN0IDogLWRpc3QpIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbSA9IChQMnkgLSBQMXkpIC8gKFAyeCAtIFAxeCk7XG4gICAgICAgIGNvbnN0IHJ1biA9IE1hdGguc3FydCgoZGlzdCAqIGRpc3QpIC8gKDEgKyBtICogbSkpICogKFAyeCA8IFAxeCA/IC0xIDogMSk7XG4gICAgICAgIGNvbnN0IHJpc2UgPSBtICogcnVuO1xuICAgICAgICBpZiAoTWF0aC5hYnMoZnJvbVkgLSBQMXkgLSBtICogKGZyb21YIC0gUDF4KSkgPCAxZS0xMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgeDogZnJvbVggKyBydW4sIHk6IGZyb21ZICsgcmlzZSB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHUgPSAoKGZyb21YIC0gUDF4KSAqIChQMnggLSBQMXgpICsgKGZyb21ZIC0gUDF5KSAqIChQMnkgLSBQMXkpKSAvIChsZW4gKiBsZW4pO1xuICAgICAgICBjb25zdCBpeCA9IFAxeCArIHUgKiAoUDJ4IC0gUDF4KTtcbiAgICAgICAgY29uc3QgaXkgPSBQMXkgKyB1ICogKFAyeSAtIFAxeSk7XG4gICAgICAgIGNvbnN0IHBSaXNlID0gdGhpcy5nZXRMaW5lTGVuZ3RoKGZyb21YLCBmcm9tWSwgaXgsIGl5KTtcbiAgICAgICAgY29uc3QgcFJ1biA9IE1hdGguc3FydChkaXN0ICogZGlzdCAtIHBSaXNlICogcFJpc2UpO1xuICAgICAgICBjb25zdCBhZGp1c3RlZFJ1biA9IE1hdGguc3FydCgocFJ1biAqIHBSdW4pIC8gKDEgKyBtICogbSkpICogKFAyeCA8IFAxeCA/IC0xIDogMSk7XG4gICAgICAgIGNvbnN0IGFkanVzdGVkUmlzZSA9IG0gKiBhZGp1c3RlZFJ1bjtcbiAgICAgICAgcmV0dXJuIHsgeDogaXggKyBhZGp1c3RlZFJ1biwgeTogaXkgKyBhZGp1c3RlZFJpc2UgfTtcbiAgICB9XG4gICAgc3RhdGljIGdldFBvaW50T25DdWJpY0JlemllcihwY3QsIFAxeCwgUDF5LCBQMngsIFAyeSwgUDN4LCBQM3ksIFA0eCwgUDR5KSB7XG4gICAgICAgIGZ1bmN0aW9uIENCMSh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdCAqIHQgKiB0O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIENCMih0KSB7XG4gICAgICAgICAgICByZXR1cm4gMyAqIHQgKiB0ICogKDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBDQjModCkge1xuICAgICAgICAgICAgcmV0dXJuIDMgKiB0ICogKDEgLSB0KSAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gQ0I0KHQpIHtcbiAgICAgICAgICAgIHJldHVybiAoMSAtIHQpICogKDEgLSB0KSAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeCA9IFA0eCAqIENCMShwY3QpICsgUDN4ICogQ0IyKHBjdCkgKyBQMnggKiBDQjMocGN0KSArIFAxeCAqIENCNChwY3QpO1xuICAgICAgICBjb25zdCB5ID0gUDR5ICogQ0IxKHBjdCkgKyBQM3kgKiBDQjIocGN0KSArIFAyeSAqIENCMyhwY3QpICsgUDF5ICogQ0I0KHBjdCk7XG4gICAgICAgIHJldHVybiB7IHgsIHkgfTtcbiAgICB9XG4gICAgc3RhdGljIGdldFBvaW50T25RdWFkcmF0aWNCZXppZXIocGN0LCBQMXgsIFAxeSwgUDJ4LCBQMnksIFAzeCwgUDN5KSB7XG4gICAgICAgIGZ1bmN0aW9uIFFCMSh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdCAqIHQ7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gUUIyKHQpIHtcbiAgICAgICAgICAgIHJldHVybiAyICogdCAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gUUIzKHQpIHtcbiAgICAgICAgICAgIHJldHVybiAoMSAtIHQpICogKDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB4ID0gUDN4ICogUUIxKHBjdCkgKyBQMnggKiBRQjIocGN0KSArIFAxeCAqIFFCMyhwY3QpO1xuICAgICAgICBjb25zdCB5ID0gUDN5ICogUUIxKHBjdCkgKyBQMnkgKiBRQjIocGN0KSArIFAxeSAqIFFCMyhwY3QpO1xuICAgICAgICByZXR1cm4geyB4LCB5IH07XG4gICAgfVxuICAgIHN0YXRpYyBnZXRQb2ludE9uRWxsaXB0aWNhbEFyYyhjeCwgY3ksIHJ4LCByeSwgdGhldGEsIHBzaSkge1xuICAgICAgICBjb25zdCBjb3NQc2kgPSBNYXRoLmNvcyhwc2kpLCBzaW5Qc2kgPSBNYXRoLnNpbihwc2kpO1xuICAgICAgICBjb25zdCBwdCA9IHtcbiAgICAgICAgICAgIHg6IHJ4ICogTWF0aC5jb3ModGhldGEpLFxuICAgICAgICAgICAgeTogcnkgKiBNYXRoLnNpbih0aGV0YSksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBjeCArIChwdC54ICogY29zUHNpIC0gcHQueSAqIHNpblBzaSksXG4gICAgICAgICAgICB5OiBjeSArIChwdC54ICogc2luUHNpICsgcHQueSAqIGNvc1BzaSksXG4gICAgICAgIH07XG4gICAgfVxuICAgIHN0YXRpYyBwYXJzZVBhdGhEYXRhKGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNzID0gZGF0YTtcbiAgICAgICAgY29uc3QgY2MgPSBbXG4gICAgICAgICAgICAnbScsXG4gICAgICAgICAgICAnTScsXG4gICAgICAgICAgICAnbCcsXG4gICAgICAgICAgICAnTCcsXG4gICAgICAgICAgICAndicsXG4gICAgICAgICAgICAnVicsXG4gICAgICAgICAgICAnaCcsXG4gICAgICAgICAgICAnSCcsXG4gICAgICAgICAgICAneicsXG4gICAgICAgICAgICAnWicsXG4gICAgICAgICAgICAnYycsXG4gICAgICAgICAgICAnQycsXG4gICAgICAgICAgICAncScsXG4gICAgICAgICAgICAnUScsXG4gICAgICAgICAgICAndCcsXG4gICAgICAgICAgICAnVCcsXG4gICAgICAgICAgICAncycsXG4gICAgICAgICAgICAnUycsXG4gICAgICAgICAgICAnYScsXG4gICAgICAgICAgICAnQScsXG4gICAgICAgIF07XG4gICAgICAgIGNzID0gY3MucmVwbGFjZShuZXcgUmVnRXhwKCcgJywgJ2cnKSwgJywnKTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBjYy5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgY3MgPSBjcy5yZXBsYWNlKG5ldyBSZWdFeHAoY2Nbbl0sICdnJyksICd8JyArIGNjW25dKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhcnIgPSBjcy5zcGxpdCgnfCcpO1xuICAgICAgICBjb25zdCBjYSA9IFtdO1xuICAgICAgICBjb25zdCBjb29yZHMgPSBbXTtcbiAgICAgICAgbGV0IGNweCA9IDA7XG4gICAgICAgIGxldCBjcHkgPSAwO1xuICAgICAgICBjb25zdCByZSA9IC8oWy0rXT8oKFxcZCtcXC5cXGQrKXwoKFxcZCspfChcXC5cXGQrKSkpKD86ZVstK10/XFxkKyk/KS9naTtcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICBmb3IgKGxldCBuID0gMTsgbiA8IGFyci5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgbGV0IHN0ciA9IGFycltuXTtcbiAgICAgICAgICAgIGxldCBjID0gc3RyLmNoYXJBdCgwKTtcbiAgICAgICAgICAgIHN0ciA9IHN0ci5zbGljZSgxKTtcbiAgICAgICAgICAgIGNvb3Jkcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlLmV4ZWMoc3RyKSkpIHtcbiAgICAgICAgICAgICAgICBjb29yZHMucHVzaChtYXRjaFswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgcCA9IFtdO1xuICAgICAgICAgICAgbGV0IGFyY1BhcmFtSW5kZXggPSBjID09PSAnQScgfHwgYyA9PT0gJ2EnID8gMCA6IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGpsZW4gPSBjb29yZHMubGVuZ3RoOyBqIDwgamxlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBjb29yZHNbal07XG4gICAgICAgICAgICAgICAgaWYgKHRva2VuID09PSAnMDAnKSB7XG4gICAgICAgICAgICAgICAgICAgIHAucHVzaCgwLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyY1BhcmFtSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyY1BhcmFtSW5kZXggPj0gNylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmNQYXJhbUluZGV4IC09IDc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyY1BhcmFtSW5kZXggPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvXlswMV17Mn1cXGQrKD86XFwuXFxkKyk/JC8udGVzdCh0b2tlbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VJbnQodG9rZW5bMF0sIDEwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5wdXNoKHBhcnNlSW50KHRva2VuWzFdLCAxMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAucHVzaChwYXJzZUZsb2F0KHRva2VuLnNsaWNlKDIpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyY1BhcmFtSW5kZXggLT0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gJzExJyB8fCB0b2tlbiA9PT0gJzEwJyB8fCB0b2tlbiA9PT0gJzAxJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAucHVzaChwYXJzZUludCh0b2tlblswXSwgMTApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VJbnQodG9rZW5bMV0sIDEwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyY1BhcmFtSW5kZXggLT0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gJzAnIHx8IHRva2VuID09PSAnMScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VJbnQodG9rZW4sIDEwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyY1BhcmFtSW5kZXggLT0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhcmNQYXJhbUluZGV4ID09PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoL15bMDFdXFxkKyg/OlxcLlxcZCspPyQvLnRlc3QodG9rZW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5wdXNoKHBhcnNlSW50KHRva2VuWzBdLCAxMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAucHVzaChwYXJzZUZsb2F0KHRva2VuLnNsaWNlKDEpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyY1BhcmFtSW5kZXggLT0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gJzAnIHx8IHRva2VuID09PSAnMScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VJbnQodG9rZW4sIDEwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJjUGFyYW1JbmRleCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyY1BhcmFtSW5kZXggLT0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRBcmMgPSBwYXJzZUZsb2F0KHRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihwYXJzZWRBcmMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VkQXJjKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAucHVzaCgwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhcmNQYXJhbUluZGV4ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmNQYXJhbUluZGV4ID49IDcpXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmNQYXJhbUluZGV4IC09IDc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUZsb2F0KHRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihwYXJzZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnB1c2gocGFyc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAucHVzaCgwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlIChwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4ocFswXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBjbWQgPSAnJztcbiAgICAgICAgICAgICAgICBsZXQgcG9pbnRzID0gW107XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRYID0gY3B4LCBzdGFydFkgPSBjcHk7XG4gICAgICAgICAgICAgICAgbGV0IHByZXZDbWQsIGN0bFB0eCwgY3RsUHR5O1xuICAgICAgICAgICAgICAgIGxldCByeCwgcnksIHBzaSwgZmEsIGZzLCB4MSwgeTE7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2wnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkeCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ICs9IGR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ICs9IGR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ00nO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhLmxlbmd0aCA+IDIgJiYgY2FbY2EubGVuZ3RoIC0gMV0uY29tbWFuZCA9PT0gJ3onKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaWR4ID0gY2EubGVuZ3RoIC0gMjsgaWR4ID49IDA7IGlkeC0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYVtpZHhdLmNvbW1hbmQgPT09ICdNJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3B4ID0gY2FbaWR4XS5wb2ludHNbMF0gKyBkeDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IGNhW2lkeF0ucG9pbnRzWzFdICsgZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gJ0wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2gnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdMJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdIJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdMJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd2JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnVic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnQyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChwLnNoaWZ0KCksIHAuc2hpZnQoKSwgcC5zaGlmdCgpLCBwLnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4ICsgcC5zaGlmdCgpLCBjcHkgKyBwLnNoaWZ0KCksIGNweCArIHAuc2hpZnQoKSwgY3B5ICsgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ0MnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldkNtZCA9IGNhW2NhLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZDbWQuY29tbWFuZCA9PT0gJ0MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4ICsgKGNweCAtIHByZXZDbWQucG9pbnRzWzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHkgKyAoY3B5IC0gcHJldkNtZC5wb2ludHNbM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIHAuc2hpZnQoKSwgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdDJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDbWQgPSBjYVtjYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Q21kLmNvbW1hbmQgPT09ICdDJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweCArIChjcHggLSBwcmV2Q21kLnBvaW50c1syXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5ICsgKGNweSAtIHByZXZDbWQucG9pbnRzWzNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGN0bFB0eCwgY3RsUHR5LCBjcHggKyBwLnNoaWZ0KCksIGNweSArIHAuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdDJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdRJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKHAuc2hpZnQoKSwgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdxJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCArIHAuc2hpZnQoKSwgY3B5ICsgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ1EnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldkNtZCA9IGNhW2NhLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZDbWQuY29tbWFuZCA9PT0gJ1EnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4ICsgKGNweCAtIHByZXZDbWQucG9pbnRzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHkgKyAoY3B5IC0gcHJldkNtZC5wb2ludHNbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ1EnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDbWQgPSBjYVtjYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Q21kLmNvbW1hbmQgPT09ICdRJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweCArIChjcHggLSBwcmV2Q21kLnBvaW50c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5ICsgKGNweSAtIHByZXZDbWQucG9pbnRzWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ1EnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcnkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwc2kgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZzID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeDEgPSBjcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB5MSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdBJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IHRoaXMuY29udmVydEVuZHBvaW50VG9DZW50ZXJQYXJhbWV0ZXJpemF0aW9uKHgxLCB5MSwgY3B4LCBjcHksIGZhLCBmcywgcngsIHJ5LCBwc2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcnggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByeSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBzaSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4MSA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkxID0gY3B5O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnQSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSB0aGlzLmNvbnZlcnRFbmRwb2ludFRvQ2VudGVyUGFyYW1ldGVyaXphdGlvbih4MSwgeTEsIGNweCwgY3B5LCBmYSwgZnMsIHJ4LCByeSwgcHNpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZDogY21kIHx8IGMsXG4gICAgICAgICAgICAgICAgICAgIHBvaW50czogcG9pbnRzLFxuICAgICAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogc3RhcnRYLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogc3RhcnRZLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwYXRoTGVuZ3RoOiB0aGlzLmNhbGNMZW5ndGgoc3RhcnRYLCBzdGFydFksIGNtZCB8fCBjLCBwb2ludHMpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGMgPT09ICd6JyB8fCBjID09PSAnWicpIHtcbiAgICAgICAgICAgICAgICBjYS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZDogJ3onLFxuICAgICAgICAgICAgICAgICAgICBwb2ludHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBzdGFydDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBwYXRoTGVuZ3RoOiAwLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYTtcbiAgICB9XG4gICAgc3RhdGljIGNhbGNMZW5ndGgoeCwgeSwgY21kLCBwb2ludHMpIHtcbiAgICAgICAgbGV0IGxlbiwgcDEsIHAyLCB0O1xuICAgICAgICBjb25zdCBwYXRoID0gUGF0aDtcbiAgICAgICAgc3dpdGNoIChjbWQpIHtcbiAgICAgICAgICAgIGNhc2UgJ0wnOlxuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLmdldExpbmVMZW5ndGgoeCwgeSwgcG9pbnRzWzBdLCBwb2ludHNbMV0pO1xuICAgICAgICAgICAgY2FzZSAnQyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEN1YmljQXJjTGVuZ3RoKFt4LCBwb2ludHNbMF0sIHBvaW50c1syXSwgcG9pbnRzWzRdXSwgW3ksIHBvaW50c1sxXSwgcG9pbnRzWzNdLCBwb2ludHNbNV1dLCAxKTtcbiAgICAgICAgICAgIGNhc2UgJ1EnOlxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRRdWFkcmF0aWNBcmNMZW5ndGgoW3gsIHBvaW50c1swXSwgcG9pbnRzWzJdXSwgW3ksIHBvaW50c1sxXSwgcG9pbnRzWzNdXSwgMSk7XG4gICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICBsZW4gPSAwLjA7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwb2ludHNbNF07XG4gICAgICAgICAgICAgICAgY29uc3QgZFRoZXRhID0gcG9pbnRzWzVdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBvaW50c1s0XSArIGRUaGV0YTtcbiAgICAgICAgICAgICAgICBsZXQgaW5jID0gTWF0aC5QSSAvIDE4MC4wO1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhzdGFydCAtIGVuZCkgPCBpbmMpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5jID0gTWF0aC5hYnMoc3RhcnQgLSBlbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwMSA9IHBhdGguZ2V0UG9pbnRPbkVsbGlwdGljYWxBcmMocG9pbnRzWzBdLCBwb2ludHNbMV0sIHBvaW50c1syXSwgcG9pbnRzWzNdLCBzdGFydCwgMCk7XG4gICAgICAgICAgICAgICAgaWYgKGRUaGV0YSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh0ID0gc3RhcnQgLSBpbmM7IHQgPiBlbmQ7IHQgLT0gaW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwMiA9IHBhdGguZ2V0UG9pbnRPbkVsbGlwdGljYWxBcmMocG9pbnRzWzBdLCBwb2ludHNbMV0sIHBvaW50c1syXSwgcG9pbnRzWzNdLCB0LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlbiArPSBwYXRoLmdldExpbmVMZW5ndGgocDEueCwgcDEueSwgcDIueCwgcDIueSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwMSA9IHAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHQgPSBzdGFydCArIGluYzsgdCA8IGVuZDsgdCArPSBpbmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAyID0gcGF0aC5nZXRQb2ludE9uRWxsaXB0aWNhbEFyYyhwb2ludHNbMF0sIHBvaW50c1sxXSwgcG9pbnRzWzJdLCBwb2ludHNbM10sIHQsIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuICs9IHBhdGguZ2V0TGluZUxlbmd0aChwMS54LCBwMS55LCBwMi54LCBwMi55KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAxID0gcDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcDIgPSBwYXRoLmdldFBvaW50T25FbGxpcHRpY2FsQXJjKHBvaW50c1swXSwgcG9pbnRzWzFdLCBwb2ludHNbMl0sIHBvaW50c1szXSwgZW5kLCAwKTtcbiAgICAgICAgICAgICAgICBsZW4gKz0gcGF0aC5nZXRMaW5lTGVuZ3RoKHAxLngsIHAxLnksIHAyLngsIHAyLnkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBsZW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHN0YXRpYyBjb252ZXJ0RW5kcG9pbnRUb0NlbnRlclBhcmFtZXRlcml6YXRpb24oeDEsIHkxLCB4MiwgeTIsIGZhLCBmcywgcngsIHJ5LCBwc2lEZWcpIHtcbiAgICAgICAgY29uc3QgcHNpID0gcHNpRGVnICogKE1hdGguUEkgLyAxODAuMCk7XG4gICAgICAgIGNvbnN0IHhwID0gKE1hdGguY29zKHBzaSkgKiAoeDEgLSB4MikpIC8gMi4wICsgKE1hdGguc2luKHBzaSkgKiAoeTEgLSB5MikpIC8gMi4wO1xuICAgICAgICBjb25zdCB5cCA9ICgtMSAqIE1hdGguc2luKHBzaSkgKiAoeDEgLSB4MikpIC8gMi4wICtcbiAgICAgICAgICAgIChNYXRoLmNvcyhwc2kpICogKHkxIC0geTIpKSAvIDIuMDtcbiAgICAgICAgY29uc3QgbGFtYmRhID0gKHhwICogeHApIC8gKHJ4ICogcngpICsgKHlwICogeXApIC8gKHJ5ICogcnkpO1xuICAgICAgICBpZiAobGFtYmRhID4gMSkge1xuICAgICAgICAgICAgcnggKj0gTWF0aC5zcXJ0KGxhbWJkYSk7XG4gICAgICAgICAgICByeSAqPSBNYXRoLnNxcnQobGFtYmRhKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZiA9IE1hdGguc3FydCgocnggKiByeCAqIChyeSAqIHJ5KSAtIHJ4ICogcnggKiAoeXAgKiB5cCkgLSByeSAqIHJ5ICogKHhwICogeHApKSAvXG4gICAgICAgICAgICAocnggKiByeCAqICh5cCAqIHlwKSArIHJ5ICogcnkgKiAoeHAgKiB4cCkpKTtcbiAgICAgICAgaWYgKGZhID09PSBmcykge1xuICAgICAgICAgICAgZiAqPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOYU4oZikpIHtcbiAgICAgICAgICAgIGYgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN4cCA9IChmICogcnggKiB5cCkgLyByeTtcbiAgICAgICAgY29uc3QgY3lwID0gKGYgKiAtcnkgKiB4cCkgLyByeDtcbiAgICAgICAgY29uc3QgY3ggPSAoeDEgKyB4MikgLyAyLjAgKyBNYXRoLmNvcyhwc2kpICogY3hwIC0gTWF0aC5zaW4ocHNpKSAqIGN5cDtcbiAgICAgICAgY29uc3QgY3kgPSAoeTEgKyB5MikgLyAyLjAgKyBNYXRoLnNpbihwc2kpICogY3hwICsgTWF0aC5jb3MocHNpKSAqIGN5cDtcbiAgICAgICAgY29uc3Qgdk1hZyA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHZbMF0gKiB2WzBdICsgdlsxXSAqIHZbMV0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB2UmF0aW8gPSBmdW5jdGlvbiAodSwgdikge1xuICAgICAgICAgICAgcmV0dXJuICh1WzBdICogdlswXSArIHVbMV0gKiB2WzFdKSAvICh2TWFnKHUpICogdk1hZyh2KSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHZBbmdsZSA9IGZ1bmN0aW9uICh1LCB2KSB7XG4gICAgICAgICAgICByZXR1cm4gKHVbMF0gKiB2WzFdIDwgdVsxXSAqIHZbMF0gPyAtMSA6IDEpICogTWF0aC5hY29zKHZSYXRpbyh1LCB2KSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHRoZXRhID0gdkFuZ2xlKFsxLCAwXSwgWyh4cCAtIGN4cCkgLyByeCwgKHlwIC0gY3lwKSAvIHJ5XSk7XG4gICAgICAgIGNvbnN0IHUgPSBbKHhwIC0gY3hwKSAvIHJ4LCAoeXAgLSBjeXApIC8gcnldO1xuICAgICAgICBjb25zdCB2ID0gWygtMSAqIHhwIC0gY3hwKSAvIHJ4LCAoLTEgKiB5cCAtIGN5cCkgLyByeV07XG4gICAgICAgIGxldCBkVGhldGEgPSB2QW5nbGUodSwgdik7XG4gICAgICAgIGlmICh2UmF0aW8odSwgdikgPD0gLTEpIHtcbiAgICAgICAgICAgIGRUaGV0YSA9IE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZSYXRpbyh1LCB2KSA+PSAxKSB7XG4gICAgICAgICAgICBkVGhldGEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmcyA9PT0gMCAmJiBkVGhldGEgPiAwKSB7XG4gICAgICAgICAgICBkVGhldGEgPSBkVGhldGEgLSAyICogTWF0aC5QSTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnMgPT09IDEgJiYgZFRoZXRhIDwgMCkge1xuICAgICAgICAgICAgZFRoZXRhID0gZFRoZXRhICsgMiAqIE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtjeCwgY3ksIHJ4LCByeSwgdGhldGEsIGRUaGV0YSwgcHNpLCBmc107XG4gICAgfVxufVxuUGF0aC5wcm90b3R5cGUuY2xhc3NOYW1lID0gJ1BhdGgnO1xuUGF0aC5wcm90b3R5cGUuX2F0dHJzQWZmZWN0aW5nU2l6ZSA9IFsnZGF0YSddO1xuX3JlZ2lzdGVyTm9kZShQYXRoKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFBhdGgsICdkYXRhJyk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJPckFycmF5T2ZOdW1iZXJzVmFsaWRhdG9yIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmV4cG9ydCBjbGFzcyBSZWN0IGV4dGVuZHMgU2hhcGUge1xuICAgIF9zY2VuZUZ1bmMoY29udGV4dCkge1xuICAgICAgICBjb25zdCBjb3JuZXJSYWRpdXMgPSB0aGlzLmNvcm5lclJhZGl1cygpLCB3aWR0aCA9IHRoaXMud2lkdGgoKSwgaGVpZ2h0ID0gdGhpcy5oZWlnaHQoKTtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgaWYgKCFjb3JuZXJSYWRpdXMpIHtcbiAgICAgICAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFV0aWwuZHJhd1JvdW5kZWRSZWN0UGF0aChjb250ZXh0LCB3aWR0aCwgaGVpZ2h0LCBjb3JuZXJSYWRpdXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgIH1cbn1cblJlY3QucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdSZWN0Jztcbl9yZWdpc3Rlck5vZGUoUmVjdCk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihSZWN0LCAnY29ybmVyUmFkaXVzJywgMCwgZ2V0TnVtYmVyT3JBcnJheU9mTnVtYmVyc1ZhbGlkYXRvcig0KSk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJPckFycmF5T2ZOdW1iZXJzVmFsaWRhdG9yLCBnZXROdW1iZXJWYWxpZGF0b3IsIH0gZnJvbSBcIi4uL1ZhbGlkYXRvcnMuanNcIjtcbmltcG9ydCB7IF9yZWdpc3Rlck5vZGUgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4uL1V0aWwuanNcIjtcbmV4cG9ydCBjbGFzcyBSZWd1bGFyUG9seWdvbiBleHRlbmRzIFNoYXBlIHtcbiAgICBfc2NlbmVGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gdGhpcy5fZ2V0UG9pbnRzKCksIHJhZGl1cyA9IHRoaXMucmFkaXVzKCksIHNpZGVzID0gdGhpcy5zaWRlcygpLCBjb3JuZXJSYWRpdXMgPSB0aGlzLmNvcm5lclJhZGl1cygpO1xuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICBpZiAoIWNvcm5lclJhZGl1cykge1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8ocG9pbnRzWzBdLngsIHBvaW50c1swXS55KTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAxOyBuIDwgcG9pbnRzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8ocG9pbnRzW25dLngsIHBvaW50c1tuXS55KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFV0aWwuZHJhd1JvdW5kZWRQb2x5Z29uUGF0aChjb250ZXh0LCBwb2ludHMsIHNpZGVzLCByYWRpdXMsIGNvcm5lclJhZGl1cyk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgfVxuICAgIF9nZXRQb2ludHMoKSB7XG4gICAgICAgIGNvbnN0IHNpZGVzID0gdGhpcy5hdHRycy5zaWRlcztcbiAgICAgICAgY29uc3QgcmFkaXVzID0gdGhpcy5hdHRycy5yYWRpdXMgfHwgMDtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gW107XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgc2lkZXM7IG4rKykge1xuICAgICAgICAgICAgcG9pbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHg6IHJhZGl1cyAqIE1hdGguc2luKChuICogMiAqIE1hdGguUEkpIC8gc2lkZXMpLFxuICAgICAgICAgICAgICAgIHk6IC0xICogcmFkaXVzICogTWF0aC5jb3MoKG4gKiAyICogTWF0aC5QSSkgLyBzaWRlcyksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcG9pbnRzO1xuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gdGhpcy5fZ2V0UG9pbnRzKCk7XG4gICAgICAgIGxldCBtaW5YID0gcG9pbnRzWzBdLng7XG4gICAgICAgIGxldCBtYXhYID0gcG9pbnRzWzBdLnk7XG4gICAgICAgIGxldCBtaW5ZID0gcG9pbnRzWzBdLng7XG4gICAgICAgIGxldCBtYXhZID0gcG9pbnRzWzBdLnk7XG4gICAgICAgIHBvaW50cy5mb3JFYWNoKChwb2ludCkgPT4ge1xuICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIHBvaW50LngpO1xuICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHBvaW50LngpO1xuICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIHBvaW50LnkpO1xuICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHBvaW50LnkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IG1pblgsXG4gICAgICAgICAgICB5OiBtaW5ZLFxuICAgICAgICAgICAgd2lkdGg6IG1heFggLSBtaW5YLFxuICAgICAgICAgICAgaGVpZ2h0OiBtYXhZIC0gbWluWSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGl1cygpICogMjtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYWRpdXMoKSAqIDI7XG4gICAgfVxuICAgIHNldFdpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMucmFkaXVzKHdpZHRoIC8gMik7XG4gICAgfVxuICAgIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5yYWRpdXMoaGVpZ2h0IC8gMik7XG4gICAgfVxufVxuUmVndWxhclBvbHlnb24ucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdSZWd1bGFyUG9seWdvbic7XG5SZWd1bGFyUG9seWdvbi5wcm90b3R5cGUuX2NlbnRyb2lkID0gdHJ1ZTtcblJlZ3VsYXJQb2x5Z29uLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gWydyYWRpdXMnXTtcbl9yZWdpc3Rlck5vZGUoUmVndWxhclBvbHlnb24pO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoUmVndWxhclBvbHlnb24sICdyYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihSZWd1bGFyUG9seWdvbiwgJ3NpZGVzJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoUmVndWxhclBvbHlnb24sICdjb3JuZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJPckFycmF5T2ZOdW1iZXJzVmFsaWRhdG9yKDQpKTtcbiIsImltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuY29uc3QgUEl4MiA9IE1hdGguUEkgKiAyO1xuZXhwb3J0IGNsYXNzIFJpbmcgZXh0ZW5kcyBTaGFwZSB7XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMuaW5uZXJSYWRpdXMoKSwgMCwgUEl4MiwgZmFsc2UpO1xuICAgICAgICBjb250ZXh0Lm1vdmVUbyh0aGlzLm91dGVyUmFkaXVzKCksIDApO1xuICAgICAgICBjb250ZXh0LmFyYygwLCAwLCB0aGlzLm91dGVyUmFkaXVzKCksIFBJeDIsIDAsIHRydWUpO1xuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGVyUmFkaXVzKCkgKiAyO1xuICAgIH1cbiAgICBnZXRIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGVyUmFkaXVzKCkgKiAyO1xuICAgIH1cbiAgICBzZXRXaWR0aCh3aWR0aCkge1xuICAgICAgICB0aGlzLm91dGVyUmFkaXVzKHdpZHRoIC8gMik7XG4gICAgfVxuICAgIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5vdXRlclJhZGl1cyhoZWlnaHQgLyAyKTtcbiAgICB9XG59XG5SaW5nLnByb3RvdHlwZS5jbGFzc05hbWUgPSAnUmluZyc7XG5SaW5nLnByb3RvdHlwZS5fY2VudHJvaWQgPSB0cnVlO1xuUmluZy5wcm90b3R5cGUuX2F0dHJzQWZmZWN0aW5nU2l6ZSA9IFsnaW5uZXJSYWRpdXMnLCAnb3V0ZXJSYWRpdXMnXTtcbl9yZWdpc3Rlck5vZGUoUmluZyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihSaW5nLCAnaW5uZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihSaW5nLCAnb3V0ZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBBbmltYXRpb24gfSBmcm9tIFwiLi4vQW5pbWF0aW9uLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmV4cG9ydCBjbGFzcyBTcHJpdGUgZXh0ZW5kcyBTaGFwZSB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyKGNvbmZpZyk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmFuaW0gPSBuZXcgQW5pbWF0aW9uKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSB0aGlzLl91cGRhdGVkO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uKCdhbmltYXRpb25DaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXgoMCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uKCdmcmFtZUluZGV4Q2hhbmdlLmtvbnZhJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uKCdmcmFtZVJhdGVDaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYW5pbS5pc1J1bm5pbmcoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLl9zZXRJbnRlcnZhbCgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IGFuaW0gPSB0aGlzLmFuaW1hdGlvbigpLCBpbmRleCA9IHRoaXMuZnJhbWVJbmRleCgpLCBpeDQgPSBpbmRleCAqIDQsIHNldCA9IHRoaXMuYW5pbWF0aW9ucygpW2FuaW1dLCBvZmZzZXRzID0gdGhpcy5mcmFtZU9mZnNldHMoKSwgeCA9IHNldFtpeDQgKyAwXSwgeSA9IHNldFtpeDQgKyAxXSwgd2lkdGggPSBzZXRbaXg0ICsgMl0sIGhlaWdodCA9IHNldFtpeDQgKyAzXSwgaW1hZ2UgPSB0aGlzLmltYWdlKCk7XG4gICAgICAgIGlmICh0aGlzLmhhc0ZpbGwoKSB8fCB0aGlzLmhhc1N0cm9rZSgpKSB7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgaWYgKG9mZnNldHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBvZmZzZXRzW2FuaW1dLCBpeDIgPSBpbmRleCAqIDI7XG4gICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQsIG9mZnNldFtpeDIgKyAwXSwgb2Zmc2V0W2l4MiArIDFdLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfaGl0RnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IGFuaW0gPSB0aGlzLmFuaW1hdGlvbigpLCBpbmRleCA9IHRoaXMuZnJhbWVJbmRleCgpLCBpeDQgPSBpbmRleCAqIDQsIHNldCA9IHRoaXMuYW5pbWF0aW9ucygpW2FuaW1dLCBvZmZzZXRzID0gdGhpcy5mcmFtZU9mZnNldHMoKSwgd2lkdGggPSBzZXRbaXg0ICsgMl0sIGhlaWdodCA9IHNldFtpeDQgKyAzXTtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgaWYgKG9mZnNldHMpIHtcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IG9mZnNldHNbYW5pbV07XG4gICAgICAgICAgICBjb25zdCBpeDIgPSBpbmRleCAqIDI7XG4gICAgICAgICAgICBjb250ZXh0LnJlY3Qob2Zmc2V0W2l4MiArIDBdLCBvZmZzZXRbaXgyICsgMV0sIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFNoYXBlKHRoaXMpO1xuICAgIH1cbiAgICBfdXNlQnVmZmVyQ2FudmFzKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuX3VzZUJ1ZmZlckNhbnZhcyh0cnVlKTtcbiAgICB9XG4gICAgX3NldEludGVydmFsKCkge1xuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoYXQuX3VwZGF0ZUluZGV4KCk7XG4gICAgICAgIH0sIDEwMDAgLyB0aGlzLmZyYW1lUmF0ZSgpKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUnVubmluZygpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyKCk7XG4gICAgICAgIHRoaXMuYW5pbS5zZXRMYXllcnMobGF5ZXIpO1xuICAgICAgICB0aGlzLl9zZXRJbnRlcnZhbCgpO1xuICAgICAgICB0aGlzLmFuaW0uc3RhcnQoKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5hbmltLnN0b3AoKTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcbiAgICB9XG4gICAgaXNSdW5uaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbmltLmlzUnVubmluZygpO1xuICAgIH1cbiAgICBfdXBkYXRlSW5kZXgoKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5mcmFtZUluZGV4KCksIGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uKCksIGFuaW1hdGlvbnMgPSB0aGlzLmFuaW1hdGlvbnMoKSwgYW5pbSA9IGFuaW1hdGlvbnNbYW5pbWF0aW9uXSwgbGVuID0gYW5pbS5sZW5ndGggLyA0O1xuICAgICAgICBpZiAoaW5kZXggPCBsZW4gLSAxKSB7XG4gICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXgoaW5kZXggKyAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZnJhbWVJbmRleCgwKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblNwcml0ZS5wcm90b3R5cGUuY2xhc3NOYW1lID0gJ1Nwcml0ZSc7XG5fcmVnaXN0ZXJOb2RlKFNwcml0ZSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTcHJpdGUsICdhbmltYXRpb24nKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNwcml0ZSwgJ2FuaW1hdGlvbnMnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNwcml0ZSwgJ2ZyYW1lT2Zmc2V0cycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoU3ByaXRlLCAnaW1hZ2UnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFNwcml0ZSwgJ2ZyYW1lSW5kZXgnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTcHJpdGUsICdmcmFtZVJhdGUnLCAxNywgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5iYWNrQ29tcGF0KFNwcml0ZSwge1xuICAgIGluZGV4OiAnZnJhbWVJbmRleCcsXG4gICAgZ2V0SW5kZXg6ICdnZXRGcmFtZUluZGV4JyxcbiAgICBzZXRJbmRleDogJ3NldEZyYW1lSW5kZXgnLFxufSk7XG4iLCJpbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmV4cG9ydCBjbGFzcyBTdGFyIGV4dGVuZHMgU2hhcGUge1xuICAgIF9zY2VuZUZ1bmMoY29udGV4dCkge1xuICAgICAgICBjb25zdCBpbm5lclJhZGl1cyA9IHRoaXMuaW5uZXJSYWRpdXMoKSwgb3V0ZXJSYWRpdXMgPSB0aGlzLm91dGVyUmFkaXVzKCksIG51bVBvaW50cyA9IHRoaXMubnVtUG9pbnRzKCk7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnRleHQubW92ZVRvKDAsIDAgLSBvdXRlclJhZGl1cyk7XG4gICAgICAgIGZvciAobGV0IG4gPSAxOyBuIDwgbnVtUG9pbnRzICogMjsgbisrKSB7XG4gICAgICAgICAgICBjb25zdCByYWRpdXMgPSBuICUgMiA9PT0gMCA/IG91dGVyUmFkaXVzIDogaW5uZXJSYWRpdXM7XG4gICAgICAgICAgICBjb25zdCB4ID0gcmFkaXVzICogTWF0aC5zaW4oKG4gKiBNYXRoLlBJKSAvIG51bVBvaW50cyk7XG4gICAgICAgICAgICBjb25zdCB5ID0gLTEgKiByYWRpdXMgKiBNYXRoLmNvcygobiAqIE1hdGguUEkpIC8gbnVtUG9pbnRzKTtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHgsIHkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgIH1cbiAgICBnZXRXaWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0ZXJSYWRpdXMoKSAqIDI7XG4gICAgfVxuICAgIGdldEhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0ZXJSYWRpdXMoKSAqIDI7XG4gICAgfVxuICAgIHNldFdpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMub3V0ZXJSYWRpdXMod2lkdGggLyAyKTtcbiAgICB9XG4gICAgc2V0SGVpZ2h0KGhlaWdodCkge1xuICAgICAgICB0aGlzLm91dGVyUmFkaXVzKGhlaWdodCAvIDIpO1xuICAgIH1cbn1cblN0YXIucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdTdGFyJztcblN0YXIucHJvdG90eXBlLl9jZW50cm9pZCA9IHRydWU7XG5TdGFyLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gWydpbm5lclJhZGl1cycsICdvdXRlclJhZGl1cyddO1xuX3JlZ2lzdGVyTm9kZShTdGFyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFN0YXIsICdudW1Qb2ludHMnLCA1LCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTdGFyLCAnaW5uZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihTdGFyLCAnb3V0ZXJSYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG4iLCJpbXBvcnQgeyBVdGlsIH0gZnJvbSBcIi4uL1V0aWwuanNcIjtcbmltcG9ydCB7IEZhY3RvcnkgfSBmcm9tIFwiLi4vRmFjdG9yeS5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IEtvbnZhIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuaW1wb3J0IHsgZ2V0TnVtYmVyVmFsaWRhdG9yLCBnZXRTdHJpbmdWYWxpZGF0b3IsIGdldE51bWJlck9yQXV0b1ZhbGlkYXRvciwgZ2V0Qm9vbGVhblZhbGlkYXRvciwgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdUb0FycmF5KHN0cmluZykge1xuICAgIHJldHVybiBbLi4uc3RyaW5nXS5yZWR1Y2UoKGFjYywgY2hhciwgaW5kZXgsIGFycmF5KSA9PiB7XG4gICAgICAgIGlmICgvXFxwe0Vtb2ppfS91LnRlc3QoY2hhcikpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRDaGFyID0gYXJyYXlbaW5kZXggKyAxXTtcbiAgICAgICAgICAgIGlmIChuZXh0Q2hhciAmJiAvXFxwe0Vtb2ppX01vZGlmaWVyfXxcXHUyMDBEL3UudGVzdChuZXh0Q2hhcikpIHtcbiAgICAgICAgICAgICAgICBhY2MucHVzaChjaGFyICsgbmV4dENoYXIpO1xuICAgICAgICAgICAgICAgIGFycmF5W2luZGV4ICsgMV0gPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFjYy5wdXNoKGNoYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKC9cXHB7UmVnaW9uYWxfSW5kaWNhdG9yfXsyfS91LnRlc3QoY2hhciArIChhcnJheVtpbmRleCArIDFdIHx8ICcnKSkpIHtcbiAgICAgICAgICAgIGFjYy5wdXNoKGNoYXIgKyBhcnJheVtpbmRleCArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpbmRleCA+IDAgJiYgL1xccHtNbn18XFxwe01lfXxcXHB7TWN9L3UudGVzdChjaGFyKSkge1xuICAgICAgICAgICAgYWNjW2FjYy5sZW5ndGggLSAxXSArPSBjaGFyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNoYXIpIHtcbiAgICAgICAgICAgIGFjYy5wdXNoKGNoYXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwgW10pO1xufVxuY29uc3QgQVVUTyA9ICdhdXRvJywgQ0VOVEVSID0gJ2NlbnRlcicsIElOSEVSSVQgPSAnaW5oZXJpdCcsIEpVU1RJRlkgPSAnanVzdGlmeScsIENIQU5HRV9LT05WQSA9ICdDaGFuZ2Uua29udmEnLCBDT05URVhUXzJEID0gJzJkJywgREFTSCA9ICctJywgTEVGVCA9ICdsZWZ0JywgVEVYVCA9ICd0ZXh0JywgVEVYVF9VUFBFUiA9ICdUZXh0JywgVE9QID0gJ3RvcCcsIEJPVFRPTSA9ICdib3R0b20nLCBNSURETEUgPSAnbWlkZGxlJywgTk9STUFMID0gJ25vcm1hbCcsIFBYX1NQQUNFID0gJ3B4ICcsIFNQQUNFID0gJyAnLCBSSUdIVCA9ICdyaWdodCcsIFJUTCA9ICdydGwnLCBXT1JEID0gJ3dvcmQnLCBDSEFSID0gJ2NoYXInLCBOT05FID0gJ25vbmUnLCBFTExJUFNJUyA9ICfigKYnLCBBVFRSX0NIQU5HRV9MSVNUID0gW1xuICAgICdkaXJlY3Rpb24nLFxuICAgICdmb250RmFtaWx5JyxcbiAgICAnZm9udFNpemUnLFxuICAgICdmb250U3R5bGUnLFxuICAgICdmb250VmFyaWFudCcsXG4gICAgJ3BhZGRpbmcnLFxuICAgICdhbGlnbicsXG4gICAgJ3ZlcnRpY2FsQWxpZ24nLFxuICAgICdsaW5lSGVpZ2h0JyxcbiAgICAndGV4dCcsXG4gICAgJ3dpZHRoJyxcbiAgICAnaGVpZ2h0JyxcbiAgICAnd3JhcCcsXG4gICAgJ2VsbGlwc2lzJyxcbiAgICAnbGV0dGVyU3BhY2luZycsXG5dLCBhdHRyQ2hhbmdlTGlzdExlbiA9IEFUVFJfQ0hBTkdFX0xJU1QubGVuZ3RoO1xuZnVuY3Rpb24gbm9ybWFsaXplRm9udEZhbWlseShmb250RmFtaWx5KSB7XG4gICAgcmV0dXJuIGZvbnRGYW1pbHlcbiAgICAgICAgLnNwbGl0KCcsJylcbiAgICAgICAgLm1hcCgoZmFtaWx5KSA9PiB7XG4gICAgICAgIGZhbWlseSA9IGZhbWlseS50cmltKCk7XG4gICAgICAgIGNvbnN0IGhhc1NwYWNlID0gZmFtaWx5LmluZGV4T2YoJyAnKSA+PSAwO1xuICAgICAgICBjb25zdCBoYXNRdW90ZXMgPSBmYW1pbHkuaW5kZXhPZignXCInKSA+PSAwIHx8IGZhbWlseS5pbmRleE9mKFwiJ1wiKSA+PSAwO1xuICAgICAgICBpZiAoaGFzU3BhY2UgJiYgIWhhc1F1b3Rlcykge1xuICAgICAgICAgICAgZmFtaWx5ID0gYFwiJHtmYW1pbHl9XCJgO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYW1pbHk7XG4gICAgfSlcbiAgICAgICAgLmpvaW4oJywgJyk7XG59XG5sZXQgZHVtbXlDb250ZXh0O1xuZnVuY3Rpb24gZ2V0RHVtbXlDb250ZXh0KCkge1xuICAgIGlmIChkdW1teUNvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuIGR1bW15Q29udGV4dDtcbiAgICB9XG4gICAgZHVtbXlDb250ZXh0ID0gVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCkuZ2V0Q29udGV4dChDT05URVhUXzJEKTtcbiAgICByZXR1cm4gZHVtbXlDb250ZXh0O1xufVxuZnVuY3Rpb24gX2ZpbGxGdW5jKGNvbnRleHQpIHtcbiAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMuX3BhcnRpYWxUZXh0LCB0aGlzLl9wYXJ0aWFsVGV4dFgsIHRoaXMuX3BhcnRpYWxUZXh0WSk7XG59XG5mdW5jdGlvbiBfc3Ryb2tlRnVuYyhjb250ZXh0KSB7XG4gICAgY29udGV4dC5zZXRBdHRyKCdtaXRlckxpbWl0JywgMik7XG4gICAgY29udGV4dC5zdHJva2VUZXh0KHRoaXMuX3BhcnRpYWxUZXh0LCB0aGlzLl9wYXJ0aWFsVGV4dFgsIHRoaXMuX3BhcnRpYWxUZXh0WSk7XG59XG5mdW5jdGlvbiBjaGVja0RlZmF1bHRGaWxsKGNvbmZpZykge1xuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcbiAgICBpZiAoIWNvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzICYmXG4gICAgICAgICFjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wcyAmJlxuICAgICAgICAhY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2UpIHtcbiAgICAgICAgY29uZmlnLmZpbGwgPSBjb25maWcuZmlsbCB8fCAnYmxhY2snO1xuICAgIH1cbiAgICByZXR1cm4gY29uZmlnO1xufVxuZXhwb3J0IGNsYXNzIFRleHQgZXh0ZW5kcyBTaGFwZSB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyKGNoZWNrRGVmYXVsdEZpbGwoY29uZmlnKSk7XG4gICAgICAgIHRoaXMuX3BhcnRpYWxUZXh0WCA9IDA7XG4gICAgICAgIHRoaXMuX3BhcnRpYWxUZXh0WSA9IDA7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgYXR0ckNoYW5nZUxpc3RMZW47IG4rKykge1xuICAgICAgICAgICAgdGhpcy5vbihBVFRSX0NIQU5HRV9MSVNUW25dICsgQ0hBTkdFX0tPTlZBLCB0aGlzLl9zZXRUZXh0RGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0VGV4dERhdGEoKTtcbiAgICB9XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGNvbnN0IHRleHRBcnIgPSB0aGlzLnRleHRBcnIsIHRleHRBcnJMZW4gPSB0ZXh0QXJyLmxlbmd0aDtcbiAgICAgICAgaWYgKCF0aGlzLnRleHQoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwYWRkaW5nID0gdGhpcy5wYWRkaW5nKCksIGZvbnRTaXplID0gdGhpcy5mb250U2l6ZSgpLCBsaW5lSGVpZ2h0UHggPSB0aGlzLmxpbmVIZWlnaHQoKSAqIGZvbnRTaXplLCB2ZXJ0aWNhbEFsaWduID0gdGhpcy52ZXJ0aWNhbEFsaWduKCksIGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uKCksIGFsaWduWSA9IDAsIGFsaWduID0gdGhpcy5hbGlnbigpLCB0b3RhbFdpZHRoID0gdGhpcy5nZXRXaWR0aCgpLCBsZXR0ZXJTcGFjaW5nID0gdGhpcy5sZXR0ZXJTcGFjaW5nKCksIGNoYXJSZW5kZXJGdW5jID0gdGhpcy5jaGFyUmVuZGVyRnVuYygpLCBmaWxsID0gdGhpcy5maWxsKCksIHRleHREZWNvcmF0aW9uID0gdGhpcy50ZXh0RGVjb3JhdGlvbigpLCBzaG91bGRVbmRlcmxpbmUgPSB0ZXh0RGVjb3JhdGlvbi5pbmRleE9mKCd1bmRlcmxpbmUnKSAhPT0gLTEsIHNob3VsZExpbmVUaHJvdWdoID0gdGV4dERlY29yYXRpb24uaW5kZXhPZignbGluZS10aHJvdWdoJykgIT09IC0xLCBuO1xuICAgICAgICBkaXJlY3Rpb24gPSBkaXJlY3Rpb24gPT09IElOSEVSSVQgPyBjb250ZXh0LmRpcmVjdGlvbiA6IGRpcmVjdGlvbjtcbiAgICAgICAgbGV0IHRyYW5zbGF0ZVkgPSBsaW5lSGVpZ2h0UHggLyAyO1xuICAgICAgICBsZXQgYmFzZWxpbmUgPSBNSURETEU7XG4gICAgICAgIGlmICghS29udmEubGVnYWN5VGV4dFJlbmRlcmluZykge1xuICAgICAgICAgICAgY29uc3QgbWV0cmljcyA9IHRoaXMubWVhc3VyZVNpemUoJ00nKTtcbiAgICAgICAgICAgIGJhc2VsaW5lID0gJ2FscGhhYmV0aWMnO1xuICAgICAgICAgICAgY29uc3QgYXNjZW50ID0gKF9hID0gbWV0cmljcy5mb250Qm91bmRpbmdCb3hBc2NlbnQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG1ldHJpY3MuYWN0dWFsQm91bmRpbmdCb3hBc2NlbnQ7XG4gICAgICAgICAgICBjb25zdCBkZXNjZW50ID0gKF9iID0gbWV0cmljcy5mb250Qm91bmRpbmdCb3hEZXNjZW50KSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBtZXRyaWNzLmFjdHVhbEJvdW5kaW5nQm94RGVzY2VudDtcbiAgICAgICAgICAgIHRyYW5zbGF0ZVkgPSAoYXNjZW50IC0gZGVzY2VudCkgLyAyICsgbGluZUhlaWdodFB4IC8gMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBSVEwpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cignZGlyZWN0aW9uJywgZGlyZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LnNldEF0dHIoJ2ZvbnQnLCB0aGlzLl9nZXRDb250ZXh0Rm9udCgpKTtcbiAgICAgICAgY29udGV4dC5zZXRBdHRyKCd0ZXh0QmFzZWxpbmUnLCBiYXNlbGluZSk7XG4gICAgICAgIGNvbnRleHQuc2V0QXR0cigndGV4dEFsaWduJywgTEVGVCk7XG4gICAgICAgIGlmICh2ZXJ0aWNhbEFsaWduID09PSBNSURETEUpIHtcbiAgICAgICAgICAgIGFsaWduWSA9ICh0aGlzLmdldEhlaWdodCgpIC0gdGV4dEFyckxlbiAqIGxpbmVIZWlnaHRQeCAtIHBhZGRpbmcgKiAyKSAvIDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmVydGljYWxBbGlnbiA9PT0gQk9UVE9NKSB7XG4gICAgICAgICAgICBhbGlnblkgPSB0aGlzLmdldEhlaWdodCgpIC0gdGV4dEFyckxlbiAqIGxpbmVIZWlnaHRQeCAtIHBhZGRpbmcgKiAyO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQudHJhbnNsYXRlKHBhZGRpbmcsIGFsaWduWSArIHBhZGRpbmcpO1xuICAgICAgICBmb3IgKG4gPSAwOyBuIDwgdGV4dEFyckxlbjsgbisrKSB7XG4gICAgICAgICAgICBsZXQgbGluZVRyYW5zbGF0ZVggPSAwO1xuICAgICAgICAgICAgbGV0IGxpbmVUcmFuc2xhdGVZID0gMDtcbiAgICAgICAgICAgIGNvbnN0IG9iaiA9IHRleHRBcnJbbl0sIHRleHQgPSBvYmoudGV4dCwgd2lkdGggPSBvYmoud2lkdGgsIGxhc3RMaW5lID0gb2JqLmxhc3RJblBhcmFncmFwaDtcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgaWYgKGFsaWduID09PSBSSUdIVCkge1xuICAgICAgICAgICAgICAgIGxpbmVUcmFuc2xhdGVYICs9IHRvdGFsV2lkdGggLSB3aWR0aCAtIHBhZGRpbmcgKiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWxpZ24gPT09IENFTlRFUikge1xuICAgICAgICAgICAgICAgIGxpbmVUcmFuc2xhdGVYICs9ICh0b3RhbFdpZHRoIC0gd2lkdGggLSBwYWRkaW5nICogMikgLyAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNob3VsZFVuZGVybGluZSkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgeU9mZnNldCA9ICFLb252YS5sZWdhY3lUZXh0UmVuZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgID8gTWF0aC5yb3VuZChmb250U2l6ZSAvIDQpXG4gICAgICAgICAgICAgICAgICAgIDogTWF0aC5yb3VuZChmb250U2l6ZSAvIDIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHggPSBsaW5lVHJhbnNsYXRlWDtcbiAgICAgICAgICAgICAgICBjb25zdCB5ID0gdHJhbnNsYXRlWSArIGxpbmVUcmFuc2xhdGVZICsgeU9mZnNldDtcbiAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyh4LCB5KTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lV2lkdGggPSBhbGlnbiA9PT0gSlVTVElGWSAmJiAhbGFzdExpbmUgPyB0b3RhbFdpZHRoIC0gcGFkZGluZyAqIDIgOiB3aWR0aDtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh4ICsgTWF0aC5yb3VuZChsaW5lV2lkdGgpLCB5KTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IGZvbnRTaXplIC8gMTU7XG4gICAgICAgICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSB0aGlzLl9nZXRMaW5lYXJHcmFkaWVudCgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBncmFkaWVudCB8fCBmaWxsO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uICE9PSBSVEwgJiZcbiAgICAgICAgICAgICAgICAobGV0dGVyU3BhY2luZyAhPT0gMCB8fCBhbGlnbiA9PT0gSlVTVElGWSB8fCBjaGFyUmVuZGVyRnVuYykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzcGFjZXNOdW1iZXIgPSB0ZXh0LnNwbGl0KCcgJykubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBjb25zdCBhcnJheSA9IHN0cmluZ1RvQXJyYXkodGV4dCk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbGkgPSAwOyBsaSA8IGFycmF5Lmxlbmd0aDsgbGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsZXR0ZXIgPSBhcnJheVtsaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZXR0ZXIgPT09ICcgJyAmJiAhbGFzdExpbmUgJiYgYWxpZ24gPT09IEpVU1RJRlkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVUcmFuc2xhdGVYICs9ICh0b3RhbFdpZHRoIC0gcGFkZGluZyAqIDIgLSB3aWR0aCkgLyBzcGFjZXNOdW1iZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFydGlhbFRleHRYID0gbGluZVRyYW5zbGF0ZVg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcnRpYWxUZXh0WSA9IHRyYW5zbGF0ZVkgKyBsaW5lVHJhbnNsYXRlWTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFydGlhbFRleHQgPSBsZXR0ZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFyUmVuZGVyRnVuYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c0xpbmVzID0gdGV4dEFyci5zbGljZSgwLCBuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzR3JhcGhlbWVzID0gcHJldmlvdXNMaW5lcy5yZWR1Y2UoKGFjYywgbGluZSkgPT4gYWNjICsgc3RyaW5nVG9BcnJheShsaW5lLnRleHQpLmxlbmd0aCwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFySW5kZXggPSBsaSArIHByZXZpb3VzR3JhcGhlbWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhclJlbmRlckZ1bmMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXI6IGxldHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogY2hhckluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IGxpbmVUcmFuc2xhdGVYLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRyYW5zbGF0ZVkgKyBsaW5lVHJhbnNsYXRlWSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lSW5kZXg6IG4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBsaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0xhc3RJbkxpbmU6IGxhc3RMaW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLm1lYXN1cmVTaXplKGxldHRlcikud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhclJlbmRlckZ1bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxpbmVUcmFuc2xhdGVYICs9IHRoaXMubWVhc3VyZVNpemUobGV0dGVyKS53aWR0aCArIGxldHRlclNwYWNpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGxldHRlclNwYWNpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zZXRBdHRyKCdsZXR0ZXJTcGFjaW5nJywgYCR7bGV0dGVyU3BhY2luZ31weGApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJ0aWFsVGV4dFggPSBsaW5lVHJhbnNsYXRlWDtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJ0aWFsVGV4dFkgPSB0cmFuc2xhdGVZICsgbGluZVRyYW5zbGF0ZVk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFydGlhbFRleHQgPSB0ZXh0O1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNob3VsZExpbmVUaHJvdWdoKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjb25zdCB5T2Zmc2V0ID0gIUtvbnZhLmxlZ2FjeVRleHRSZW5kZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgPyAtTWF0aC5yb3VuZChmb250U2l6ZSAvIDQpXG4gICAgICAgICAgICAgICAgICAgIDogMDtcbiAgICAgICAgICAgICAgICBjb25zdCB4ID0gYWxpZ24gPT09IEpVU1RJRlkgPyAwIDogbGluZVRyYW5zbGF0ZVg7XG4gICAgICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oeCwgdHJhbnNsYXRlWSArIGxpbmVUcmFuc2xhdGVZICsgeU9mZnNldCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZVdpZHRoID0gYWxpZ24gPT09IEpVU1RJRlkgJiYgIWxhc3RMaW5lID8gdG90YWxXaWR0aCAtIHBhZGRpbmcgKiAyIDogd2lkdGg7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oeCArIE1hdGgucm91bmQobGluZVdpZHRoKSwgdHJhbnNsYXRlWSArIGxpbmVUcmFuc2xhdGVZICsgeU9mZnNldCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSBmb250U2l6ZSAvIDE1O1xuICAgICAgICAgICAgICAgIGNvbnN0IGdyYWRpZW50ID0gdGhpcy5fZ2V0TGluZWFyR3JhZGllbnQoKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gZ3JhZGllbnQgfHwgZmlsbDtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICBpZiAodGV4dEFyckxlbiA+IDEpIHtcbiAgICAgICAgICAgICAgICB0cmFuc2xhdGVZICs9IGxpbmVIZWlnaHRQeDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfaGl0RnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5nZXRXaWR0aCgpLCBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpO1xuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgIH1cbiAgICBzZXRUZXh0KHRleHQpIHtcbiAgICAgICAgY29uc3Qgc3RyID0gVXRpbC5faXNTdHJpbmcodGV4dClcbiAgICAgICAgICAgID8gdGV4dFxuICAgICAgICAgICAgOiB0ZXh0ID09PSBudWxsIHx8IHRleHQgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gJydcbiAgICAgICAgICAgICAgICA6IHRleHQgKyAnJztcbiAgICAgICAgdGhpcy5fc2V0QXR0cihURVhULCBzdHIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIGNvbnN0IGlzQXV0byA9IHRoaXMuYXR0cnMud2lkdGggPT09IEFVVE8gfHwgdGhpcy5hdHRycy53aWR0aCA9PT0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gaXNBdXRvID8gdGhpcy5nZXRUZXh0V2lkdGgoKSArIHRoaXMucGFkZGluZygpICogMiA6IHRoaXMuYXR0cnMud2lkdGg7XG4gICAgfVxuICAgIGdldEhlaWdodCgpIHtcbiAgICAgICAgY29uc3QgaXNBdXRvID0gdGhpcy5hdHRycy5oZWlnaHQgPT09IEFVVE8gfHwgdGhpcy5hdHRycy5oZWlnaHQgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIGlzQXV0b1xuICAgICAgICAgICAgPyB0aGlzLmZvbnRTaXplKCkgKiB0aGlzLnRleHRBcnIubGVuZ3RoICogdGhpcy5saW5lSGVpZ2h0KCkgK1xuICAgICAgICAgICAgICAgIHRoaXMucGFkZGluZygpICogMlxuICAgICAgICAgICAgOiB0aGlzLmF0dHJzLmhlaWdodDtcbiAgICB9XG4gICAgZ2V0VGV4dFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0V2lkdGg7XG4gICAgfVxuICAgIGdldFRleHRIZWlnaHQoKSB7XG4gICAgICAgIFV0aWwud2FybigndGV4dC5nZXRUZXh0SGVpZ2h0KCkgbWV0aG9kIGlzIGRlcHJlY2F0ZWQuIFVzZSB0ZXh0LmhlaWdodCgpIC0gZm9yIGZ1bGwgaGVpZ2h0IGFuZCB0ZXh0LmZvbnRTaXplKCkgLSBmb3Igb25lIGxpbmUgaGVpZ2h0LicpO1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0SGVpZ2h0O1xuICAgIH1cbiAgICBtZWFzdXJlU2l6ZSh0ZXh0KSB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZywgX2gsIF9qLCBfaywgX2w7XG4gICAgICAgIGxldCBfY29udGV4dCA9IGdldER1bW15Q29udGV4dCgpLCBmb250U2l6ZSA9IHRoaXMuZm9udFNpemUoKSwgbWV0cmljcztcbiAgICAgICAgX2NvbnRleHQuc2F2ZSgpO1xuICAgICAgICBfY29udGV4dC5mb250ID0gdGhpcy5fZ2V0Q29udGV4dEZvbnQoKTtcbiAgICAgICAgbWV0cmljcyA9IF9jb250ZXh0Lm1lYXN1cmVUZXh0KHRleHQpO1xuICAgICAgICBfY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgIGNvbnN0IHNjYWxlRmFjdG9yID0gZm9udFNpemUgLyAxMDA7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3R1YWxCb3VuZGluZ0JveEFzY2VudDogKF9hID0gbWV0cmljcy5hY3R1YWxCb3VuZGluZ0JveEFzY2VudCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogNzEuNTgyMDMxMjUgKiBzY2FsZUZhY3RvcixcbiAgICAgICAgICAgIGFjdHVhbEJvdW5kaW5nQm94RGVzY2VudDogKF9iID0gbWV0cmljcy5hY3R1YWxCb3VuZGluZ0JveERlc2NlbnQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IDAsXG4gICAgICAgICAgICBhY3R1YWxCb3VuZGluZ0JveExlZnQ6IChfYyA9IG1ldHJpY3MuYWN0dWFsQm91bmRpbmdCb3hMZWZ0KSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAtNy40MjE4NzUgKiBzY2FsZUZhY3RvcixcbiAgICAgICAgICAgIGFjdHVhbEJvdW5kaW5nQm94UmlnaHQ6IChfZCA9IG1ldHJpY3MuYWN0dWFsQm91bmRpbmdCb3hSaWdodCkgIT09IG51bGwgJiYgX2QgIT09IHZvaWQgMCA/IF9kIDogNzUuNzMyNDIxODc1ICogc2NhbGVGYWN0b3IsXG4gICAgICAgICAgICBhbHBoYWJldGljQmFzZWxpbmU6IChfZSA9IG1ldHJpY3MuYWxwaGFiZXRpY0Jhc2VsaW5lKSAhPT0gbnVsbCAmJiBfZSAhPT0gdm9pZCAwID8gX2UgOiAwLFxuICAgICAgICAgICAgZW1IZWlnaHRBc2NlbnQ6IChfZiA9IG1ldHJpY3MuZW1IZWlnaHRBc2NlbnQpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IDEwMCAqIHNjYWxlRmFjdG9yLFxuICAgICAgICAgICAgZW1IZWlnaHREZXNjZW50OiAoX2cgPSBtZXRyaWNzLmVtSGVpZ2h0RGVzY2VudCkgIT09IG51bGwgJiYgX2cgIT09IHZvaWQgMCA/IF9nIDogLTIwICogc2NhbGVGYWN0b3IsXG4gICAgICAgICAgICBmb250Qm91bmRpbmdCb3hBc2NlbnQ6IChfaCA9IG1ldHJpY3MuZm9udEJvdW5kaW5nQm94QXNjZW50KSAhPT0gbnVsbCAmJiBfaCAhPT0gdm9pZCAwID8gX2ggOiA5MSAqIHNjYWxlRmFjdG9yLFxuICAgICAgICAgICAgZm9udEJvdW5kaW5nQm94RGVzY2VudDogKF9qID0gbWV0cmljcy5mb250Qm91bmRpbmdCb3hEZXNjZW50KSAhPT0gbnVsbCAmJiBfaiAhPT0gdm9pZCAwID8gX2ogOiAyMSAqIHNjYWxlRmFjdG9yLFxuICAgICAgICAgICAgaGFuZ2luZ0Jhc2VsaW5lOiAoX2sgPSBtZXRyaWNzLmhhbmdpbmdCYXNlbGluZSkgIT09IG51bGwgJiYgX2sgIT09IHZvaWQgMCA/IF9rIDogNzIuODAwMDAzMDUxNzU3ODEgKiBzY2FsZUZhY3RvcixcbiAgICAgICAgICAgIGlkZW9ncmFwaGljQmFzZWxpbmU6IChfbCA9IG1ldHJpY3MuaWRlb2dyYXBoaWNCYXNlbGluZSkgIT09IG51bGwgJiYgX2wgIT09IHZvaWQgMCA/IF9sIDogLTIxICogc2NhbGVGYWN0b3IsXG4gICAgICAgICAgICB3aWR0aDogbWV0cmljcy53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogZm9udFNpemUsXG4gICAgICAgIH07XG4gICAgfVxuICAgIF9nZXRDb250ZXh0Rm9udCgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmZvbnRTdHlsZSgpICtcbiAgICAgICAgICAgIFNQQUNFICtcbiAgICAgICAgICAgIHRoaXMuZm9udFZhcmlhbnQoKSArXG4gICAgICAgICAgICBTUEFDRSArXG4gICAgICAgICAgICAodGhpcy5mb250U2l6ZSgpICsgUFhfU1BBQ0UpICtcbiAgICAgICAgICAgIG5vcm1hbGl6ZUZvbnRGYW1pbHkodGhpcy5mb250RmFtaWx5KCkpKTtcbiAgICB9XG4gICAgX2FkZFRleHRMaW5lKGxpbmUpIHtcbiAgICAgICAgY29uc3QgYWxpZ24gPSB0aGlzLmFsaWduKCk7XG4gICAgICAgIGlmIChhbGlnbiA9PT0gSlVTVElGWSkge1xuICAgICAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5fZ2V0VGV4dFdpZHRoKGxpbmUpO1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0QXJyLnB1c2goe1xuICAgICAgICAgICAgdGV4dDogbGluZSxcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgIGxhc3RJblBhcmFncmFwaDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZ2V0VGV4dFdpZHRoKHRleHQpIHtcbiAgICAgICAgY29uc3QgbGV0dGVyU3BhY2luZyA9IHRoaXMubGV0dGVyU3BhY2luZygpO1xuICAgICAgICBjb25zdCBsZW5ndGggPSB0ZXh0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGdldER1bW15Q29udGV4dCgpLm1lYXN1cmVUZXh0KHRleHQpLndpZHRoICsgbGV0dGVyU3BhY2luZyAqIGxlbmd0aDtcbiAgICB9XG4gICAgX3NldFRleHREYXRhKCkge1xuICAgICAgICBsZXQgbGluZXMgPSB0aGlzLnRleHQoKS5zcGxpdCgnXFxuJyksIGZvbnRTaXplID0gK3RoaXMuZm9udFNpemUoKSwgdGV4dFdpZHRoID0gMCwgbGluZUhlaWdodFB4ID0gdGhpcy5saW5lSGVpZ2h0KCkgKiBmb250U2l6ZSwgd2lkdGggPSB0aGlzLmF0dHJzLndpZHRoLCBoZWlnaHQgPSB0aGlzLmF0dHJzLmhlaWdodCwgZml4ZWRXaWR0aCA9IHdpZHRoICE9PSBBVVRPICYmIHdpZHRoICE9PSB1bmRlZmluZWQsIGZpeGVkSGVpZ2h0ID0gaGVpZ2h0ICE9PSBBVVRPICYmIGhlaWdodCAhPT0gdW5kZWZpbmVkLCBwYWRkaW5nID0gdGhpcy5wYWRkaW5nKCksIG1heFdpZHRoID0gd2lkdGggLSBwYWRkaW5nICogMiwgbWF4SGVpZ2h0UHggPSBoZWlnaHQgLSBwYWRkaW5nICogMiwgY3VycmVudEhlaWdodFB4ID0gMCwgd3JhcCA9IHRoaXMud3JhcCgpLCBzaG91bGRXcmFwID0gd3JhcCAhPT0gTk9ORSwgd3JhcEF0V29yZCA9IHdyYXAgIT09IENIQVIgJiYgc2hvdWxkV3JhcCwgc2hvdWxkQWRkRWxsaXBzaXMgPSB0aGlzLmVsbGlwc2lzKCk7XG4gICAgICAgIHRoaXMudGV4dEFyciA9IFtdO1xuICAgICAgICBnZXREdW1teUNvbnRleHQoKS5mb250ID0gdGhpcy5fZ2V0Q29udGV4dEZvbnQoKTtcbiAgICAgICAgY29uc3QgYWRkaXRpb25hbFdpZHRoID0gc2hvdWxkQWRkRWxsaXBzaXNcbiAgICAgICAgICAgID8gdGhpcy5fZ2V0VGV4dFdpZHRoKEVMTElQU0lTKVxuICAgICAgICAgICAgOiAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbWF4ID0gbGluZXMubGVuZ3RoOyBpIDwgbWF4OyArK2kpIHtcbiAgICAgICAgICAgIGxldCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgICAgICBsZXQgbGluZVdpZHRoID0gdGhpcy5fZ2V0VGV4dFdpZHRoKGxpbmUpO1xuICAgICAgICAgICAgaWYgKGZpeGVkV2lkdGggJiYgbGluZVdpZHRoID4gbWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAobGluZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsb3cgPSAwLCBoaWdoID0gc3RyaW5nVG9BcnJheShsaW5lKS5sZW5ndGgsIG1hdGNoID0gJycsIG1hdGNoV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkID0gKGxvdyArIGhpZ2gpID4+PiAxLCBsaW5lQXJyYXkgPSBzdHJpbmdUb0FycmF5KGxpbmUpLCBzdWJzdHIgPSBsaW5lQXJyYXkuc2xpY2UoMCwgbWlkICsgMSkuam9pbignJyksIHN1YnN0cldpZHRoID0gdGhpcy5fZ2V0VGV4dFdpZHRoKHN1YnN0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRDb25zaWRlckVsbGlwc2lzID0gc2hvdWxkQWRkRWxsaXBzaXMgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXhlZEhlaWdodCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRIZWlnaHRQeCArIGxpbmVIZWlnaHRQeCA+IG1heEhlaWdodFB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWZmZWN0aXZlV2lkdGggPSBzaG91bGRDb25zaWRlckVsbGlwc2lzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBzdWJzdHJXaWR0aCArIGFkZGl0aW9uYWxXaWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogc3Vic3RyV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWZmZWN0aXZlV2lkdGggPD0gbWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gc3Vic3RyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoV2lkdGggPSBzdWJzdHJXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2ggPSBtaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod3JhcEF0V29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVBcnJheSA9IHN0cmluZ1RvQXJyYXkobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hBcnJheSA9IHN0cmluZ1RvQXJyYXkobWF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRDaGFyID0gbGluZUFycmF5W21hdGNoQXJyYXkubGVuZ3RoXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0SXNTcGFjZU9yRGFzaCA9IG5leHRDaGFyID09PSBTUEFDRSB8fCBuZXh0Q2hhciA9PT0gREFTSDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd3JhcEluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0SXNTcGFjZU9yRGFzaCAmJiBtYXRjaFdpZHRoIDw9IG1heFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBJbmRleCA9IG1hdGNoQXJyYXkubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdFNwYWNlSW5kZXggPSBtYXRjaEFycmF5Lmxhc3RJbmRleE9mKFNQQUNFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdERhc2hJbmRleCA9IG1hdGNoQXJyYXkubGFzdEluZGV4T2YoREFTSCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBJbmRleCA9IE1hdGgubWF4KGxhc3RTcGFjZUluZGV4LCBsYXN0RGFzaEluZGV4KSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3cmFwSW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvdyA9IHdyYXBJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBsaW5lQXJyYXkuc2xpY2UoMCwgbG93KS5qb2luKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aChtYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBtYXRjaC50cmltUmlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFRleHRMaW5lKG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRXaWR0aCA9IE1hdGgubWF4KHRleHRXaWR0aCwgbWF0Y2hXaWR0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50SGVpZ2h0UHggKz0gbGluZUhlaWdodFB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkSGFuZGxlRWxsaXBzaXMgPSB0aGlzLl9zaG91bGRIYW5kbGVFbGxpcHNpcyhjdXJyZW50SGVpZ2h0UHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZEhhbmRsZUVsbGlwc2lzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJ5VG9BZGRFbGxpcHNpc1RvTGFzdExpbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVBcnJheSA9IHN0cmluZ1RvQXJyYXkobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZUFycmF5LnNsaWNlKGxvdykuam9pbignJykudHJpbUxlZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGggPSB0aGlzLl9nZXRUZXh0V2lkdGgobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVXaWR0aCA8PSBtYXhXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRUZXh0TGluZShsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlaWdodFB4ICs9IGxpbmVIZWlnaHRQeDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFdpZHRoID0gTWF0aC5tYXgodGV4dFdpZHRoLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFRleHRMaW5lKGxpbmUpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRIZWlnaHRQeCArPSBsaW5lSGVpZ2h0UHg7XG4gICAgICAgICAgICAgICAgdGV4dFdpZHRoID0gTWF0aC5tYXgodGV4dFdpZHRoLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zaG91bGRIYW5kbGVFbGxpcHNpcyhjdXJyZW50SGVpZ2h0UHgpICYmIGkgPCBtYXggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyeVRvQWRkRWxsaXBzaXNUb0xhc3RMaW5lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudGV4dEFyclt0aGlzLnRleHRBcnIubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRBcnJbdGhpcy50ZXh0QXJyLmxlbmd0aCAtIDFdLmxhc3RJblBhcmFncmFwaCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZml4ZWRIZWlnaHQgJiYgY3VycmVudEhlaWdodFB4ICsgbGluZUhlaWdodFB4ID4gbWF4SGVpZ2h0UHgpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRleHRIZWlnaHQgPSBmb250U2l6ZTtcbiAgICAgICAgdGhpcy50ZXh0V2lkdGggPSB0ZXh0V2lkdGg7XG4gICAgfVxuICAgIF9zaG91bGRIYW5kbGVFbGxpcHNpcyhjdXJyZW50SGVpZ2h0UHgpIHtcbiAgICAgICAgY29uc3QgZm9udFNpemUgPSArdGhpcy5mb250U2l6ZSgpLCBsaW5lSGVpZ2h0UHggPSB0aGlzLmxpbmVIZWlnaHQoKSAqIGZvbnRTaXplLCBoZWlnaHQgPSB0aGlzLmF0dHJzLmhlaWdodCwgZml4ZWRIZWlnaHQgPSBoZWlnaHQgIT09IEFVVE8gJiYgaGVpZ2h0ICE9PSB1bmRlZmluZWQsIHBhZGRpbmcgPSB0aGlzLnBhZGRpbmcoKSwgbWF4SGVpZ2h0UHggPSBoZWlnaHQgLSBwYWRkaW5nICogMiwgd3JhcCA9IHRoaXMud3JhcCgpLCBzaG91bGRXcmFwID0gd3JhcCAhPT0gTk9ORTtcbiAgICAgICAgcmV0dXJuICghc2hvdWxkV3JhcCB8fFxuICAgICAgICAgICAgKGZpeGVkSGVpZ2h0ICYmIGN1cnJlbnRIZWlnaHRQeCArIGxpbmVIZWlnaHRQeCA+IG1heEhlaWdodFB4KSk7XG4gICAgfVxuICAgIF90cnlUb0FkZEVsbGlwc2lzVG9MYXN0TGluZSgpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLmF0dHJzLndpZHRoLCBmaXhlZFdpZHRoID0gd2lkdGggIT09IEFVVE8gJiYgd2lkdGggIT09IHVuZGVmaW5lZCwgcGFkZGluZyA9IHRoaXMucGFkZGluZygpLCBtYXhXaWR0aCA9IHdpZHRoIC0gcGFkZGluZyAqIDIsIHNob3VsZEFkZEVsbGlwc2lzID0gdGhpcy5lbGxpcHNpcygpO1xuICAgICAgICBjb25zdCBsYXN0TGluZSA9IHRoaXMudGV4dEFyclt0aGlzLnRleHRBcnIubGVuZ3RoIC0gMV07XG4gICAgICAgIGlmICghbGFzdExpbmUgfHwgIXNob3VsZEFkZEVsbGlwc2lzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpeGVkV2lkdGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhdmVTcGFjZSA9IHRoaXMuX2dldFRleHRXaWR0aChsYXN0TGluZS50ZXh0ICsgRUxMSVBTSVMpIDwgbWF4V2lkdGg7XG4gICAgICAgICAgICBpZiAoIWhhdmVTcGFjZSkge1xuICAgICAgICAgICAgICAgIGxhc3RMaW5lLnRleHQgPSBsYXN0TGluZS50ZXh0LnNsaWNlKDAsIGxhc3RMaW5lLnRleHQubGVuZ3RoIC0gMyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50ZXh0QXJyLnNwbGljZSh0aGlzLnRleHRBcnIubGVuZ3RoIC0gMSwgMSk7XG4gICAgICAgIHRoaXMuX2FkZFRleHRMaW5lKGxhc3RMaW5lLnRleHQgKyBFTExJUFNJUyk7XG4gICAgfVxuICAgIGdldFN0cm9rZVNjYWxlRW5hYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIF91c2VCdWZmZXJDYW52YXMoKSB7XG4gICAgICAgIGNvbnN0IGhhc0xpbmUgPSB0aGlzLnRleHREZWNvcmF0aW9uKCkuaW5kZXhPZigndW5kZXJsaW5lJykgIT09IC0xIHx8XG4gICAgICAgICAgICB0aGlzLnRleHREZWNvcmF0aW9uKCkuaW5kZXhPZignbGluZS10aHJvdWdoJykgIT09IC0xO1xuICAgICAgICBjb25zdCBoYXNTaGFkb3cgPSB0aGlzLmhhc1NoYWRvdygpO1xuICAgICAgICBpZiAoaGFzTGluZSAmJiBoYXNTaGFkb3cpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci5fdXNlQnVmZmVyQ2FudmFzKCk7XG4gICAgfVxufVxuVGV4dC5wcm90b3R5cGUuX2ZpbGxGdW5jID0gX2ZpbGxGdW5jO1xuVGV4dC5wcm90b3R5cGUuX3N0cm9rZUZ1bmMgPSBfc3Ryb2tlRnVuYztcblRleHQucHJvdG90eXBlLmNsYXNzTmFtZSA9IFRFWFRfVVBQRVI7XG5UZXh0LnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gW1xuICAgICd0ZXh0JyxcbiAgICAnZm9udFNpemUnLFxuICAgICdwYWRkaW5nJyxcbiAgICAnd3JhcCcsXG4gICAgJ2xpbmVIZWlnaHQnLFxuICAgICdsZXR0ZXJTcGFjaW5nJyxcbl07XG5fcmVnaXN0ZXJOb2RlKFRleHQpO1xuRmFjdG9yeS5vdmVyV3JpdGVTZXR0ZXIoVGV4dCwgJ3dpZHRoJywgZ2V0TnVtYmVyT3JBdXRvVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5vdmVyV3JpdGVTZXR0ZXIoVGV4dCwgJ2hlaWdodCcsIGdldE51bWJlck9yQXV0b1ZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHQsICdkaXJlY3Rpb24nLCBJTkhFUklUKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHQsICdmb250RmFtaWx5JywgJ0FyaWFsJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAnZm9udFNpemUnLCAxMiwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dCwgJ2ZvbnRTdHlsZScsIE5PUk1BTCk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAnZm9udFZhcmlhbnQnLCBOT1JNQUwpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dCwgJ3BhZGRpbmcnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAnYWxpZ24nLCBMRUZUKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHQsICd2ZXJ0aWNhbEFsaWduJywgVE9QKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHQsICdsaW5lSGVpZ2h0JywgMSwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dCwgJ3dyYXAnLCBXT1JEKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHQsICdlbGxpcHNpcycsIGZhbHNlLCBnZXRCb29sZWFuVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dCwgJ2xldHRlclNwYWNpbmcnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAndGV4dCcsICcnLCBnZXRTdHJpbmdWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAndGV4dERlY29yYXRpb24nLCAnJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0LCAnY2hhclJlbmRlckZ1bmMnLCB1bmRlZmluZWQpO1xuIiwiaW1wb3J0IHsgVXRpbCB9IGZyb20gXCIuLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4uL1NoYXBlLmpzXCI7XG5pbXBvcnQgeyBQYXRoIH0gZnJvbSBcIi4vUGF0aC5qc1wiO1xuaW1wb3J0IHsgVGV4dCwgc3RyaW5nVG9BcnJheSB9IGZyb20gXCIuL1RleHQuanNcIjtcbmltcG9ydCB7IGdldE51bWJlclZhbGlkYXRvciB9IGZyb20gXCIuLi9WYWxpZGF0b3JzLmpzXCI7XG5pbXBvcnQgeyBfcmVnaXN0ZXJOb2RlIH0gZnJvbSBcIi4uL0dsb2JhbC5qc1wiO1xuY29uc3QgRU1QVFlfU1RSSU5HID0gJycsIE5PUk1BTCA9ICdub3JtYWwnO1xuZnVuY3Rpb24gX2ZpbGxGdW5jKGNvbnRleHQpIHtcbiAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMucGFydGlhbFRleHQsIDAsIDApO1xufVxuZnVuY3Rpb24gX3N0cm9rZUZ1bmMoY29udGV4dCkge1xuICAgIGNvbnRleHQuc3Ryb2tlVGV4dCh0aGlzLnBhcnRpYWxUZXh0LCAwLCAwKTtcbn1cbmV4cG9ydCBjbGFzcyBUZXh0UGF0aCBleHRlbmRzIFNoYXBlIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgc3VwZXIoY29uZmlnKTtcbiAgICAgICAgdGhpcy5kdW1teUNhbnZhcyA9IFV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpO1xuICAgICAgICB0aGlzLmRhdGFBcnJheSA9IFtdO1xuICAgICAgICB0aGlzLl9yZWFkRGF0YUF0dHJpYnV0ZSgpO1xuICAgICAgICB0aGlzLm9uKCdkYXRhQ2hhbmdlLmtvbnZhJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fcmVhZERhdGFBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldFRleHREYXRhKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uKCd0ZXh0Q2hhbmdlLmtvbnZhIGFsaWduQ2hhbmdlLmtvbnZhIGxldHRlclNwYWNpbmdDaGFuZ2Uua29udmEga2VybmluZ0Z1bmNDaGFuZ2Uua29udmEgZm9udFNpemVDaGFuZ2Uua29udmEgZm9udEZhbWlseUNoYW5nZS5rb252YScsIHRoaXMuX3NldFRleHREYXRhKTtcbiAgICAgICAgdGhpcy5fc2V0VGV4dERhdGEoKTtcbiAgICB9XG4gICAgX2dldFRleHRQYXRoTGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gUGF0aC5nZXRQYXRoTGVuZ3RoKHRoaXMuZGF0YUFycmF5KTtcbiAgICB9XG4gICAgX2dldFBvaW50QXRMZW5ndGgobGVuZ3RoKSB7XG4gICAgICAgIGlmICghdGhpcy5hdHRycy5kYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0b3RhbExlbmd0aCA9IHRoaXMucGF0aExlbmd0aDtcbiAgICAgICAgaWYgKGxlbmd0aCA+IHRvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUGF0aC5nZXRQb2ludEF0TGVuZ3RoT2ZEYXRhQXJyYXkobGVuZ3RoLCB0aGlzLmRhdGFBcnJheSk7XG4gICAgfVxuICAgIF9yZWFkRGF0YUF0dHJpYnV0ZSgpIHtcbiAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSBQYXRoLnBhcnNlUGF0aERhdGEodGhpcy5hdHRycy5kYXRhKTtcbiAgICAgICAgdGhpcy5wYXRoTGVuZ3RoID0gdGhpcy5fZ2V0VGV4dFBhdGhMZW5ndGgoKTtcbiAgICB9XG4gICAgX3NjZW5lRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuc2V0QXR0cignZm9udCcsIHRoaXMuX2dldENvbnRleHRGb250KCkpO1xuICAgICAgICBjb250ZXh0LnNldEF0dHIoJ3RleHRCYXNlbGluZScsIHRoaXMudGV4dEJhc2VsaW5lKCkpO1xuICAgICAgICBjb250ZXh0LnNldEF0dHIoJ3RleHRBbGlnbicsICdsZWZ0Jyk7XG4gICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICBjb25zdCB0ZXh0RGVjb3JhdGlvbiA9IHRoaXMudGV4dERlY29yYXRpb24oKTtcbiAgICAgICAgY29uc3QgZmlsbCA9IHRoaXMuZmlsbCgpO1xuICAgICAgICBjb25zdCBmb250U2l6ZSA9IHRoaXMuZm9udFNpemUoKTtcbiAgICAgICAgY29uc3QgZ2x5cGhJbmZvID0gdGhpcy5nbHlwaEluZm87XG4gICAgICAgIGlmICh0ZXh0RGVjb3JhdGlvbiA9PT0gJ3VuZGVybGluZScpIHtcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbHlwaEluZm8ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgY29uc3QgcDAgPSBnbHlwaEluZm9baV0ucDA7XG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShwMC54LCBwMC55KTtcbiAgICAgICAgICAgIGNvbnRleHQucm90YXRlKGdseXBoSW5mb1tpXS5yb3RhdGlvbik7XG4gICAgICAgICAgICB0aGlzLnBhcnRpYWxUZXh0ID0gZ2x5cGhJbmZvW2ldLnRleHQ7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0ZXh0RGVjb3JhdGlvbiA9PT0gJ3VuZGVybGluZScpIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbygwLCBmb250U2l6ZSAvIDIgKyAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oZm9udFNpemUsIGZvbnRTaXplIC8gMiArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRleHREZWNvcmF0aW9uID09PSAndW5kZXJsaW5lJykge1xuICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IGZpbGw7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IGZvbnRTaXplIC8gMjA7XG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgIH1cbiAgICBfaGl0RnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnN0IGdseXBoSW5mbyA9IHRoaXMuZ2x5cGhJbmZvO1xuICAgICAgICBpZiAoZ2x5cGhJbmZvLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICBjb25zdCBwMCA9IGdseXBoSW5mb1swXS5wMDtcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHAwLngsIHAwLnkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2x5cGhJbmZvLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwMSA9IGdseXBoSW5mb1tpXS5wMTtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHAxLngsIHAxLnkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuc2V0QXR0cignbGluZVdpZHRoJywgdGhpcy5mb250U2l6ZSgpKTtcbiAgICAgICAgY29udGV4dC5zZXRBdHRyKCdzdHJva2VTdHlsZScsIHRoaXMuY29sb3JLZXkpO1xuICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIH1cbiAgICBnZXRUZXh0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHRXaWR0aDtcbiAgICB9XG4gICAgZ2V0VGV4dEhlaWdodCgpIHtcbiAgICAgICAgVXRpbC53YXJuKCd0ZXh0LmdldFRleHRIZWlnaHQoKSBtZXRob2QgaXMgZGVwcmVjYXRlZC4gVXNlIHRleHQuaGVpZ2h0KCkgLSBmb3IgZnVsbCBoZWlnaHQgYW5kIHRleHQuZm9udFNpemUoKSAtIGZvciBvbmUgbGluZSBoZWlnaHQuJyk7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHRIZWlnaHQ7XG4gICAgfVxuICAgIHNldFRleHQodGV4dCkge1xuICAgICAgICByZXR1cm4gVGV4dC5wcm90b3R5cGUuc2V0VGV4dC5jYWxsKHRoaXMsIHRleHQpO1xuICAgIH1cbiAgICBfZ2V0Q29udGV4dEZvbnQoKSB7XG4gICAgICAgIHJldHVybiBUZXh0LnByb3RvdHlwZS5fZ2V0Q29udGV4dEZvbnQuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgX2dldFRleHRTaXplKHRleHQpIHtcbiAgICAgICAgY29uc3QgZHVtbXlDYW52YXMgPSB0aGlzLmR1bW15Q2FudmFzO1xuICAgICAgICBjb25zdCBfY29udGV4dCA9IGR1bW15Q2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgIF9jb250ZXh0LnNhdmUoKTtcbiAgICAgICAgX2NvbnRleHQuZm9udCA9IHRoaXMuX2dldENvbnRleHRGb250KCk7XG4gICAgICAgIGNvbnN0IG1ldHJpY3MgPSBfY29udGV4dC5tZWFzdXJlVGV4dCh0ZXh0KTtcbiAgICAgICAgX2NvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IG1ldHJpY3Mud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KGAke3RoaXMuZm9udFNpemUoKX1gLCAxMCksXG4gICAgICAgIH07XG4gICAgfVxuICAgIF9zZXRUZXh0RGF0YSgpIHtcbiAgICAgICAgY29uc3QgY2hhckFyciA9IHN0cmluZ1RvQXJyYXkodGhpcy50ZXh0KCkpO1xuICAgICAgICBjb25zdCBjaGFycyA9IFtdO1xuICAgICAgICBsZXQgd2lkdGggPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYXJBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNoYXJzLnB1c2goe1xuICAgICAgICAgICAgICAgIGNoYXI6IGNoYXJBcnJbaV0sXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuX2dldFRleHRTaXplKGNoYXJBcnJbaV0pLndpZHRoLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB3aWR0aCArPSBjaGFyc1tpXS53aWR0aDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGhlaWdodCB9ID0gdGhpcy5fZ2V0VGV4dFNpemUodGhpcy5hdHRycy50ZXh0KTtcbiAgICAgICAgdGhpcy50ZXh0V2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy50ZXh0SGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLmdseXBoSW5mbyA9IFtdO1xuICAgICAgICBpZiAoIXRoaXMuYXR0cnMuZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGV0dGVyU3BhY2luZyA9IHRoaXMubGV0dGVyU3BhY2luZygpO1xuICAgICAgICBjb25zdCBhbGlnbiA9IHRoaXMuYWxpZ24oKTtcbiAgICAgICAgY29uc3Qga2VybmluZ0Z1bmMgPSB0aGlzLmtlcm5pbmdGdW5jKCk7XG4gICAgICAgIGNvbnN0IHRleHRXaWR0aCA9IE1hdGgubWF4KHRoaXMudGV4dFdpZHRoICsgKCh0aGlzLmF0dHJzLnRleHQgfHwgJycpLmxlbmd0aCAtIDEpICogbGV0dGVyU3BhY2luZywgMCk7XG4gICAgICAgIGxldCBvZmZzZXQgPSAwO1xuICAgICAgICBpZiAoYWxpZ24gPT09ICdjZW50ZXInKSB7XG4gICAgICAgICAgICBvZmZzZXQgPSBNYXRoLm1heCgwLCB0aGlzLnBhdGhMZW5ndGggLyAyIC0gdGV4dFdpZHRoIC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFsaWduID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgICBvZmZzZXQgPSBNYXRoLm1heCgwLCB0aGlzLnBhdGhMZW5ndGggLSB0ZXh0V2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBvZmZzZXRUb0dseXBoID0gb2Zmc2V0O1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBjaGFyU3RhcnRQb2ludCA9IHRoaXMuX2dldFBvaW50QXRMZW5ndGgob2Zmc2V0VG9HbHlwaCk7XG4gICAgICAgICAgICBpZiAoIWNoYXJTdGFydFBvaW50KVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBjaGFyc1tpXS5jaGFyO1xuICAgICAgICAgICAgbGV0IGdseXBoV2lkdGggPSBjaGFyc1tpXS53aWR0aCArIGxldHRlclNwYWNpbmc7XG4gICAgICAgICAgICBpZiAoY2hhciA9PT0gJyAnICYmIGFsaWduID09PSAnanVzdGlmeScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBudW1iZXJPZlNwYWNlcyA9IHRoaXMudGV4dCgpLnNwbGl0KCcgJykubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBnbHlwaFdpZHRoICs9ICh0aGlzLnBhdGhMZW5ndGggLSB0ZXh0V2lkdGgpIC8gbnVtYmVyT2ZTcGFjZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjaGFyRW5kUG9pbnQgPSB0aGlzLl9nZXRQb2ludEF0TGVuZ3RoKG9mZnNldFRvR2x5cGggKyBnbHlwaFdpZHRoKTtcbiAgICAgICAgICAgIGlmICghY2hhckVuZFBvaW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBQYXRoLmdldExpbmVMZW5ndGgoY2hhclN0YXJ0UG9pbnQueCwgY2hhclN0YXJ0UG9pbnQueSwgY2hhckVuZFBvaW50LngsIGNoYXJFbmRQb2ludC55KTtcbiAgICAgICAgICAgIGxldCBrZXJuID0gMDtcbiAgICAgICAgICAgIGlmIChrZXJuaW5nRnVuYykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGtlcm4gPSBrZXJuaW5nRnVuYyhjaGFyc1tpIC0gMV0uY2hhciwgY2hhcikgKiB0aGlzLmZvbnRTaXplKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGtlcm4gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoYXJTdGFydFBvaW50LnggKz0ga2VybjtcbiAgICAgICAgICAgIGNoYXJFbmRQb2ludC54ICs9IGtlcm47XG4gICAgICAgICAgICB0aGlzLnRleHRXaWR0aCArPSBrZXJuO1xuICAgICAgICAgICAgY29uc3QgbWlkcG9pbnQgPSBQYXRoLmdldFBvaW50T25MaW5lKGtlcm4gKyB3aWR0aCAvIDIuMCwgY2hhclN0YXJ0UG9pbnQueCwgY2hhclN0YXJ0UG9pbnQueSwgY2hhckVuZFBvaW50LngsIGNoYXJFbmRQb2ludC55KTtcbiAgICAgICAgICAgIGNvbnN0IHJvdGF0aW9uID0gTWF0aC5hdGFuMihjaGFyRW5kUG9pbnQueSAtIGNoYXJTdGFydFBvaW50LnksIGNoYXJFbmRQb2ludC54IC0gY2hhclN0YXJ0UG9pbnQueCk7XG4gICAgICAgICAgICB0aGlzLmdseXBoSW5mby5wdXNoKHtcbiAgICAgICAgICAgICAgICB0cmFuc3Bvc2VYOiBtaWRwb2ludC54LFxuICAgICAgICAgICAgICAgIHRyYW5zcG9zZVk6IG1pZHBvaW50LnksXG4gICAgICAgICAgICAgICAgdGV4dDogY2hhckFycltpXSxcbiAgICAgICAgICAgICAgICByb3RhdGlvbjogcm90YXRpb24sXG4gICAgICAgICAgICAgICAgcDA6IGNoYXJTdGFydFBvaW50LFxuICAgICAgICAgICAgICAgIHAxOiBjaGFyRW5kUG9pbnQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG9mZnNldFRvR2x5cGggKz0gZ2x5cGhXaWR0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRTZWxmUmVjdCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmdseXBoSW5mby5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAwLFxuICAgICAgICAgICAgICAgIGhlaWdodDogMCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcG9pbnRzID0gW107XG4gICAgICAgIHRoaXMuZ2x5cGhJbmZvLmZvckVhY2goZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKGluZm8ucDAueCk7XG4gICAgICAgICAgICBwb2ludHMucHVzaChpbmZvLnAwLnkpO1xuICAgICAgICAgICAgcG9pbnRzLnB1c2goaW5mby5wMS54KTtcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKGluZm8ucDEueSk7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgbWluWCA9IHBvaW50c1swXSB8fCAwO1xuICAgICAgICBsZXQgbWF4WCA9IHBvaW50c1swXSB8fCAwO1xuICAgICAgICBsZXQgbWluWSA9IHBvaW50c1sxXSB8fCAwO1xuICAgICAgICBsZXQgbWF4WSA9IHBvaW50c1sxXSB8fCAwO1xuICAgICAgICBsZXQgeCwgeTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICB4ID0gcG9pbnRzW2kgKiAyXTtcbiAgICAgICAgICAgIHkgPSBwb2ludHNbaSAqIDIgKyAxXTtcbiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCB4KTtcbiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCB4KTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB5KTtcbiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCB5KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmb250U2l6ZSA9IHRoaXMuZm9udFNpemUoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IG1pblggLSBmb250U2l6ZSAvIDIsXG4gICAgICAgICAgICB5OiBtaW5ZIC0gZm9udFNpemUgLyAyLFxuICAgICAgICAgICAgd2lkdGg6IG1heFggLSBtaW5YICsgZm9udFNpemUsXG4gICAgICAgICAgICBoZWlnaHQ6IG1heFkgLSBtaW5ZICsgZm9udFNpemUsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIFV0aWwucmVsZWFzZUNhbnZhcyh0aGlzLmR1bW15Q2FudmFzKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRlc3Ryb3koKTtcbiAgICB9XG59XG5UZXh0UGF0aC5wcm90b3R5cGUuX2ZpbGxGdW5jID0gX2ZpbGxGdW5jO1xuVGV4dFBhdGgucHJvdG90eXBlLl9zdHJva2VGdW5jID0gX3N0cm9rZUZ1bmM7XG5UZXh0UGF0aC5wcm90b3R5cGUuX2ZpbGxGdW5jSGl0ID0gX2ZpbGxGdW5jO1xuVGV4dFBhdGgucHJvdG90eXBlLl9zdHJva2VGdW5jSGl0ID0gX3N0cm9rZUZ1bmM7XG5UZXh0UGF0aC5wcm90b3R5cGUuY2xhc3NOYW1lID0gJ1RleHRQYXRoJztcblRleHRQYXRoLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gWyd0ZXh0JywgJ2ZvbnRTaXplJywgJ2RhdGEnXTtcbl9yZWdpc3Rlck5vZGUoVGV4dFBhdGgpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dFBhdGgsICdkYXRhJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0UGF0aCwgJ2ZvbnRGYW1pbHknLCAnQXJpYWwnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHRQYXRoLCAnZm9udFNpemUnLCAxMiwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dFBhdGgsICdmb250U3R5bGUnLCBOT1JNQUwpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dFBhdGgsICdhbGlnbicsICdsZWZ0Jyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0UGF0aCwgJ2xldHRlclNwYWNpbmcnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0UGF0aCwgJ3RleHRCYXNlbGluZScsICdtaWRkbGUnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHRQYXRoLCAnZm9udFZhcmlhbnQnLCBOT1JNQUwpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVGV4dFBhdGgsICd0ZXh0JywgRU1QVFlfU1RSSU5HKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRleHRQYXRoLCAndGV4dERlY29yYXRpb24nLCAnJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUZXh0UGF0aCwgJ2tlcm5pbmdGdW5jJywgdW5kZWZpbmVkKTtcbiIsImltcG9ydCB7IFV0aWwsIFRyYW5zZm9ybSB9IGZyb20gXCIuLi9VdGlsLmpzXCI7XG5pbXBvcnQgeyBGYWN0b3J5IH0gZnJvbSBcIi4uL0ZhY3RvcnkuanNcIjtcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi4vTm9kZS5qc1wiO1xuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vU2hhcGUuanNcIjtcbmltcG9ydCB7IFJlY3QgfSBmcm9tIFwiLi9SZWN0LmpzXCI7XG5pbXBvcnQgeyBHcm91cCB9IGZyb20gXCIuLi9Hcm91cC5qc1wiO1xuaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBnZXRCb29sZWFuVmFsaWRhdG9yLCBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmNvbnN0IEVWRU5UU19OQU1FID0gJ3RyLWtvbnZhJztcbmNvbnN0IEFUVFJfQ0hBTkdFX0xJU1QgPSBbXG4gICAgJ3Jlc2l6ZUVuYWJsZWRDaGFuZ2UnLFxuICAgICdyb3RhdGVBbmNob3JPZmZzZXRDaGFuZ2UnLFxuICAgICdyb3RhdGVFbmFibGVkQ2hhbmdlJyxcbiAgICAnZW5hYmxlZEFuY2hvcnNDaGFuZ2UnLFxuICAgICdhbmNob3JTaXplQ2hhbmdlJyxcbiAgICAnYm9yZGVyRW5hYmxlZENoYW5nZScsXG4gICAgJ2JvcmRlclN0cm9rZUNoYW5nZScsXG4gICAgJ2JvcmRlclN0cm9rZVdpZHRoQ2hhbmdlJyxcbiAgICAnYm9yZGVyRGFzaENoYW5nZScsXG4gICAgJ2FuY2hvclN0cm9rZUNoYW5nZScsXG4gICAgJ2FuY2hvclN0cm9rZVdpZHRoQ2hhbmdlJyxcbiAgICAnYW5jaG9yRmlsbENoYW5nZScsXG4gICAgJ2FuY2hvckNvcm5lclJhZGl1c0NoYW5nZScsXG4gICAgJ2lnbm9yZVN0cm9rZUNoYW5nZScsXG4gICAgJ2FuY2hvclN0eWxlRnVuY0NoYW5nZScsXG5dXG4gICAgLm1hcCgoZSkgPT4gZSArIGAuJHtFVkVOVFNfTkFNRX1gKVxuICAgIC5qb2luKCcgJyk7XG5jb25zdCBOT0RFU19SRUNUID0gJ25vZGVzUmVjdCc7XG5jb25zdCBUUkFOU0ZPUk1fQ0hBTkdFX1NUUiA9IFtcbiAgICAnd2lkdGhDaGFuZ2UnLFxuICAgICdoZWlnaHRDaGFuZ2UnLFxuICAgICdzY2FsZVhDaGFuZ2UnLFxuICAgICdzY2FsZVlDaGFuZ2UnLFxuICAgICdza2V3WENoYW5nZScsXG4gICAgJ3NrZXdZQ2hhbmdlJyxcbiAgICAncm90YXRpb25DaGFuZ2UnLFxuICAgICdvZmZzZXRYQ2hhbmdlJyxcbiAgICAnb2Zmc2V0WUNoYW5nZScsXG4gICAgJ3RyYW5zZm9ybXNFbmFibGVkQ2hhbmdlJyxcbiAgICAnc3Ryb2tlV2lkdGhDaGFuZ2UnLFxuICAgICdkcmFnZ2FibGVDaGFuZ2UnLFxuXTtcbmNvbnN0IEFOR0xFUyA9IHtcbiAgICAndG9wLWxlZnQnOiAtNDUsXG4gICAgJ3RvcC1jZW50ZXInOiAwLFxuICAgICd0b3AtcmlnaHQnOiA0NSxcbiAgICAnbWlkZGxlLXJpZ2h0JzogLTkwLFxuICAgICdtaWRkbGUtbGVmdCc6IDkwLFxuICAgICdib3R0b20tbGVmdCc6IC0xMzUsXG4gICAgJ2JvdHRvbS1jZW50ZXInOiAxODAsXG4gICAgJ2JvdHRvbS1yaWdodCc6IDEzNSxcbn07XG5jb25zdCBUT1VDSF9ERVZJQ0UgPSAnb250b3VjaHN0YXJ0JyBpbiBLb252YS5fZ2xvYmFsO1xuZnVuY3Rpb24gZ2V0Q3Vyc29yKGFuY2hvck5hbWUsIHJhZCwgcm90YXRlQ3Vyc29yKSB7XG4gICAgaWYgKGFuY2hvck5hbWUgPT09ICdyb3RhdGVyJykge1xuICAgICAgICByZXR1cm4gcm90YXRlQ3Vyc29yO1xuICAgIH1cbiAgICByYWQgKz0gVXRpbC5kZWdUb1JhZChBTkdMRVNbYW5jaG9yTmFtZV0gfHwgMCk7XG4gICAgY29uc3QgYW5nbGUgPSAoKFV0aWwucmFkVG9EZWcocmFkKSAlIDM2MCkgKyAzNjApICUgMzYwO1xuICAgIGlmIChVdGlsLl9pblJhbmdlKGFuZ2xlLCAzMTUgKyAyMi41LCAzNjApIHx8IFV0aWwuX2luUmFuZ2UoYW5nbGUsIDAsIDIyLjUpKSB7XG4gICAgICAgIHJldHVybiAnbnMtcmVzaXplJztcbiAgICB9XG4gICAgZWxzZSBpZiAoVXRpbC5faW5SYW5nZShhbmdsZSwgNDUgLSAyMi41LCA0NSArIDIyLjUpKSB7XG4gICAgICAgIHJldHVybiAnbmVzdy1yZXNpemUnO1xuICAgIH1cbiAgICBlbHNlIGlmIChVdGlsLl9pblJhbmdlKGFuZ2xlLCA5MCAtIDIyLjUsIDkwICsgMjIuNSkpIHtcbiAgICAgICAgcmV0dXJuICdldy1yZXNpemUnO1xuICAgIH1cbiAgICBlbHNlIGlmIChVdGlsLl9pblJhbmdlKGFuZ2xlLCAxMzUgLSAyMi41LCAxMzUgKyAyMi41KSkge1xuICAgICAgICByZXR1cm4gJ253c2UtcmVzaXplJztcbiAgICB9XG4gICAgZWxzZSBpZiAoVXRpbC5faW5SYW5nZShhbmdsZSwgMTgwIC0gMjIuNSwgMTgwICsgMjIuNSkpIHtcbiAgICAgICAgcmV0dXJuICducy1yZXNpemUnO1xuICAgIH1cbiAgICBlbHNlIGlmIChVdGlsLl9pblJhbmdlKGFuZ2xlLCAyMjUgLSAyMi41LCAyMjUgKyAyMi41KSkge1xuICAgICAgICByZXR1cm4gJ25lc3ctcmVzaXplJztcbiAgICB9XG4gICAgZWxzZSBpZiAoVXRpbC5faW5SYW5nZShhbmdsZSwgMjcwIC0gMjIuNSwgMjcwICsgMjIuNSkpIHtcbiAgICAgICAgcmV0dXJuICdldy1yZXNpemUnO1xuICAgIH1cbiAgICBlbHNlIGlmIChVdGlsLl9pblJhbmdlKGFuZ2xlLCAzMTUgLSAyMi41LCAzMTUgKyAyMi41KSkge1xuICAgICAgICByZXR1cm4gJ253c2UtcmVzaXplJztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIFV0aWwuZXJyb3IoJ1RyYW5zZm9ybWVyIGhhcyB1bmtub3duIGFuZ2xlIGZvciBjdXJzb3IgZGV0ZWN0aW9uOiAnICsgYW5nbGUpO1xuICAgICAgICByZXR1cm4gJ3BvaW50ZXInO1xuICAgIH1cbn1cbmNvbnN0IEFOQ0hPUlNfTkFNRVMgPSBbXG4gICAgJ3RvcC1sZWZ0JyxcbiAgICAndG9wLWNlbnRlcicsXG4gICAgJ3RvcC1yaWdodCcsXG4gICAgJ21pZGRsZS1yaWdodCcsXG4gICAgJ21pZGRsZS1sZWZ0JyxcbiAgICAnYm90dG9tLWxlZnQnLFxuICAgICdib3R0b20tY2VudGVyJyxcbiAgICAnYm90dG9tLXJpZ2h0Jyxcbl07XG5jb25zdCBNQVhfU0FGRV9JTlRFR0VSID0gMTAwMDAwMDAwO1xuZnVuY3Rpb24gZ2V0Q2VudGVyKHNoYXBlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogc2hhcGUueCArXG4gICAgICAgICAgICAoc2hhcGUud2lkdGggLyAyKSAqIE1hdGguY29zKHNoYXBlLnJvdGF0aW9uKSArXG4gICAgICAgICAgICAoc2hhcGUuaGVpZ2h0IC8gMikgKiBNYXRoLnNpbigtc2hhcGUucm90YXRpb24pLFxuICAgICAgICB5OiBzaGFwZS55ICtcbiAgICAgICAgICAgIChzaGFwZS5oZWlnaHQgLyAyKSAqIE1hdGguY29zKHNoYXBlLnJvdGF0aW9uKSArXG4gICAgICAgICAgICAoc2hhcGUud2lkdGggLyAyKSAqIE1hdGguc2luKHNoYXBlLnJvdGF0aW9uKSxcbiAgICB9O1xufVxuZnVuY3Rpb24gcm90YXRlQXJvdW5kUG9pbnQoc2hhcGUsIGFuZ2xlUmFkLCBwb2ludCkge1xuICAgIGNvbnN0IHggPSBwb2ludC54ICtcbiAgICAgICAgKHNoYXBlLnggLSBwb2ludC54KSAqIE1hdGguY29zKGFuZ2xlUmFkKSAtXG4gICAgICAgIChzaGFwZS55IC0gcG9pbnQueSkgKiBNYXRoLnNpbihhbmdsZVJhZCk7XG4gICAgY29uc3QgeSA9IHBvaW50LnkgK1xuICAgICAgICAoc2hhcGUueCAtIHBvaW50LngpICogTWF0aC5zaW4oYW5nbGVSYWQpICtcbiAgICAgICAgKHNoYXBlLnkgLSBwb2ludC55KSAqIE1hdGguY29zKGFuZ2xlUmFkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5zaGFwZSxcbiAgICAgICAgcm90YXRpb246IHNoYXBlLnJvdGF0aW9uICsgYW5nbGVSYWQsXG4gICAgICAgIHgsXG4gICAgICAgIHksXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHJvdGF0ZUFyb3VuZENlbnRlcihzaGFwZSwgZGVsdGFSYWQpIHtcbiAgICBjb25zdCBjZW50ZXIgPSBnZXRDZW50ZXIoc2hhcGUpO1xuICAgIHJldHVybiByb3RhdGVBcm91bmRQb2ludChzaGFwZSwgZGVsdGFSYWQsIGNlbnRlcik7XG59XG5mdW5jdGlvbiBnZXRTbmFwKHNuYXBzLCBuZXdSb3RhdGlvblJhZCwgdG9sKSB7XG4gICAgbGV0IHNuYXBwZWQgPSBuZXdSb3RhdGlvblJhZDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNuYXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGFuZ2xlID0gS29udmEuZ2V0QW5nbGUoc25hcHNbaV0pO1xuICAgICAgICBjb25zdCBhYnNEaWZmID0gTWF0aC5hYnMoYW5nbGUgLSBuZXdSb3RhdGlvblJhZCkgJSAoTWF0aC5QSSAqIDIpO1xuICAgICAgICBjb25zdCBkaWYgPSBNYXRoLm1pbihhYnNEaWZmLCBNYXRoLlBJICogMiAtIGFic0RpZmYpO1xuICAgICAgICBpZiAoZGlmIDwgdG9sKSB7XG4gICAgICAgICAgICBzbmFwcGVkID0gYW5nbGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNuYXBwZWQ7XG59XG5sZXQgYWN0aXZlVHJhbnNmb3JtZXJzQ291bnQgPSAwO1xuZXhwb3J0IGNsYXNzIFRyYW5zZm9ybWVyIGV4dGVuZHMgR3JvdXAge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgICAgICBzdXBlcihjb25maWcpO1xuICAgICAgICB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUVsZW1lbnRzKCk7XG4gICAgICAgIHRoaXMuX2hhbmRsZU1vdXNlTW92ZSA9IHRoaXMuX2hhbmRsZU1vdXNlTW92ZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9oYW5kbGVNb3VzZVVwID0gdGhpcy5faGFuZGxlTW91c2VVcC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnVwZGF0ZSA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub24oQVRUUl9DSEFOR0VfTElTVCwgdGhpcy51cGRhdGUpO1xuICAgICAgICBpZiAodGhpcy5nZXROb2RlKCkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXR0YWNoVG8obm9kZSkge1xuICAgICAgICB0aGlzLnNldE5vZGUobm9kZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXROb2RlKG5vZGUpIHtcbiAgICAgICAgVXRpbC53YXJuKCd0ci5zZXROb2RlKHNoYXBlKSwgdHIubm9kZShzaGFwZSkgYW5kIHRyLmF0dGFjaFRvKHNoYXBlKSBtZXRob2RzIGFyZSBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRyLm5vZGVzKG5vZGVzQXJyYXkpIGluc3RlYWQuJyk7XG4gICAgICAgIHJldHVybiB0aGlzLnNldE5vZGVzKFtub2RlXSk7XG4gICAgfVxuICAgIGdldE5vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ub2RlcyAmJiB0aGlzLl9ub2Rlc1swXTtcbiAgICB9XG4gICAgX2dldEV2ZW50TmFtZXNwYWNlKCkge1xuICAgICAgICByZXR1cm4gRVZFTlRTX05BTUUgKyB0aGlzLl9pZDtcbiAgICB9XG4gICAgc2V0Tm9kZXMobm9kZXMgPSBbXSkge1xuICAgICAgICBpZiAodGhpcy5fbm9kZXMgJiYgdGhpcy5fbm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmRldGFjaCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkTm9kZXMgPSBub2Rlcy5maWx0ZXIoKG5vZGUpID0+IHtcbiAgICAgICAgICAgIGlmIChub2RlLmlzQW5jZXN0b3JPZih0aGlzKSkge1xuICAgICAgICAgICAgICAgIFV0aWwuZXJyb3IoJ0tvbnZhLlRyYW5zZm9ybWVyIGNhbm5vdCBiZSBhbiBhIGNoaWxkIG9mIHRoZSBub2RlIHlvdSBhcmUgdHJ5aW5nIHRvIGF0dGFjaCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fbm9kZXMgPSBub2RlcyA9IGZpbHRlcmVkTm9kZXM7XG4gICAgICAgIGlmIChub2Rlcy5sZW5ndGggPT09IDEgJiYgdGhpcy51c2VTaW5nbGVOb2RlUm90YXRpb24oKSkge1xuICAgICAgICAgICAgdGhpcy5yb3RhdGlvbihub2Rlc1swXS5nZXRBYnNvbHV0ZVJvdGF0aW9uKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yb3RhdGlvbigwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9ub2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvbkNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlcygpLmxlbmd0aCA9PT0gMSAmJiB0aGlzLnVzZVNpbmdsZU5vZGVSb3RhdGlvbigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb24odGhpcy5ub2RlcygpWzBdLmdldEFic29sdXRlUm90YXRpb24oKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0VHJhbnNmb3JtQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3RyYW5zZm9ybWluZyAmJiAhdGhpcy5pc0RyYWdnaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKG5vZGUuX2F0dHJzQWZmZWN0aW5nU2l6ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhZGRpdGlvbmFsRXZlbnRzID0gbm9kZS5fYXR0cnNBZmZlY3RpbmdTaXplXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoKHByb3ApID0+IHByb3AgKyAnQ2hhbmdlLicgKyB0aGlzLl9nZXRFdmVudE5hbWVzcGFjZSgpKVxuICAgICAgICAgICAgICAgICAgICAuam9pbignICcpO1xuICAgICAgICAgICAgICAgIG5vZGUub24oYWRkaXRpb25hbEV2ZW50cywgb25DaGFuZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZS5vbihUUkFOU0ZPUk1fQ0hBTkdFX1NUUi5tYXAoKGUpID0+IGUgKyBgLiR7dGhpcy5fZ2V0RXZlbnROYW1lc3BhY2UoKX1gKS5qb2luKCcgJyksIG9uQ2hhbmdlKTtcbiAgICAgICAgICAgIG5vZGUub24oYGFic29sdXRlVHJhbnNmb3JtQ2hhbmdlLiR7dGhpcy5fZ2V0RXZlbnROYW1lc3BhY2UoKX1gLCBvbkNoYW5nZSk7XG4gICAgICAgICAgICB0aGlzLl9wcm94eURyYWcobm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9yZXNldFRyYW5zZm9ybUNhY2hlKCk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzQ3JlYXRlZCA9ICEhdGhpcy5maW5kT25lKCcudG9wLWxlZnQnKTtcbiAgICAgICAgaWYgKGVsZW1lbnRzQ3JlYXRlZCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgX3Byb3h5RHJhZyhub2RlKSB7XG4gICAgICAgIGxldCBsYXN0UG9zO1xuICAgICAgICBub2RlLm9uKGBkcmFnc3RhcnQuJHt0aGlzLl9nZXRFdmVudE5hbWVzcGFjZSgpfWAsIChlKSA9PiB7XG4gICAgICAgICAgICBsYXN0UG9zID0gbm9kZS5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZygpICYmIG5vZGUgIT09IHRoaXMuZmluZE9uZSgnLmJhY2snKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnREcmFnKGUsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIG5vZGUub24oYGRyYWdtb3ZlLiR7dGhpcy5fZ2V0RXZlbnROYW1lc3BhY2UoKX1gLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFsYXN0UG9zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYWJzID0gbm9kZS5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBkeCA9IGFicy54IC0gbGFzdFBvcy54O1xuICAgICAgICAgICAgY29uc3QgZHkgPSBhYnMueSAtIGxhc3RQb3MueTtcbiAgICAgICAgICAgIHRoaXMubm9kZXMoKS5mb3JFYWNoKChvdGhlck5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXJOb2RlID09PSBub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyTm9kZS5pc0RyYWdnaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBvdGhlckFicyA9IG90aGVyTm9kZS5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgb3RoZXJOb2RlLnNldEFic29sdXRlUG9zaXRpb24oe1xuICAgICAgICAgICAgICAgICAgICB4OiBvdGhlckFicy54ICsgZHgsXG4gICAgICAgICAgICAgICAgICAgIHk6IG90aGVyQWJzLnkgKyBkeSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBvdGhlck5vZGUuc3RhcnREcmFnKGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsYXN0UG9zID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldE5vZGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbm9kZXMgfHwgW107XG4gICAgfVxuICAgIGdldEFjdGl2ZUFuY2hvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21vdmluZ0FuY2hvck5hbWU7XG4gICAgfVxuICAgIGRldGFjaCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX25vZGVzKSB7XG4gICAgICAgICAgICB0aGlzLl9ub2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgbm9kZS5vZmYoJy4nICsgdGhpcy5fZ2V0RXZlbnROYW1lc3BhY2UoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9ub2RlcyA9IFtdO1xuICAgICAgICB0aGlzLl9yZXNldFRyYW5zZm9ybUNhY2hlKCk7XG4gICAgfVxuICAgIF9yZXNldFRyYW5zZm9ybUNhY2hlKCkge1xuICAgICAgICB0aGlzLl9jbGVhckNhY2hlKE5PREVTX1JFQ1QpO1xuICAgICAgICB0aGlzLl9jbGVhckNhY2hlKCd0cmFuc2Zvcm0nKTtcbiAgICAgICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKCdhYnNvbHV0ZVRyYW5zZm9ybScpO1xuICAgIH1cbiAgICBfZ2V0Tm9kZVJlY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZShOT0RFU19SRUNULCB0aGlzLl9fZ2V0Tm9kZVJlY3QpO1xuICAgIH1cbiAgICBfX2dldE5vZGVTaGFwZShub2RlLCByb3QgPSB0aGlzLnJvdGF0aW9uKCksIHJlbGF0aXZlKSB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSBub2RlLmdldENsaWVudFJlY3Qoe1xuICAgICAgICAgICAgc2tpcFRyYW5zZm9ybTogdHJ1ZSxcbiAgICAgICAgICAgIHNraXBTaGFkb3c6IHRydWUsXG4gICAgICAgICAgICBza2lwU3Ryb2tlOiB0aGlzLmlnbm9yZVN0cm9rZSgpLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgYWJzU2NhbGUgPSBub2RlLmdldEFic29sdXRlU2NhbGUocmVsYXRpdmUpO1xuICAgICAgICBjb25zdCBhYnNQb3MgPSBub2RlLmdldEFic29sdXRlUG9zaXRpb24ocmVsYXRpdmUpO1xuICAgICAgICBjb25zdCBkeCA9IHJlY3QueCAqIGFic1NjYWxlLnggLSBub2RlLm9mZnNldFgoKSAqIGFic1NjYWxlLng7XG4gICAgICAgIGNvbnN0IGR5ID0gcmVjdC55ICogYWJzU2NhbGUueSAtIG5vZGUub2Zmc2V0WSgpICogYWJzU2NhbGUueTtcbiAgICAgICAgY29uc3Qgcm90YXRpb24gPSAoS29udmEuZ2V0QW5nbGUobm9kZS5nZXRBYnNvbHV0ZVJvdGF0aW9uKCkpICsgTWF0aC5QSSAqIDIpICVcbiAgICAgICAgICAgIChNYXRoLlBJICogMik7XG4gICAgICAgIGNvbnN0IGJveCA9IHtcbiAgICAgICAgICAgIHg6IGFic1Bvcy54ICsgZHggKiBNYXRoLmNvcyhyb3RhdGlvbikgKyBkeSAqIE1hdGguc2luKC1yb3RhdGlvbiksXG4gICAgICAgICAgICB5OiBhYnNQb3MueSArIGR5ICogTWF0aC5jb3Mocm90YXRpb24pICsgZHggKiBNYXRoLnNpbihyb3RhdGlvbiksXG4gICAgICAgICAgICB3aWR0aDogcmVjdC53aWR0aCAqIGFic1NjYWxlLngsXG4gICAgICAgICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0ICogYWJzU2NhbGUueSxcbiAgICAgICAgICAgIHJvdGF0aW9uOiByb3RhdGlvbixcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJvdGF0ZUFyb3VuZFBvaW50KGJveCwgLUtvbnZhLmdldEFuZ2xlKHJvdCksIHtcbiAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICB5OiAwLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgX19nZXROb2RlUmVjdCgpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMuZ2V0Tm9kZSgpO1xuICAgICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogLU1BWF9TQUZFX0lOVEVHRVIsXG4gICAgICAgICAgICAgICAgeTogLU1BWF9TQUZFX0lOVEVHRVIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAwLFxuICAgICAgICAgICAgICAgIHJvdGF0aW9uOiAwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0b3RhbFBvaW50cyA9IFtdO1xuICAgICAgICB0aGlzLm5vZGVzKCkubWFwKChub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBib3ggPSBub2RlLmdldENsaWVudFJlY3Qoe1xuICAgICAgICAgICAgICAgIHNraXBUcmFuc2Zvcm06IHRydWUsXG4gICAgICAgICAgICAgICAgc2tpcFNoYWRvdzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBza2lwU3Ryb2tlOiB0aGlzLmlnbm9yZVN0cm9rZSgpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBwb2ludHMgPSBbXG4gICAgICAgICAgICAgICAgeyB4OiBib3gueCwgeTogYm94LnkgfSxcbiAgICAgICAgICAgICAgICB7IHg6IGJveC54ICsgYm94LndpZHRoLCB5OiBib3gueSB9LFxuICAgICAgICAgICAgICAgIHsgeDogYm94LnggKyBib3gud2lkdGgsIHk6IGJveC55ICsgYm94LmhlaWdodCB9LFxuICAgICAgICAgICAgICAgIHsgeDogYm94LngsIHk6IGJveC55ICsgYm94LmhlaWdodCB9LFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zID0gbm9kZS5nZXRBYnNvbHV0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFucy5wb2ludChwb2ludCk7XG4gICAgICAgICAgICAgICAgdG90YWxQb2ludHMucHVzaCh0cmFuc2Zvcm1lZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHRyID0gbmV3IFRyYW5zZm9ybSgpO1xuICAgICAgICB0ci5yb3RhdGUoLUtvbnZhLmdldEFuZ2xlKHRoaXMucm90YXRpb24oKSkpO1xuICAgICAgICBsZXQgbWluWCA9IEluZmluaXR5LCBtaW5ZID0gSW5maW5pdHksIG1heFggPSAtSW5maW5pdHksIG1heFkgPSAtSW5maW5pdHk7XG4gICAgICAgIHRvdGFsUG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyLnBvaW50KHBvaW50KTtcbiAgICAgICAgICAgIGlmIChtaW5YID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBtaW5YID0gbWF4WCA9IHRyYW5zZm9ybWVkLng7XG4gICAgICAgICAgICAgICAgbWluWSA9IG1heFkgPSB0cmFuc2Zvcm1lZC55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIHRyYW5zZm9ybWVkLngpO1xuICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIHRyYW5zZm9ybWVkLnkpO1xuICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHRyYW5zZm9ybWVkLngpO1xuICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHRyYW5zZm9ybWVkLnkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdHIuaW52ZXJ0KCk7XG4gICAgICAgIGNvbnN0IHAgPSB0ci5wb2ludCh7IHg6IG1pblgsIHk6IG1pblkgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBwLngsXG4gICAgICAgICAgICB5OiBwLnksXG4gICAgICAgICAgICB3aWR0aDogbWF4WCAtIG1pblgsXG4gICAgICAgICAgICBoZWlnaHQ6IG1heFkgLSBtaW5ZLFxuICAgICAgICAgICAgcm90YXRpb246IEtvbnZhLmdldEFuZ2xlKHRoaXMucm90YXRpb24oKSksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldFgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXROb2RlUmVjdCgpLng7XG4gICAgfVxuICAgIGdldFkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXROb2RlUmVjdCgpLnk7XG4gICAgfVxuICAgIGdldFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Tm9kZVJlY3QoKS53aWR0aDtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Tm9kZVJlY3QoKS5oZWlnaHQ7XG4gICAgfVxuICAgIF9jcmVhdGVFbGVtZW50cygpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlQmFjaygpO1xuICAgICAgICBBTkNIT1JTX05BTUVTLmZvckVhY2goKG5hbWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUFuY2hvcihuYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUFuY2hvcigncm90YXRlcicpO1xuICAgIH1cbiAgICBfY3JlYXRlQW5jaG9yKG5hbWUpIHtcbiAgICAgICAgY29uc3QgYW5jaG9yID0gbmV3IFJlY3Qoe1xuICAgICAgICAgICAgc3Ryb2tlOiAncmdiKDAsIDE2MSwgMjU1KScsXG4gICAgICAgICAgICBmaWxsOiAnd2hpdGUnLFxuICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDEsXG4gICAgICAgICAgICBuYW1lOiBuYW1lICsgJyBfYW5jaG9yJyxcbiAgICAgICAgICAgIGRyYWdEaXN0YW5jZTogMCxcbiAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGhpdFN0cm9rZVdpZHRoOiBUT1VDSF9ERVZJQ0UgPyAxMCA6ICdhdXRvJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgICBhbmNob3Iub24oJ21vdXNlZG93biB0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNlbGYuX2hhbmRsZU1vdXNlRG93bihlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGFuY2hvci5vbignZHJhZ3N0YXJ0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGFuY2hvci5zdG9wRHJhZygpO1xuICAgICAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgYW5jaG9yLm9uKCdkcmFnZW5kJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGFuY2hvci5vbignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJhZCA9IEtvbnZhLmdldEFuZ2xlKHRoaXMucm90YXRpb24oKSk7XG4gICAgICAgICAgICBjb25zdCByb3RhdGVDdXJzb3IgPSB0aGlzLnJvdGF0ZUFuY2hvckN1cnNvcigpO1xuICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZ2V0Q3Vyc29yKG5hbWUsIHJhZCwgcm90YXRlQ3Vyc29yKTtcbiAgICAgICAgICAgIGFuY2hvci5nZXRTdGFnZSgpLmNvbnRlbnQgJiZcbiAgICAgICAgICAgICAgICAoYW5jaG9yLmdldFN0YWdlKCkuY29udGVudC5zdHlsZS5jdXJzb3IgPSBjdXJzb3IpO1xuICAgICAgICAgICAgdGhpcy5fY3Vyc29yQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGFuY2hvci5vbignbW91c2VvdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICBhbmNob3IuZ2V0U3RhZ2UoKS5jb250ZW50ICYmXG4gICAgICAgICAgICAgICAgKGFuY2hvci5nZXRTdGFnZSgpLmNvbnRlbnQuc3R5bGUuY3Vyc29yID0gJycpO1xuICAgICAgICAgICAgdGhpcy5fY3Vyc29yQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFkZChhbmNob3IpO1xuICAgIH1cbiAgICBfY3JlYXRlQmFjaygpIHtcbiAgICAgICAgY29uc3QgYmFjayA9IG5ldyBTaGFwZSh7XG4gICAgICAgICAgICBuYW1lOiAnYmFjaycsXG4gICAgICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgICAgIGhlaWdodDogMCxcbiAgICAgICAgICAgIHNjZW5lRnVuYyhjdHgsIHNoYXBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHIgPSBzaGFwZS5nZXRQYXJlbnQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWRkaW5nID0gdHIucGFkZGluZygpO1xuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjdHgucmVjdCgtcGFkZGluZywgLXBhZGRpbmcsIHNoYXBlLndpZHRoKCkgKyBwYWRkaW5nICogMiwgc2hhcGUuaGVpZ2h0KCkgKyBwYWRkaW5nICogMik7XG4gICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhzaGFwZS53aWR0aCgpIC8gMiwgLXBhZGRpbmcpO1xuICAgICAgICAgICAgICAgIGlmICh0ci5yb3RhdGVFbmFibGVkKCkgJiYgdHIucm90YXRlTGluZVZpc2libGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHNoYXBlLndpZHRoKCkgLyAyLCAtdHIucm90YXRlQW5jaG9yT2Zmc2V0KCkgKiBVdGlsLl9zaWduKHNoYXBlLmhlaWdodCgpKSAtIHBhZGRpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0cm9rZVNoYXBlKHNoYXBlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaXRGdW5jOiAoY3R4LCBzaGFwZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zaG91bGRPdmVyZHJhd1dob2xlQXJlYSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcGFkZGluZyA9IHRoaXMucGFkZGluZygpO1xuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjdHgucmVjdCgtcGFkZGluZywgLXBhZGRpbmcsIHNoYXBlLndpZHRoKCkgKyBwYWRkaW5nICogMiwgc2hhcGUuaGVpZ2h0KCkgKyBwYWRkaW5nICogMik7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHJva2VTaGFwZShzaGFwZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hZGQoYmFjayk7XG4gICAgICAgIHRoaXMuX3Byb3h5RHJhZyhiYWNrKTtcbiAgICAgICAgYmFjay5vbignZHJhZ3N0YXJ0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGJhY2sub24oJ2RyYWdtb3ZlJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGJhY2sub24oJ2RyYWdlbmQnLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5vbignZHJhZ21vdmUnLCAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9oYW5kbGVNb3VzZURvd24oZSkge1xuICAgICAgICBpZiAodGhpcy5fdHJhbnNmb3JtaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW92aW5nQW5jaG9yTmFtZSA9IGUudGFyZ2V0Lm5hbWUoKS5zcGxpdCgnICcpWzBdO1xuICAgICAgICBjb25zdCBhdHRycyA9IHRoaXMuX2dldE5vZGVSZWN0KCk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gYXR0cnMud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGF0dHJzLmhlaWdodDtcbiAgICAgICAgY29uc3QgaHlwb3RlbnVzZSA9IE1hdGguc3FydChNYXRoLnBvdyh3aWR0aCwgMikgKyBNYXRoLnBvdyhoZWlnaHQsIDIpKTtcbiAgICAgICAgdGhpcy5zaW4gPSBNYXRoLmFicyhoZWlnaHQgLyBoeXBvdGVudXNlKTtcbiAgICAgICAgdGhpcy5jb3MgPSBNYXRoLmFicyh3aWR0aCAvIGh5cG90ZW51c2UpO1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9oYW5kbGVNb3VzZU1vdmUpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuX2hhbmRsZU1vdXNlTW92ZSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX2hhbmRsZU1vdXNlVXAsIHRydWUpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5faGFuZGxlTW91c2VVcCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtaW5nID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgYXAgPSBlLnRhcmdldC5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7XG4gICAgICAgIGNvbnN0IHBvcyA9IGUudGFyZ2V0LmdldFN0YWdlKCkuZ2V0UG9pbnRlclBvc2l0aW9uKCk7XG4gICAgICAgIHRoaXMuX2FuY2hvckRyYWdPZmZzZXQgPSB7XG4gICAgICAgICAgICB4OiBwb3MueCAtIGFwLngsXG4gICAgICAgICAgICB5OiBwb3MueSAtIGFwLnksXG4gICAgICAgIH07XG4gICAgICAgIGFjdGl2ZVRyYW5zZm9ybWVyc0NvdW50Kys7XG4gICAgICAgIHRoaXMuX2ZpcmUoJ3RyYW5zZm9ybXN0YXJ0JywgeyBldnQ6IGUuZXZ0LCB0YXJnZXQ6IHRoaXMuZ2V0Tm9kZSgpIH0pO1xuICAgICAgICB0aGlzLl9ub2Rlcy5mb3JFYWNoKCh0YXJnZXQpID0+IHtcbiAgICAgICAgICAgIHRhcmdldC5fZmlyZSgndHJhbnNmb3Jtc3RhcnQnLCB7IGV2dDogZS5ldnQsIHRhcmdldCB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9oYW5kbGVNb3VzZU1vdmUoZSkge1xuICAgICAgICBsZXQgeCwgeSwgbmV3SHlwb3RlbnVzZTtcbiAgICAgICAgY29uc3QgYW5jaG9yTm9kZSA9IHRoaXMuZmluZE9uZSgnLicgKyB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lKTtcbiAgICAgICAgY29uc3Qgc3RhZ2UgPSBhbmNob3JOb2RlLmdldFN0YWdlKCk7XG4gICAgICAgIHN0YWdlLnNldFBvaW50ZXJzUG9zaXRpb25zKGUpO1xuICAgICAgICBjb25zdCBwcCA9IHN0YWdlLmdldFBvaW50ZXJQb3NpdGlvbigpO1xuICAgICAgICBsZXQgbmV3Tm9kZVBvcyA9IHtcbiAgICAgICAgICAgIHg6IHBwLnggLSB0aGlzLl9hbmNob3JEcmFnT2Zmc2V0LngsXG4gICAgICAgICAgICB5OiBwcC55IC0gdGhpcy5fYW5jaG9yRHJhZ09mZnNldC55LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBvbGRBYnMgPSBhbmNob3JOb2RlLmdldEFic29sdXRlUG9zaXRpb24oKTtcbiAgICAgICAgaWYgKHRoaXMuYW5jaG9yRHJhZ0JvdW5kRnVuYygpKSB7XG4gICAgICAgICAgICBuZXdOb2RlUG9zID0gdGhpcy5hbmNob3JEcmFnQm91bmRGdW5jKCkob2xkQWJzLCBuZXdOb2RlUG9zLCBlKTtcbiAgICAgICAgfVxuICAgICAgICBhbmNob3JOb2RlLnNldEFic29sdXRlUG9zaXRpb24obmV3Tm9kZVBvcyk7XG4gICAgICAgIGNvbnN0IG5ld0FicyA9IGFuY2hvck5vZGUuZ2V0QWJzb2x1dGVQb3NpdGlvbigpO1xuICAgICAgICBpZiAob2xkQWJzLnggPT09IG5ld0Ficy54ICYmIG9sZEFicy55ID09PSBuZXdBYnMueSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID09PSAncm90YXRlcicpIHtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJzID0gdGhpcy5fZ2V0Tm9kZVJlY3QoKTtcbiAgICAgICAgICAgIHggPSBhbmNob3JOb2RlLngoKSAtIGF0dHJzLndpZHRoIC8gMjtcbiAgICAgICAgICAgIHkgPSAtYW5jaG9yTm9kZS55KCkgKyBhdHRycy5oZWlnaHQgLyAyO1xuICAgICAgICAgICAgbGV0IGRlbHRhID0gTWF0aC5hdGFuMigteSwgeCkgKyBNYXRoLlBJIC8gMjtcbiAgICAgICAgICAgIGlmIChhdHRycy5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgZGVsdGEgLT0gTWF0aC5QSTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG9sZFJvdGF0aW9uID0gS29udmEuZ2V0QW5nbGUodGhpcy5yb3RhdGlvbigpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdGF0aW9uID0gb2xkUm90YXRpb24gKyBkZWx0YTtcbiAgICAgICAgICAgIGNvbnN0IHRvbCA9IEtvbnZhLmdldEFuZ2xlKHRoaXMucm90YXRpb25TbmFwVG9sZXJhbmNlKCkpO1xuICAgICAgICAgICAgY29uc3Qgc25hcHBlZFJvdCA9IGdldFNuYXAodGhpcy5yb3RhdGlvblNuYXBzKCksIG5ld1JvdGF0aW9uLCB0b2wpO1xuICAgICAgICAgICAgY29uc3QgZGlmZiA9IHNuYXBwZWRSb3QgLSBhdHRycy5yb3RhdGlvbjtcbiAgICAgICAgICAgIGNvbnN0IHNoYXBlID0gcm90YXRlQXJvdW5kQ2VudGVyKGF0dHJzLCBkaWZmKTtcbiAgICAgICAgICAgIHRoaXMuX2ZpdE5vZGVzSW50byhzaGFwZSwgZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2hpZnRCZWhhdmlvciA9IHRoaXMuc2hpZnRCZWhhdmlvcigpO1xuICAgICAgICBsZXQga2VlcFByb3BvcnRpb247XG4gICAgICAgIGlmIChzaGlmdEJlaGF2aW9yID09PSAnaW52ZXJ0ZWQnKSB7XG4gICAgICAgICAgICBrZWVwUHJvcG9ydGlvbiA9IHRoaXMua2VlcFJhdGlvKCkgJiYgIWUuc2hpZnRLZXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2hpZnRCZWhhdmlvciA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgICBrZWVwUHJvcG9ydGlvbiA9IHRoaXMua2VlcFJhdGlvKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBrZWVwUHJvcG9ydGlvbiA9IHRoaXMua2VlcFJhdGlvKCkgfHwgZS5zaGlmdEtleTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2VudGVyZWRTY2FsaW5nID0gdGhpcy5jZW50ZXJlZFNjYWxpbmcoKSB8fCBlLmFsdEtleTtcbiAgICAgICAgaWYgKHRoaXMuX21vdmluZ0FuY2hvck5hbWUgPT09ICd0b3AtbGVmdCcpIHtcbiAgICAgICAgICAgIGlmIChrZWVwUHJvcG9ydGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBhcmVQb2ludCA9IGNlbnRlcmVkU2NhbGluZ1xuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGgoKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCgpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuZmluZE9uZSgnLmJvdHRvbS1yaWdodCcpLngoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuZmluZE9uZSgnLmJvdHRvbS1yaWdodCcpLnkoKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBuZXdIeXBvdGVudXNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGNvbXBhcmVQb2ludC54IC0gYW5jaG9yTm9kZS54KCksIDIpICtcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3coY29tcGFyZVBvaW50LnkgLSBhbmNob3JOb2RlLnkoKSwgMikpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldmVyc2VYID0gdGhpcy5maW5kT25lKCcudG9wLWxlZnQnKS54KCkgPiBjb21wYXJlUG9pbnQueCA/IC0xIDogMTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXZlcnNlWSA9IHRoaXMuZmluZE9uZSgnLnRvcC1sZWZ0JykueSgpID4gY29tcGFyZVBvaW50LnkgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgeCA9IG5ld0h5cG90ZW51c2UgKiB0aGlzLmNvcyAqIHJldmVyc2VYO1xuICAgICAgICAgICAgICAgIHkgPSBuZXdIeXBvdGVudXNlICogdGhpcy5zaW4gKiByZXZlcnNlWTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLngoY29tcGFyZVBvaW50LnggLSB4KTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLnkoY29tcGFyZVBvaW50LnkgLSB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID09PSAndG9wLWNlbnRlcicpIHtcbiAgICAgICAgICAgIHRoaXMuZmluZE9uZSgnLnRvcC1sZWZ0JykueShhbmNob3JOb2RlLnkoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbW92aW5nQW5jaG9yTmFtZSA9PT0gJ3RvcC1yaWdodCcpIHtcbiAgICAgICAgICAgIGlmIChrZWVwUHJvcG9ydGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBhcmVQb2ludCA9IGNlbnRlcmVkU2NhbGluZ1xuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGgoKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCgpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuZmluZE9uZSgnLmJvdHRvbS1sZWZ0JykueCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5maW5kT25lKCcuYm90dG9tLWxlZnQnKS55KCksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgbmV3SHlwb3RlbnVzZSA9IE1hdGguc3FydChNYXRoLnBvdyhhbmNob3JOb2RlLngoKSAtIGNvbXBhcmVQb2ludC54LCAyKSArXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucG93KGNvbXBhcmVQb2ludC55IC0gYW5jaG9yTm9kZS55KCksIDIpKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXZlcnNlWCA9IHRoaXMuZmluZE9uZSgnLnRvcC1yaWdodCcpLngoKSA8IGNvbXBhcmVQb2ludC54ID8gLTEgOiAxO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldmVyc2VZID0gdGhpcy5maW5kT25lKCcudG9wLXJpZ2h0JykueSgpID4gY29tcGFyZVBvaW50LnkgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgeCA9IG5ld0h5cG90ZW51c2UgKiB0aGlzLmNvcyAqIHJldmVyc2VYO1xuICAgICAgICAgICAgICAgIHkgPSBuZXdIeXBvdGVudXNlICogdGhpcy5zaW4gKiByZXZlcnNlWTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy50b3AtcmlnaHQnKS54KGNvbXBhcmVQb2ludC54ICsgeCk7XG4gICAgICAgICAgICAgICAgdGhpcy5maW5kT25lKCcudG9wLXJpZ2h0JykueShjb21wYXJlUG9pbnQueSAtIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBvcyA9IGFuY2hvck5vZGUucG9zaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuZmluZE9uZSgnLnRvcC1sZWZ0JykueShwb3MueSk7XG4gICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy5ib3R0b20tcmlnaHQnKS54KHBvcy54KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID09PSAnbWlkZGxlLWxlZnQnKSB7XG4gICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLngoYW5jaG9yTm9kZS54KCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX21vdmluZ0FuY2hvck5hbWUgPT09ICdtaWRkbGUtcmlnaHQnKSB7XG4gICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy5ib3R0b20tcmlnaHQnKS54KGFuY2hvck5vZGUueCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID09PSAnYm90dG9tLWxlZnQnKSB7XG4gICAgICAgICAgICBpZiAoa2VlcFByb3BvcnRpb24pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wYXJlUG9pbnQgPSBjZW50ZXJlZFNjYWxpbmdcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLndpZHRoKCkgLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5oZWlnaHQoKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLmZpbmRPbmUoJy50b3AtcmlnaHQnKS54KCksXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmZpbmRPbmUoJy50b3AtcmlnaHQnKS55KCksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgbmV3SHlwb3RlbnVzZSA9IE1hdGguc3FydChNYXRoLnBvdyhjb21wYXJlUG9pbnQueCAtIGFuY2hvck5vZGUueCgpLCAyKSArXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucG93KGFuY2hvck5vZGUueSgpIC0gY29tcGFyZVBvaW50LnksIDIpKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXZlcnNlWCA9IGNvbXBhcmVQb2ludC54IDwgYW5jaG9yTm9kZS54KCkgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgY29uc3QgcmV2ZXJzZVkgPSBhbmNob3JOb2RlLnkoKSA8IGNvbXBhcmVQb2ludC55ID8gLTEgOiAxO1xuICAgICAgICAgICAgICAgIHggPSBuZXdIeXBvdGVudXNlICogdGhpcy5jb3MgKiByZXZlcnNlWDtcbiAgICAgICAgICAgICAgICB5ID0gbmV3SHlwb3RlbnVzZSAqIHRoaXMuc2luICogcmV2ZXJzZVk7XG4gICAgICAgICAgICAgICAgYW5jaG9yTm9kZS54KGNvbXBhcmVQb2ludC54IC0geCk7XG4gICAgICAgICAgICAgICAgYW5jaG9yTm9kZS55KGNvbXBhcmVQb2ludC55ICsgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3MgPSBhbmNob3JOb2RlLnBvc2l0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLngocG9zLngpO1xuICAgICAgICAgICAgdGhpcy5maW5kT25lKCcuYm90dG9tLXJpZ2h0JykueShwb3MueSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbW92aW5nQW5jaG9yTmFtZSA9PT0gJ2JvdHRvbS1jZW50ZXInKSB7XG4gICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy5ib3R0b20tcmlnaHQnKS55KGFuY2hvck5vZGUueSgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID09PSAnYm90dG9tLXJpZ2h0Jykge1xuICAgICAgICAgICAgaWYgKGtlZXBQcm9wb3J0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGFyZVBvaW50ID0gY2VudGVyZWRTY2FsaW5nXG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy53aWR0aCgpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuaGVpZ2h0KCkgLyAyLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy5maW5kT25lKCcudG9wLWxlZnQnKS54KCksXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLnkoKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBuZXdIeXBvdGVudXNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGFuY2hvck5vZGUueCgpIC0gY29tcGFyZVBvaW50LngsIDIpICtcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3coYW5jaG9yTm9kZS55KCkgLSBjb21wYXJlUG9pbnQueSwgMikpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldmVyc2VYID0gdGhpcy5maW5kT25lKCcuYm90dG9tLXJpZ2h0JykueCgpIDwgY29tcGFyZVBvaW50LnggPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgY29uc3QgcmV2ZXJzZVkgPSB0aGlzLmZpbmRPbmUoJy5ib3R0b20tcmlnaHQnKS55KCkgPCBjb21wYXJlUG9pbnQueSA/IC0xIDogMTtcbiAgICAgICAgICAgICAgICB4ID0gbmV3SHlwb3RlbnVzZSAqIHRoaXMuY29zICogcmV2ZXJzZVg7XG4gICAgICAgICAgICAgICAgeSA9IG5ld0h5cG90ZW51c2UgKiB0aGlzLnNpbiAqIHJldmVyc2VZO1xuICAgICAgICAgICAgICAgIHRoaXMuZmluZE9uZSgnLmJvdHRvbS1yaWdodCcpLngoY29tcGFyZVBvaW50LnggKyB4KTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmRPbmUoJy5ib3R0b20tcmlnaHQnKS55KGNvbXBhcmVQb2ludC55ICsgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG5ldyBFcnJvcignV3JvbmcgcG9zaXRpb24gYXJndW1lbnQgb2Ygc2VsZWN0aW9uIHJlc2l6ZXI6ICcgK1xuICAgICAgICAgICAgICAgIHRoaXMuX21vdmluZ0FuY2hvck5hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjZW50ZXJlZFNjYWxpbmcgPSB0aGlzLmNlbnRlcmVkU2NhbGluZygpIHx8IGUuYWx0S2V5O1xuICAgICAgICBpZiAoY2VudGVyZWRTY2FsaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB0b3BMZWZ0ID0gdGhpcy5maW5kT25lKCcudG9wLWxlZnQnKTtcbiAgICAgICAgICAgIGNvbnN0IGJvdHRvbVJpZ2h0ID0gdGhpcy5maW5kT25lKCcuYm90dG9tLXJpZ2h0Jyk7XG4gICAgICAgICAgICBjb25zdCB0b3BPZmZzZXRYID0gdG9wTGVmdC54KCk7XG4gICAgICAgICAgICBjb25zdCB0b3BPZmZzZXRZID0gdG9wTGVmdC55KCk7XG4gICAgICAgICAgICBjb25zdCBib3R0b21PZmZzZXRYID0gdGhpcy5nZXRXaWR0aCgpIC0gYm90dG9tUmlnaHQueCgpO1xuICAgICAgICAgICAgY29uc3QgYm90dG9tT2Zmc2V0WSA9IHRoaXMuZ2V0SGVpZ2h0KCkgLSBib3R0b21SaWdodC55KCk7XG4gICAgICAgICAgICBib3R0b21SaWdodC5tb3ZlKHtcbiAgICAgICAgICAgICAgICB4OiAtdG9wT2Zmc2V0WCxcbiAgICAgICAgICAgICAgICB5OiAtdG9wT2Zmc2V0WSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdG9wTGVmdC5tb3ZlKHtcbiAgICAgICAgICAgICAgICB4OiBib3R0b21PZmZzZXRYLFxuICAgICAgICAgICAgICAgIHk6IGJvdHRvbU9mZnNldFksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhYnNQb3MgPSB0aGlzLmZpbmRPbmUoJy50b3AtbGVmdCcpLmdldEFic29sdXRlUG9zaXRpb24oKTtcbiAgICAgICAgeCA9IGFic1Bvcy54O1xuICAgICAgICB5ID0gYWJzUG9zLnk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5maW5kT25lKCcuYm90dG9tLXJpZ2h0JykueCgpIC0gdGhpcy5maW5kT25lKCcudG9wLWxlZnQnKS54KCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuZmluZE9uZSgnLmJvdHRvbS1yaWdodCcpLnkoKSAtIHRoaXMuZmluZE9uZSgnLnRvcC1sZWZ0JykueSgpO1xuICAgICAgICB0aGlzLl9maXROb2Rlc0ludG8oe1xuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHksXG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgIHJvdGF0aW9uOiBLb252YS5nZXRBbmdsZSh0aGlzLnJvdGF0aW9uKCkpLFxuICAgICAgICB9LCBlKTtcbiAgICB9XG4gICAgX2hhbmRsZU1vdXNlVXAoZSkge1xuICAgICAgICB0aGlzLl9yZW1vdmVFdmVudHMoZSk7XG4gICAgfVxuICAgIGdldEFic29sdXRlVHJhbnNmb3JtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUcmFuc2Zvcm0oKTtcbiAgICB9XG4gICAgX3JlbW92ZUV2ZW50cyhlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRoaXMuX3RyYW5zZm9ybWluZykge1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNmb3JtaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5faGFuZGxlTW91c2VNb3ZlKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5faGFuZGxlTW91c2VNb3ZlKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX2hhbmRsZU1vdXNlVXAsIHRydWUpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuX2hhbmRsZU1vdXNlVXAsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMuZ2V0Tm9kZSgpO1xuICAgICAgICAgICAgYWN0aXZlVHJhbnNmb3JtZXJzQ291bnQtLTtcbiAgICAgICAgICAgIHRoaXMuX2ZpcmUoJ3RyYW5zZm9ybWVuZCcsIHsgZXZ0OiBlLCB0YXJnZXQ6IG5vZGUgfSk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLmdldExheWVyKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5iYXRjaERyYXcoKTtcbiAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbm9kZXMuZm9yRWFjaCgodGFyZ2V0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Ll9maXJlKCd0cmFuc2Zvcm1lbmQnLCB7IGV2dDogZSwgdGFyZ2V0IH0pO1xuICAgICAgICAgICAgICAgICAgICAoX2EgPSB0YXJnZXQuZ2V0TGF5ZXIoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmJhdGNoRHJhdygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbW92aW5nQW5jaG9yTmFtZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZpdE5vZGVzSW50byhuZXdBdHRycywgZXZ0KSB7XG4gICAgICAgIGNvbnN0IG9sZEF0dHJzID0gdGhpcy5fZ2V0Tm9kZVJlY3QoKTtcbiAgICAgICAgY29uc3QgbWluU2l6ZSA9IDE7XG4gICAgICAgIGlmIChVdGlsLl9pblJhbmdlKG5ld0F0dHJzLndpZHRoLCAtdGhpcy5wYWRkaW5nKCkgKiAyIC0gbWluU2l6ZSwgbWluU2l6ZSkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWwuX2luUmFuZ2UobmV3QXR0cnMuaGVpZ2h0LCAtdGhpcy5wYWRkaW5nKCkgKiAyIC0gbWluU2l6ZSwgbWluU2l6ZSkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdCA9IG5ldyBUcmFuc2Zvcm0oKTtcbiAgICAgICAgdC5yb3RhdGUoS29udmEuZ2V0QW5nbGUodGhpcy5yb3RhdGlvbigpKSk7XG4gICAgICAgIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lICYmXG4gICAgICAgICAgICBuZXdBdHRycy53aWR0aCA8IDAgJiZcbiAgICAgICAgICAgIHRoaXMuX21vdmluZ0FuY2hvck5hbWUuaW5kZXhPZignbGVmdCcpID49IDApIHtcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHQucG9pbnQoe1xuICAgICAgICAgICAgICAgIHg6IC10aGlzLnBhZGRpbmcoKSAqIDIsXG4gICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbmV3QXR0cnMueCArPSBvZmZzZXQueDtcbiAgICAgICAgICAgIG5ld0F0dHJzLnkgKz0gb2Zmc2V0Lnk7XG4gICAgICAgICAgICBuZXdBdHRycy53aWR0aCArPSB0aGlzLnBhZGRpbmcoKSAqIDI7XG4gICAgICAgICAgICB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID0gdGhpcy5fbW92aW5nQW5jaG9yTmFtZS5yZXBsYWNlKCdsZWZ0JywgJ3JpZ2h0Jyk7XG4gICAgICAgICAgICB0aGlzLl9hbmNob3JEcmFnT2Zmc2V0LnggLT0gb2Zmc2V0Lng7XG4gICAgICAgICAgICB0aGlzLl9hbmNob3JEcmFnT2Zmc2V0LnkgLT0gb2Zmc2V0Lnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbW92aW5nQW5jaG9yTmFtZSAmJlxuICAgICAgICAgICAgbmV3QXR0cnMud2lkdGggPCAwICYmXG4gICAgICAgICAgICB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lLmluZGV4T2YoJ3JpZ2h0JykgPj0gMCkge1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdC5wb2ludCh7XG4gICAgICAgICAgICAgICAgeDogdGhpcy5wYWRkaW5nKCkgKiAyLFxuICAgICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX21vdmluZ0FuY2hvck5hbWUgPSB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lLnJlcGxhY2UoJ3JpZ2h0JywgJ2xlZnQnKTtcbiAgICAgICAgICAgIHRoaXMuX2FuY2hvckRyYWdPZmZzZXQueCAtPSBvZmZzZXQueDtcbiAgICAgICAgICAgIHRoaXMuX2FuY2hvckRyYWdPZmZzZXQueSAtPSBvZmZzZXQueTtcbiAgICAgICAgICAgIG5ld0F0dHJzLndpZHRoICs9IHRoaXMucGFkZGluZygpICogMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbW92aW5nQW5jaG9yTmFtZSAmJlxuICAgICAgICAgICAgbmV3QXR0cnMuaGVpZ2h0IDwgMCAmJlxuICAgICAgICAgICAgdGhpcy5fbW92aW5nQW5jaG9yTmFtZS5pbmRleE9mKCd0b3AnKSA+PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXQgPSB0LnBvaW50KHtcbiAgICAgICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgICAgIHk6IC10aGlzLnBhZGRpbmcoKSAqIDIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5ld0F0dHJzLnggKz0gb2Zmc2V0Lng7XG4gICAgICAgICAgICBuZXdBdHRycy55ICs9IG9mZnNldC55O1xuICAgICAgICAgICAgdGhpcy5fbW92aW5nQW5jaG9yTmFtZSA9IHRoaXMuX21vdmluZ0FuY2hvck5hbWUucmVwbGFjZSgndG9wJywgJ2JvdHRvbScpO1xuICAgICAgICAgICAgdGhpcy5fYW5jaG9yRHJhZ09mZnNldC54IC09IG9mZnNldC54O1xuICAgICAgICAgICAgdGhpcy5fYW5jaG9yRHJhZ09mZnNldC55IC09IG9mZnNldC55O1xuICAgICAgICAgICAgbmV3QXR0cnMuaGVpZ2h0ICs9IHRoaXMucGFkZGluZygpICogMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9tb3ZpbmdBbmNob3JOYW1lICYmXG4gICAgICAgICAgICBuZXdBdHRycy5oZWlnaHQgPCAwICYmXG4gICAgICAgICAgICB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lLmluZGV4T2YoJ2JvdHRvbScpID49IDApIHtcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHQucG9pbnQoe1xuICAgICAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICAgICAgeTogdGhpcy5wYWRkaW5nKCkgKiAyLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9tb3ZpbmdBbmNob3JOYW1lID0gdGhpcy5fbW92aW5nQW5jaG9yTmFtZS5yZXBsYWNlKCdib3R0b20nLCAndG9wJyk7XG4gICAgICAgICAgICB0aGlzLl9hbmNob3JEcmFnT2Zmc2V0LnggLT0gb2Zmc2V0Lng7XG4gICAgICAgICAgICB0aGlzLl9hbmNob3JEcmFnT2Zmc2V0LnkgLT0gb2Zmc2V0Lnk7XG4gICAgICAgICAgICBuZXdBdHRycy5oZWlnaHQgKz0gdGhpcy5wYWRkaW5nKCkgKiAyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJvdW5kQm94RnVuYygpKSB7XG4gICAgICAgICAgICBjb25zdCBib3VuZGVkID0gdGhpcy5ib3VuZEJveEZ1bmMoKShvbGRBdHRycywgbmV3QXR0cnMpO1xuICAgICAgICAgICAgaWYgKGJvdW5kZWQpIHtcbiAgICAgICAgICAgICAgICBuZXdBdHRycyA9IGJvdW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oJ2JvdW5kQm94RnVuYyByZXR1cm5lZCBmYWxzeS4gWW91IHNob3VsZCByZXR1cm4gbmV3IGJvdW5kIHJlY3QgZnJvbSBpdCEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBiYXNlU2l6ZSA9IDEwMDAwMDAwO1xuICAgICAgICBjb25zdCBvbGRUciA9IG5ldyBUcmFuc2Zvcm0oKTtcbiAgICAgICAgb2xkVHIudHJhbnNsYXRlKG9sZEF0dHJzLngsIG9sZEF0dHJzLnkpO1xuICAgICAgICBvbGRUci5yb3RhdGUob2xkQXR0cnMucm90YXRpb24pO1xuICAgICAgICBvbGRUci5zY2FsZShvbGRBdHRycy53aWR0aCAvIGJhc2VTaXplLCBvbGRBdHRycy5oZWlnaHQgLyBiYXNlU2l6ZSk7XG4gICAgICAgIGNvbnN0IG5ld1RyID0gbmV3IFRyYW5zZm9ybSgpO1xuICAgICAgICBjb25zdCBuZXdTY2FsZVggPSBuZXdBdHRycy53aWR0aCAvIGJhc2VTaXplO1xuICAgICAgICBjb25zdCBuZXdTY2FsZVkgPSBuZXdBdHRycy5oZWlnaHQgLyBiYXNlU2l6ZTtcbiAgICAgICAgaWYgKHRoaXMuZmxpcEVuYWJsZWQoKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG5ld1RyLnRyYW5zbGF0ZShuZXdBdHRycy54LCBuZXdBdHRycy55KTtcbiAgICAgICAgICAgIG5ld1RyLnJvdGF0ZShuZXdBdHRycy5yb3RhdGlvbik7XG4gICAgICAgICAgICBuZXdUci50cmFuc2xhdGUobmV3QXR0cnMud2lkdGggPCAwID8gbmV3QXR0cnMud2lkdGggOiAwLCBuZXdBdHRycy5oZWlnaHQgPCAwID8gbmV3QXR0cnMuaGVpZ2h0IDogMCk7XG4gICAgICAgICAgICBuZXdUci5zY2FsZShNYXRoLmFicyhuZXdTY2FsZVgpLCBNYXRoLmFicyhuZXdTY2FsZVkpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5ld1RyLnRyYW5zbGF0ZShuZXdBdHRycy54LCBuZXdBdHRycy55KTtcbiAgICAgICAgICAgIG5ld1RyLnJvdGF0ZShuZXdBdHRycy5yb3RhdGlvbik7XG4gICAgICAgICAgICBuZXdUci5zY2FsZShuZXdTY2FsZVgsIG5ld1NjYWxlWSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVsdGEgPSBuZXdUci5tdWx0aXBseShvbGRUci5pbnZlcnQoKSk7XG4gICAgICAgIHRoaXMuX25vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGlmICghbm9kZS5nZXRTdGFnZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGFyZW50VHJhbnNmb3JtID0gbm9kZS5nZXRQYXJlbnQoKS5nZXRBYnNvbHV0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgY29uc3QgbG9jYWxUcmFuc2Zvcm0gPSBub2RlLmdldFRyYW5zZm9ybSgpLmNvcHkoKTtcbiAgICAgICAgICAgIGxvY2FsVHJhbnNmb3JtLnRyYW5zbGF0ZShub2RlLm9mZnNldFgoKSwgbm9kZS5vZmZzZXRZKCkpO1xuICAgICAgICAgICAgY29uc3QgbmV3TG9jYWxUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICBuZXdMb2NhbFRyYW5zZm9ybVxuICAgICAgICAgICAgICAgIC5tdWx0aXBseShwYXJlbnRUcmFuc2Zvcm0uY29weSgpLmludmVydCgpKVxuICAgICAgICAgICAgICAgIC5tdWx0aXBseShkZWx0YSlcbiAgICAgICAgICAgICAgICAubXVsdGlwbHkocGFyZW50VHJhbnNmb3JtKVxuICAgICAgICAgICAgICAgIC5tdWx0aXBseShsb2NhbFRyYW5zZm9ybSk7XG4gICAgICAgICAgICBjb25zdCBhdHRycyA9IG5ld0xvY2FsVHJhbnNmb3JtLmRlY29tcG9zZSgpO1xuICAgICAgICAgICAgbm9kZS5zZXRBdHRycyhhdHRycyk7XG4gICAgICAgICAgICAoX2EgPSBub2RlLmdldExheWVyKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5iYXRjaERyYXcoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucm90YXRpb24oVXRpbC5fZ2V0Um90YXRpb24obmV3QXR0cnMucm90YXRpb24pKTtcbiAgICAgICAgdGhpcy5fbm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fZmlyZSgndHJhbnNmb3JtJywgeyBldnQ6IGV2dCwgdGFyZ2V0OiBub2RlIH0pO1xuICAgICAgICAgICAgbm9kZS5fZmlyZSgndHJhbnNmb3JtJywgeyBldnQ6IGV2dCwgdGFyZ2V0OiBub2RlIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcmVzZXRUcmFuc2Zvcm1DYWNoZSgpO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmdldExheWVyKCkuYmF0Y2hEcmF3KCk7XG4gICAgfVxuICAgIGZvcmNlVXBkYXRlKCkge1xuICAgICAgICB0aGlzLl9yZXNldFRyYW5zZm9ybUNhY2hlKCk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIF9iYXRjaENoYW5nZUNoaWxkKHNlbGVjdG9yLCBhdHRycykge1xuICAgICAgICBjb25zdCBhbmNob3IgPSB0aGlzLmZpbmRPbmUoc2VsZWN0b3IpO1xuICAgICAgICBhbmNob3Iuc2V0QXR0cnMoYXR0cnMpO1xuICAgIH1cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgYXR0cnMgPSB0aGlzLl9nZXROb2RlUmVjdCgpO1xuICAgICAgICB0aGlzLnJvdGF0aW9uKFV0aWwuX2dldFJvdGF0aW9uKGF0dHJzLnJvdGF0aW9uKSk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gYXR0cnMud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGF0dHJzLmhlaWdodDtcbiAgICAgICAgY29uc3QgZW5hYmxlZEFuY2hvcnMgPSB0aGlzLmVuYWJsZWRBbmNob3JzKCk7XG4gICAgICAgIGNvbnN0IHJlc2l6ZUVuYWJsZWQgPSB0aGlzLnJlc2l6ZUVuYWJsZWQoKTtcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IHRoaXMucGFkZGluZygpO1xuICAgICAgICBjb25zdCBhbmNob3JTaXplID0gdGhpcy5hbmNob3JTaXplKCk7XG4gICAgICAgIGNvbnN0IGFuY2hvcnMgPSB0aGlzLmZpbmQoJy5fYW5jaG9yJyk7XG4gICAgICAgIGFuY2hvcnMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgICAgbm9kZS5zZXRBdHRycyh7XG4gICAgICAgICAgICAgICAgd2lkdGg6IGFuY2hvclNpemUsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBhbmNob3JTaXplLFxuICAgICAgICAgICAgICAgIG9mZnNldFg6IGFuY2hvclNpemUgLyAyLFxuICAgICAgICAgICAgICAgIG9mZnNldFk6IGFuY2hvclNpemUgLyAyLFxuICAgICAgICAgICAgICAgIHN0cm9rZTogdGhpcy5hbmNob3JTdHJva2UoKSxcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogdGhpcy5hbmNob3JTdHJva2VXaWR0aCgpLFxuICAgICAgICAgICAgICAgIGZpbGw6IHRoaXMuYW5jaG9yRmlsbCgpLFxuICAgICAgICAgICAgICAgIGNvcm5lclJhZGl1czogdGhpcy5hbmNob3JDb3JuZXJSYWRpdXMoKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYmF0Y2hDaGFuZ2VDaGlsZCgnLnRvcC1sZWZ0Jywge1xuICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICBvZmZzZXRYOiBhbmNob3JTaXplIC8gMiArIHBhZGRpbmcsXG4gICAgICAgICAgICBvZmZzZXRZOiBhbmNob3JTaXplIC8gMiArIHBhZGRpbmcsXG4gICAgICAgICAgICB2aXNpYmxlOiByZXNpemVFbmFibGVkICYmIGVuYWJsZWRBbmNob3JzLmluZGV4T2YoJ3RvcC1sZWZ0JykgPj0gMCxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2JhdGNoQ2hhbmdlQ2hpbGQoJy50b3AtY2VudGVyJywge1xuICAgICAgICAgICAgeDogd2lkdGggLyAyLFxuICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgIG9mZnNldFk6IGFuY2hvclNpemUgLyAyICsgcGFkZGluZyxcbiAgICAgICAgICAgIHZpc2libGU6IHJlc2l6ZUVuYWJsZWQgJiYgZW5hYmxlZEFuY2hvcnMuaW5kZXhPZigndG9wLWNlbnRlcicpID49IDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9iYXRjaENoYW5nZUNoaWxkKCcudG9wLXJpZ2h0Jywge1xuICAgICAgICAgICAgeDogd2lkdGgsXG4gICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgb2Zmc2V0WDogYW5jaG9yU2l6ZSAvIDIgLSBwYWRkaW5nLFxuICAgICAgICAgICAgb2Zmc2V0WTogYW5jaG9yU2l6ZSAvIDIgKyBwYWRkaW5nLFxuICAgICAgICAgICAgdmlzaWJsZTogcmVzaXplRW5hYmxlZCAmJiBlbmFibGVkQW5jaG9ycy5pbmRleE9mKCd0b3AtcmlnaHQnKSA+PSAwLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYmF0Y2hDaGFuZ2VDaGlsZCgnLm1pZGRsZS1sZWZ0Jywge1xuICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgIHk6IGhlaWdodCAvIDIsXG4gICAgICAgICAgICBvZmZzZXRYOiBhbmNob3JTaXplIC8gMiArIHBhZGRpbmcsXG4gICAgICAgICAgICB2aXNpYmxlOiByZXNpemVFbmFibGVkICYmIGVuYWJsZWRBbmNob3JzLmluZGV4T2YoJ21pZGRsZS1sZWZ0JykgPj0gMCxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2JhdGNoQ2hhbmdlQ2hpbGQoJy5taWRkbGUtcmlnaHQnLCB7XG4gICAgICAgICAgICB4OiB3aWR0aCxcbiAgICAgICAgICAgIHk6IGhlaWdodCAvIDIsXG4gICAgICAgICAgICBvZmZzZXRYOiBhbmNob3JTaXplIC8gMiAtIHBhZGRpbmcsXG4gICAgICAgICAgICB2aXNpYmxlOiByZXNpemVFbmFibGVkICYmIGVuYWJsZWRBbmNob3JzLmluZGV4T2YoJ21pZGRsZS1yaWdodCcpID49IDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9iYXRjaENoYW5nZUNoaWxkKCcuYm90dG9tLWxlZnQnLCB7XG4gICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgeTogaGVpZ2h0LFxuICAgICAgICAgICAgb2Zmc2V0WDogYW5jaG9yU2l6ZSAvIDIgKyBwYWRkaW5nLFxuICAgICAgICAgICAgb2Zmc2V0WTogYW5jaG9yU2l6ZSAvIDIgLSBwYWRkaW5nLFxuICAgICAgICAgICAgdmlzaWJsZTogcmVzaXplRW5hYmxlZCAmJiBlbmFibGVkQW5jaG9ycy5pbmRleE9mKCdib3R0b20tbGVmdCcpID49IDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9iYXRjaENoYW5nZUNoaWxkKCcuYm90dG9tLWNlbnRlcicsIHtcbiAgICAgICAgICAgIHg6IHdpZHRoIC8gMixcbiAgICAgICAgICAgIHk6IGhlaWdodCxcbiAgICAgICAgICAgIG9mZnNldFk6IGFuY2hvclNpemUgLyAyIC0gcGFkZGluZyxcbiAgICAgICAgICAgIHZpc2libGU6IHJlc2l6ZUVuYWJsZWQgJiYgZW5hYmxlZEFuY2hvcnMuaW5kZXhPZignYm90dG9tLWNlbnRlcicpID49IDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9iYXRjaENoYW5nZUNoaWxkKCcuYm90dG9tLXJpZ2h0Jywge1xuICAgICAgICAgICAgeDogd2lkdGgsXG4gICAgICAgICAgICB5OiBoZWlnaHQsXG4gICAgICAgICAgICBvZmZzZXRYOiBhbmNob3JTaXplIC8gMiAtIHBhZGRpbmcsXG4gICAgICAgICAgICBvZmZzZXRZOiBhbmNob3JTaXplIC8gMiAtIHBhZGRpbmcsXG4gICAgICAgICAgICB2aXNpYmxlOiByZXNpemVFbmFibGVkICYmIGVuYWJsZWRBbmNob3JzLmluZGV4T2YoJ2JvdHRvbS1yaWdodCcpID49IDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9iYXRjaENoYW5nZUNoaWxkKCcucm90YXRlcicsIHtcbiAgICAgICAgICAgIHg6IHdpZHRoIC8gMixcbiAgICAgICAgICAgIHk6IC10aGlzLnJvdGF0ZUFuY2hvck9mZnNldCgpICogVXRpbC5fc2lnbihoZWlnaHQpIC0gcGFkZGluZyxcbiAgICAgICAgICAgIHZpc2libGU6IHRoaXMucm90YXRlRW5hYmxlZCgpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYmF0Y2hDaGFuZ2VDaGlsZCgnLmJhY2snLCB7XG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgIHZpc2libGU6IHRoaXMuYm9yZGVyRW5hYmxlZCgpLFxuICAgICAgICAgICAgc3Ryb2tlOiB0aGlzLmJvcmRlclN0cm9rZSgpLFxuICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IHRoaXMuYm9yZGVyU3Ryb2tlV2lkdGgoKSxcbiAgICAgICAgICAgIGRhc2g6IHRoaXMuYm9yZGVyRGFzaCgpLFxuICAgICAgICAgICAgZHJhZ2dhYmxlOiB0aGlzLm5vZGVzKCkuc29tZSgobm9kZSkgPT4gbm9kZS5kcmFnZ2FibGUoKSksXG4gICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgeTogMCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN0eWxlRnVuYyA9IHRoaXMuYW5jaG9yU3R5bGVGdW5jKCk7XG4gICAgICAgIGlmIChzdHlsZUZ1bmMpIHtcbiAgICAgICAgICAgIGFuY2hvcnMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIHN0eWxlRnVuYyhub2RlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IHRoaXMuZ2V0TGF5ZXIoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmJhdGNoRHJhdygpO1xuICAgIH1cbiAgICBpc1RyYW5zZm9ybWluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zZm9ybWluZztcbiAgICB9XG4gICAgc3RvcFRyYW5zZm9ybSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3RyYW5zZm9ybWluZykge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRzKCk7XG4gICAgICAgICAgICBjb25zdCBhbmNob3JOb2RlID0gdGhpcy5maW5kT25lKCcuJyArIHRoaXMuX21vdmluZ0FuY2hvck5hbWUpO1xuICAgICAgICAgICAgaWYgKGFuY2hvck5vZGUpIHtcbiAgICAgICAgICAgICAgICBhbmNob3JOb2RlLnN0b3BEcmFnKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZ2V0U3RhZ2UoKSAmJiB0aGlzLl9jdXJzb3JDaGFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0U3RhZ2UoKS5jb250ZW50ICYmICh0aGlzLmdldFN0YWdlKCkuY29udGVudC5zdHlsZS5jdXJzb3IgPSAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgR3JvdXAucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kZXRhY2goKTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRzKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0b09iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIE5vZGUucHJvdG90eXBlLnRvT2JqZWN0LmNhbGwodGhpcyk7XG4gICAgfVxuICAgIGNsb25lKG9iaikge1xuICAgICAgICBjb25zdCBub2RlID0gTm9kZS5wcm90b3R5cGUuY2xvbmUuY2FsbCh0aGlzLCBvYmopO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG4gICAgZ2V0Q2xpZW50UmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMubm9kZXMoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Q2xpZW50UmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHsgeDogMCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xuICAgICAgICB9XG4gICAgfVxufVxuVHJhbnNmb3JtZXIuaXNUcmFuc2Zvcm1pbmcgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGFjdGl2ZVRyYW5zZm9ybWVyc0NvdW50ID4gMDtcbn07XG5mdW5jdGlvbiB2YWxpZGF0ZUFuY2hvcnModmFsKSB7XG4gICAgaWYgKCEodmFsIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgIFV0aWwud2FybignZW5hYmxlZEFuY2hvcnMgdmFsdWUgc2hvdWxkIGJlIGFuIGFycmF5Jyk7XG4gICAgfVxuICAgIGlmICh2YWwgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICB2YWwuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgaWYgKEFOQ0hPUlNfTkFNRVMuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBVdGlsLndhcm4oJ1Vua25vd24gYW5jaG9yIG5hbWU6ICcgK1xuICAgICAgICAgICAgICAgICAgICBuYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJy4gQXZhaWxhYmxlIG5hbWVzIGFyZTogJyArXG4gICAgICAgICAgICAgICAgICAgIEFOQ0hPUlNfTkFNRVMuam9pbignLCAnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdmFsIHx8IFtdO1xufVxuVHJhbnNmb3JtZXIucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdUcmFuc2Zvcm1lcic7XG5fcmVnaXN0ZXJOb2RlKFRyYW5zZm9ybWVyKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnZW5hYmxlZEFuY2hvcnMnLCBBTkNIT1JTX05BTUVTLCB2YWxpZGF0ZUFuY2hvcnMpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdmbGlwRW5hYmxlZCcsIHRydWUsIGdldEJvb2xlYW5WYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ3Jlc2l6ZUVuYWJsZWQnLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnYW5jaG9yU2l6ZScsIDEwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ3JvdGF0ZUVuYWJsZWQnLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAncm90YXRlTGluZVZpc2libGUnLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAncm90YXRpb25TbmFwcycsIFtdKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAncm90YXRlQW5jaG9yT2Zmc2V0JywgNTAsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAncm90YXRlQW5jaG9yQ3Vyc29yJywgJ2Nyb3NzaGFpcicpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdyb3RhdGlvblNuYXBUb2xlcmFuY2UnLCA1LCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ2JvcmRlckVuYWJsZWQnLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnYW5jaG9yU3Ryb2tlJywgJ3JnYigwLCAxNjEsIDI1NSknKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnYW5jaG9yU3Ryb2tlV2lkdGgnLCAxLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ2FuY2hvckZpbGwnLCAnd2hpdGUnKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnYW5jaG9yQ29ybmVyUmFkaXVzJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdib3JkZXJTdHJva2UnLCAncmdiKDAsIDE2MSwgMjU1KScpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdib3JkZXJTdHJva2VXaWR0aCcsIDEsIGdldE51bWJlclZhbGlkYXRvcigpKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnYm9yZGVyRGFzaCcpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdrZWVwUmF0aW8nLCB0cnVlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnc2hpZnRCZWhhdmlvcicsICdkZWZhdWx0Jyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ2NlbnRlcmVkU2NhbGluZycsIGZhbHNlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAnaWdub3JlU3Ryb2tlJywgZmFsc2UpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdwYWRkaW5nJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdub2RlcycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdub2RlJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ2JvdW5kQm94RnVuYycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdhbmNob3JEcmFnQm91bmRGdW5jJyk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihUcmFuc2Zvcm1lciwgJ2FuY2hvclN0eWxlRnVuYycpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoVHJhbnNmb3JtZXIsICdzaG91bGRPdmVyZHJhd1dob2xlQXJlYScsIGZhbHNlKTtcbkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKFRyYW5zZm9ybWVyLCAndXNlU2luZ2xlTm9kZVJvdGF0aW9uJywgdHJ1ZSk7XG5GYWN0b3J5LmJhY2tDb21wYXQoVHJhbnNmb3JtZXIsIHtcbiAgICBsaW5lRW5hYmxlZDogJ2JvcmRlckVuYWJsZWQnLFxuICAgIHJvdGF0ZUhhbmRsZXJPZmZzZXQ6ICdyb3RhdGVBbmNob3JPZmZzZXQnLFxuICAgIGVuYWJsZWRIYW5kbGVyczogJ2VuYWJsZWRBbmNob3JzJyxcbn0pO1xuIiwiaW1wb3J0IHsgRmFjdG9yeSB9IGZyb20gXCIuLi9GYWN0b3J5LmpzXCI7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9TaGFwZS5qc1wiO1xuaW1wb3J0IHsgS29udmEgfSBmcm9tIFwiLi4vR2xvYmFsLmpzXCI7XG5pbXBvcnQgeyBnZXROdW1iZXJWYWxpZGF0b3IgfSBmcm9tIFwiLi4vVmFsaWRhdG9ycy5qc1wiO1xuaW1wb3J0IHsgX3JlZ2lzdGVyTm9kZSB9IGZyb20gXCIuLi9HbG9iYWwuanNcIjtcbmV4cG9ydCBjbGFzcyBXZWRnZSBleHRlbmRzIFNoYXBlIHtcbiAgICBfc2NlbmVGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5yYWRpdXMoKSwgMCwgS29udmEuZ2V0QW5nbGUodGhpcy5hbmdsZSgpKSwgdGhpcy5jbG9ja3dpc2UoKSk7XG4gICAgICAgIGNvbnRleHQubGluZVRvKDAsIDApO1xuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICB9XG4gICAgZ2V0V2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGl1cygpICogMjtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYWRpdXMoKSAqIDI7XG4gICAgfVxuICAgIHNldFdpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMucmFkaXVzKHdpZHRoIC8gMik7XG4gICAgfVxuICAgIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5yYWRpdXMoaGVpZ2h0IC8gMik7XG4gICAgfVxufVxuV2VkZ2UucHJvdG90eXBlLmNsYXNzTmFtZSA9ICdXZWRnZSc7XG5XZWRnZS5wcm90b3R5cGUuX2NlbnRyb2lkID0gdHJ1ZTtcbldlZGdlLnByb3RvdHlwZS5fYXR0cnNBZmZlY3RpbmdTaXplID0gWydyYWRpdXMnXTtcbl9yZWdpc3Rlck5vZGUoV2VkZ2UpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoV2VkZ2UsICdyYWRpdXMnLCAwLCBnZXROdW1iZXJWYWxpZGF0b3IoKSk7XG5GYWN0b3J5LmFkZEdldHRlclNldHRlcihXZWRnZSwgJ2FuZ2xlJywgMCwgZ2V0TnVtYmVyVmFsaWRhdG9yKCkpO1xuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoV2VkZ2UsICdjbG9ja3dpc2UnLCBmYWxzZSk7XG5GYWN0b3J5LmJhY2tDb21wYXQoV2VkZ2UsIHtcbiAgICBhbmdsZURlZzogJ2FuZ2xlJyxcbiAgICBnZXRBbmdsZURlZzogJ2dldEFuZ2xlJyxcbiAgICBzZXRBbmdsZURlZzogJ3NldEFuZ2xlJyxcbn0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0ZnVuY3Rpb24oKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG5cdFx0ZnVuY3Rpb24oKSB7IHJldHVybiBtb2R1bGU7IH07XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IEFwcGxpY2F0aW9uIH0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiO1xuaW1wb3J0IHsgZGVmaW5pdGlvbnNGcm9tQ29udGV4dCB9IGZyb20gXCJAaG90d2lyZWQvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzXCI7XG5pbXBvcnQgS29udmEgZnJvbSBcImtvbnZhXCI7XG5cbmNvbnNvbGUubG9nKFwidGVzdFwiKTtcblxud2luZG93LlN0aW11bHVzID0gQXBwbGljYXRpb24uc3RhcnQoKTtcbmNvbnN0IGNvbnRleHQgPSByZXF1aXJlLmNvbnRleHQoXCIuL2NvbnRyb2xsZXJzXCIsIHRydWUsIC9cXC5qcyQvKTtcblN0aW11bHVzLmxvYWQoZGVmaW5pdGlvbnNGcm9tQ29udGV4dChjb250ZXh0KSk7XG5cbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpO1xuY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG5pbWcuc3JjID1cbiAgXCJodHRwczovL3d3dy5nYXJkZW5nb3VybWV0Lm5sL3NpdGVzL2RlZmF1bHQvZmlsZXMvc3R5bGVzLzc2OF93aWR0aC9wdWJsaWMvMjAyNC0wOC92ZWdhbi1idXJnZXIucG5nP2l0b2s9cFhLV3U5d0JcIjtcblxuY2FudmFzLndpZHRoID0gODAwO1xuY2FudmFzLmhlaWdodCA9IDYwMDtcblxubGV0IGNhbnZhc0NpcmNsZVBvc2l0aW9ucyA9IFtcbiAgWzAuNSwgMC41XSxcbiAgWzAuNSwgMC4yXSxcbiAgWzAuNzEsIDAuMjldLFxuICBbMC44LCAwLjVdLFxuICBbMC43MSwgMC43MV0sXG4gIFswLjUsIDAuOF0sXG4gIFswLjI5LCAwLjcxXSxcbiAgWzAuMiwgMC41XSxcbiAgWzAuMjksIDAuMjldLFxuXTtcblxubGV0IGNpcmNsZVJhZGl1cyA9IDAuMSAqIGNhbnZhcy5oZWlnaHQ7XG5cbmxldCBhbW91bnRzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDldO1xuXG5jdHguZm9udCA9IFwiMjBweCBBcmlhbFwiO1xuY3R4LmZpbGxUZXh0KFwiQ2FyYm9uIENhbGN1bGF0b3JcIiwgY2FudmFzLndpZHRoIC8gMjAsIGNhbnZhcy5oZWlnaHQgLyAyMCk7XG5cbmN0eC5iZWdpblBhdGgoKTtcbmZvciAobGV0IFtpLCBwb3NpdGlvbl0gb2YgY2FudmFzQ2lyY2xlUG9zaXRpb25zLmVudHJpZXMoKSkge1xuICBjdHgubW92ZVRvKFxuICAgIHBvc2l0aW9uWzBdICogY2FudmFzLndpZHRoICsgY2lyY2xlUmFkaXVzLFxuICAgIHBvc2l0aW9uWzFdICogY2FudmFzLmhlaWdodFxuICApO1xuICBjdHguYXJjKFxuICAgIHBvc2l0aW9uWzBdICogY2FudmFzLndpZHRoLFxuICAgIHBvc2l0aW9uWzFdICogY2FudmFzLmhlaWdodCxcbiAgICBjaXJjbGVSYWRpdXMsXG4gICAgMCxcbiAgICAyICogTWF0aC5QSVxuICApO1xuXG4gIGZvciAobGV0IGogPSAwOyBqIDwgYW1vdW50c1tpXTsgaisrKVxuICAgIGltZy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICBjdHguZHJhd0ltYWdlKFxuICAgICAgICBpbWcsXG4gICAgICAgIHBvc2l0aW9uWzBdICogY2FudmFzLndpZHRoIC1cbiAgICAgICAgICAwLjUgKiBjaXJjbGVSYWRpdXMgK1xuICAgICAgICAgIGogKiAoY2lyY2xlUmFkaXVzIC8gYW1vdW50c1tpXSksXG4gICAgICAgIHBvc2l0aW9uWzFdICogY2FudmFzLmhlaWdodCAtICgwLjUgKiBjaXJjbGVSYWRpdXMpIC8gYW1vdW50c1tpXSxcbiAgICAgICAgY2lyY2xlUmFkaXVzIC8gYW1vdW50c1tpXSxcbiAgICAgICAgY2lyY2xlUmFkaXVzIC8gYW1vdW50c1tpXVxuICAgICAgKTtcbiAgICB9KTtcbn1cbmN0eC5zdHJva2UoKTtcblxuLy8gZmlyc3Qgd2UgbmVlZCB0byBjcmVhdGUgYSBzdGFnZVxuY29uc3Qgc3RhZ2UgPSBuZXcgS29udmEuU3RhZ2Uoe1xuICBjb250YWluZXI6IFwia29udmFcIiwgLy8gaWQgb2YgY29udGFpbmVyIDxkaXY+XG4gIHdpZHRoOiA4MDAsXG4gIGhlaWdodDogNjAwLFxufSk7XG5cbi8vIHRoZW4gY3JlYXRlIGxheWVyXG5jb25zdCBsYXllciA9IG5ldyBLb252YS5MYXllcigpO1xuXG4vLyBjcmVhdGUgb3VyIHNoYXBlc1xubGV0IGNpcmNsZVBvc2l0aW9ucyA9IFtcbiAgWzAuNSwgMC41XSxcbiAgWzAuNSwgMC4yXSxcbiAgWzAuNzEsIDAuMjldLFxuICBbMC44LCAwLjVdLFxuICBbMC43MSwgMC43MV0sXG4gIFswLjUsIDAuOF0sXG4gIFswLjI5LCAwLjcxXSxcbiAgWzAuMiwgMC41XSxcbiAgWzAuMjksIDAuMjldLFxuXTtcblxuZnVuY3Rpb24gY3JlYXRlQ2lyY2xlKHgsIHksIHJhZGl1cykge1xuICByZXR1cm4gbmV3IEtvbnZhLkNpcmNsZSh7XG4gICAgeDogeCxcbiAgICB5OiB5LFxuICAgIHJhZGl1czogcmFkaXVzLFxuICAgIGZpbGw6IFwid2hpdGVcIixcbiAgICBzdHJva2U6IFwiYmxhY2tcIixcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUltYWdlKHgsIHksIHdpZHRoLCBoZWlnaHQsIHNvdXJjZSkge1xuICBjb25zdCBpbWdPYmogPSBuZXcgSW1hZ2UoKTtcbiAgaW1nT2JqLnNyYyA9IHNvdXJjZTtcblxuICByZXR1cm4gbmV3IEtvbnZhLkltYWdlKHtcbiAgICB4OiB4LFxuICAgIHk6IHksXG4gICAgaW1hZ2U6IGltZ09iaixcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gIH0pO1xufVxuXG5mb3IgKGxldCBbaSwgcG9zaXRpb25dIG9mIGNpcmNsZVBvc2l0aW9ucy5lbnRyaWVzKCkpIHtcbiAgLy8gYWRkIHRoZSBzaGFwZXMgdG8gdGhlIGxheWVyXG4gIGxheWVyLmFkZChcbiAgICBjcmVhdGVDaXJjbGUoXG4gICAgICBzdGFnZS53aWR0aCgpICogcG9zaXRpb25bMF0sXG4gICAgICBzdGFnZS5oZWlnaHQoKSAqIHBvc2l0aW9uWzFdLFxuICAgICAgc3RhZ2Uud2lkdGgoKSAqIDAuMDhcbiAgICApXG4gICk7XG5cbiAgZm9yIChsZXQgaiA9IDA7IGogPCBhbW91bnRzW2ldOyBqKyspIHtcbiAgICBsYXllci5hZGQoXG4gICAgICBjcmVhdGVJbWFnZShcbiAgICAgICAgcG9zaXRpb25bMF0gKiBzdGFnZS53aWR0aCgpIC1cbiAgICAgICAgICAwLjUgKiBjaXJjbGVSYWRpdXMgK1xuICAgICAgICAgIGogKiAoY2lyY2xlUmFkaXVzIC8gYW1vdW50c1tpXSksXG4gICAgICAgIHBvc2l0aW9uWzFdICogc3RhZ2UuaGVpZ2h0KCkgLSAoMC41ICogY2lyY2xlUmFkaXVzKSAvIGFtb3VudHNbaV0sXG4gICAgICAgIGNpcmNsZVJhZGl1cyAvIGFtb3VudHNbaV0sXG4gICAgICAgIGNpcmNsZVJhZGl1cyAvIGFtb3VudHNbaV0sXG4gICAgICAgIFwiaHR0cHM6Ly93d3cuZ2FyZGVuZ291cm1ldC5ubC9zaXRlcy9kZWZhdWx0L2ZpbGVzL3N0eWxlcy83Njhfd2lkdGgvcHVibGljLzIwMjQtMDgvdmVnYW4tYnVyZ2VyLnBuZz9pdG9rPXBYS1d1OXdCXCJcbiAgICAgIClcbiAgICApO1xuICB9XG59XG5cbi8vIGFkZCB0aGUgbGF5ZXIgdG8gdGhlIHN0YWdlXG5zdGFnZS5hZGQobGF5ZXIpO1xuIiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307Il0sIm5hbWVzIjpbIkNvbnRyb2xsZXIiLCJ0YXJnZXRzIiwidG9nZ2xlUmVnaW9uIiwiZXZlbnQiLCJ0YXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJyZWdpb25UYXJnZXQiLCJzZXRBdHRyaWJ1dGUiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwid2luZG93Iiwic2Nyb2xsIiwidG9wIiwicGFnZVlPZmZzZXQiLCJpbm5lckhlaWdodCIsImxlZnQiLCJiZWhhdmlvciIsIm9wZW4iLCJzdG9wUHJvcGFnYXRpb24iLCJvdmVybGF5VGFyZ2V0IiwiY2xhc3NMaXN0IiwiYWRkIiwiY2xvc2UiLCJyZW1vdmUiLCJjb25uZWN0IiwiaW5pdGlhbGl6ZUJ1dHRvbnMiLCJpbml0aWFsaXplQ2hlY2tib3hlcyIsInNlbGVjdGVkQ2F0ZWdvcmllcyIsImdldFNlbGVjdGVkQ2F0ZWdvcmllcyIsInRvZ2dsZVN1Z2dlc3Rpb25zRGl2IiwiY29udGludWVCdXR0b24iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYmFja0J1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJhY3RpdmF0ZVN0ZXBUd28iLCJiaW5kIiwiYWN0aXZhdGVTdGVwT25lIiwiY2F0ZWdvcmllc0ZpZWxkIiwicXVlcnlTZWxlY3RvciIsImNoZWNrYm94ZXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwidGhpc1JlZiIsImZvckVhY2giLCJlIiwiY2hlY2tlZCIsInB1c2giLCJ2YWx1ZSIsInNob3dTdWdnZXN0aW9uQ2F0ZWdvcnkiLCJwb3AiLCJoaWRlU3VnZ2VzdGlvbkNhdGVnb3J5IiwidGlwc0RpdiIsImxlbmd0aCIsImNhdGVnb3J5IiwiaWROYW1lIiwicmVwbGFjZUFsbCIsInN1Z2dlc3Rpb25EaXYiLCJwYXJlbnQiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsInNjcm9sbFRvIiwiY2F0ZWdvcmllc1NwYW4iLCJpbm5lckhUTUwiLCJnZXRTZWxlY3RlZENhdGVnb3JpZXNIVE1MIiwic2VsZWN0ZWRDYXRlZ29yeUJ1dHRvbnMiLCJodG1sU3RyaW5nIiwiY29weSIsInVwZGF0ZUNvZGUiLCJrZXl1cCIsInNlbGYiLCJjb2RlVGFyZ2V0IiwibWVzc2FnZVRhcmdldCIsInN0eWxlIiwiZGlzcGxheSIsInNldFRpbWVvdXQiLCJjbGVhciIsInRpdGxlVGFyZ2V0IiwiZm9jdXMiLCJ1cmxUYXJnZXQiLCJleGFtcGxlVGFyZ2V0IiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwidGl0bGUiLCJsaW5rVGFyZ2V0cyIsImVsZW1lbnQiLCJzb2NpYWxNZWRpYVBsYXRmb3JtIiwiZGF0YXNldCIsInNvY2lhbFBsYXRmb3JtIiwibGluayJdLCJzb3VyY2VSb290IjoiIn0=